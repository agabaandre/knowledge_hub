var spread;
var app;
var APP_NAME="Mutima Docs";

! function e(t, i) { "object" == typeof exports && "object" == typeof module ? module.exports = i() : "function" == typeof define && define.amd ? define([], i) : "object" == typeof exports ? exports.designerUI = i() : (t.GC = t.GC || {}, t.GC.Spread = t.GC.Spread || {}, t.GC.Spread.Sheets = t.GC.Spread.Sheets || {}, t.GC.Spread.Sheets.Designer = t.GC.Spread.Sheets.Designer || {}, t.GC.Spread.Sheets.Designer.designerUI = i()) }(this, function() {
    return function(e) {
        var t = {};

        function i(o) { if (t[o]) return t[o].exports; var n = t[o] = { i: o, l: !1, exports: {} }; return e[o].call(n.exports, n, n.exports, i), n.l = !0, n.exports }
        return i.m = e, i.c = t, i.i = function(e) { return e }, i.d = function(e, t, o) { i.o(e, t) || Object.defineProperty(e, t, { configurable: !1, enumerable: !0, get: o }) }, i.n = function(e) { var t = e && e.h ? function t() { return e.default } : function t() { return e }; return i.d(t, "a", t), t }, i.o = function(e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, i.p = "", i(i.s = 49)
    }([function(e, t) {
        ! function() {
            "use strict";
            var t = {};

            function i(e) { return void 0 === e || null === e } t.isNullOrUndefined = i;

            function o(e) {
                var t, i, o = e.shapes.all(),
                    n = [];
                for (t = 0; t < o.length; t++) i = o[t], i.isSelected() && n.push(i);
                return n
            }
            t.getActiveShapes = o;

            function n(e, t) { if (i(e)) return !1; for (var o = 0; o < e.length; o++) { if ("groupShapeType" === a(e[o])) return n(e[o].all(), t); if (a(e[o]) === t) return !0 } return !1 } t.isHasAppointedShapeType = n;

            function r(e, t) { if (!(e && e.length < 0)) { for (var i = 0; i < e.length; i++) { if ("groupShapeType" === a(e[i])) return r(e[i].all(), t); if (a(e[i]) !== t) return !1 } return !0 } } t.isAllIsAppointedShapeType = r;

            function a(e) { return e instanceof GC.Spread.Sheets.Shapes.Shape ? "autoShapeType" : e instanceof GC.Spread.Sheets.Shapes.ConnectorShape ? "connectorShapeType" : e instanceof GC.Spread.Sheets.Shapes.GroupShape ? "groupShapeType" : void 0 } t.getShapeType = a;

            function s(e, t) {
                var o, n, r, a;
                if (!i(e))
                    for (o = 0; o < e.length; o++) {
                        if ((n = e[o]) instanceof GC.Spread.Sheets.Shapes.GroupShape) return s(n.all(), t);
                        for (r = 0; r < t.length; r++)
                            if (a = t[r], n instanceof GC.Spread.Sheets.Shapes[a]) return n
                    }
            }
            t.getAppointedShape = s;

            function l(e) {
                var t = o(e),
                    i = [
                        [],
                        [],
                        []
                    ];
                return t.forEach(function(e) { i[0].push(e.width()), i[1].push(e.height()), e.rotate && i[2].push(e.rotate()) }), i[0] = c(i[0]), i[1] = c(i[1]), i[2] = c(i[2]), i
            }
            t.updataSize = l;

            function c(e) {
                var t, i = !0;
                if (e) {
                    for (t = 1; t < e.length; t++)
                        if (void 0 !== e[t] && "" !== e[t] && e[t] !== e[0]) { i = !1; break } return i ? e[0] : ""
                }
            }
            t.getDataInValueArray = c;

            function d(e) {
                var t, i, o = e.getActiveRowIndex(),
                    n = e.getActiveColumnIndex(),
                    r = e.getViewportBottomRow(1),
                    a = e.getViewportTopRow(1),
                    s = e.getViewportLeftColumn(1),
                    l = e.getViewportRightColumn(1);
                return t = o <= a ? a : o >= r ? r : o, i = n <= s ? s : n >= l ? l : n, p(e, t, i)
            }
            t.getShapePosition = d;

            function p(e, t, i) {
                var o, n, r = 20,
                    a = 20;
                for (o = 0; o < i; o++) r += e.getColumnWidth(o);
                for (n = 0; n < t; n++) a += e.getRowHeight(n);
                return { x: r, y: a }
            }
            t.getShapePositionInXY = p, e.exports = t
        }()
    }, function(e, t) { e.exports = { chartColors: { colorful: { name: "Colorful", colors: [{ tip: "Blue, Orange, Gray, Gold, Blue, Green", items: ["accent 1", "accent 2", "accent 3", "accent 4", "accent 5", "accent 6"] }, { tip: "Blue, Orange, Gray, Gold, Blue, Green", items: ["accent 1", "accent 3", "accent 5", "accent 1 -40", "accent 3 -40", "accent 5 -40"] }, { tip: "Blue, Orange, Gray, Gold, Blue, Green", items: ["accent 2", "accent 4", "accent 6", "accent 2 -40", "accent 4 -40", "accent 6 -40"] }, { tip: "Blue, Orange, Gray, Gold, Blue, Green", items: ["accent 6", "accent 5", "accent 4", "accent 6 -40", "accent 5 -40", "accent 4 -40"] }] }, monochromatic: { name: "Monochromatic", colors: [{ tip: "Blue gradient, dark to light", items: { startColor: "accent 1 -50", stopColor: "accent 1 50" } }, { tip: "Orange gradient, dark to light", items: { startColor: "accent 2 -50", stopColor: "accent 2 50" } }, { tip: "Gray gradient, dark to light", items: { startColor: "accent 3 -50", stopColor: "accent 3 50" } }, { tip: "Gold gradient, dark to light", items: { startColor: "accent 4 -50", stopColor: "accent 4 50" } }, { tip: "Blue gradient, dark to light", items: { startColor: "accent 5 -50", stopColor: "accent 5 50" } }, { tip: "Green gradient, dark to light", items: { startColor: "accent 6 -50", stopColor: "accent 6 50" } }, { tip: "Dark Gray, Light Gray, Gray, Dark Gray, Light Gray, Gray", items: ["text 1 11.5", "text 1 45", "text 1 25", "text 1 1.5", "text 1 70", "text 1 40"] }, { tip: "Blue gradient, light to dark", items: { startColor: "accent 1 50", stopColor: "accent 1 -50" } }, { tip: "Orange gradient, light to dark", items: { startColor: "accent 2 50", stopColor: "accent 2 -50" } }, { tip: "Gray gradient, light to dark", items: { startColor: "accent 3 50", stopColor: "accent 3 -50" } }, { tip: "Gold gradient, light to dark", items: { startColor: "accent 4 50", stopColor: "accent 4 -50" } }, { tip: "Blue gradient, light to dark", items: { startColor: "accent 5 50", stopColor: "accent 5 -50" } }, { tip: "Green gradient, light to dark", items: { startColor: "accent 6 50", stopColor: "accent 6 -50" } }] } }, chartStyles: { columnClustered: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], columnStacked: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], columnStacked100: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], line: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], lineStacked: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], lineStacked100: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], lineMarkers: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], lineMarkersStacked: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], lineMarkersStacked100: [null, { dataLabels: { showValue: !0 } }, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], pie: [null, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { chartArea: { backColor: "rgba(187,255,255,1)" }, dataLabels: { showValue: !0 } }, { legend: { position: 1 } }, { legend: { position: 1 }, dataLabels: { showValue: !0 } }], doughnut: [null, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }], barClustered: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], barStacked: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], barStacked100: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], area: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], areaStacked: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], areaStacked100: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], xyScatter: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], xyScatterSmooth: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], xyScatterSmoothNoMarkers: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], xyScatterLines: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], xyScatterLinesNoMarkers: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], bubble: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }], stockHLC: [null, { axes: { primaryValue: { minorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(91,155,213,1)", color: "rgba(255,255,255,1)" } }], stockOHLC: [null, { axes: { primaryValue: { minorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(91,155,213,1)", color: "rgba(255,255,255,1)" } }], stockVHLC: [null, { axes: { primaryValue: { minorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(91,155,213,1)", color: "rgba(255,255,255,1)" } }], stockVOHLC: [null, { axes: { primaryValue: { minorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(91,155,213,1)", color: "rgba(255,255,255,1)" } }], radar: [{ legend: { position: 1 }, series: { border: { width: 3 } } }, { legend: { position: 4 }, series: { border: { width: 1 } } }, { series: { border: { width: 5 } }, chartArea: { backColor: "rgba(242,242,242,1)", color: "rgba(5,0,0,1)" } }, { series: { border: { width: 4 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 4 }, title: { fontSize: 25 } }, { title: { fontSize: 25 }, series: { border: { width: 5 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }], radarMarkers: [{ legend: { position: 1 }, series: { border: { width: 3 } } }, { legend: { position: 4 }, series: { border: { width: 1 } } }, { series: { border: { width: 5 } }, chartArea: { backColor: "rgba(242,242,242,1)", color: "rgba(5,0,0,1)" } }, { series: { border: { width: 4 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 4 }, title: { fontSize: 25 } }, { title: { fontSize: 25 }, series: { border: { width: 5 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }], radarFilled: [{ legend: { position: 1 }, series: { border: { width: 3 } } }, { legend: { position: 4 }, series: { border: { width: 1 } } }, { series: { border: { width: 5 } }, chartArea: { backColor: "rgba(242,242,242,1)", color: "rgba(5,0,0,1)" } }, { series: { border: { width: 4 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 4 }, title: { fontSize: 25 } }, { title: { fontSize: 25 }, series: { border: { width: 5 } }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }], sunburst: [{ dataLabels: { showCategoryName: !0 }, chartArea: { color: "rgba(255,255,255,1)" } }, { dataLabels: { showCategoryName: !0 }, series: { border: { width: 5 } }, legend: { position: 2, backColor: "rgba(242,242,242,1)" }, chartArea: { backColor: "rgba(242,242,242,1)", color: "rgba(255,255,255,1)" } }, { dataLabels: { showCategoryName: !0 }, title: { fontSize: 25 }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }], treemap: [{ dataLabels: { showCategoryName: !0 }, chartArea: { color: "rgba(255,255,255,1)" } }, { dataLabels: { showCategoryName: !0 }, chartArea: { backColor: "rgba(242,242,242,1)", color: "rgba(255,255,255,1)" } }, { dataLabels: { showCategoryName: !0 }, title: { fontSize: 25 }, chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }], combo: [null, { axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" } }, { legend: { position: 1 } }, { chartArea: { backColor: "rgba(93,93,93,1)", color: "rgba(255,255,255,1)" }, axes: { primaryCategory: { majorGridLine: { visible: !0 } } } }, { legend: { position: 1 }, axes: { primaryCategory: { majorGridLine: { visible: !0 } }, primaryValue: { majorGridLine: { visible: !1 }, style: { color: "rgba(0,0,0,0)" } } }, dataLabels: { showValue: !0 } }] } } }, function(e, t) {
        var i = function() {
            var e, t, i = !1;

            function o(e, t, i, o) {
                if (e) {
                    var n = { status: "success", file: e };
                    switch (t) {
                        case "insertPicture":
                            a(n, "dataurl", i);
                            break;
                        default:
                            a(n, "", i, o)
                    }
                }
            }

            function n(e) { var t, i, o = { dir: "", fileName: "" }; return e && (t = !1, ["\\", "/"].forEach(function(o) { t || -1 === (i = e.lastIndexOf(o)) || (t = !0) }), o.fileName = e.substr(i + 1), t && (o.dir = e.substr(0, i))), o }

            function r(e, t) { var i = e.lastIndexOf("."); return t && (t.pos = i, t.name = e.substr(0, i)), -1 === i ? "" : e.substring(i + 1).toLowerCase() }

            function a(e, t, i, o) {
                var n, a;
                if (e && e.file) switch (n = e.file, t || (t = r(n.name)), a = new FileReader, a.onload = function() { "xlsx" === t ? l(this.result, o, i, n) : (e.data = this.result, i(e)) }, t) {
                    case "dataurl":
                        a.readAsDataURL(n);
                        break;
                    case "xlsx":
                        a.readAsArrayBuffer(n);
                        break;
                    default:
                        a.readAsText(n)
                }
            }

            function s(e) {
                function t(e) {
                    var t = e.split("("),
                        i = t[0].trim(),
                        o = t[1].trim().replace(")", ""),
                        n = o.split(" ").map(function(e) { return e.replace("*.", ".") });
                    return { name: i, extensions: n }
                }
                return e && e.map(t) || []
            }

            function l(e, t, i, o) {
                var n = new GC.Spread.Excel.IO;
                n.open(e, function(e) { i && i({ status: "success", data: e, file: o }) }, function(e) { i && i({ status: "failed", errorData: e, file: o }) }, t)
            }

            function c(e, t, i) {
                var o = { password: t.password },
                    n = new GC.Spread.Excel.IO;
                n.save(e, function(e) { i && i({ status: "success", data: e }) }, function(e) { i && i({ status: "failed", errorData: e }) }, o)
            }
            return {
                showSaveDialog: function(e, i) {
                    t || (t = new GC.Spread.Sheets.Designer.SaveAsDialog);
                    var o = e.fileExtension || s(e.nameFilters)[0].extensions[0];
                    t.open({
                        fileExtension: o,
                        done: function(e) {
                            var t = e && e.fileName,
                                n = e && e.cancelled;
                            i(n || !t ? { status: "cancelled" } : { status: "success", fileName: t + o })
                        }
                    })
                },
                showOpenDialog: function(t, n, r) {
                    var a, l;
                    e ? $("#fileSelector").replaceWith(e.clone()) : e = $("#fileSelector").clone(), i || ($(document.body).on("change", "#fileSelector", function() {
                        var e = this.files,
                            t = e && e[0],
                            i = $(this).data("action"),
                            n = $(this).data("callback"),
                            r = $(this).data("importOptions");
                        if (!t) return !1;
                        o(t, i, n, r)
                    }), i = !0), a = $("#fileSelector"), a.data("action", t.action), a.data("callback", n), a.data("importOptions", r), l = t.filters || s(t.nameFilters)[0].extensions.join(" "), a.attr("accept", l || ""), a.click()
                },
                save: function(e, t, i, o) {
                    var n, a, s, l, d;

                    function p(e) { var t, i = {}; return r(e, i), t = i.name, /^[_a-zA-Z\$]{1}[_a-zA-Z0-9\$]*$/.test(t) ? t : "_" + t.replace(/[ \.]/g, "_") }

                    function u(e, t, i, o, n) {
                        try {
                            var r = { type: i };
                            n && (r.encoding = n), saveAs(new Blob([t], r), e), o({ status: "success" })
                        } catch (e) { o({ status: "failed", message: e }) }
                    }
                    switch (n = t.spread || t, a = o && o.saveAsJS, a && (n = "var " + p(e) + " = " + n + ";"), s = t.exportFileType, l = "text/plain;charset=utf-8", d = null, s) {
                        case "xlsx":
                            return l = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", void c(n, o, function(t) { "success" === t.status ? u(e, t.data, l, i) : i({ status: "failed", message: t.errorData }) });
                        case "pdf":
                            return void t.spread.savePDF(function(t) { saveAs(t, e), i({ status: "success" }) }, function(e) { i({ status: "failed", message: e }) }, o.setting, o.sheetIndex);
                        case "csv":
                            l = "text/csv;charset=utf-8", d = o && o.encoding
                    }
                    u(e, n, l, i, d)
                },
                notify: function() { return "" },
                openUrl: function() { return !1 },
                notifyReady: function() {},
                getFileInfo: n,
                getExtension: r
            }
        }();
        e.exports.app = i
        app = i; //my app
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = o.util.chartHelper,
            r = void 0,
            a = o.ColorHelper,
            s = i(1);
        ! function() {
            "use strict";
            var t, i, l = "rgba(91,155,213,1)",
                c = {
                    baseChart: { series: { fillAndLine: { Line: ["fill", "border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, chartArea: { fillAndLine: { Line: ["fill"] }, sizeAndProperties: { Size: ["size"] }, textFill: { Text: ["textFill", "font"] } }, chartTitle: { textFill: { Text: ["textFill", "font", "textElement"] } }, legend: { fillAndLine: { Line: ["fill", "border"] }, legendPosition: { Legend: ["position"] } }, dataLabels: { textFill: { Text: ["textFill"] } }, primaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, primaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, primaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, primaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, secondaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, secondaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } } },
                    columnClustered: {},
                    columnStacked: {},
                    columnStacked100: {},
                    line: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    lineStacked: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    lineStacked100: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, chartArea: { fillAndLine: { Line: ["fill"] }, sizeAndProperties: { Size: ["size"] }, textFill: { Text: ["textFill", "font"] } }, chartTitle: { textFill: { Text: ["textFill", "font", "textElement"] } }, dataLabels: { textFill: { Text: ["textFill"] } }, primaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, primaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, primaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, primaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, secondaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, secondaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } } },
                    lineMarkers: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, chartArea: { fillAndLine: { Line: ["fill"] }, sizeAndProperties: { Size: ["size"] }, textFill: { Text: ["textFill", "font"] } }, chartTitle: { textFill: { Text: ["textFill", "font", "textElement"] } }, dataLabels: { textFill: { Text: ["textFill"] } }, primaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, primaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, primaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, primaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, secondaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, secondaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } } },
                    lineMarkersStacked: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, chartArea: { fillAndLine: { Line: ["fill"] }, sizeAndProperties: { Size: ["size"] }, textFill: { Text: ["textFill", "font"] } }, chartTitle: { textFill: { Text: ["textFill", "font", "textElement"] } }, dataLabels: { textFill: { Text: ["textFill"] } }, primaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, primaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, primaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, primaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, secondaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, secondaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } } },
                    lineMarkersStacked100: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, chartArea: { fillAndLine: { Line: ["fill"] }, sizeAndProperties: { Size: ["size"] }, textFill: { Text: ["textFill", "font"] } }, chartTitle: { textFill: { Text: ["textFill", "font", "textElement"] } }, dataLabels: { textFill: { Text: ["textFill"] } }, primaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, primaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, primaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, primaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, primaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, primaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryCategory: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisCategory", "tick"] } }, secondaryValue: { fillAndLine: { Line: ["line"] }, textFill: { Text: ["textFill", "font"] }, axisOptions: { Axis: ["axisValue", "tick"] } }, secondaryCategoryTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryValueTitle: { textFill: { Text: ["titleTextFill", "titleFont", "titleTextElement"] } }, secondaryCategoryMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryValueMajorGridLine: { fillAndLine: { MajorLine: ["majorLine"] } }, secondaryCategoryMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } }, secondaryValueMinorGridLine: { fillAndLine: { MinorLine: ["minorLine"] } } },
                    pie: { series: { fillAndLine: { Line: ["fillPie", "border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    doughnut: { series: { fillAndLine: { Line: ["fillPie", "border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    barClustered: {},
                    barStacked: {},
                    barStacked100: {},
                    area: {},
                    areaStacked: {},
                    areaStacked100: {},
                    xyScatter: { series: { fillAndLine: { Line: ["fill"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    xyScatterSmooth: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    xyScatterSmoothNoMarkers: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    xyScatterLines: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    xyScatterLinesNoMarkers: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    bubble: { series: { fillAndLine: { Line: ["line"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } } },
                    combo: {},
                    stockHLC: {},
                    stockOHLC: {},
                    stockVHLC: {},
                    stockVOHLC: {},
                    radar: { series: { fillAndLine: { Line: ["border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, primaryCategory: { textFill: { Text: ["textFill", "font"] } }, primaryCategoryTitle: {}, primaryCategoryMajorGridLine: {}, primaryCategoryMinorGridLine: {} },
                    radarMarkers: { series: { fillAndLine: { Line: ["border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, primaryCategory: { textFill: { Text: ["textFill", "font"] } }, primaryCategoryTitle: {}, primaryCategoryMajorGridLine: {}, primaryCategoryMinorGridLine: {} },
                    radarFilled: { series: { fillAndLine: { Line: ["fill", "border"] }, seriesOptions: { SeriesOptions: ["seriesOptions"] } }, primaryCategory: { textFill: { Text: ["textFill", "font"] } }, primaryCategoryTitle: {}, primaryCategoryMajorGridLine: {}, primaryCategoryMinorGridLine: {} },
                    sunburst: { series: { fillAndLine: { Line: ["fill", "border"] } }, dataPoints: { fillAndLine: { Line: ["fill"] } }, legend: { fillAndLine: { Line: ["fill", "border"] }, legendPosition: { Legend: ["position"] } }, primaryCategory: {}, primaryValue: {}, primaryCategoryTitle: {}, primaryValueTitle: {}, primaryCategoryMajorGridLine: {}, primaryValueMajorGridLine: {}, primaryCategoryMinorGridLine: {}, primaryValueMinorGridLine: {}, secondaryCategory: {}, secondaryValue: {}, secondaryCategoryTitle: {}, secondaryValueTitle: {}, secondaryCategoryMajorGridLine: {}, secondaryValueMajorGridLine: {}, secondaryCategoryMinorGridLine: {}, secondaryValueMinorGridLine: {} },
                    treemap: { series: { fillAndLine: { Line: ["fill", "border"] } }, dataPoints: { fillAndLine: { Line: ["fill"] } }, legend: { fillAndLine: { Line: ["fill", "border"] }, legendPosition: { Legend: ["position"] } }, primaryCategory: {}, primaryValue: {}, primaryCategoryTitle: {}, primaryValueTitle: {}, primaryCategoryMajorGridLine: {}, primaryValueMajorGridLine: {}, primaryCategoryMinorGridLine: {}, primaryValueMinorGridLine: {}, secondaryCategory: {}, secondaryValue: {}, secondaryCategoryTitle: {}, secondaryValueTitle: {}, secondaryCategoryMajorGridLine: {}, secondaryValueMajorGridLine: {}, secondaryCategoryMinorGridLine: {}, secondaryValueMinorGridLine: {} }
                },
                d = o.res.ribbon.fontFamilies,
                p = [d.ff1.name, d.ff2.name, d.ff3.name, d.ff4.name, d.ff5.name, d.ff6.name, d.ff7.name, d.ff8.name, d.ff9.name, d.ff10.name, d.ff11.name, d.ff12.name, d.ff13.name, d.ff14.name, d.ff15.name, d.ff16.name, d.ff17.name, d.ff18.name, d.ff19.name, d.ff20.name, d.ff21.name, d.ff22.name, d.ff23.name],
                u = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];

                console.log("This is it");
                 spread = o;
                console.log('spreadsheet',o)

            function h(e) { return void 0 === e || null === e }

            function f(e) {
                var t, i = e.split(" ");
                if (i.length > 0)
                    for (e = i[0].toLocaleLowerCase(), t = 1; t < i.length; t++) e = e + " " + i[t].toLocaleLowerCase();
                return e
            }

            function g(e) {
                var t, i = e.split("And"),
                    o = "";
                if (i.length > 0)
                    for (o = i[0].toLocaleLowerCase(), t = 1; t < i.length; t++) o = o + "-" + i[t].toLocaleLowerCase();
                return o
            }

            function m() {
                var e = $(".slider-panel");
                e.sliderpanel("close", "panel2")
            }

            function b(e) { return !e || "object" == typeof e && 0 === Object.keys(e).length }

            function v(e, t, i, n) {
                var r, a = y(),
                    s = e.backColor,
                    l = GC.Spread.Sheets.Charts.ChartType;
                return e && t && null !== i && (!0 === n ? (r = w(e.backColor)) && (s = o.res.chartSliderPanel.automatic) : a.chartType() === l.sunburst || a.chartType() === l.treemap ? x(a) && (s = o.res.chartSliderPanel.automatic) : s = k(e.backColor, t, i, a)), s ? { text: s, color: e.backColor } : e.backColor
            }

            function y() {
                var e = o.wrapper.spread.getActiveSheet(),
                    t = null;
                return e.charts.all().forEach(function(e) { e.isSelected() && (t = e) }), t
            }

            function w(e) {
                var t, i = n.getPieColorArray(e);
                for (t = 1; t < i.length; t++)
                    if (i[t] !== i[t - 1]) return !0;
                return !1
            }

            function x(e) {
                var t, i = e.series(),
                    o = i.dataPoints(),
                    n = o.get().length,
                    r = S(e);
                for (t = 0; t < n; t++)
                    if (!C(r, o, t)) return !1;
                return !0
            }

            function C(e, t, i) {
                var r, s, l, c, d = t.get().length,
                    p = n.generateColor(e, d, i);
                return !h(p) && "" !== p && (r = a.hexToRgb(a.parse(p, o.wrapper.spread.getActiveSheet().currentTheme()).color), s = t.get()[i], l = s.fillColor, !h(l) && "" !== l && (c = a.hexToRgb(a.parse(l, o.wrapper.spread.getActiveSheet().currentTheme()).color), l === r || c === r))
            }

            function S(e) { var t, i, o, n = s.chartColors.colorful.colors[0].items; return e && e.colorAndStyle && e.colorAndStyle.color && e.colorAndStyle.color.group && e.colorAndStyle.color.index && (t = e.colorAndStyle.color, i = t.group, o = t.index, n = s.chartColors[i].colors[o].items), n }

            function k(e, t, i, r) { var a, s, l; return null === e || void 0 === e ? e : (a = S(r), s = n.generateColor(a, t, i), l = e.split(" "), "0" === l[l.length - 1] && (l.pop(), e = l.join(" ")), s === e ? o.res.chartSliderPanel.automatic : void 0) }

            function T(e, t) {
                var i, n, r, a, s, l, d = o.util.chartHelper.getChartTypeString(e.chartType()),
                    p = c[d] && c[d].dataPoints || c.baseChart.dataPoints,
                    u = e.series(),
                    f = { fill: m },
                    g = {};

                function m(e) { return { name: o.res.chartSliderPanel.fill, data: { backColor: e.fillColor, transparency: e.transparency }, type: "fill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }
                if (!h(t) && u && u.dataPoints()) {
                    i = e.series().dataPoints().get(t);
                    for (n in p) {
                        r = g[n] = { type: n };
                        for (a in p[n]) s = [], p[n][a].forEach(function(e) {
                            var t = f[e](i);
                            s.push(t)
                        }), l = {}, l[a] = s, r.content = [], r.content.push(l)
                    }
                    return g
                }
            }

            function A(e, t, i) {
                var a, l, d, p, u, h, f, g, m, b, y = e.series(),
                    w = y.Count,
                    x = n.getChartTypeString(e.chartType());

                function C(e, t, i) { var n = v(e, i, t, !0); return { name: o.res.chartSliderPanel.fill, data: { backColor: n, transparency: e.backColorTransparency }, type: "fill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill, automaticColorText: o.res.chartSliderPanel.automatic } } }

                function S(e, t, i) { var n = v(e, i, t, !1); return { name: o.res.chartSliderPanel.fill, data: { backColor: n, transparency: e.backColorTransparency }, type: "fill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill, automaticColorText: o.res.chartSliderPanel.automatic } } }

                function k(e) { return { name: o.res.chartSliderPanel.border, data: { borderWidth: e.border.width, borderColor: e.border.color || "rgba(0, 0, 0, 0)", transparency: e.border && e.border.transparency || 0 }, type: "border", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } } }

                function T(e) { return { name: o.res.chartSliderPanel.seriesOptions, data: { axisGroup: e.axisGroup }, type: "series", resources: { primaryAxisText: o.res.chartSliderPanel.primaryAxis, secondaryAxisText: o.res.chartSliderPanel.secondaryAxis } } }

                function A(e, t, i) {
                    var a = s.chartColors.colorful.colors[0].items,
                        l = n.generateColor(a, i, t);
                    return e.border.color === r && (e.border.color = l), { name: o.res.chartSliderPanel.line, data: { borderWidth: e.border.width, borderColor: e.border.color || "rgba(0,0,0,0)", transparency: e.border && e.border.transparency || 0 }, type: "line", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } }
                }
                if ("stockHLC" !== x && "stockOHLC" !== x && "stockVHLC" !== x && "stockVOHLC" !== x)
                    for ("pie" !== x && "doughnut" !== x || (w = 1), l = { fill: S, fillPie: C, border: k, seriesOptions: T, line: A }, d = 0; d < w; d++) {
                        p = t["series " + i[d]] = {}, u = y.get(d), 1 !== u.chartType && 33 !== u.chartType && 34 !== u.chartType && 35 !== u.chartType && 36 !== u.chartType || (u.border.width = null), x = n.getChartTypeString(u.chartType), a = c[x] && c[x].series || c.baseChart.series;
                        for (h in a) {
                            p[h] = { type: h }, f = p[h];
                            for (g in a[h]) m = [], a[h][g].forEach(function(e) {
                                var t = l[e](u, d, w);
                                m.push(t)
                            }), b = {}, b[g] = m, f.content = [], f.content.push(b)
                        }
                    }
            }

            function E(e) {
                var t, i, n, r, a, s, l, d = o.util.chartHelper.getChartTypeString(e.chartType()),
                    p = c[d] && c[d].legend || c.baseChart.legend,
                    u = { fill: f, border: g, position: h };

                function h(e) { return { name: o.res.chartSliderPanel.legendPosition, data: { position: e.position }, type: "legend", resources: { topText: o.res.chartSliderPanel.top, bottomText: o.res.chartSliderPanel.bottom, leftText: o.res.chartSliderPanel.left, rightText: o.res.chartSliderPanel.right } } }

                function f(e) { return { name: o.res.chartSliderPanel.fill, data: { backColor: e.backColor, transparency: e.backColorTransparency }, type: "fill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function g(e) { return { name: o.res.chartSliderPanel.border, data: { borderWidth: e.borderStyle && e.borderStyle.width || 0, borderColor: e.borderStyle && e.borderStyle.color || "rgba(0, 0, 0, 0)", transparency: e.borderStyle && e.borderStyle.transparency || 0 }, type: "border", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } } }
                if ("stockHLC" !== d && "stockOHLC" !== d && "stockVHLC" !== d && "stockVOHLC" !== d) {
                    t = {}, i = e.legend();
                    for (n in p) {
                        r = t[n] = { type: n };
                        for (a in p[n]) s = [], p[n][a].forEach(function(e) {
                            var t = u[e](i);
                            s.push(t)
                        }), l = {}, l[a] = s, r.content = [], r.content.push(l)
                    }
                    return t
                }
            }

            function I(e) {
                var t, i, n, r, a, s, l = o.util.chartHelper.getChartTypeString(e.chartType()),
                    d = c[l] && c[l].dataLabels || c.baseChart.dataLabels,
                    p = { textFill: h },
                    u = e.dataLabels();

                function h(e) { return { name: o.res.chartSliderPanel.textFill, data: { color: e.color, transparency: e.transparency }, type: "textFill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }
                if (!(b(u) || !1 === u.showValue && !1 === u.showSeriesName && !1 === u.showCategoryName)) {
                    t = {};
                    for (i in d) {
                        t[i] = { type: i }, n = t[i];
                        for (r in d[i]) a = [], d[i][r].forEach(function(e) {
                            var t = p[e](u);
                            a.push(t)
                        }), s = {}, s[r] = a, n.content = [], n.content.push(s)
                    }
                    return t
                }
            }

            function D(e) {
                var t, i, n, r, a, s, l = o.util.chartHelper.getChartTypeString(e.chartType()),
                    d = c[l] && c[l].chartTitle || c.baseChart.chartTitle,
                    p = { textFill: h, font: f, textElement: g },
                    u = e.title();

                function h(e) { return { name: o.res.chartSliderPanel.textFill, data: { color: e.color, transparency: e.transparency }, type: "textFill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function f(e) { return { name: o.res.chartSliderPanel.font, data: { fontFamily: e.fontFamily, fontSize: e.fontSize }, type: "font", resources: { fontFamily: o.res.chartSliderPanel.fontFamily, fontSize: o.res.chartSliderPanel.fontSize } } }

                function g(e) { return { name: o.res.chartSliderPanel.textEditor, data: { text: e.text }, type: "textElement", resources: { textElement: o.res.chartSliderPanel.text } } }
                if (!b(u)) {
                    t = {};
                    for (i in d) {
                        t[i] = { type: i }, n = t[i];
                        for (r in d[i]) a = [], d[i][r].forEach(function(e) {
                            var t = p[e](u);
                            a.push(t)
                        }), s = {}, s[r] = a, n.content = [], n.content.push(s)
                    }
                    return t
                }
            }

            function L(e) {
                var t, i, n, r, a, s = o.util.chartHelper.getChartTypeString(e.chartType()),
                    l = c[s] && c[s].chartArea || c.baseChart.chartArea,
                    d = { fill: h, size: f, textFill: g, font: m },
                    p = {},
                    u = e.chartArea();
                for (t in l) {
                    p[t] = { type: t }, i = p[t];
                    for (n in l[t]) r = [], l[t][n].forEach(function(t) {
                        var i = d[t]("size" === t ? e : u);
                        r.push(i)
                    }), a = {}, a[n] = r, i.content = [], i.content.push(a)
                }
                return p;

                function h(e) { return { name: o.res.chartSliderPanel.fill, data: { backColor: e.backColor, transparency: e.backColorTransparency }, type: "fill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function f(e) { return { name: o.res.chartSliderPanel.size, data: { xOffset: e.x(), yOffset: e.y(), width: e.width(), height: e.height() }, type: "size", resources: { widthText: o.res.chartSliderPanel.width, heightText: o.res.chartSliderPanel.height } } }

                function g(e) { return { name: o.res.chartSliderPanel.textFill, data: { color: e.color, transparency: e.transparency }, type: "textFill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function m(e) { return { name: o.res.chartSliderPanel.font, data: { fontFamily: e.fontFamily || "Calibri", fontSize: e.fontSize || "10" }, type: "font", resources: { fontFamily: o.res.chartSliderPanel.fontFamily, fontSize: o.res.chartSliderPanel.fontSize } } }
            }

            function F(e, t) {
                var i, n, r, a, s = e.axes();

                function l(e, i) {
                    var o, n, l, c, d, p, u;
                    if (!h(e) && !b(e)) {
                        o = t[i] = {}, n = s[a];
                        for (l in e) {
                            o[l] = { type: l }, c = o[l];
                            for (d in e[l]) p = [], e[l][d].forEach(function(e) {
                                var t = r[e](n);
                                p.push(t)
                            }), u = {}, u[d] = p, c.content = [], c.content.push(u)
                        }
                    }
                }

                function d(e) { return { name: o.res.chartSliderPanel.line, data: { majorGridLineWidth: e.majorGridLine.width, majorGridLineColor: e.majorGridLine.color, transparency: e.majorGridLine.transparency }, type: "line", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } } }

                function p(e) { return { name: o.res.chartSliderPanel.line, data: { minorGridLineWidth: e.minorGridLine.width, minorGridLineColor: e.minorGridLine.color, transparency: e.minorGridLine.transparency }, type: "line", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } } }

                function u(e) { return { name: o.res.chartSliderPanel.font, data: { fontFamilyTitle: e.title.fontFamily, fontSizeTitle: e.title.fontSize }, type: "font", resources: { fontFamily: o.res.chartSliderPanel.fontFamily, fontSize: o.res.chartSliderPanel.fontSize } } }

                function f(e) { return { name: o.res.chartSliderPanel.textFill, data: { colorTitle: e.title.color, transparency: e.title.transparency }, type: "textFill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function g(e) { return { name: o.res.chartSliderPanel.textEditor, data: { textTitle: e.title.text }, type: "textElement", resources: { textElement: o.res.chartSliderPanel.text } } }

                function m(e) { return { name: o.res.chartSliderPanel.textFill, data: { color: e.style.color, transparency: e.style.transparency }, type: "textFill", resources: { noColorText: o.res.chartSliderPanel.noFill, solidColorText: o.res.chartSliderPanel.solidFill } } }

                function v(e) { return { name: o.res.chartSliderPanel.font, data: { fontFamily: e.style.fontFamily, fontSize: e.style.fontSize }, type: "font", resources: { fontFamily: o.res.chartSliderPanel.fontFamily, fontSize: o.res.chartSliderPanel.fontSize } } }

                function y(e) { return { name: o.res.chartSliderPanel.line, data: { borderWidth: e.lineStyle.width, borderColor: e.lineStyle.color, transparency: e.lineStyle.transparency }, type: "line", resources: { noColorText: o.res.chartSliderPanel.noLine, solidColorText: o.res.chartSliderPanel.solidLine, widthText: o.res.chartSliderPanel.width } } }

                function w(e) { return { name: o.res.chartSliderPanel.tickMarks, data: { majorTickPosition: e.majorTickPosition, minorTickPosition: e.minorTickPosition }, type: "tick", resources: { majorText: o.res.chartSliderPanel.majorType, minorText: o.res.chartSliderPanel.minorType } } }

                function x(e) { return 3 === e.categoryType ? { name: o.res.chartSliderPanel.axisOptions, data: { majorUnit: e.majorUnit, minorUnit: e.minorUnit, maxValue: e.max, minValue: e.min }, type: "axisValue", resources: { majorUnitText: o.res.chartSliderPanel.unitsMajor, minorUnitText: o.res.chartSliderPanel.unitsMinor, maxValueText: o.res.chartSliderPanel.maximum, minValueText: o.res.chartSliderPanel.minimum } } : { name: o.res.chartSliderPanel.axisOptions, data: { categoryType: e.categoryType, maxValue: 2 === e.categoryType ? e.max && e.max.toLocaleDateString() : e.max, minValue: 2 === e.categoryType ? e.min && e.min.toLocaleDateString() : e.min }, type: "axisCategory", resources: { textText: o.res.chartSliderPanel.textAxis, dateText: o.res.chartSliderPanel.dateAxis, maxValueText: o.res.chartSliderPanel.maximum, minValueText: o.res.chartSliderPanel.minimum } } }

                function C(e) { return { name: o.res.chartSliderPanel.axisOptions, data: { majorUnit: e.majorUnit, minorUnit: e.minorUnit, maxValue: e.max, minValue: e.min }, type: "axisValue", resources: { majorUnitText: o.res.chartSliderPanel.unitsMajor, minorUnitText: o.res.chartSliderPanel.unitsMinor, maxValueText: o.res.chartSliderPanel.maximum, minValueText: o.res.chartSliderPanel.minimum } } }
                if (!b(s)) {
                    i = o.util.chartHelper.getChartTypeString(e.chartType()), r = { line: y, textFill: m, font: v, tick: w, axisCategory: x, axisValue: C, titleTextFill: f, titleFont: u, titleTextElement: g, majorLine: d, minorLine: p };
                    for (a in s)
                        if (!0 === s[a].visible) {
                            if (n = c[i] && c[i][a] || c.baseChart[a], h(n) || b(n)) continue;
                            l(n, a), "" !== s[a].title.text && (n = c[i] && c[i][a + "Title"] || c.baseChart[a + "Title"], l(n, a + "Title")), !0 === s[a].majorGridLine.visible && (n = c[i] && c[i][a + "MajorGridLine"] || c.baseChart[a + "MajorGridLine"], l(n, a + "MajorGridLine")), !0 === s[a].minorGridLine.visible && (n = c[i] && c[i][a + "MinorGridLine"] || c.baseChart[a + "MinorGridLine"], l(n, a + "MinorGridLine"))
                        }
                }
            }

            function R(e, t, i) {
                var o, n = this;
                this.tabChanged = i, o = $("<div></div>").addClass("panel-content-header"), t.forEach(function(e) { o.append(n.addTabHeader(e.name)) }), this.activePropertyTabHeader = $(o.children()[0]), this.activePropertyTabHeader.children().remove(), this.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + g(this.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel")), this.propertyTabHeaders = o, e.append(o)
            }
            R.prototype.addTabHeader = function(e) {
                var t = this,
                    i = $("<span></span>").addClass(g(e)).addClass("format-chart-panel"),
                    o = $("<div></div>").append(i).attr("title", e).addClass("format-chart-panel-background");
                return o.click(function(e) { t.tabChanged($(e.currentTarget).attr("title")) }), o
            }, t = { fill: Y, border: ee, series: J, line: X, size: K, textFill: _, legend: q, font: H, tick: j, axisValue: G, axisCategory: V, textElement: M };

            function B(e, t) { var i, o, n, r, a = this; for (this.owner = t, this.propertyHeaderData = [], this.propertyGroupPanels = [], i = $("<div></div>"), o = 0; o < e.length; o++) this.propertyHeaderData.push({ name: e[o].name }); for (this.propertyHeaderPanel = new R(i, this.propertyHeaderData, function(e) { a.activeTabChanged(e) }), n = 0; n < e.length; n++) r = new O(e[n].name, e[n].properties, function(e, t, i, o) { return a.activePanelValueChanged(e, t, i, o) }), i.append(r), this.propertyGroupPanels.push({ name: e[n].name, propertyGroupPanel: r }); return this.activePropertyGroupPanel = this.propertyGroupPanels[0].propertyGroupPanel, this.showPropertyGroupPanel(this.activePropertyGroupPanel), i } B.prototype.activePanelValueChanged = function(e, t, i, o) { return this.owner.updateData(e, t, i, o) }, B.prototype.activeTabChanged = function(e) { for (var t = 0; t < this.propertyGroupPanels.length; t++) this.propertyGroupPanels[t].name === e && (this.hidePropertyGroupPanel(this.activePropertyGroupPanel), this.activePropertyGroupPanel = this.propertyGroupPanels[t].propertyGroupPanel, this.showPropertyGroupPanel(this.activePropertyGroupPanel, e)) }, B.prototype.hidePropertyGroupPanel = function(e) { e.hide(), this.propertyHeaderPanel.activePropertyTabHeader.children().remove(), this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass(g(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel")) }, B.prototype.showPropertyGroupPanel = function(e, t) { var i, o; for (e.show(), i = this.propertyHeaderPanel.propertyTabHeaders.children(), o = 0; o < i.length; o++) $(i[o]).attr("title") === t && (this.propertyHeaderPanel.activePropertyTabHeader = $(i[o]), this.propertyHeaderPanel.activePropertyTabHeader.children().remove(), this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + g(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel"))) };

            function O(e, t, i) {
                var o, n, r, a;
                for (t.length, this.changedValue = i, o = this, o.name = e, n = $("<div></div>").hide(), r = 0; r < t.length;) {
                    for (a = 0; a < t[r].editors.length; a++) n.append(new P(t[r].editors[a], t[r].aggregate, r, a, function(e, t, i) { return o.groupContainerValueChanged(e, t, i) }));
                    r++
                }
                return n
            }
            O.prototype.groupContainerValueChanged = function(e, t, i) { return this.changedValue(this.name, e, t, i) };

            function P(e, t, i, o, n) { var r, a, s = this; return s.aggregate = t, s.contentIndex = i, s.index = o, this.changedValue = n, r = $("<div></div>"), a = new N(e.name, function(e) { s.updateEditorContainer(e) }), r.append(a), this.editorContainer = new z(e, function(e, t) { return s.editorContainerValueChanged(e, t) }), r.append(this.editorContainer), r } P.prototype.editorContainerValueChanged = function(e, t) { return this.changedValue(["content", this.contentIndex, this.aggregate, this.index], e, t) }, P.prototype.updateEditorContainer = function(e) { "extend" === e ? this.editorContainer.hide() : this.editorContainer.show() };

            function N(e, t) { return this.changedEditorStatus = t, this.addEditorTitle(e) } N.prototype.addEditorTitle = function(e) {
                var t = this,
                    i = $("<label>").text(e).css({ font: "Bold 12pt Calibri" });
                return t.triangleExtend = $("<div><div").css({ width: "0", height: "0", "margin-right": "6px", "margin-bottom": "3px", "border-right": "8px solid rgba(0, 0, 0, 0.8)", "border-top": "8px solid transparent", display: "inline-block" }).attr("name", "extend").click(function(e) {
                    t.triangleCollapse.show(), $(this).hide();
                    var i = $(e.target).attr("name");
                    t.changedEditorStatus(i)
                }), t.triangleCollapse = $("<div><div").css({ width: "0", height: "0", "margin-right": "6px", "border-top": "5px solid transparent", "border-left": "8px solid rgba(0, 0, 0, 0.8)", "border-bottom": "5px solid transparent", display: "inline-block" }).attr("name", "collapse").hide().click(function(e) {
                    t.triangleExtend.show(), $(this).hide();
                    var i = $(e.target).attr("name");
                    t.changedEditorStatus(i)
                }), $("<p></p>").css({ margin: "2px 0px 0px 15px" }).append(t.triangleExtend).append(t.triangleCollapse).append(i)
            }, N.prototype.changedEditorStatus = function(e) { this.changedEditorStatus(e) };

            function z(e, i) { var o, n, r = this; return this.changedValue = i, o = $("<ul></ul>").css("padding-left", "30px"), n = t[e.type], this.editorType = new n(o, e.data, e.name, e.resources, function(e, t) { return r.editorValueChanged(e, t) }), o } z.prototype.editorValueChanged = function(e, t) { return this.changedValue("data." + e, t) };

            function M(e, t, i, o, n) {
                this.textChanged = n;
                var r = this;
                this.textEditor = new ie(e, o.textElement, function(e) {
                    var i = r.textChanged(t.textTitle ? "textTitle" : "text", e);
                    i && r.updateUI(i)
                }), this.updateUI(t.textTitle || t.text)
            }
            M.prototype.updateUI = function(e) { this.textEditor.text = e, this.textEditor.updateValue() };

            function V(e, t, i, o, n) {
                this.categoryTypeChanged = n;
                var r = this;
                this.textText = o.textText, this.dateText = o.dateText, this.radiogroup = new oe(e, [this.textText, this.dateText], i, function(e) { return r.radioGroupSelectionChanged(e) }), this.settingValueEditor = new G(e, { maxValue: t.maxValue, minValue: t.minValue }, i, { maxValueText: o.maxValueText, minValueText: o.minValueText }, function(e, t) { return r.categoryTypeChanged(e, t) }), this.updateUI(t)
            }
            V.prototype.radioGroupSelectionChanged = function(e) {
                var t = this.categoryTypeChanged("categoryType", e.toLocaleLowerCase() === this.textText.toLocaleLowerCase() ? 1 : 2);
                t && this.updateUI(t)
            }, V.prototype.updateUI = function(e) { e.categoryType && this.updateRadiogroup(e.categoryType), this.updateSettingValueEditor(e) }, V.prototype.updateRadiogroup = function(e) {
                var t;
                t = 1 === e ? this.textText : this.dateText, this.radiogroup.setSelectedItem(t)
            }, V.prototype.updateSettingValueEditor = function(e) { 1 !== e.categoryType ? this.settingValueEditor.showEditor() : this.settingValueEditor.hideEditor() };

            function G(e, t, i, o, n) {
                var r, a;
                this.valueChanged = n, r = this, a = !0, (o.majorUnitText || o.minorUnitText) && (this.majorUnitEditor = new ie(e, o.majorUnitText, function(e) {
                    null !== e && void 0 !== e && (e = +e);
                    var t = r.valueChanged("majorUnit", e);
                    r.updateMajorUI(t)
                }, a), this.minorUnitEditor = new ie(e, o.minorUnitText, function(e) {
                    null !== e && void 0 !== e && (e = +e);
                    var t = r.valueChanged("minorUnit", e);
                    r.updateMinorUI(t)
                }, a), this.updateMajorUI(t.majorUnit), this.updateMinorUI(t.minorUnit)), this.maxValueEditor = new ie(e, o.maxValueText, function(e) {
                    var t = r.valueChanged("max", e);
                    r.updateMaxUI(t)
                }, a), this.minValueEditor = new ie(e, o.minValueText, function(e) {
                    var t = r.valueChanged("min", e);
                    r.updateMinUI(t)
                }, a), this.updateMaxUI(t.maxValue), this.updateMinUI(t.minValue)
            }
            G.prototype.updateMajorUI = function(e) { this.majorUnitEditor.text = e, this.majorUnitEditor.updateValue() }, G.prototype.updateMinorUI = function(e) { this.minorUnitEditor.text = e, this.minorUnitEditor.updateValue() }, G.prototype.updateMaxUI = function(e) { this.maxValueEditor.text = e, this.maxValueEditor.updateValue() }, G.prototype.updateMinUI = function(e) { this.minValueEditor.text = e, this.minValueEditor.updateValue() }, G.prototype.showEditor = function() { this.minValueEditor.domInput.show(), this.maxValueEditor.domInput.show() }, G.prototype.hideEditor = function() { this.minValueEditor.domInput.hide(), this.maxValueEditor.domInput.hide() };

            function j(e, t, i, n, r) {
                var a, s, l;
                this.changedTickOption = r, a = this, this.majorText = n.majorText, this.minorText = n.minorText, s = [o.res.chartSliderPanel.tick.cross, o.res.chartSliderPanel.tick.inside, o.res.chartSliderPanel.tick.none, o.res.chartSliderPanel.tick.outSide], l = {}, l[o.res.chartSliderPanel.tick.cross] = 0, l[o.res.chartSliderPanel.tick.inside] = 1, l[o.res.chartSliderPanel.tick.none] = 2, l[o.res.chartSliderPanel.tick.outSide] = 3, this.tickCollection1 = s, this.dropEditor1 = new W(e, s[t.majorTickPosition], "majorTickPosition", this.majorText, s, function(e) { return a.tickCollection1[a.changedTickOption("majorTickPosition", l[e])] }), this.dropEditor2 = new W(e, s[t.minorTickPosition], "minorTickPosition", this.minorText, s, function(e) { return a.tickCollection1[a.changedTickOption("minorTickPosition", l[e])] })
            }

            function H(e, t, i, o, n) {
                var r, a;
                this.changedFontOption = n, r = this, this.fontFamily = o.fontFamily, this.fontSize = o.fontSize, a = Math.round(3 * +t.fontSize / 4) || Math.round(3 * +t.fontSizeTitle / 4), this.dropEditor1 = new W(e, a, "fontSize", this.fontSize, u, function(e) { return 3 * r.changedFontOption(t.fontSize ? "fontSize" : "fontSizeTitle", 4 * e / 3) / 4 }), this.dropEditor2 = new W(e, t.fontFamily || t.fontFamilyTitle, "fontFamily", this.fontFamily, p, function(e) { return r.changedFontOption(t.fontFamily ? "fontFamily" : "fontFamilyTitle", e) })
            }

            function W(e, t, i, o, n, r) {
                var a, s = this;
                s.listChanged = r, a = $("<li></li>").css({ margin: "4px 1px", "list-style-type": "none", "line-height": "28px", "white-space": "nowrap" }).append($("<lable></lable>").css({ "margin-left": "6px" }).text(o)), this.defauleItem = this.j(i), a.append(this.defauleItem).appendTo(e), this.itemsList = new U(n, i, function(e) { s.changedValue(e) }), a.append(this.itemsList), this.updateUI(t)
            }
            W.prototype.j = function(e) {
                var t = this,
                    i = $("<button></button>").addClass("ui-button ui-widget ui-state-default ui-button-text-icon-secondary ui-corner-left").addClass("format-panel-drop-default-button-" + e),
                    o = $("<span></span>").addClass("panel-button-text").addClass("format-panel-drop-default-span-" + e),
                    n = $("<span></span>").addClass("ui-button-icon-secondary ui-icon ui-icon-triangle-1-s");
                return i.append(o).append(n), i.click(function() { t.itemsList && t.itemsList.gcuipopup("show", { of: $(this), my: "left+0 top+22", at: "left top" }) }), i
            }, W.prototype.changedValue = function(e) {
                var t = this.listChanged(e);
                t && this.updateUI(t)
            }, W.prototype.updateUI = function(e) { $("span:first", this.defauleItem).text(e) };

            function U(e, t, i) { var o = this; return o.updateSelectedElement = i, o.selectedElementListDom = o.addItems(e, t), o.selectedElementListDom } U.prototype.addItems = function(e, t) {
                var i, o = this,
                    n = $("<ul></ul>").css({ background: "white", "z-index": "10", "padding-left": "0px" });
                return "fontFamily" === t && n.css({ width: "210px" }), e.forEach(function(e) {
                    var t = $("<li></li>").attr("name", e).append($("<label></label>").text(e).css({ "margin-left": "2px" })).css({ "list-style-type": "none", "line-height": "25px" });
                    t.click(function(e) {
                        var t = $(e.currentTarget).attr("name");
                        o.changedSelectedElement(t)
                    }).mouseenter(function() { $(this).css("background", "#DBDBDB") }).mouseleave(function() { $(this).css("background", "white") }), n.append(t)
                }), i = $("<div></div>").addClass("format-panel-drop-list-common format-panel-drop-list-" + t).append(n), i.gcuipopup({ autoHide: !0 }), i
            }, U.prototype.changedSelectedElement = function(e) { this.updateSelectedElement(e), this.selectedElementListDom.hide() };

            function q(e, t, i, o, n) {
                this.changedPosition = n;
                var r = this;
                this.topText = o.topText, this.bottomText = o.bottomText, this.leftText = o.leftText, this.rightText = o.rightText, this.radiogroup = new oe(e, [this.topText, this.bottomText, this.leftText, this.rightText], i, function(e) { r.radioGroupSelectionChanged(e) }), this.updateUI(t.position)
            }
            q.prototype.radioGroupSelectionChanged = function(e) {
                var t = this.changedPosition("position", e);
                t && this.updateUI(t)
            }, q.prototype.updateUI = function(e) {
                var t = [, this.topText, this.rightText, this.leftText, this.bottomText];
                this.radiogroup.setSelectedItem(t[e])
            };

            function _(e, t, i, o, n) {
                this.colorChanged = n;
                var a = this;
                this.colorEditor = new Q(e, t.color !== r ? t.color : t.colorTitle, t.transparency, i, { noColorText: o.noColorText, solidColorText: o.solidColorText }, function(e) { return a.colorChanged(t.color !== r ? "color" : "colorTitle", e) }, function(e) { return a.colorChanged(t.color !== r ? "transparency" : "titleTransparency", e) })
            }

            function K(e, t, i, n, r) {
                var a = this;
                a.sizeChanged = r, this.widthEditor = new te(e, n.widthText, function(e) { a.sizeChanged("width", e) && a.updateWidthUI(t.width) }), this.heightEditor = new te(e, n.heightText, function(e) { a.sizeChanged("height", e) && a.updateHeightUI(t.height) }), a.updateWidthUI(t.width), a.updateHeightUI(t.height), o.wrapper.spread.getActiveSheet().bind(GC.Spread.Sheets.Events.FloatingObjectChanged, function(e, i) {
                    var o = i.floatingObject.width(),
                        n = i.floatingObject.height();
                    t.width === o && t.height === n || (a.updateWidthUI(o), a.updateHeightUI(n))
                })
            }
            K.prototype.updateWidthUI = function(e) { this.widthEditor.value = e, this.widthEditor.updateValue() }, K.prototype.updateHeightUI = function(e) { this.heightEditor.value = e, this.heightEditor.updateValue() };

            function X(e, t, i, o, n) { ee.call(this, e, t, i, o, n) } X.prototype = ee.prototype, X.prototype.constructor = ee;

            function J(e, t, i, o, n) {
                var r = this;
                r.seriesOptionsChanged = n, this.primaryAxisText = o.primaryAxisText, this.secondaryAxisText = o.secondaryAxisText, this.radiogroup = new oe(e, [this.primaryAxisText, this.secondaryAxisText], i, function(e) { r.radioGroupSelectionChanged(e) }), this.updateUI(t.axisGroup)
            }
            J.prototype.radioGroupSelectionChanged = function(e) {
                var t = this.seriesOptionsChanged("axisGroup", e.toLocaleLowerCase() === o.res.chartSliderPanel.secondaryAxis.toLocaleLowerCase() ? 1 : 0);
                0 !== t && 1 !== t || this.updateUI(t)
            }, J.prototype.updateUI = function(e) {
                var t = e ? this.secondaryAxisText : this.primaryAxisText;
                this.radiogroup.setSelectedItem(t)
            };

            function Y(e, t, i, o, n) {
                this.colorChanged = n;
                var r = this;
                this.colorEditor = new Q(e, t.backColor, t.transparency || 0, i, { noColorText: o.noColorText, solidColorText: o.solidColorText, automaticColorText: o.automaticColorText }, function(e) { return r.colorChanged("backColor", e) }, function(e) { return r.colorChanged("backColorTransparency", e) })
            }
            console.log('thiss',this);

            function Q(e, t, i, n, r, a, s) {
                var l = this,
                    c = i || 0;
                l.changedValue = a, l.changedOpacity = s, l.noColorText = r.noColorText, l.solidColorText = r.solidColorText, l.automaticColorText = r.automaticColorText, l.radiogroup = new oe(e, [this.noColorText, this.solidColorText, this.automaticColorText], n, function(e) { return l.radioGroupSelectionChanged(e) }), l.colorpicker = new re(e, function(e) { l.colorPicked(e) }), l.opacityEditor = new te(e, o.res.chartSliderPanel.transparency, function(e) { l.changedOpacity(e / 100) }, { min: 0, max: 100, descString: "%" }), l.updateUI(t, 100 * c)
            }
            Q.prototype.radioGroupSelectionChanged = function(e) {
                var t, i;
                e === (this.noColorText && this.noColorText.toLocaleLowerCase()) ? ((t = this.changedValue("")) || "" === t) && this.updateUI(t, this.opacityEditor.value) : e === (this.automaticColorText && this.automaticColorText.toLocaleLowerCase()) ? ((t = this.changedValue(o.res.chartSliderPanel.automatic)) || "" === t) && this.updateUI(t, this.opacityEditor.value) : (t = this.changedValue(this.colorpicker.color), i = this.changedOpacity(this.opacityEditor.value / 100), (t || "" === t) && this.updateUI(t, 100 * i))
            }, Q.prototype.colorPicked = function(e) {
                var t = this.changedValue(e);
                (t || "" === t) && this.updateUI(t, this.opacityEditor.value)
            }, Q.prototype.updateUI = function(e, t) {
                if (e) {
                    var i = e.text || (h(e.color) ? e : e.color);
                    this.updateRadiogroup(i), i.toLocaleLowerCase() === o.res.chartSliderPanel.automatic.toLocaleLowerCase() ? (this.updateColorPicker(r), this.updateOpacityInputNum(0)) : (this.updateColorPicker(h(e.color) ? e : e.color), h(t) || this.updateOpacityInputNum(t))
                } else "" === e ? (this.updateRadiogroup(e), this.updateColorPicker(e), h(t) || this.updateOpacityInputNum(t)) : (this.updateRadiogroup(r), this.updateColorPicker(r), this.updateOpacityInputNum(0))
            }, Q.prototype.updateRadiogroup = function(e) {
                var t, i, n, a;
                if (e !== r && e.toLocaleLowerCase() === o.res.chartSliderPanel.automatic.toLocaleLowerCase()) t = this.automaticColorText;
                else if (e) {
                    for (i = Z(e), n = e, a = i; - 1 !== n.indexOf(" ");) n = n.replace(" ", "");
                    for (; - 1 !== a.indexOf(" ");) a = a.replace(" ", "");
                    t = !0 === a ? this.automaticColorText : "rgba(0,0,0,0)" === e || "rgba(0,0,0,0)" === a ? this.noColorText : this.solidColorText
                } else t = this.noColorText;
                this.radiogroup.setSelectedItem(t)
            }, Q.prototype.updateColorPicker = function(e) {
                var t, i, o;
                if (e) {
                    for (t = Z(e), i = e, o = t; - 1 !== i.indexOf(" ");) i = i.replace(" ", "");
                    for (; !0 !== o && -1 !== o.indexOf(" ");) o = o.replace(" ", "");
                    i && "rgba(0,0,0,0)" !== i && !0 !== o && "rgba(0,0,0,0)" !== o ? (this.colorpicker.showColorPicker(), this.opacityEditor.show(), this.colorpicker.color = t || e, this.colorpicker.updateColor()) : (this.colorpicker.hideColorPicker(), this.opacityEditor.hide())
                } else this.colorpicker.hideColorPicker(), this.opacityEditor.hide()
            }, Q.prototype.updateOpacityInputNum = function(e) { this.opacityEditor.value = parseInt(e), this.opacityEditor.updateValue() };

            function Z(e) {
                var t, i, r, s = n.getPieColorArray(e),
                    l = a.parse(s[0], o.wrapper.spread.getActiveSheet().currentTheme()).color;
                if (s.length > 1) {
                    for (r = 1; r < s.length - 1; r++)
                        if (t = a.parse(s[r], o.wrapper.spread.getActiveSheet().currentTheme()).color, i = a.parse(s[r - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color, t !== i) return !0;
                    return t = a.parse(s[s.length - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color, i = a.parse(s[s.length - 2], o.wrapper.spread.getActiveSheet().currentTheme()).color, t !== i || l
                }
                return l
            }

            function ee(e, t, i, o, n) {
                this.borderChanged = n;
                var a = this;
                this.colorEditor = new Q(e, t.majorGridLineColor || t.minorGridLineColor || t.borderColor, t.transparency, i, { noColorText: o.noColorText, solidColorText: o.solidColorText, automaticColorText: o.automaticColorText }, function(e) { var i = t.minorGridLineColor ? "minorGridLineColor" : "borderColor"; return a.borderChanged(t.majorGridLineColor ? "majorGridLineColor" : i, e) }, function(e) { var i = t.minorGridLineColor ? "minorGridLineTransparency" : "borderTransparency"; return a.borderChanged(t.majorGridLineColor ? "majorGridLineTransparency" : i, e) }), (null !== t.borderWidth && t.borderWidth !== r || t.majorGridLineWidth || t.minorGridLineWidth) && (this.widthEditor = new te(e, o.widthText, function(e) {
                    var i = t.minorGridLineWidth ? "minorGridLineWidth" : "borderWidth",
                        o = a.borderChanged(t.majorGridLineWidth ? "majorGridLineWidth" : i, e);
                    o && a.updateUI(o)
                }), this.updateUI(t.majorGridLineWidth || t.minorGridLineWidth || t.borderWidth))
            }
            ee.prototype.updateUI = function(e) { this.widthEditor.value = e, this.widthEditor.updateValue() };

            function te(e, t, i, o) { this.valueChanged = i, this.domInput = this.addInputNumberEditor(t), this.maxValue = o && !h(o.max) ? o.max : Number.MAX_VALUE, this.minValue = o && !h(o.min) ? o.min : -Number.MAX_VALUE, this.descString = o && o.descString || "", e.append(this.domInput) } te.prototype.addInputNumberEditor = function(e) {
                var t, i, o, n, r, a = this;
                return this.value = 0,
                    t = $("<span></span>").addClass("ui-spinner ui-widget ui-widget-content ui-corner-all").css({ width: "85px", float: "right", "margin-right": "3px", height: "23px" }), i = $("<input />", { type: "input" }).addClass("label-top-padding numeric column1 ui-spinner-input").css({ position: "absolute", left: "1px", top: "1px" }).change(function() {
                        var e = parseInt($(i).val());
                        a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                    }), o = $("<a />").addClass("ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-bottom": "3px", "border-left": "4px solid transparent", "border-right": "4px solid transparent", "border-bottom": "6px solid rgba(0, 0, 0, 0.4)", display: "inline-block" })).click(function() {
                        var e = a.value;
                        e += 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                    }), n = $("<a />").addClass("ui-spinner-button ui-spinner-down ui-corner-br ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-top": "3px", "border-width": "6px 4px 6px", "border-style": "solid", "border-color": "rgba(0, 0, 0, 0.4) transparent transparent", display: "inline-block" })).click(function() {
                        var e = a.value;
                        e -= 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                    }), t.append(i).append(o).append(n), r = $("<label></label>").css({ "margin-left": "6px" }).text(e), $("<li></li>").append(r).append(t).css({ margin: "1px", "list-style-type": "none", "line-height": "25px" })
            }, te.prototype.adjustValue = function(e) { return isNaN(e) && (e = this.value), h(e) || (h(this.minValue) || (e = Math.max(e, this.minValue)), h(this.maxValue) || (e = Math.min(e, this.maxValue))), e }, te.prototype.updateValue = function() { $("input", this.domInput).val(this.value + this.descString) }, te.prototype.hide = function() { this.domInput.hide() }, te.prototype.show = function() { this.domInput.show() };

            function ie(e, t, i, o) { this.valueChanged = i, this.isShowAuto = o || !1, this.domInput = this.addInputTextEditor(t), e.append(this.domInput) } ie.prototype.addInputTextEditor = function(e) { var t, i, n = this; return this.text = "", this.isShowAuto ? (this.autoDescLabel = $("<div></div>").addClass("input-auto-desc").text(o.res.chartSliderPanel.auto), this.resetBtn = $("<div></div>").addClass("input-reset-btn").text(o.res.chartSliderPanel.reset).click(function() { n.valueChanged(null) }), t = $("<input />", { type: "input" }).addClass("input-number-editor-auto").change(function(e) { n.valueChanged($(e.target).val()) })) : t = $("<input />", { type: "input" }).addClass("input-number-editor").change(function(e) { n.valueChanged($(e.target).val()) }), i = $("<label></label>").css({ "margin-left": "6px", float: "left", width: "70px" }).text(e), $("<li></li>").append(i).append(t).append(this.resetBtn).append(this.autoDescLabel).css({ margin: "1px", "list-style-type": "none", "line-height": "28px", height: "28px" }) }, ie.prototype.updateValue = function() { this.isShowAuto && (void 0 === this.text || null === this.text ? (this.resetBtn.css({ display: "none" }), this.autoDescLabel.css({ display: "inline-block" })) : (this.autoDescLabel.css({ display: "none" }), this.resetBtn.css({ display: "inline-block" }))), $("input", this.domInput).val(this.text) };

            function oe(e, t, i, o) {
                var n = this;
                n.updateRaidoSelectedItem = o, n.domRadio = e, t.forEach(function(t) { t && e.append(n.addRadioItem(i, t)) })
            }
            oe.prototype.addRadioItem = function(e, t) {
                var i = this,
                    o = ne(e, t);
                return $(o.children()[0]).click(function(e) { i.updateRaidoSelectedItem($(e.currentTarget).data("name")) }), o
            }, oe.prototype.setSelectedItem = function(e) {
                var t = e.toLocaleLowerCase();
                $("[data-name='" + t + "']", this.domRadio).prop("checked", !0)
            };

            function ne(e, t) {
                var i = $("<input />", { type: "radio", name: e }).attr("data-name", f(t)).attr("id", f(t)),
                    o = $("<label></label>").text(t).attr("for", f(t)),
                    n = $("<span></span>").append(i).append(o).attr("data-name", f(t)).attr("id", f(t));
                return $("<li></li>").append(n).css({ "list-style-type": "none", "line-height": "25px" })
            }

            function re(e, t) { this.colorChanged = t, this.domColor = this.createColorElement(), e.append(this.domColor) } re.prototype.createColorElement = function(e) {
                var t, i, n, r, a = this;
                return a.color = l || "transparent", t = $("<div></div>").css({ width: "143px", margin: "3px", float: "right", display: "inline-block" }), i = $("<span></span>").appendTo(t), $("<span></span>").addClass("color-picker-span").appendTo(i), n = $("<div></div>").appendTo(t), a.k || (a.k = $("<div></div>").addClass("forecolor-picker").colorpicker({ valueChanged: function(e, t) { a.colorChanged(t.name || t.color) }, choosedColor: function(e, i) { t.comboframe("close") }, openColorDialog: function(e, i) { t.comboframe("close") }, showNoFill: !1, themeColors: o.wrapper.getThemeColors() }).appendTo(n)), n.gcuipopup({
                    autoHide: !0,
                    showing: function(e, t) {
                        var i = a.k;
                        i.colorpicker("option", "value", a.color), i.colorpicker("option", "themeColors", o.wrapper.getThemeColors())
                    }
                }), t.comboframe().click(function() { t.comboframe("open") }), r = $("<label></label>").css({ "margin-left": "6px" }).text(o.res.chartSliderPanel.color), $("<li></li>").append(r).append(t).addClass("format-chart-panel-color").hide()
            }, re.prototype.colorChanged = function(e, t) { this.colorChanged(e.target, t) }, re.prototype.showColorPicker = function() { this.domColor.show() }, re.prototype.hideColorPicker = function() { this.domColor.hide() }, re.prototype.updateColor = function() { $(".color-picker-span", this.domColor).css({ "background-color": this.color }) };

            function ae(e, t) { return this.updateSelectedElement = t, this.selectedElementListDom = this.createSlectedElementEditor(e), this.selectedElementListDom } ae.prototype.createSlectedElementEditor = function(e) {
                var t = this,
                    i = $("<ul></ul>").addClass("chart-selected-element"),
                    o = $("<div>").addClass("select-element-popup").append(i);
                return o.gcuipopup({ autoHide: !0 }), e.elements.forEach(function(e) {
                    var o = $("<li></li>").attr("data-name", e.selectedElement).append($("<label></label>").text(e.text).css({ "margin-left": "2px" })).css({ "list-style-type": "none", "line-height": "25px", "text-overflow": "ellipsis", "white-space": "nowrap", overflow: "hidden", width: "220px" }),
                        n = "white";
                    o.click(function(e) {
                        var i = $(e.currentTarget).attr("data-name");
                        t.changedSlectedElement(i)
                    }).mouseenter(function() { n = $(this).css("background-color"), $(this).css("background", "#cfeadb") }).mouseleave(function() { var e, t; for ($(this).css("background", n), e = this.parentElement.childNodes, t = 0; t < e.length; t++) e[t] !== this && $("<div></div>").css("background", n).css("background-color") === $(e[t]).css("background-color") && "rgba(0, 0, 0, 0)" !== n && $(e[t]).css("background", "white") }), i.append(o)
                }), o
            }, ae.prototype.changedSlectedElement = function(e) { this.updateSelectedElement(e), this.selectedElementListDom.hide() };

            function se(e, t) { var i = this; return this.selectedElementsText = [], this.updateSelectedChartElement = t, this.selectedElement = this.createSelectedChartElement(e), e.elements.forEach(function(e) { i.selectedElementsText.push({ key: e.selectedElement, text: e.element }) }), this.selectedElement } se.prototype.createSelectedChartElement = function(e) {
                var t, i = this;
                return i.elements = e, t = $("<div><div").addClass("triangle-chart-selected-element").attr("name", "triangle-chart").click(function(e) {
                    var t, o, n;
                    if (e.target === e.currentTarget) {
                        if (!$(e.target).children()[0]) return;
                        if (t = i.selectedItem || i.elements.currentElement.item, i.element === t) return void(i.element = r);
                        for (o = $(".select-element-popup", $(e.target)).children()[0].children, n = 0; n < o.length; n++) $(o[n]).css("background", "white");
                        $("[data-name='" + t + "']", $(e.target.children[0])).css("background", "#92d3af"), $(".select-element-popup", $(e.target)).gcuipopup("show", { of: $(".this-class"), my: "left+6 top+22", at: "left top" }), i.element = t
                    }
                }), t.append(new ae(e, function(e) { i.selectedItem = e, i.changedSelectedChartElement(e) })), $("<div></div>").css({ color: "rgba(0, 0, 0, 0.7)", height: "25px" }).append($("<div>").addClass("this-class").css({ padding: "2px 15px" }).append($("<label>").text(e.currentElement.element).css({ "font-weight": "bold", "font-size": "10pt" })).append(t))
            }, se.prototype.changedSelectedChartElement = function(e) {
                var t, i = this.selectedElementsText;
                for (t = 0; t < i.length; t++)
                    if (i[t].key === e) { this.updateSelectedChartElementText(i[t].text); break } this.updateSelectedChartElement(e)
            }, se.prototype.updateSelectedChartElementText = function(e) { $("label:first", this.selectedElement).text(e) };

            function le(e, t) {
                var i, o = $("<div>").css({ color: "rgba(0, 0, 0, 0.8)", height: "40px" }).appendTo(e);
                o.children().remove(), i = $("<div>").css({ padding: "0px 10px", "padding-top": "10px" }).appendTo(o), $("<label>").text(t).css({ "font-size": "17pt", "font-weight": "lighter", color: "#08892c" }).appendTo(i), $("<span>").addClass("slider-panel-close-button").appendTo(i).click(m)
            }

            function ce(e, t, i) { var o = $("<div>").css({ width: "100%", position: "absolute", top: "40px", bottom: "0" }).addClass("slider-panel-content").appendTo(e); return new pe(o, t, i) }

            function de(e, t) {
                var i, o;
                e.sliderpanel(), i = e.sliderpanel("getContainer", "panel2"), i.children().remove(), o = t.getHeaderData().title, le(i, o), ce(i, t, function() { de(e, t) })
            }

            function pe(e, t, i) {
                var o = this;
                o.owner = t, o.container = e, o.updateSlideCallBack = i, o.container.append(new se(this.owner.getElements(), function(e) { o.updateChartPanelTab(e), o.updateSlideCallBack() })), o.initChartPanelContent()
            }
            pe.prototype.initChartPanelContent = function() {
                var e = this.owner.getDatas();
                this.chartPanelContentDom = new B(e, this.owner), this.container.append(this.chartPanelContentDom)
            }, pe.prototype.updateChartPanelTab = function(e) { this.owner.q = e, this.chartPanelContentDom.remove(), this.initChartPanelContent() };

            function ue(e, t, i, o, n) { this.u = e, this.v = t, this.q = i, this.A = o, this.B = n, h(n) || (this.v = "dataPoints", this.q = "dataPoints"), this.makeChartData(e) } ue.prototype.getHeaderData = function() {
                var e = this.v;
                switch (e) {
                    case "series":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.dataSeries };
                    case "dataPoints":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.dataPoints };
                    case "axis":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.axis };
                    case "legend":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.legend };
                    case "dataLabels":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.dataLable };
                    case "chartTitle":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.chartTitle };
                    case "plotArea":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.plotArea };
                    case "chartArea":
                        return { title: o.res.chart.formatChartArea + o.res.chart.formatChart.chartArea };
                    default:
                        return { title: o.res.chart.formatChartArea }
                }
            }, ue.prototype.updateData = function(e, t, i, a) {
                var s, l, c, d, p, u, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, $, L = this.v,
                    F = this.C,
                    R = this.A,
                    B = this.G,
                    O = B[this.q || L],
                    P = i.split("."),
                    N = this,
                    z = o.wrapper.spread,
                    M = N.u;
                switch (L) {
                    case "series":
                        for (m = this.q.slice(7, this.q.length), b = 0; b < R.length; b++)
                            if (R[b] + "" === m) {
                                if (M) {
                                    if (c = P[P.length - 1], l = M.series().get(b), y = !1, "borderColor" === c) l.border.color = a;
                                    else if ("borderWidth" === c) l.border.width = a;
                                    else if ("borderTransparency" === c) l.border.transparency = a;
                                    else if (y = !0, a === o.res.chartSliderPanel.automatic) w = M.colorAndStyle && M.colorAndStyle.color && (M.colorAndStyle && M.colorAndStyle.color).group, x = M.colorAndStyle && M.colorAndStyle.color && (M.colorAndStyle && M.colorAndStyle.color).index, o.actions.doAction("changeChartSeriesColor", o.wrapper.spread, { group: w, index: x, type: c, ignoreEvent: !0 }, M), v = { text: o.res.chartSliderPanel.automatic };
                                    else if ("pie" !== n.getChartTypeString(M.chartType()) && "doughnut" !== n.getChartTypeString(M.chartType()) || "backColor" !== c) l[c] = a;
                                    else
                                        for (C = n.getPieColorArray(l[c]), d = 1, l[c] = a; d < C.length;) l[c] += "," + a, d++;
                                    for (a !== o.res.chartSliderPanel.automatic && (l.isFillSetting = y, o.actions.doAction("updateChartSeries", z, { chart: M, element: { index: b, value: l } })), p = M.series().get(b), f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                                    for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                                    for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                                    a = "borderColor" === c ? p.border.color : "borderWidth" === c ? p.border.width : "borderTransparency" === c ? p.border.transparency : p[c], s = O[c] = a
                                }
                                return v ? (v.color = s, v) : s
                            } break;
                    case "dataPoints":
                        if (c = P[P.length - 1], S = N.B, T = c, !h(S) && !h(a) && M.series() && M.series().dataPoints()) {
                            switch (c = P[P.length - 1]) {
                                case "backColor":
                                    k = { fillColor: a }, T = "fillColor";
                                    break;
                                case "backColorTransparency":
                                    k = { transparency: a }, T = "transparency";
                                    break;
                                default:
                                    k = null
                            }
                            k && o.actions.doAction("changeDataPointProperty", z, { chart: M, dataPointIndex: S, dataPointOption: k })
                        }
                        return A = M.series().dataPoints().get(S), a = A[T], s = O[c] = a;
                    case "axis":
                        if (M) {
                            for (c = P[P.length - 1], E = F || L && N.q, l = M.axes()[E], "fontSize" === c ? l.style.fontSize = a : "fontFamily" === c ? l.style.fontFamily = a : "color" === c ? l.style.color = a : "transparency" === c ? l.style.transparency = a : "borderColor" === c ? l.lineStyle.color = a : "borderTransparency" === c ? l.lineStyle.transparency = a : "borderWidth" === c ? l.lineStyle.width = a : "colorTitle" === c ? l.title.color = a : "titleTransparency" === c ? l.title.transparency = a : "fontSizeTitle" === c ? l.title.fontSize = a : "fontFamilyTitle" === c ? l.title.fontFamily = a : "textTitle" === c ? l.title.text = a : "majorGridLineColor" === c ? l.majorGridLine.color = a : "minorGridLineColor" === c ? l.minorGridLine.color = a : "majorGridLineTransparency" === c ? l.majorGridLine.transparency = a : "minorGridLineTransparency" === c ? l.minorGridLine.transparency = a : "majorGridLineWidth" === c ? l.majorGridLine.width = a : "minorGridLineWidth" === c ? l.minorGridLine.width = a : (2 !== l.categoryType || "max" !== c && "min" !== c ? l.categoryType && (3 !== l.categoryType || "max" !== c && "min" !== c) || (a = a && +a) : a = null === a || a === r ? a && new Date(a).getTime() : a && new Date(a).getTime() || l[c] && new Date(l[c]).getTime(), l[c] = a), I = {}, I[E] = l, o.actions.doAction("changeChartFormatProperty", z, { chart: M, element: { axes: I } }), p = M.axes()[F || L && N.q], f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                            for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                            for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                            a = "fontSize" === c ? p.style.fontSize : "fontFamily" === c ? p.style.fontFamily : "color" === c ? p.style.color : "transparency" === c ? p.style.transparency : "borderColor" === c ? p.lineStyle.color : "borderTransparency" === c ? p.lineStyle.transparency : "borderWidth" === c ? p.lineStyle.width : "colorTitle" === c ? p.title.color : "titleTransparency" === c ? p.title.transparency : "fontSizeTitle" === c ? p.title.fontSize : "fontFamilyTitle" === c ? p.title.fontFamily : "textTitle" === c ? p.title.text : "majorGridLineColor" === c ? p.majorGridLine.color : "minorGridLineColor" === c ? p.minorGridLine.color : "majorGridLineTransparency" === c ? p.majorGridLine.transparency : "minorGridLineTransparency" === c ? p.minorGridLine.transparency : "majorGridLineWidth" === c ? p.majorGridLine.width : "minorGridLineWidth" === c ? p.minorGridLine.width : "categoryType" === c ? { categoryType: p.categoryType, minValue: p.minValue, maxValue: p.maxValue } : 2 !== l.categoryType || "max" !== c && "min" !== c ? p[c] : p[c] && p[c].toLocaleDateString(), s = O[c] = a
                        }
                        return s;
                    case "legend":
                        if (M) {
                            for (l = M.legend(), c = P[P.length - 1], "borderColor" === c ? l.borderStyle.color = a : "borderWidth" === c ? l.borderStyle.width = a : "borderTransparency" === c ? l.borderStyle.transparency = a : "backColor" === c ? l[c] = a : "backColorTransparency" === c ? l[c] = a : (D = {}, D[o.res.chartSliderPanel.top] = 1, D[o.res.chartSliderPanel.right] = 2, D[o.res.chartSliderPanel.left] = 3, D[o.res.chartSliderPanel.bottom] = 4, l[c] = D[a]), o.actions.doAction("changeChartFormatProperty", z, { chart: M, element: { legend: l } }), p = M.legend(), a = "borderColor" === c ? p.borderStyle.color : "borderWidth" === c ? p.borderStyle.width : "borderTransparency" === c ? p.borderStyle.transparency : p[c], f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                            for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                            for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                            s = O[c] = a
                        }
                        return s;
                    case "dataLabels":
                        if (M) {
                            for (c = P[P.length - 1], l = M.dataLabels(), l[c] = a, o.actions.doAction("changeChartFormatProperty", z, { chart: M, element: { dataLabels: l } }), p = M.dataLabels(), a = p[c], f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                            for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                            for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                            s = O[c] = a
                        }
                        return s;
                    case "chartTitle":
                        if (M) {
                            for (c = P[P.length - 1], l = M.title(), l || (l = { text: "" }), l[c] = a, o.actions.doAction("changeChartFormatProperty", z, { chart: M, element: { title: l } }), p = M.title(), p || (p = { text: "" }), a = p[c], f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                            for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                            for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                            s = O[c] = a
                        }
                        return s;
                    case "plotArea":
                        break;
                    case "chartArea":
                        if (M) {
                            if ("sizeAndProperties" === e) l = { name: [M.name()], x: 0, y: 0, width: 0, height: 0 }, c = P[P.length - 1], l[c] = "width" === c ? +a - M.width() : +a - M.height(), o.actions.doAction("updateChartSize", z, l), $ = { name: [M.name()], x: M.x(), y: M.y(), width: M.width(), height: M.height() }, a = $[c];
                            else if (c = P[P.length - 1], l = {}, l[c] = a, o.actions.doAction("changeChartFormatProperty", z, { chart: M, element: { chartArea: l } }), p = M.chartArea(), a = p[c], "color" === c)
                                for (d in B) B[d].textFill && (B[d].textFill.content[0].Text[0].data.color = a);
                            for (f = e.split("."), u = 0; u < f.length; u++) O = O[f[u]];
                            for (g = t, u = 0; u < g.length;) O = O[g[u]][g[u + 1]], u += 2;
                            for (u = 0; u < P.length - 1; u++) O = O[P[u]];
                            s = O[c] = a
                        }
                        return s;
                    default:
                        return null
                }
            }, ue.prototype.getDatas = function() {
                var e, t, i, o, n = this,
                    r = [];
                n.makeChartImp(n.u, n.A, n.B), e = n.G[this.q || this.v], this.syncSelectedElement();
                for (t in e) {
                    i = { name: e[t].type, properties: [] };
                    for (o in e[t]) "type" !== o && e[t][o].forEach(function(e) {
                        var t, o, n = {};
                        for (t in e) n.aggregate = t, o = n.editors = [], e[t].forEach(function(e) { o.push({ name: e.name, data: e.data, type: e.type, resources: e.resources }) });
                        i.properties.push(n)
                    });
                    r.push(i)
                }
                return r
            }, ue.prototype.getElements = function() {
                var e, t, i, r = this.G,
                    a = this.q,
                    s = this.v,
                    l = o.res.chart.selectedOption[s] || o.res.chart.selectedOption[a],
                    c = { currentElement: { element: l, item: a || s } };
                c.elements = [];
                for (e in r) "series" !== e.split(" ")[0] ? (t = o.res.chart.selectedText[e], n.isBarGroup(this.u) && (t = o.res.chart.selectedBarChartText[e] || t), n.isRadarGroup(this.u) && (t = o.res.chart.selectedRadarChartText[e] || t), c.elements.push({ element: o.res.chart.selectedOption[e], text: t, selectedElement: e })) : (i = e.split(" "), i.shift(), c.elements.push({ element: o.res.chart.selectedOption.series, text: o.res.chart.selectedText.series + " " + i.join(" "), selectedElement: e }));
                return c
            }, ue.prototype.syncSelectedElement = function() { this.C = void 0, "series" === this.q.split(" ")[0] ? this.v = "series" : "primaryCategory" === this.q || "primaryValue" === this.q || "secondaryCategory" === this.q || "secondaryValue" === this.q ? this.v = "axis" : "primaryCategoryTitle" === this.q || "primaryCategoryMajorGridLine" === this.q || "primaryCategoryMinorGridLine" === this.q ? (this.v = "axis", this.C = "primaryCategory") : "secondaryCategoryTitle" === this.q || "secondaryCategoryMajorGridLine" === this.q || "secondaryCategoryMinorGridLine" === this.q ? (this.v = "axis", this.C = "secondaryCategory") : "secondaryValueTitle" === this.q || "secondaryValueMajorGridLine" === this.q || "secondaryValueMinorGridLine" === this.q ? (this.v = "axis", this.C = "secondaryValue") : "primaryValueTitle" === this.q || "primaryValueMajorGridLine" === this.q || "primaryValueMinorGridLine" === this.q ? (this.v = "axis", this.C = "primaryValue") : this.v = this.q }, ue.prototype.makeChartData = function(e) {
                var t = this,
                    i = t.A,
                    o = { selectedItem: t.q, chartElement: t.v },
                    n = { chart: e, selectedElement: o, data: null, categories: i };
                t.makeChartImp(e, i, t.B), n.data = t.G, n = t.updateSelectedElement(n), t.v = n.selectedElement.chartElement, t.q = n.selectedElement.selectedItem
            }, ue.prototype.makeChartImp = function(e, t, i) {
                var o = {},
                    n, r, a, s, l;
                A(e, o, t), n = E(e), h(n) || b(n) || (o.legend = n), l = T(e, i), h(l) || b(l) || (o.dataPoints = l), r = I(e), h(r) || b(r) || (o.dataLabels = r), a = D(e), h(a) || b(a) || (o.chartTitle = a), s = L(e), h(s) || b(s) || (o.chartArea = s), F(e, o), this.G = o
            }, ue.prototype.updateSelectedElement = function(e) {
                for (var t in e.data)
                    if ("" + t === e.selectedElement.selectedItem) return e;
                return e.selectedElement.selectedItem = "chartArea", e.selectedElement.chartElement = "chartArea", e
            }, i = {
                sliderPanelDataManager: {},
                initChartSliderPanel: function(e, t, o, r, a) {
                    var s = $(".slider-panel");
                    i.sliderPanelDataManager = new ue(e, t, o, r || n.getChartSeriesNames(e), a), de(s, i.sliderPanelDataManager), s.sliderpanel("open", "panel2")
                },
                refreshSliderPanel: function(e) {
                    var t = i.sliderPanelDataManager,
                        o = $(".slider-panel");
                    !b(t) && o.is(":visible") && (t.makeChartData(e), de(o, t))
                }
            }, e.exports = i
        }()
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = i(0);
        ! function() {
            "use strict";

            function t(e, t, i) {
                var n, r, a = this;
                a.closeCallBack = i, a.H = e, a.container = n = $("<div class='shape-insert-container'></div>"), n.addClass("shape-insert-container-scroll"), e.unbind(), e.resizable(), e.resize(function() { parseInt($(this).height()) <= 539 ? n.removeClass("shape-insert-container-scroll") : n.addClass("shape-insert-container-scroll") }), a.container.appendTo(a.H), a.isChangeShapeType = t, r = o.res.shapeType, a.UIDataSource = [{ resource: o.res.insertShapeDialog.lines, isConnectorType: !0, shapes: [{ type: "straight", className: "noHeadStraight", name: r.line }, { type: "straight", className: "endArrowHeadStraight", name: r.lineArrow, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { beginArrowhead: { beginArrowheadStyle: "open", beginArrowheadWidth: "medium", beginArrowheadLength: "medium" }, type: "straight", className: "beginEndArrowHeadStraight", name: r.lineArrowDouble, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { type: "elbow", name: r.elbow, className: "Elbow" }, { type: "elbow", name: r.elbowArrow, className: "endArrowHeadElbow", endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { beginArrowhead: { beginArrowheadStyle: "open", beginArrowheadWidth: "medium", beginArrowheadLength: "medium" }, type: "elbow", className: "beginEndArrowHeadElbow", name: r.elbowArrowDouble, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }] }, { resource: o.res.insertShapeDialog.rectangles, shapes: [{ type: "rectangle", name: r.rectangle }, { type: "roundedRectangle", name: r.roundedRectangle }, { type: "snip1Rectangle", name: r.snip1Rectangle }, { type: "snip2SameRectangle", name: r.snip2SameRectangle }, { type: "snip2DiagRectangle", name: r.snip2DiagRectangle }, { type: "snipRoundRectangle", name: r.snipRoundRectangle }, { type: "round1Rectangle", name: r.round1Rectangle }, { type: "round2SameRectangle", name: r.round2SameRectangle }, { type: "round2DiagRectangle", name: r.round2DiagRectangle }] }, { resource: o.res.insertShapeDialog.basicShapes, shapes: [{ type: "oval", name: r.oval }, { type: "isoscelesTriangle", name: r.isoscelesTriangle }, { type: "rightTriangle", name: r.rightTriangle }, { type: "parallelogram", name: r.parallelogram }, { type: "trapezoid", name: r.trapezoid }, { type: "diamond", name: r.diamond }, { type: "regularPentagon", name: r.regularPentagon }, { type: "hexagon", name: r.hexagon }, { type: "heptagon", name: r.heptagon }, { type: "octagon", name: r.octagon }, { type: "decagon", name: r.decagon }, { type: "dodecagon", name: r.dodecagon }, { type: "pie", name: r.pie }, { type: "chord", name: r.chord }, { type: "tear", name: r.tear }, { type: "frame", name: r.frame }, { type: "halfFrame", name: r.halfFrame }, { type: "corner", name: r.corner }, { type: "diagonalStripe", name: r.diagonalStripe }, { type: "cross", name: r.cross }, { type: "plaque", name: r.plaque }, { type: "can", name: r.can }, { type: "cube", name: r.cube }, { type: "bevel", name: r.bevel }, { type: "donut", name: r.donut }, { type: "noSymbol", name: r.noSymbol }, { type: "blockArc", name: r.blockArc }, { type: "foldedCorner", name: r.foldedCorner }, { type: "smileyFace", name: r.smileyFace }, { type: "heart", name: r.heart }, { type: "lightningBolt", name: r.lightningBolt }, { type: "sun", name: r.sun }, { type: "moon", name: r.moon }, { type: "cloud", name: r.cloud }, { type: "arc", name: r.arc }, { type: "doubleBracket", name: r.doubleBracket }, { type: "doubleBrace", name: r.doubleBrace }, { type: "leftBracket", name: r.leftBracket }, { type: "rightBracket", name: r.rightBracket }, { type: "leftBrace", name: r.leftBrace }, { type: "rightBrace", name: r.rightBrace }, { type: "upDownArrowCallout", name: r.upDownArrowCallout }, { type: "actionButtonHome", name: r.actionButtonHome }, { type: "actionButtonHelp", name: r.actionButtonHelp }, { type: "actionButtonInformation", name: r.actionButtonInformation }, { type: "actionButtonBackorPrevious", name: r.actionButtonBackorPrevious }, { type: "actionButtonForwardorNext", name: r.actionButtonForwardorNext }, { type: "actionButtonBeginning", name: r.actionButtonBeginning }, { type: "actionButtonEnd", name: r.actionButtonEnd }, { type: "actionButtonReturn", name: r.actionButtonReturn }, { type: "actionButtonDocument", name: r.actionButtonDocument }, { type: "actionButtonSound", name: r.actionButtonSound }, { type: "actionButtonMovie", name: r.actionButtonMovie }, { type: "flowchartOfflineStorage", name: r.flowchartOfflineStorage }, { type: "leftRightRibbon", name: r.leftRightRibbon }, { type: "chartStar", name: r.chartStar }, { type: "chartPlus", name: r.chartPlus }, { type: "lineInverse", name: r.lineInverse }, { type: "leftCircularArrow", name: r.leftCircularArrow }, { type: "leftRightCircularArrow", name: r.leftRightCircularArrow }, { type: "swooshArrow", name: r.swooshArrow }, { type: "chartX", name: r.chartX }, { type: "gear6", name: r.gear6 }, { type: "gear9", name: r.gear9 }, { type: "funnel", name: r.funnel }, { type: "pieWedge", name: r.pieWedge }, { type: "nonIsoscelesTrapezoid", name: r.nonIsoscelesTrapezoid }, { type: "cornerTabs", name: r.cornerTabs }, { type: "squareTabs", name: r.squareTabs }, { type: "plaqueTabs", name: r.plaqueTabs }] }, { resource: o.res.insertShapeDialog.blockArrows, shapes: [{ type: "rightArrow", name: r.rightArrow }, { type: "leftArrow", name: r.leftArrow }, { type: "upArrow", name: r.upArrow }, { type: "downArrow", name: r.downArrow }, { type: "leftRightArrow", name: r.leftRightArrow }, { type: "upDownArrow", name: r.upDownArrow }, { type: "quadArrow", name: r.quadArrow }, { type: "leftRightUpArrow", name: r.leftRightUpArrow }, { type: "bentArrow", name: r.bentArrow }, { type: "uTurnArrow", name: r.uTurnArrow }, { type: "leftUpArrow", name: r.leftUpArrow }, { type: "bentUpArrow", name: r.bentUpArrow }, { type: "curvedRightArrow", name: r.curvedRightArrow }, { type: "curvedLeftArrow", name: r.curvedLeftArrow }, { type: "curvedUpArrow", name: r.curvedUpArrow }, { type: "curvedDownArrow", name: r.curvedDownArrow }, { type: "stripedRightArrow", name: r.stripedRightArrow }, { type: "notchedRightArrow", name: r.notchedRightArrow }, { type: "pentagon", name: r.pentagon }, { type: "chevron", name: r.chevron }, { type: "rightArrowCallout", name: r.rightArrowCallout }, { type: "downArrowCallout", name: r.downArrowCallout }, { type: "leftArrowCallout", name: r.leftArrowCallout }, { type: "upArrowCallout", name: r.upArrowCallout }, { type: "leftRightArrowCallout", name: r.leftRightArrowCallout }, { type: "quadArrowCallout", name: r.quadArrowCallout }, { type: "circularArrow", name: r.circularArrow }] }, { resource: o.res.insertShapeDialog.equationShapes, shapes: [{ type: "mathPlus", name: r.mathPlus }, { type: "mathMinus", name: r.mathMinus }, { type: "mathMultiply", name: r.mathMultiply }, { type: "mathDivide", name: r.mathDivide }, { type: "mathEqual", name: r.mathEqual }, { type: "mathNotEqual", name: r.mathNotEqual }] }, { resource: o.res.insertShapeDialog.flowChart, shapes: [{ type: "flowchartProcess", name: r.flowchartProcess }, { type: "flowchartAlternateProcess", name: r.flowchartAlternateProcess }, { type: "flowchartDecision", name: r.flowchartDecision }, { type: "flowchartData", name: r.flowchartData }, { type: "flowchartPredefinedProcess", name: r.flowchartPredefinedProcess }, { type: "flowchartInternalStorage", name: r.flowchartInternalStorage }, { type: "flowchartDocument", name: r.flowchartDocument }, { type: "flowchartMultidocument", name: r.flowchartMultidocument }, { type: "flowchartTerminator", name: r.flowchartTerminator }, { type: "flowchartPreparation", name: r.flowchartPreparation }, { type: "flowchartManualInput", name: r.flowchartManualInput }, { type: "flowchartManualOperation", name: r.flowchartManualOperation }, { type: "flowchartConnector", name: r.flowchartConnector }, { type: "flowchartOffpageConnector", name: r.flowchartOffpageConnector }, { type: "flowchartCard", name: r.flowchartCard }, { type: "flowchartPunchedTape", name: r.flowchartPunchedTape }, { type: "flowchartSummingJunction", name: r.flowchartSummingJunction }, { type: "flowchartOr", name: r.flowchartOr }, { type: "flowchartCollate", name: r.flowchartCollate }, { type: "flowchartSort", name: r.flowchartSort }, { type: "flowchartExtract", name: r.flowchartExtract }, { type: "flowchartMerge", name: r.flowchartMerge }, { type: "flowchartStoredData", name: r.flowchartStoredData }, { type: "flowchartDelay", name: r.flowchartDelay }, { type: "flowchartSequentialAccessStorage", name: r.flowchartSequentialAccessStorage }, { type: "flowchartMagneticDisk", name: r.flowchartMagneticDisk }, { type: "flowchartDirectAccessStorage", name: r.flowchartDirectAccessStorage }, { type: "flowchartDisplay", name: r.flowchartDisplay }] }, { resource: o.res.insertShapeDialog.starsAndBanners, shapes: [{ type: "explosion1", name: r.explosion1 }, { type: "explosion2", name: r.explosion2 }, { type: "shape4pointStar", name: r.shape4pointStar }, { type: "shape5pointStar", name: r.shape5pointStar }, { type: "star6Point", name: r.star6Point }, { type: "star7Point", name: r.star7Point }, { type: "shape8pointStar", name: r.shape8pointStar }, { type: "star10Point", name: r.star10Point }, { type: "star12Point", name: r.star12Point }, { type: "shape16pointStar", name: r.shape16pointStar }, { type: "shape24pointStar", name: r.shape24pointStar }, { type: "shape32pointStar", name: r.shape32pointStar }, { type: "upRibbon", name: r.upRibbon }, { type: "downRibbon", name: r.downRibbon }, { type: "curvedUpRibbon", name: r.curvedUpRibbon }, { type: "curvedDownRibbon", name: r.curvedDownRibbon }, { type: "verticalScroll", name: r.verticalScroll }, { type: "horizontalScroll", name: r.horizontalScroll }, { type: "wave", name: r.wave }, { type: "doubleWave", name: r.doubleWave }] }, { resource: o.res.insertShapeDialog.callouts, shapes: [{ type: "rectangularCallout", name: r.rectangularCallout }, { type: "roundedRectangularCallout", name: r.roundedRectangularCallout }, { type: "ovalCallout", name: r.ovalCallout }, { type: "cloudCallout", name: r.cloudCallout }, { type: "lineCallout2", name: r.lineCallout2 }, { type: "lineCallout3", name: r.lineCallout3 }, { type: "lineCallout4", name: r.lineCallout4 }, { type: "lineCallout2AccentBar", name: r.lineCallout2AccentBar }, { type: "lineCallout3AccentBar", name: r.lineCallout3AccentBar }, { type: "lineCallout4AccentBar", name: r.lineCallout4AccentBar }, { type: "lineCallout2NoBorder", name: r.lineCallout2NoBorder }, { type: "lineCallout3NoBorder", name: r.lineCallout3NoBorder }, { type: "lineCallout4NoBorder", name: r.lineCallout4NoBorder }, { type: "lineCallout2BorderandAccentBar", name: r.lineCallout2BorderandAccentBar }, { type: "lineCallout3BorderandAccentBar", name: r.lineCallout3BorderandAccentBar }, { type: "lineCallout4BorderandAccentBar", name: r.lineCallout4BorderandAccentBar }] }], "change" === t && a.UIDataSource.shift(), a.I()
            }
            t.prototype.I = function() {
                var e, t, i = this,
                    o = this.UIDataSource;
                for (e = 0; e < o.length; e++) t = o[e], i.J(t.resource), i.K(t.shapes, t.isConnectorType)
            }, t.prototype.J = function(e) {
                var t = this,
                    i = $("<div class='shape-insert-item-header'></div>");
                i.html(e), i.appendTo(t.container)
            }, t.prototype.K = function(e, t) {
                var i, o, n = this,
                    r = $("<div class='shape-insert-item-con'></div>");
                for (i = 0; i < e.length; i++) o = e[i], n.L(r, o, t);
                r.appendTo(n.container)
            }, t.prototype.L = function(e, t, i) {
                var o = this,
                    n = $("<div class='shape-insert-item'></div>"),
                    r = t.className || t.type;
                n.addClass("insert-shape-item-" + r), n.attr("title", t.name), n.click(function() {
                    switch (o.isChangeShapeType) {
                        case "insert":
                            o.N(t, i);
                            break;
                        case "change":
                            o.O(t)
                    }
                }), n.appendTo(e)
            }, t.prototype.N = function(e, t) {
                var i = this,
                    r = o.wrapper.spread.getActiveSheet(),
                    a = n.getShapePosition(r);
                o.actions.doAction("insertShape", o.wrapper.spread, { shapeInfo: e, isConnectorType: t, position: a }), i.closeCallBack()
            }, t.prototype.O = function(e) {
                var t = this,
                    i = o.wrapper.spread.getActiveSheet(),
                    r = n.getActiveShapes(i);
                o.actions.doAction("changeShapeType", o.wrapper.spread, { selectShapes: r, newShapeType: e }), t.closeCallBack()
            }, e.exports = t
        }()
    }, function(e, t) {
        ! function() {
            "use strict";
            var e, t = GC.Spread.Sheets.Charts.Chart.prototype.toJSON;
            GC.Spread.Sheets.Charts.Chart.prototype.toJSON = function() {
                var e = this,
                    i = t.call(e),
                    o = this.colorAndStyle;
                return o && (i.colorAndStyle = o), i
            }, e = GC.Spread.Sheets.Charts.Chart.prototype.fromJSON, GC.Spread.Sheets.Charts.Chart.prototype.fromJSON = function(t, i) {
                var o, n = this;
                e.call(n, t, i), (o = t.colorAndStyle) && (n.colorAndStyle = o)
            }
        }()
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(2), i(18), i(20), i(17), i(19)
        }()
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(22), i(24), i(25), i(23), i(27)
        }()
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(31), i(28), i(43), i(12), i(21), i(26), i(30), i(29)
        }()
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(40), i(42), i(39), i(37), i(38), i(41)
        }()
    }, function(module, exports) {
        var __extends, gcui, designer = GC.Spread.Sheets.Designer;
        ! function(e, t) {
            var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T;
            i = function(e) { return new i.prototype.init(e) }, e.Globalize = i, i.cultures = {}, i.prototype = { constructor: i, init: function(e) { return this.cultures = i.cultures, this.cultureSelector = e, this } }, i.prototype.init.prototype = i.prototype, i.cultures.default = {
                    name: "en",
                    englishName: "English",
                    nativeName: "English",
                    isRTL: !1,
                    language: "en",
                    numberFormat: {
                        pattern: ["-n"],
                        decimals: 2,
                        ",": ",",
                        ".": ".",
                        groupSizes: [3],
                        "+": "+",
                        "-": "-",
                        NaN: "NaN",
                        negativeInfinity: "-Infinity",
                        positiveInfinity: "Infinity",
                        percent: { pattern: ["-n %", "n %"], decimals: 2, groupSizes: [3], ",": ",", ".": ".", symbol: "%" },
                        currency: { pattern: ["($n)", "$n"], decimals: 2, groupSizes: [3], ",": ",", ".": ".", symbol: "$" }
                    },
                    calendars: { standard: { name: "Gregorian_USEnglish", "/": "/", ":": ":", firstDay: 0, days: { names: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], namesAbbr: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], namesShort: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"] }, months: { names: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", ""], namesAbbr: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", ""] }, AM: ["AM", "am", "AM"], PM: ["PM", "pm", "PM"], eras: [{ name: "A.D.", start: null, offset: 0 }], twoDigitYearMax: 2029, patterns: { d: "M/d/yyyy", D: "dddd, MMMM dd, yyyy", t: "h:mm tt", T: "h:mm:ss tt", f: "dddd, MMMM dd, yyyy h:mm tt", F: "dddd, MMMM dd, yyyy h:mm:ss tt", M: "MMMM dd", Y: "yyyy MMMM", S: "yyyy'-'MM'-'dd'T'HH':'mm':'ss" } } },
                    messages: {}
                }, i.cultures.default.calendar = i.cultures.default.calendars.standard, i.cultures.en = i.cultures.default, i.cultureSelector = "en", o = /^0x[a-f0-9]+$/i, n = /^[+-]?infinity$/i, r = /^[+-]?\d*\.?\d*(e[+-]?\d+)?$/, a = /^\s+|\s+$/g, s = function(e, t) {
                    if (e.indexOf) return e.indexOf(t);
                    for (var i = 0, o = e.length; i < o; i++)
                        if (e[i] === t) return i;
                    return -1
                }, l = function(e, t) { return e.substr(e.length - t.length) === t }, c = function(e) {
                    var i, o, n, r, a, s, l = arguments[0] || {},
                        h = 1,
                        f = arguments.length,
                        e = !1;
                    for ("boolean" == typeof l && (e = l, l = arguments[1] || {}, h = 2), "object" == typeof l || p(l) || (l = {}); h < f; h++)
                        if (null != (i = arguments[h]))
                            for (o in i) n = l[o], r = i[o], l !== r && (e && r && (u(r) || (a = d(r))) ? (a ? (a = !1, s = n && d(n) ? n : []) : s = n && u(n) ? n : {}, l[o] = c(e, s, r)) : r !== t && (l[o] = r));
                    return l
                }, d = Array.isArray || function(e) { return "[object Array]" === Object.prototype.toString.call(e) }, p = function(e) { return "[object Function]" === Object.prototype.toString.call(e) }, u = function(e) { return "[object Object]" === Object.prototype.toString.call(e) }, h = function(e, t) { return 0 === e.indexOf(t) }, f = function(e) { return (e + "").replace(a, "") }, g = function(e) { return isNaN(e) ? NaN : 0 | e }, m = function(e, t, i) { for (var o = e.length; o < t; o += 1) e = i ? "0" + e : e + "0"; return e }, b = function(e, t) {
                    var i, o, n, r, a;
                    for (i = 0, o = !1, n = 0, r = e.length; n < r; n++) switch (a = e.charAt(n)) {
                        case "'":
                            o ? t.push("'") : i++, o = !1;
                            break;
                        case "\\":
                            o && t.push("\\"), o = !o;
                            break;
                        default:
                            t.push(a), o = !1
                    }
                    return i
                }, v = function(e, t) {
                    t = t || "F";
                    var i, o = e.patterns,
                        n = t.length;
                    if (1 === n) {
                        if (!(i = o[t])) throw "Invalid date format string '" + t + "'.";
                        t = i
                    } else 2 === n && "%" === t.charAt(0) && (t = t.charAt(1));
                    return t
                }, y = function(e, t, i) {
                    var o, n, r, a, s, l, c, d, p, u, h, f, g, m, w, k, T, A, E, I, D = i.calendar,
                        $ = D.convert;
                    if (!t || !t.length || "i" === t) return i && i.name.length ? $ ? o = y(e, D.patterns.F, i) : (n = new Date(e.getTime()), r = C(e, D.eras), n.setFullYear(S(e, D, r)), o = n.toLocaleString()) : o = "" + e, o;
                    a = D.eras, s = "s" === t, t = v(D, t), o = [], c = ["0", "00", "000"], u = /([^d]|^)(d|dd)([^d]|$)/g, h = 0, f = x();

                    function L(e, t) { var i, o = e + ""; return t > 1 && o.length < t ? (i = c[t - 2] + o, i.substr(i.length - t, t)) : i = o }

                    function F() { return d || p ? d : (d = u.test(t), p = !0, d) }

                    function R(e, t) {
                        if (g) return g[t];
                        switch (t) {
                            case 0:
                                return e.getFullYear();
                            case 1:
                                return e.getMonth();
                            case 2:
                                return e.getDate()
                        }
                    }
                    for (!s && $ && (g = $.fromGregorian(e)); m = f.lastIndex, w = f.exec(t), k = t.slice(m, w ? w.index : t.length), h += b(k, o), w;)
                        if (h % 2) o.push(w[0]);
                        else switch (T = w[0], A = T.length, T) {
                            case "ddd":
                            case "dddd":
                                E = 3 === A ? D.days.namesAbbr : D.days.names, o.push(E[e.getDay()]);
                                break;
                            case "d":
                            case "dd":
                                d = !0, o.push(L(R(e, 2), A));
                                break;
                            case "MMM":
                            case "MMMM":
                                I = R(e, 1), o.push(D.monthsGenitive && F() ? D.monthsGenitive[3 === A ? "namesAbbr" : "names"][I] : D.months[3 === A ? "namesAbbr" : "names"][I]);
                                break;
                            case "M":
                            case "MM":
                                o.push(L(R(e, 1) + 1, A));
                                break;
                            case "y":
                            case "yy":
                            case "yyyy":
                                I = g ? g[0] : S(e, D, C(e, a), s), A < 4 && (I %= 100), o.push(L(I, A));
                                break;
                            case "h":
                            case "hh":
                                l = e.getHours() % 12, 0 === l && (l = 12), o.push(L(l, A));
                                break;
                            case "H":
                            case "HH":
                                o.push(L(e.getHours(), A));
                                break;
                            case "m":
                            case "mm":
                                o.push(L(e.getMinutes(), A));
                                break;
                            case "s":
                            case "ss":
                                o.push(L(e.getSeconds(), A));
                                break;
                            case "t":
                            case "tt":
                                I = e.getHours() < 12 ? D.AM ? D.AM[0] : " " : D.PM ? D.PM[0] : " ", o.push(1 === A ? I.charAt(0) : I);
                                break;
                            case "f":
                            case "ff":
                            case "fff":
                                o.push(L(e.getMilliseconds(), 3).substr(0, A));
                                break;
                            case "z":
                            case "zz":
                                l = e.getTimezoneOffset() / 60, o.push((l <= 0 ? "+" : "-") + L(Math.floor(Math.abs(l)), A));
                                break;
                            case "zzz":
                                l = e.getTimezoneOffset() / 60, o.push((l <= 0 ? "+" : "-") + L(Math.floor(Math.abs(l)), 2) + ":" + L(Math.abs(e.getTimezoneOffset() % 60), 2));
                                break;
                            case "g":
                            case "gg":
                                D.eras && o.push(D.eras[C(e, a)].name);
                                break;
                            case "/":
                                o.push(D["/"]);
                                break;
                            default:
                                throw "Invalid date format pattern '" + T + "'."
                        }
                    return o.join("")
                },
                function() {
                    var e;
                    e = function(e, t, i) {
                        var o, n, r, a, s, l, c, d, p = i.groupSizes,
                            u = p[0],
                            h = 1,
                            f = Math.pow(10, t),
                            g = Math.round(e * f) / f;
                        for (isFinite(g) || (g = e), e = g, o = e + "", n = "", r = o.split(/e/i), a = r.length > 1 ? parseInt(r[1], 10) : 0, o = r[0], r = o.split("."), o = r[0], n = r.length > 1 ? r[1] : "", a > 0 ? (n = m(n, a, !1), o += n.slice(0, a), n = n.substr(a)) : a < 0 && (a = -a, o = m(o, a + 1), n = o.slice(-a, o.length) + n, o = o.slice(0, -a)), n = t > 0 ? i["."] + (n.length > t ? n.slice(0, t) : m(n, t)) : "", l = o.length - 1, c = i[","], d = ""; l >= 0;) {
                            if (0 === u || u > l) return o.slice(0, l + 1) + (d.length ? c + d + n : n);
                            d = o.slice(l - u + 1, l + 1) + (d.length ? c + d : ""), l -= u, h < p.length && (u = p[h], h++)
                        }
                        return o.slice(0, l + 1) + c + d + n
                    }, w = function(t, i, o) {
                        var n, r, a, s, l, c, d, p, u, h;
                        if (!isFinite(t)) return t === 1 / 0 ? o.numberFormat.positiveInfinity : t === -1 / 0 ? o.numberFormat.negativeInfinity : o.numberFormat.NaN;
                        if (!i || "i" === i) return o.name.length ? t.toLocaleString() : "" + t;
                        switch (i = i || "D", n = o.numberFormat, r = Math.abs(t), a = -1, i.length > 1 && (a = parseInt(i.slice(1), 10)), l = i.charAt(0).toUpperCase()) {
                            case "D":
                                s = "n", r = g(r), -1 !== a && (r = m("" + r, a, !0)), t < 0 && (r = "-" + r);
                                break;
                            case "N":
                                c = n;
                            case "C":
                                c = c || n.currency;
                            case "P":
                                c = c || n.percent, s = t < 0 ? c.pattern[0] : c.pattern[1] || "n", -1 === a && (a = c.decimals), r = e(r * ("P" === l ? 100 : 1), a, c);
                                break;
                            default:
                                throw "Bad number format specifier: " + l
                        }
                        for (d = /n|\$|-|%/g, p = ""; u = d.lastIndex, h = d.exec(s), p += s.slice(u, h ? h.index : s.length), h;) switch (h[0]) {
                            case "n":
                                p += r;
                                break;
                            case "$":
                                p += n.currency.symbol;
                                break;
                            case "-":
                                /[1-9]/.test(r) && (p += n["-"]);
                                break;
                            case "%":
                                p += n.percent.symbol
                        }
                        return p
                    }
                }(), x = function() { return /\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g }, C = function(e, t) {
                    if (!t) return 0;
                    for (var i, o = e.getTime(), n = 0, r = t.length; n < r; n++)
                        if (null === (i = t[n].start) || o >= i) return n;
                    return 0
                }, S = function(e, t, i, o) { var n = e.getFullYear(); return !o && t.eras && (n -= t.eras[i].offset), n },
                function() {
                    var e, t, i, o, n, r, a;
                    e = function(e, t) {
                        if (t < 100) {
                            var i = new Date,
                                o = C(i),
                                n = S(i, e, o),
                                r = e.twoDigitYearMax;
                            r = "string" == typeof r ? (new Date).getFullYear() % 100 + parseInt(r, 10) : r, t += n - n % 100, t > r && (t -= 100)
                        }
                        return t
                    }, t = function(e, t, i) {
                        var o, n = e.days,
                            l = e.P;
                        return l || (e.P = l = [a(n.names), a(n.namesAbbr), a(n.namesShort)]), t = r(t), i ? -1 === (o = s(l[1], t)) && (o = s(l[2], t)) : o = s(l[0], t), o
                    }, i = function(e, t, i) {
                        var o, n = e.months,
                            l = e.monthsGenitive || e.months,
                            c = e.R,
                            d = e.U;
                        return c || (e.R = c = [a(n.names), a(n.namesAbbr)], e.U = d = [a(l.names), a(l.namesAbbr)]), t = r(t), o = s(i ? c[1] : c[0], t), o < 0 && (o = s(i ? d[1] : d[0], t)), o
                    }, o = function(e, t) {
                        var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m = e.V;
                        if (m) { if (i = m[t]) return i } else e.V = m = {};
                        for (o = v(e, t).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g, "\\\\$1"), n = ["^"], r = [], a = 0, s = 0, l = x(); null !== (c = l.exec(o));)
                            if (d = o.slice(a, c.index), a = l.lastIndex, (s += b(d, n)) % 2) n.push(c[0]);
                            else {
                                switch (p = c[0], u = p.length, p) {
                                    case "dddd":
                                    case "ddd":
                                    case "MMMM":
                                    case "MMM":
                                    case "gg":
                                    case "g":
                                        h = "(\\D+)";
                                        break;
                                    case "tt":
                                    case "t":
                                        h = "(\\D*)";
                                        break;
                                    case "yyyy":
                                    case "fff":
                                    case "ff":
                                    case "f":
                                        h = "(\\d{" + u + "})";
                                        break;
                                    case "dd":
                                    case "d":
                                    case "MM":
                                    case "M":
                                    case "yy":
                                    case "y":
                                    case "HH":
                                    case "H":
                                    case "hh":
                                    case "h":
                                    case "mm":
                                    case "m":
                                    case "ss":
                                    case "s":
                                        h = "(\\d\\d?)";
                                        break;
                                    case "zzz":
                                        h = "([+-]?\\d\\d?:\\d{2})";
                                        break;
                                    case "zz":
                                    case "z":
                                        h = "([+-]?\\d\\d?)";
                                        break;
                                    case "/":
                                        h = "(\\" + e["/"] + ")";
                                        break;
                                    default:
                                        throw "Invalid date format pattern '" + p + "'."
                                }
                                h && n.push(h), r.push(c[0])
                            } return b(o.slice(a), n), n.push("$"), f = n.join("").replace(/\s+/g, "\\s+"), g = { regExp: f, groups: r }, m[t] = g
                    }, n = function(e, t, i) { return e < t || e > i }, r = function(e) { return e.split("\xa0").join(" ").toUpperCase() }, a = function(e) { for (var t = [], i = 0, o = e.length; i < o; i++) t[i] = r(e[i]); return t }, k = function(r, a, s) {
                        var l, c, d, p, u, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, $, L, F, R, B, O, P, N, z, M, V;
                        if (r = f(r), l = s.calendar, c = o(l, a), d = RegExp(c.regExp).exec(r), null === d) return null;
                        for (p = c.groups, u = null, g = null, m = null, b = null, v = null, y = 0, x = 0, C = 0, S = 0, k = null, T = !1, A = 0, E = p.length; A < E; A++)
                            if (I = d[A + 1]) switch (D = p[A], $ = D.length, L = parseInt(I, 10), D) {
                                case "dd":
                                case "d":
                                    if (b = L, n(b, 1, 31)) return null;
                                    break;
                                case "MMM":
                                case "MMMM":
                                    if (m = i(l, I, 3 === $), n(m, 0, 11)) return null;
                                    break;
                                case "M":
                                case "MM":
                                    if (m = L - 1, n(m, 0, 11)) return null;
                                    break;
                                case "y":
                                case "yy":
                                case "yyyy":
                                    if (g = $ < 4 ? e(l, L) : L, n(g, 0, 9999)) return null;
                                    break;
                                case "h":
                                case "hh":
                                    if (y = L, 12 === y && (y = 0), n(y, 0, 11)) return null;
                                    break;
                                case "H":
                                case "HH":
                                    if (y = L, n(y, 0, 23)) return null;
                                    break;
                                case "m":
                                case "mm":
                                    if (x = L, n(x, 0, 59)) return null;
                                    break;
                                case "s":
                                case "ss":
                                    if (C = L, n(C, 0, 59)) return null;
                                    break;
                                case "tt":
                                case "t":
                                    if (!(T = l.PM && (I === l.PM[0] || I === l.PM[1] || I === l.PM[2])) && (!l.AM || I !== l.AM[0] && I !== l.AM[1] && I !== l.AM[2])) return null;
                                    break;
                                case "f":
                                case "ff":
                                case "fff":
                                    if (S = L * Math.pow(10, 3 - $), n(S, 0, 999)) return null;
                                    break;
                                case "ddd":
                                case "dddd":
                                    if (v = t(l, I, 3 === $), n(v, 0, 6)) return null;
                                    break;
                                case "zzz":
                                    if (F = I.split(/:/), 2 !== F.length) return null;
                                    if (w = parseInt(F[0], 10), n(w, -12, 13)) return null;
                                    if (R = parseInt(F[1], 10), n(R, 0, 59)) return null;
                                    k = 60 * w + (h(I, "-") ? -R : R);
                                    break;
                                case "z":
                                case "zz":
                                    if (w = L, n(w, -12, 13)) return null;
                                    k = 60 * w;
                                    break;
                                case "g":
                                case "gg":
                                    if (!(B = I) || !l.eras) return null;
                                    for (B = f(B.toLowerCase()), O = 0, P = l.eras.length; O < P; O++)
                                        if (B === l.eras[O].name.toLowerCase()) { u = O; break } if (null === u) return null
                            }
                        if (N = new Date, M = l.convert, z = M ? M.fromGregorian(N)[0] : N.getFullYear(), null === g ? g = z : l.eras && (g += l.eras[u || 0].offset), null === m && (m = 0), null === b && (b = 1), M) { if (null === (N = M.toGregorian(g, m, b))) return null } else { if (N.setFullYear(g, m, b), N.getDate() !== b) return null; if (null !== v && N.getDay() !== v) return null }
                        return T && y < 12 && (y += 12), N.setHours(y, x, C, S), null !== k && (V = N.getMinutes() - (k + N.getTimezoneOffset()), N.setHours(N.getHours() + parseInt(V / 60, 10), V % 60)), N
                    }
                }(), T = function(e, t, i) {
                    var o = t["-"],
                        n = t["+"],
                        r;
                    switch (i) {
                        case "n -":
                            o = " " + o, n = " " + n;
                        case "n-":
                            l(e, o) ? r = ["-", e.substr(0, e.length - o.length)] : l(e, n) && (r = ["+", e.substr(0, e.length - n.length)]);
                            break;
                        case "- n":
                            o += " ", n += " ";
                        case "-n":
                            h(e, o) ? r = ["-", e.substr(o.length)] : h(e, n) && (r = ["+", e.substr(n.length)]);
                            break;
                        case "(n)":
                            h(e, "(") && l(e, ")") && (r = ["-", e.substr(1, e.length - 2)])
                    }
                    return r || ["", e]
                }, i.prototype.findClosestCulture = function(e) { return i.findClosestCulture.call(this, e) }, i.prototype.format = function(e, t, o) { return i.format.call(this, e, t, o) }, i.prototype.localize = function(e, t) { return i.localize.call(this, e, t) }, i.prototype.parseInt = function(e, t, o) { return i.parseInt.call(this, e, t, o) }, i.prototype.parseFloat = function(e, t, o) { return i.parseFloat.call(this, e, t, o) }, i.prototype.culture = function(e) { return i.culture.call(this, e) }, i.addCultureInfo = function(e, t, i) {
                    var o = {},
                        n = !1;
                    "string" != typeof e ? (i = e, e = this.culture().name, o = this.cultures[e]) : "string" != typeof t ? (i = t, n = null == this.cultures[e], o = this.cultures[e] || this.cultures.default) : (n = !0, o = this.cultures[t]), this.cultures[e] = c(!0, {}, o, i), n && (this.cultures[e].calendar = this.cultures[e].calendars.standard)
                }, i.findClosestCulture = function(e) {
                    var t, i, o, n, r, a, s, l, c, p, u, h;
                    if (!e) return this.cultures[this.cultureSelector] || this.cultures.default;
                    if ("string" == typeof e && (e = e.split(",")), d(e)) {
                        for (o = this.cultures, n = e, r = n.length, a = [], s = 0; s < r; s++) e = f(n[s]), c = e.split(";"), i = f(c[0]), 1 === c.length ? l = 1 : (e = f(c[1]), 0 === e.indexOf("q=") ? (e = e.substr(2), l = parseFloat(e), l = isNaN(l) ? 0 : l) : l = 1), a.push({ lang: i, pri: l });
                        for (a.sort(function(e, t) { return e.pri < t.pri ? 1 : -1 }), s = 0; s < r; s++)
                            if (i = a[s].lang, t = o[i]) return t;
                        for (s = 0; s < r; s++)
                            for (i = a[s].lang;;) { if (-1 === (p = i.lastIndexOf("-"))) break; if (i = i.substr(0, p), t = o[i]) return t }
                        for (s = 0; s < r; s++) {
                            i = a[s].lang;
                            for (u in o)
                                if (h = o[u], h.language == i) return h
                        }
                    } else if ("object" == typeof e) return e;
                    return t || null
                }, i.format = function(e, t, i) { return culture = this.findClosestCulture(i), e instanceof Date ? e = y(e, t, culture) : "number" == typeof e && (e = w(e, t, culture)), e }, i.localize = function(e, t) { return this.findClosestCulture(t).messages[e] || this.cultures.default.messages[e] }, i.parseDate = function(e, t, i) {
                    var o, n, r, a, s, l;
                    if (i = this.findClosestCulture(i), t) {
                        if ("string" == typeof t && (t = [t]), t.length)
                            for (a = 0, s = t.length; a < s && (!(l = t[a]) || !(o = k(e, l, i))); a++);
                    } else {
                        r = i.calendar.patterns;
                        for (n in r)
                            if (o = k(e, r[n], i)) break
                    }
                    return o || null
                }, i.parseInt = function(e, t, o) { return g(i.parseFloat(e, t, o)) }, i.parseFloat = function(e, t, i) { var a, s, l, c, d, p, u, h, g, m, b, v, y, w, x, C, S; return "number" != typeof t && (i = t, t = 10), a = this.findClosestCulture(i), s = NaN, l = a.numberFormat, e.indexOf(a.numberFormat.currency.symbol) > -1 && (e = e.replace(a.numberFormat.currency.symbol, ""), e = e.replace(a.numberFormat.currency["."], a.numberFormat["."])), e = f(e), n.test(e) ? s = parseFloat(e) : !t && o.test(e) ? s = parseInt(e, 16) : (c = T(e, l, l.pattern[0]), d = c[0], p = c[1], "" === d && "(n)" !== l.pattern[0] && (c = T(e, l, "(n)"), d = c[0], p = c[1]), "" === d && "-n" !== l.pattern[0] && (c = T(e, l, "-n"), d = c[0], p = c[1]), d = d || "+", g = p.indexOf("e"), g < 0 && (g = p.indexOf("E")), g < 0 ? (h = p, u = null) : (h = p.substr(0, g), u = p.substr(g + 1)), v = l["."], y = h.indexOf(v), y < 0 ? (m = h, b = null) : (m = h.substr(0, y), b = h.substr(y + v.length)), w = l[","], m = m.split(w).join(""), x = w.replace(/\u00A0/g, " "), w !== x && (m = m.split(x).join("")), C = d + m, null !== b && (C += "." + b), null !== u && (S = T(u, l, "-n"), C += "e" + (S[0] || "+") + S[1]), r.test(C) && (s = parseFloat(C))), s }, i.culture = function(e) { return void 0 !== e && (this.cultureSelector = e), this.findClosestCulture(e) || this.culture.default }
        }(window), __extends = this.W || function(e, t) {
                function i() { this.constructor = e } i.prototype = t.prototype, e.prototype = new i
            },
            function(e) {
                var t, i, o, n = jQuery,
                    r = {
                        autoMobilize: !0,
                        uiCSS: { widget: "ui-widget", overlay: "ui-widget-overlay", content: "ui-widget-content", header: "ui-widget-header", stateDisabled: "ui-state-disabled", stateFocus: "ui-state-focus", stateActive: "ui-state-active", stateDefault: "ui-state-default", stateHightlight: "ui-state-highlight", stateHover: "ui-state-hover", stateChecked: "ui-state-checked", stateError: "ui-state-error", getState: function(e) { return e = e.charAt(0).toUpperCase() + e.substr(1), n.gcui.uiCSS["state" + e] }, icon: "ui-icon", iconCheck: "ui-icon-check", iconRadioOn: "ui-icon-radio-on", iconRadioOff: "ui-icon-radio-off", iconClose: "ui-icon-close", iconArrow4Diag: "ui-icon-arrow-4-diag", iconNewWin: "ui-icon-newwin", iconVGripSolid: "ui-icon-grip-solid-vertical", iconHGripSolid: "ui-icon-grip-solid-horizontal", iconPlay: "ui-icon-play", iconPause: "ui-icon-pause", iconStop: "ui-icon-stop", iconArrowUp: "ui-icon-triangle-1-n", iconArrowRight: "ui-icon-triangle-1-e", iconArrowDown: "ui-icon-triangle-1-s", iconArrowLeft: "ui-icon-triangle-1-w", iconArrowRightDown: "ui-icon-triangle-1-se", iconCaratUp: "ui-icon-carat-1-n", iconCaratRight: "ui-icon-carat-1-e", iconCaratDown: "ui-icon-carat-1-s", iconCaratLeft: "ui-icon-carat-1-w", iconSeekFirst: "ui-icon-seek-first", iconSeekEnd: "ui-icon-seek-end", iconSeekNext: "ui-icon-seek-next", iconSeekPrev: "ui-icon-seek-prev", inputSpinnerLeft: "ui-input-spinner-left", inputSpinnerRight: "ui-input-spinner-right", inputTriggerLeft: "ui-input-trigger-left", inputTriggerRight: "ui-input-trigger-right", inputSpinnerTriggerLeft: "ui-input-spinner-trigger-left", inputSpinnerTriggerRight: "ui-input-spinner-trigger-right", cornerAll: "ui-corner-all", cornerLeft: "ui-corner-left", cornerRight: "ui-corner-right", cornerBottom: "ui-corner-bottom", cornerBL: "ui-corner-bl", cornerBR: "ui-corner-br", cornerTop: "ui-corner-top", cornerTL: "ui-corner-tl", cornerTR: "ui-corner-tr", helperClearFix: "ui-helper-clearfix", helperReset: "ui-helper-reset", helperHidden: "ui-helper-hidden", priorityPrimary: "ui-priority-primary", prioritySecondary: "ui-priority-secondary", button: "ui-button", buttonText: "ui-button-text", buttonTextOnly: "ui-button-text-only", tabs: "ui-tabs", tabsTop: "ui-tabs-top", tabsBottom: "ui-tabs-bottom", tabsLeft: "ui-tabs-left", tabsRight: "ui-tabs-right", tabsLoading: "ui-tabs-loading", tabsActive: "ui-tabs-active", tabsPanel: "ui-tabs-panel", tabsNav: "ui-tabs-nav", tabsHide: "ui-tabs-hide", tabsCollapsible: "ui-tabs-collapsible", activeMenuitem: "ui-active-menuitem" },
                        mobileCSS: { content: "ui-content", header: "ui-header", overlay: "ui-overlay", stateDisabled: "ui-disabled", stateFocus: "ui-focus", stateActive: "ui-btn-active", stateDefault: "ui-btn-up-a", iconArrowUp: "ui-icon-arrow-u", iconArrowRight: "ui-icon-arrow-r", iconArrowDown: "ui-icon-arrow-d", iconArrowLeft: "ui-icon-arrow-l", iconArrowRightDown: "ui-icon-arrow-d", iconSeekFirst: "ui-icon-arrow-l", iconSeekEnd: "ui-icon-arrow-r", iconSeekNext: "ui-icon-arrow-r", iconSeekPrev: "ui-icon-arrow-l", iconClose: "ui-icon-delete", iconStop: "ui-icon-grid", iconCheck: "ui-icon-checkbox-on" },
                        mobileThemePrefix: ["ui-bar", "ui-body", "ui-overlay", "ui-btn-up", "ui-btn-hover", "ui-btn-down"],
                        autoInit: function(e, t) {
                            if (n.mobile && n.mobile.page && t) {
                                var i = n.mobile.page.prototype.options.keepNative;
                                i = i && i.length && -1 === i.indexOf(t) ? [i, t].join(", ") : t, n.mobile.page.prototype.options.keepNative = i
                            }
                            n.mobile && n.gcui[e] && n.gcui[e].prototype && n.gcui[e].prototype.enhanceWithin && n(document).bind("pagecreate create", function(t) { n.gcui[e].prototype.enhanceWithin(t.target) })
                        },
                        registerWidget: function(e, t, i, o) {
                            var r = "gcui." + e,
                                a;
                            "function" == typeof i && (a = i, i = null), null !== i && void 0 !== i || (i = n.extend(!0, {}, t), t = n.gcui.widget), i.options = i.options || {}, i.options.initSelector = i.options.initSelector || ":jqmData(role='" + e + "')", n.mobile && i.options && i.options.mobileCSS && (i.options.uiCSS = i.options.uiCSS || {}, n.extend(i.options.uiCSS, i.options.mobileCSS)), n.widget(r, t, i), a ? a.call() : this.autoInit && this.autoInit(e, i.options.initSelector)
                        },
                        addThemeToMobileCSS: function(e, t) {
                            n.each(t, function(i, o) {
                                "string" == typeof o ? n.each(jQueryGCUI.mobileThemePrefix, function(n, r) {
                                    var a = RegExp("\\b" + r);
                                    a.test(o) && (t[i] = o + " " + r + "-" + e)
                                }) : jQueryGCUI.addThemeToMobileCSS(e, o)
                            })
                        },
                        replaceClassName: function(e) { return e.replace(/\s/g, "") },
                        getTextAutoWidth: function(e) { var t, i, o, r; if (e.children()) { for (t = e.children().length, i = 0, o = n("#measureWidth"), r = 0; r < t; r++) o.css("font", e.find(".ui-button-text").css("font")).text(n(e.children()[r]).find(".ui-button-text").text()), i = o.innerWidth() > i ? o.innerWidth() : i; return o.addClass("update-width"), i } }
                    };
                n.gcui = r, t = function() {
                    function e() {}
                    return e.prototype.options = { uiCSS: n.gcui.uiCSS }, e.prototype.widget = function() { return this.element }, ["destory", "_setOption", "_create", "_init"].forEach(function(t) { e.prototype[t] = function() { n.Widget.prototype[t].apply(this, arguments) } }), e
                }(), e.GCUIWidget = t, i = function(e) {
                    __extends(t, e);

                    function t() { e.apply(this, arguments) }
                    return t
                }(t), e.GCUIMobileWidget = i, n(window.document).trigger("gcuiinit"), o = function(e) {
                    __extends(t, e);

                    function t() { e.apply(this, arguments), this.Z = !1 }
                    return t.prototype.$ = function() { return this._ ? n.mobile.widget : n.Widget }, t.prototype.aa = function(e, t) { this.Z = !0, this.ba && (this.widgetEventPrefix = this.widgetName), window.applyTouchUtilEvents && (n = window.applyTouchUtilEvents(n)), this.$().prototype.aa.apply(this, arguments) }, t.prototype._create = function() { this.$().prototype._create.apply(this, arguments) }, t.prototype._init = function() { this.$().prototype._init.apply(this, arguments) }, t.prototype.destroy = function() { this.$().prototype.destroy.apply(this, arguments) }, t.prototype._setOption = function(e, t) { this.$().prototype._setOption.apply(this, arguments), "disabled" === e && t && this._ && this.element.removeClass("ui-state-disabled").addClass(this.options.uiCSS.stateDisabled) }, t
                }(i), e.gcuiWidget = o, o.prototype.ba = !0, o.prototype._ = !1, null != n.mobile && !0 === n.gcui.autoMobilize ? (n.extend(!0, o.prototype.options.uiCSS, n.gcui.mobileCSS), o.prototype._ = !0, o.prototype.options = n.extend(!0, {}, o.prototype.options, o.prototype.$().prototype.options), o.prototype.enhanceWithin = function(e, t) { this.Z || n.mobile.widget.prototype.enhanceWithin.apply(this, arguments) }, o.prototype.ca = function() {
                    var e = this.element,
                        t, i = function(e) {
                            if (void 0 === e) return {};
                            if (null === e) return {};
                            var t = /(?:(?:\{[\n\r\t\s]*(.+?)\s*\:[\n\r\t\s]*)|(?:,[\n\r\t\s]*(.+?)\s*\:[\n\r\t\s]*))('(.*?[^\\])')?/gi,
                                i = /\[.*?(?=[\]\[])|[\]\[].*?(?=[\]])/gi,
                                o = e.replace(t, function(e, t, i, o) {
                                    var n, r = /[\n\r\t\s]*['"]?([^\{,\s]+?)['"]?\s*:[\n\r\t\s]*/i,
                                        a = /\:[\n\r\t\s]*(?:'(.*)')?/i;
                                    return n = e.replace(r, '"$1":'), o ? n.replace(a, ':"$1"') : n
                                }).replace(i, function(e) { var t = /'(.*?[^\\])'/g; return e.replace(t, '"$1"') });
                            return n.parseJSON(o)
                        },
                        o = i(e.attr("data-" + n.mobile.nsNormalize("options"))),
                        r;
                    return t = n.mobile.widget.prototype.ca.apply(this, arguments), r = n.extend(!0, {}, this.options.uiCSS), this.theme = void 0 !== this.options.theme ? this.options.theme : this.element.jqmData("theme"), this.theme && n.gcui.addThemeToMobileCSS(this.theme, r), n.extend(t, { uiCSS: r }, o)
                }, n.widget("gcui.widget", n.mobile.widget, o.prototype), n(document).on("pageshow", function(e, t) {
                    if (null != e.target) {
                        var i = n(e.target);
                        i.gcuiTriggerVisibility && i.gcuiTriggerVisibility()
                    }
                })) : (o.prototype.options = n.extend(!0, {}, o.prototype.options, o.prototype.$().prototype.options), n.widget("gcui.widget", o.prototype))
            }(gcui || (gcui = {})),
            function(e) {
                var t, i, o, n, r, a, s;
                $.fn.extend({
                    getTextSelection: function() {
                        var e, t, i, o, n, r, a, s, l, c, d, p = this[0],
                            u = this.val();
                        if (0 === arguments.length) { if (a = GC.Spread.Sheets.util.browser, a.msie && parseInt(a.version) < 9) try { s = document.selection, "textarea" != p.tagName.toLowerCase() ? (i = s.createRange().duplicate(), i.moveEnd("character", u.length), n = "" === i.text ? u.length : u.lastIndexOf(i.text), i = s.createRange().duplicate(), i.moveStart("character", -u.length), r = i.text.length) : (i = s.createRange(), o = i.duplicate(), o.moveToElementText(p), o.setEndPoint("EndToEnd", i), n = o.text.length - i.text.length, r = n + i.text.length) } catch (r) {} else n = p.selectionStart, r = p.selectionEnd; return l = u.substring(n, r), { start: n, end: r, text: l, replace: function(e) { return u.substring(0, n) + e + u.substring(r, u.length) } } } 1 === arguments.length ? "object" == typeof arguments[0] && "number" == typeof arguments[0].start && "number" == typeof arguments[0].end ? (e = arguments[0].start, t = arguments[0].end) : "string" == typeof arguments[0] ? (e = u.indexOf(arguments[0])) > -1 && (t = e + arguments[0].length) : "[object RegExp]" === Object.prototype.toString.call(arguments[0]) && null != (c = arguments[0].exec(u)) && (e = c.index, t = e + c[0].length) : 2 === arguments.length && "number" == typeof arguments[0] && "number" == typeof arguments[1] && (e = arguments[0], t = arguments[1]), void 0 === e && (e = 0, t = u.length), a.msie ? (d = p.createTextRange(), d.collapse(!0), d.moveStart("character", e), d.moveEnd("character", t - e), d.select()) : (p.selectionStart = e, p.selectionEnd = t)
                    },
                    getContent: function(e) { return this.each(function() { this.innerHTML = '<iframe frameborder="0" style="width: 100%; height: 100%;" src="' + e + '">"' }) },
                    addVisibilityObserver: function(e, t) {
                        return this.each(function() {
                            var i = this;
                            $(this).addClass("gcui-observer-visibility"), $(this).bind("gcuimovisibilitychanged" + (t ? "." + t : ""), function(t) { e.apply(i, arguments), t.stopPropagation() })
                        })
                    },
                    removeVisibilityObserver: function(e) { return this.each(function() { $(this).removeClass("gcui-observer-visibility"), e ? jQuery.isFunction(e) ? $(this).unbind("gcuimovisibilitychanged", e) : $(this).unbind("gcuimovisibilitychanged." + e) : $(this).unbind("gcuimovisibilitychanged") }) },
                    triggerVisibility: function() {
                        return this.each(function() {
                            var e = $(this);
                            e.hasClass("gcui-observer-visibility") && e.trigger("gcuimovisibilitychanged"), e.find(".gcui-observer-visibility").trigger("gcuimovisibilitychanged")
                        })
                    },
                    leftBorderWidth: function() {
                        var e = parseFloat($(this).css("borderLeftWidth")),
                            t = parseFloat($(this).css("padding-left")),
                            i = 0;
                        return "auto" !== $(this).css("margin-left") && (i = parseFloat($(this).css("margin-left"))), l(e) + l(t) + l(i)
                    },
                    rightBorderWidth: function() {
                        var e = parseFloat($(this).css("borderRightWidth")),
                            t = parseFloat($(this).css("padding-right")),
                            i = 0;
                        return "auto" !== $(this).css("margin-right") && (i = parseFloat($(this).css("margin-right"))), l(e) + l(t) + l(i)
                    },
                    topBorderWidth: function() {
                        var e = parseFloat($(this).css("borderTopWidth")),
                            t = parseFloat($(this).css("padding-top")),
                            i = 0;
                        return "auto" !== $(this).css("margin-top") && (i = parseFloat($(this).css("margin-top"))), l(e) + l(t) + l(i)
                    },
                    bottomBorderWidth: function() {
                        var e = parseFloat($(this).css("borderBottomWidth")),
                            t = parseFloat($(this).css("padding-bottom")),
                            i = 0;
                        return "auto" !== $(this).css("margin-bottom") && (i = parseFloat($(this).css("margin-bottom"))), l(e) + l(t) + l(i)
                    },
                    borderSize: function() {
                        var e = $(this).leftBorderWidth() + $(this).rightBorderWidth(),
                            t = $(this).topBorderWidth() + $(this).bottomBorderWidth(),
                            i = { width: e, height: t };
                        return i
                    },
                    setOutWidth: function(e) { var t = $(this).leftBorderWidth() + $(this).rightBorderWidth(); return $(this).width(e - t), this },
                    setOutHeight: function(e) { var t = $(this).topBorderWidth() + $(this).bottomBorderWidth(); return $(this).height(e - t), this },
                    getWidget: function() { var e = this.data("widgetName"); return e && "" !== e ? this.data(e) : null },
                    gcuishow: function(e, t, i, o, n) {
                        var r = e.animated || !1,
                            a = e.duration || 400,
                            s = e.easing,
                            l = e.option || {};
                        if (o && $.isFunction(o) && o.call(this), r) { if (t && t[r]) return void t[r](e, $.extend(i, { complete: n })); if ($.effects && ($.effects[r] || $.effects.effect && $.effects.effect[r])) return void this.show(r, $.extend(l, { easing: s }), a, n) } this.show(), n && $.isFunction(n) && n.call(this)
                    },
                    gcuihide: function(e, t, i, o, n) {
                        var r = e.animated || !1,
                            a = e.duration || 400,
                            s = e.easing,
                            l = e.option || {};
                        if (o && $.isFunction(o) && o.call(this), r) { if (t && t[r]) return void t[r](e, $.extend(i, { complete: n })); if ($.effects && ($.effects[r] || $.effects.effect && $.effects.effect[r])) return void this.stop().hide(r, $.extend(l, { easing: s }), a, n) } this.hide(), n && $.isFunction(n) && n.call(this)
                    }
                });

                function l(e) { return isNaN(e) ? 0 : e } $.save = function(e, t) { if ($.effects) return $.effects.save(e, t); for (var i = 0; i < t.length; i++) null !== t[i] && e.data("ec.storage." + t[i], e[0].style[t[i]]) }, $.restore = function(e, t) { if ($.effects) return $.effects.restore(e, t); for (var i = 0; i < t.length; i++) null !== t[i] && e.css(t[i], e.data("ec.storage." + t[i])) }, $.createWrapper = function(e) {
                    if ($.effects) return $.effects.createWrapper(e);
                    if (e.parent().is(".ui-effects-wrapper")) return e.parent();
                    var t = { width: e.outerWidth(!0), height: e.outerHeight(!0), float: e.css("float") },
                        i = $("<div></div>").addClass("ui-effects-wrapper").css({ fontSize: "100%", background: "transparent", border: "none", margin: 0, padding: 0 }),
                        o = document.activeElement;
                    return e.wrap(i), (e[0] === o || $.contains(e[0], o)) && $(o).focus(), i = e.parent(), "static" == e.css("position") ? (i.css({ position: "relative" }), e.css({ position: "relative" })) : ($.extend(t, { position: e.css("position"), zIndex: e.css("z-index") }), $.each(["top", "left", "bottom", "right"], function(i, o) { t[o] = e.css(o), isNaN(parseInt(t[o], 10)) && (t[o] = "auto") }), e.css({ position: "relative", top: 0, left: 0, right: "auto", bottom: "auto" })), i.css(t).show()
                }, $.removeWrapper = function(e) { if ($.effects) return $.effects.removeWrapper(e); var t, i = document.activeElement; return e.parent().is(".ui-effects-wrapper") ? (t = e.parent().replaceWith(e), (e[0] === i || $.contains(e[0], i)) && $(i).focus(), t) : e }, $.setMode = function(e, t) { return $.effects ? $.effects.setMode(e, t) : ("toggle" === t && (t = e.is(":hidden") ? "show" : "hide"), t) }, t = function() {}, $.extend(t.prototype, {
                    da: " ! \" # % & ' ( ) * , - . / : ; ? @ [ \\ ] { } \xa1 \xab \xad \xb7 \xbb \xbf \u037e \u0387 \u055a \u055b \u055c \u055d \u055e \u055f \u0589 \u058a \u05be \u05c0 \u05c3 \u05f3 \u05f4 \u060c \u061b \u061f \u066a \u066b \u066c \u066d \u06d4 \u0700 \u0701 \u0702 \u0703 \u0704 \u0705 \u0706 \u0707 \u0708 \u0709 \u070a \u070b \u070c \u070d \u0964 \u0965 \u0970 \u0df4 \u0e4f \u0e5a \u0e5b \u0f04 \u0f05 \u0f06 \u0f07 \u0f08 \u0f09 \u0f0a \u0f0b \u0f0c \u0f0d \u0f0e \u0f0f \u0f10 \u0f11 \u0f12 \u0f3a \u0f3b \u0f3c \u0f3d \u0f85 \u104a \u104b \u104c \u104d \u104e \u104f \u10fb \u1361 \u1362 \u1363 \u1364 \u1365 \u1366 \u1367 \u1368 \u166d \u166e \u169b \u169c \u16eb \u16ec \u16ed \u17d4 \u17d5 \u17d6 \u17d7 \u17d8 \u17d9 \u17da \u17dc \u1800 \u1801 \u1802 \u1803 \u1804 \u1805 \u1806 \u1807 \u1808 \u1809 \u180a \u2010 \u2011 \u2012 \u2013 \u2014 \u2015 \u2016 \u2017 \u2018 \u2019 \u201a \u201b \u201c \u201d \u201e \u201f \u2020 \u2021 \u2022 \u2023 \u2024 \u2025 \u2026 \u2027 \u2030 \u2031 \u2032 \u2033 \u2034 \u2035 \u2036 \u2037 \u2038 \u2039 \u203a \u203b \u203c \u203d \u203e \u2041 \u2042 \u2043 \u2045 \u2046 \u2048 \u2049 \u204a \u204b \u204c \u204d \u207d \u207e \u208d \u208e \u2329 \u232a \u3001 \u3002 \u3003 \u3008 \u3009 \u300a \u300b \u300c \u300d \u300e \u300f \u3010 \u3011 \u3014 \u3015 \u3016 \u3017 \u3018 \u3019 \u301a \u301b \u301c \u301d \u301e \u301f \u3030 \ufd3e \ufd3f \ufe30 \ufe31 \ufe32 \ufe35 \ufe36 \ufe37 \ufe38 \ufe39 \ufe3a \ufe3b \ufe3c \ufe3d \ufe3e \ufe3f \ufe40 \ufe41 \ufe42 \ufe43 \ufe44 \ufe49 \ufe4a \ufe4b \ufe4c \ufe50 \ufe51 \ufe52 \ufe54 \ufe55 \ufe56 \ufe57 \ufe58 \ufe59 \ufe5a \ufe5b \ufe5c \ufe5d \ufe5e \ufe5f \ufe60 \ufe61 \ufe63 \ufe68 \ufe6a \ufe6b \uff01 \uff02 \uff03 \uff05 \uff06 \uff07 \uff08 \uff09 \uff0a \uff0c \uff0d \uff0e \uff0f \uff1a \uff1b \uff1f \uff20 \uff3b \uff3c \uff3d \uff5b \uff5d \uff61 \uff62 \uff63 \uff64';this.UTFWhitespacesString_='\t \v \f \x1f   \xa0 \u1680 \u2000 \u2001 \u2002 \u2003 \u2004 \u2005 \u2006 \u2007 \u2008 \u2009 \u200a \u200b \u2028 \u202f \u3000",
                    isDigit: function(e) { var t = e.charCodeAt(0); return t >= 48 && t < 58 },
                    isLetter: function(e) { return !!(e + "").match(RegExp("[A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u021f\u0222-\u0233\u0250-\u02ad\u02b0-\u02b8\u02bb-\u02c1\u02d0\u02d1\u02e0-\u02e4\u02ee\u037a\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d7\u03da-\u03f3\u0400-\u0481\u048c-\u04c4\u04c7\u04c8\u04cb\u04cc\u04d0-\u04f5\u04f8\u04f9\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0640-\u064a\u0671-\u06d3\u06d5\u06e5\u06e6\u06fa-\u06fc\u0710\u0712-\u072c\u0780-\u07a5\u0905-\u0939\u093d\u0950\u0958-\u0961\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b36-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60\u0d61\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6a\u0f88-\u0f8b\u1000-\u1021\u1023-\u1027\u1029\u102a\u1050-\u1055\u10a0-\u10c5\u10d0-\u10f6\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1206\u1208-\u1246\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1286\u1288\u128a-\u128d\u1290-\u12ae\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12ce\u12d0-\u12d6\u12d8-\u12ee\u12f0-\u130e\u1310\u1312-\u1315\u1318-\u131e\u1320-\u1346\u1348-\u135a\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1780-\u17b3\u1820-\u1877\u1880-\u18a8\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u207f\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u3005\u3006\u3031-\u3035\u3041-\u3094\u309d\u309e\u30a1-\u30fa\u30fc-\u30fe\u3105-\u312c\u3131-\u318e\u31a0-\u31b7\u3400-\u4db5\u4e00-\u9fa5\ua000-\ua48c\uac00-\ud7a3\uf900-\ufa2d\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe72\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")) },
                    isLetterOrDigit: function(e) { return this.isLetter(e) || this.isDigit(e) },
                    isDoubleByteNumber: function(e) { var t = e.charCodeAt(0); return t >= 65296 && t < 65306 },
                    isSymbol: function(e) {
                        var t = RegExp("[$+<->^`|~\xa2-\xa9\xac\xae-\xb1\xb4\xb6\xb8\xd7\xf7\u02b9\u02ba\u02c2-\u02cf\u02d2-\u02df\u02e5-\u02ed\u0374\u0375\u0384\u0385\u0482\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0b70\u0e3f\u0f01-\u0f03\u0f13-\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fcf\u17db\u1fbd\u1fbf-\u1fc1\u1fcd-\u1fcf\u1fdd-\u1fdf\u1fed-\u1fef\u1ffd\u1ffe\u2044\u207a-\u207c\u208a-\u208c\u20a0-\u20af\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211e-\u2123\u2125\u2127\u2129\u212e\u2132\u213a\u2190-\u21f3\u2200-\u22f1\u2300-\u2328\u232b-\u237b\u237d-\u239a\u2400-\u2426\u2440-\u244a\u249c-\u24e9\u2500-\u2595\u25a0-\u25f7\u2600-\u2613\u2619-\u2671\u2701-\u2704\u2706-\u2709\u270c-\u2727\u2729-\u274b\u274d\u274f-\u2752\u2756\u2758-\u275e\u2761-\u2767\u2794\u2798-\u27af\u27b1-\u27be\u2800-\u28ff\u2e80-\u2e99\u2e9b-\u2ef3\u2f00-\u2fd5\u2ff0-\u2ffb\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\u3190\u3191\u3196-\u319f\u3200-\u321c\u322a-\u3243\u3260-\u327b\u327f\u328a-\u32b0\u32c0-\u32cb\u32d0-\u32fe\u3300-\u3376\u337b-\u33dd\u33e0-\u33fe\ua490-\ua4a1\ua4a4-\ua4b3\ua4b5-\ua4c0\ua4c2-\ua4c4\ua4c6\ufb29\ufe62\ufe64-\ufe66\ufe69\uff04\uff0b\uff1c-\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee\ufffc\ufffd]");
                        return t.test(e + "")
                    },
                    isPunctuation: function(e) { return this.da.indexOf(e) >= 0 },
                    isPrintableChar: function(e) { return !!(this.isLetterOrDigit(e) || this.isPunctuation(e) || this.isSymbol(e) || this.isDoubleByteNumber(e)) || " " === e },
                    isAscii: function(e) { return e >= "!" && e <= "~" },
                    isAsciiLetter: function(e) { return e >= "A" && e <= "Z" || e >= "a" && e <= "z" },
                    isUpper: function(e) { return e.toUpperCase() === e },
                    isLower: function(e) { return e.toLowerCase() === e },
                    isAlphanumeric: function(e) { return !!this.isLetter(e) || this.isDigit(e) },
                    isAciiAlphanumeric: function(e) { return !(e < "0" || e > "9") || !(e < "A" || e > "Z") || e >= "a" && e <= "z" },
                    setChar: function(e, t, i) { return i >= e.length || i < 0 ? e : e.substr(0, i) + t + e.substr(i + 1) }
                }), $.fn.zIndex || ($.fn.zIndex = function(e) {
                    if (void 0 !== e) return this.css("zIndex", e);
                    if (this.length)
                        for (var t = $(this[0]), i, o; t.length && t[0] !== document;) {
                            if (("absolute" === (i = t.css("position")) || "relative" === i || "fixed" === i) && (o = parseInt(t.css("zIndex"), 10), !isNaN(o) && 0 !== o)) return o;
                            t = t.parent()
                        }
                    return 0
                }), i = ["\n", "\r", '"', "@", "+", "'", "<", ">", "%", "{", "}"], o = ["!ESC!NN!", "!ESC!RR!", "!ESC!01!", "!ESC!02!", "!ESC!03!", "!ESC!04!", "!ESC!05!", "!ESC!06!", "!ESC!07!", "!ESC!08!", "!ESC!09!"], n = ["(\n)", "(\r)", '(")', "(@)", "(\\+)", "(')", "(\\<)", "(\\>)", "(%)", "(\\{)", "(\\})"], $.gcuiutil || $.extend({ gcuiutil: { charValidator: new t, encodeString: function(e) { var t, r; for (t = 0; t < i.length; t++) r = RegExp(n[t], "g"), e = e.replace(r, o[t]); return e }, decodeString: function(e) { var t, n; if ("" !== e) { for (t = 0; t < o.length; t++) n = RegExp(o[t], "g"), e = e.replace(n, i[t]); return e } } } }), jQuery.uaMatch || (jQuery.uaMatch = function(e) { e = e.toLowerCase(); var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || []; return { browser: t[1] || "", version: t[2] || "0" } }), jQuery.browser || (r = jQuery.uaMatch(navigator.userAgent), a = { version: "0", msie: !1, opera: !1, safari: !1, mozilla: !1, webkit: !1, chrome: !1 }, r.browser && (a[r.browser] = !0, a.version = r.version), a.chrome ? a.webkit = !0 : a.webkit && (a.safari = !0), jQuery.browser = a), $.ui && $.ui.position && $.ui.position.flipfit && ($.ui.position.flip.top = function(e, t) {
                    var i = t.within,
                        o = i.offset.top + i.scrollTop,
                        n = i.height,
                        r = i.isWindow ? i.scrollTop : i.offset.top,
                        a = e.top - t.collisionPosition.marginTop,
                        s = a - r,
                        l = a + t.collisionHeight - n - r,
                        c = "top" === t.my[1],
                        d = c ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0,
                        p = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0,
                        u = -2 * t.offset[1],
                        h, f;
                    s < 0 ? (f = e.top + d + p + u + t.collisionHeight - n - o, e.top + d + p + u > s && (f < 0 || f < Math.abs(s)) && (e.top += d + p + u)) : l > 0 && (h = e.top - t.collisionPosition.marginTop + d + p + u - r, e.top + d + p + u + t.collisionHeight - n - r < l && (h > 0 || Math.abs(h) < l) && (e.top += d + p + u))
                }), s = $.fn.position, $.fn.position = function(e) {
                    if (e && $.isPlainObject(e) && e.offset) {
                        var t = (e.my || "").split(" "),
                            i = /left|center|right/,
                            o = /top|center|bottom/,
                            n = (e.offset || "").split(" ");
                        1 === t.length && (i.test(t[0]) ? t.concat(["center"]) : o.test(t[0]) && ["center"].concat(t)), 1 === n.length && n.concat(n[0]), $.each(t, function(e, i) { /\+|-/.test(n[e]) ? t[e] = t[e] + n[e] : t[e] = t[e] + "+" + n[e] }), e.my = t.join(" ")
                    }
                    return s.apply(this, arguments)
                };

                function c() { if ($.ui && $.ui.keyCode) return $.ui.keyCode; if ($.mobile && $.mobile.keyCode) return $.mobile.keyCode; throw "keyCode object is not found" } e.getKeyCodeEnum = c
            }(gcui || (gcui = {}));

        function __gcuiReadOptionEvents(e, t) {
            var i, o, n;
            for (i = 0; i < e.length; i++) null !== t.options[e[i]] && t.element.bind(e[i], t.options[e[i]]);
            for (i in t.options)
                if (-1 !== i.indexOf(" "))
                    for (o = i.split(" "), n = 0; n < o.length; n++) o[n].length > 0 && t.element.bind(o[n], t.options[i])
        }

        function gcuiASPNetParseOptionsReviewer(o, k) {
            var a, v = o[k],
                d;
            if (v) switch (typeof v) {
                case "string":
                    a = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?):(\d{3})Z$/.exec(v), a && (d = new Date(+a[1], +a[2] - 1, +a[3], +a[4], +a[5], +a[6], +a[7]), d.setFullYear(+a[1]), o[k] = d);
                    break;
                case "object":
                    if (void 0 !== v.needQuotes && void 0 !== v.valueString) v.needQuotes ? o[k] = v.valueString : o[k] = eval(v.valueString);
                    else
                        for (k in v) gcuiASPNetParseOptionsReviewer(v, k)
            }
        }

        function gcuiASPNetParseOptions(e) { var t; if (!e) return e; for (t in e) gcuiASPNetParseOptionsReviewer(e, t); return e }! function(e) {
            var t, i;
            e.expando = ".gcui", t = function() {
                function e(e) { this.message = e, this.stack = "gcui" + Error().stack, this.name = "GCUIError" }
                return e
            }(), e.GCUIError = t, i = t, i.prototype = Error(), i.prototype.constructor = i
        }(gcui || (gcui = {})),
        function(e) {
            ! function(t) {
                var i = function() {
                    function t(e) { this.object = e }
                    return t.getFrom = function i(o, n) {
                        void 0 === n && (n = !0);
                        var r = e.expando,
                            a;
                        if (Object(o) !== o) return null;
                        if (a = o[r], a && a.object !== o && (a = null), n && !(a instanceof t && Object.prototype.hasOwnProperty.call(o, r))) { a = new t(o); try { Object.defineProperty(o, r, { value: a, configurable: !1, enumerable: !1, writable: !1 }) } catch (e) { o[r] = a } }
                        return a
                    }, t
                }();
                t.Expando = i
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                ! function(e) {
                    function t(e) { return function() { var t = function() { return e.prototype.ea.apply(t, arguments) }; return $.extend(t, e.prototype), e.apply(t, arguments), t } } e.funcClass = t
                }(e.util || (e.util = {}));
                var t = e.util
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t, i, o, n, r, a, s = jQuery,
                    l = function() {
                        function e(e, t) { this.handler = e, this.context = t }
                        return e.prototype.trigger = function(e) { return this.handler.apply(this.context, e) }, e
                    }();
                e.SubscriberEntry = l, t = function() {
                    function t(e) { this.defaultContext = e, this.fa = [] }
                    return t.prototype.subscribe = function(t, i) { var o, n; return void 0 === i && (i = this.defaultContext), o = this, n = new l(t, i), this.fa.push(n), { dispose: function() { return e.util.remove(o.fa, n) } } }, t.prototype.trigger = function() {
                        var t, i = [];
                        for (t = 0; t < arguments.length - 0; t++) i[t] = arguments[t + 0];
                        e.util.each(this.fa, function(e, t) { return t.trigger(i) })
                    }, t.makeSubscribable = function e(i) { var o = new t(i); return i.subscribe = s.proxy(o.subscribe, o), o }, t
                }(), e.Subscribable = t;

                function c(e) { return s.isFunction(e.subscribe) } e.isSubscriptable = c, i = function() {
                    function e() {}
                    return e.prototype.subscribe = function(e, i) { return this.ga = this.ga || new t(this), this.ga.subscribe(e, i) }, e.prototype._trigger = function() {
                        var e, t = [];
                        for (e = 0; e < arguments.length - 0; e++) t[e] = arguments[e + 0];
                        this.ga && this.ga.trigger.apply(this.ga, arguments)
                    }, e
                }(), e.BaseObservable = i, o = function(e) {
                    __extends(t, e);

                    function t(t) { e.call(this), this.mutable = t }
                    return t.prototype.ea = function() { return this.mutable.value }, t
                }(i), e.ha = o, n = e.util.funcClass(o), r = function(e) {
                    __extends(t, e);

                    function t(t, i) { void 0 === i && (i = !1), e.call(this), this.value = t, this.checkNewValue = i }
                    return t.prototype.ea = function(e) { return arguments.length > 0 && (!this.checkNewValue || e !== this.value) && (this.value = e, this._trigger(e), this.ia && this.ia._trigger(e)), this.value }, t.prototype.read = function() { return this.ia = this.ia || new n(this), this.ia }, t
                }(i), e.ja = r, a = e.util.funcClass(r);

                function d(e) { return void 0 === e && (e = null), new a(e) } e.observable = d;

                function p(e) { return void 0 === e && (e = null), new a(e, !0) } e.observableWithNewValueCheck = p;

                function u(e) { return s.isFunction(e) && c(e) } e.isObservable = u
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(t) {
                ! function(i) {
                    var o, n, r = jQuery;

                    function a(e, t) { return void 0 === t && (t = !1), r.isArray(e) ? e = e.slice(0) : r.isPlainObject(e) && (e = r.extend(!!t, {}, e)), e } i.clone = a;

                    function s(e) { return "string" == typeof e || e instanceof String } i.isString = s;

                    function l(e) { return "number" == typeof e } i.isNumeric = l;

                    function c(t) { return t === e.expando || t === r.expando } i.isInternalProperty = c;

                    function d(e, t) {
                        var i = this;
                        r.each(e, function(e, o) { if (!c(e)) return t.call(i, e, o) })
                    }
                    i.each = d;

                    function p(t, i) { var o = r.map(t, i); return delete o[e.expando], o } i.map = p;

                    function u(e) { var t; return t = e && r.isFunction(e.toString) && e.toString !== Object.prototype.toString ? "" + e : JSON.stringify(e), null != t && t.length > 2 && '"' === t[0] && '"' === t[t.length - 1] && (t = t.substr(1, t.length - 2)), t } i.toStr = u;

                    function h(e) { var t, i = []; for (t = 0; t < arguments.length - 1; t++) i[t] = arguments[t + 1]; return e.replace(/{(\d+)}/g, function(e, t) { return u(i[parseInt(t, 10)]) }) } i.format = h;

                    function f(e, t) { var i = !0; return d(e, function(e, o) { if (i = o, t && (i = t.call(i, i, e)), !i) return !1 }), i } i.every = f;

                    function g(e, t) { var i = !1; return d(e, function(e, o) { if (i = o, t && (i = t.call(i, i, e)), i) return !1 }), i } i.some = g;

                    function m(e, t) {
                        var i, o, n;
                        if (null == e) return null == t ? 0 : -1;
                        if (null == t) return 1;
                        if (r.isArray(e) && r.isArray(t)) {
                            for (o = Math.min(e.length, t.length), i = 0; i < o; i++)
                                if (0 !== (n = m(e[i], t[i]))) return n;
                            return e.length - t.length
                        }
                        return s(e) && s(t) ? (e = e.toLowerCase(), t = t.toLowerCase(), e < t ? -1 : e > t ? 1 : 0) : (n = e - t, isNaN(n) ? 0 : n)
                    }
                    i.compare = m;

                    function b(e, t) { return r.inArray(t, e) >= 0 } i.contains = b;

                    function v(e, t) {
                        var i = 0,
                            o;
                        for (o = 0; o < e.length;) e[o] !== t ? o++ : (e.splice(o, 1), i++);
                        return i
                    }
                    i.remove = v;

                    function y(e, t) { return -1 == e ? -1 : 0 == e ? 0 : t ? Math.ceil(e / t) : 1 } i.pageCount = y;

                    function w(e, t) {
                        var i, o = [];
                        for (i = 0; i < arguments.length - 2; i++) o[i] = arguments[i + 2];

                        function n() { return e.apply(t, o) }
                        if ("undefined" == typeof setTimeout) return n();
                        setTimeout(n, 10)
                    }
                    i.executeDelayed = w;

                    function x(e) { "undefined" != typeof console && (console.error ? console.error(e) : console.log && console.log(e)) } i.logError = x;

                    function C(e, i) {
                        for (var o, n, r = 0, a = e;;)
                            if (n = i.indexOf(".", r), n >= 0 ? (o = i.substring(r, n), r = n + 1) : o = r > 0 ? i.substring(r) : i, a = a[o], t.isObservable(a) && (a = a()), n < 0) break;
                        return a
                    }
                    i.getProperty = C;

                    function S(e, i, o) { for (var n, r, a, s = 0;;) { if (r = i.indexOf(".", s), r >= 0 ? (n = i.substring(s, r), s = r + 1) : n = s > 0 ? i.substring(s) : i, a = e[n], !(r >= 0)) { t.isObservable(a) ? a(o) : e[n] = o; break } t.isObservable(a) && (a = a()), e = a } } i.setProperty = S;

                    function k(e) { return "object" == typeof e && !r.isArray(e) && !r.isPlainObject(e) && e.constructor !== Object.prototype.constructor } i.isClassInstance = k;

                    function T(e) {
                        t.util.each(e, function(e, i) {
                            i && "object" == typeof i && t.util.each(i, function(e, o) {
                                var n;
                                t.util.isString(o) && (n = /\/Date\((-?\d+)\)\//.exec(o)) && (i[e] = new Date(parseInt(n[1], 10)))
                            })
                        })
                    }
                    i.convertDateProperties = T, o = function() {
                        function e(e) { this.key = e }
                        return e
                    }(), i.HashMapEntry = o, n = function() {
                        function e() { this.hash = {} }
                        return e.prototype.getEntry = function(e, t) {
                            var i, n, r, a;
                            if (void 0 === t && (t = !1), null === e) return !this.nullEntry && t && (this.nullEntry = new o(e)), this.nullEntry;
                            if (i = e + "", null == (n = this.hash[i])) {
                                if (!t) return null;
                                n = [], this.hash[i] = n
                            }
                            for (a = 0; a < n.length; a++)
                                if (n[a].key === e) return n[a];
                            return t && (r = new o(e), n.push(r)), null
                        }, e.prototype.containsKey = function(e) { return !!this.getEntry(e) }, e.prototype.get = function(e, t) { void 0 === t && (t = null); var i = this.getEntry(e); return i ? i.value : t }, e.prototype.put = function(e, t) { this.getEntry(e, !0).value = t }, e
                    }(), i.HashMap = n
                }(t.util || (t.util = {}));
                var i = t.util
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(t) {
                t.errors = {}, t.errors.ka = function(i) {
                    t.util.each(i, function(i, o) {
                        function n() { var i, n, r = []; for (i = 0; i < arguments.length - 0; i++) r[i] = arguments[i + 0]; return $.isFunction(o) ? o = o.apply(this, arguments) : arguments.length > 0 && (r.unshift(o), o = t.util.format.apply(this, r)), o = $.trim(o), n = o[o.length - 1], "." !== n && "!" !== n && "?" !== n && (o += "."), new e.GCUIError(o) } t.errors[i] = function() { throw n.apply(this, arguments) }, t.errors[i].create = n
                    })
                }, t.errors.ka({ indexOutOfBounds: "Index is outside the bounds of the array.", notImplemented: "The operation is not implemented", unsupprtedOperation: "Unsupported operation", unsupportedFilterOperator: "Unsupported filter operator: {0}", unsupportedDataSource: "Unsupported data source", argument: function(e) { var t = "Unexpected argument value."; return e && (t += "\nParameter name: " + e), t }, argumentNull: "Argument '{0}' is null/undefined", noParser: "There is no parser for type '{0}'", noUrl: "Url is not specified", cantConvert: "Value can't be converted to type '{0}': '{1}'", noGlobalize: "Globalize is not defined. Make sure you include globalize.js", itemNotInView: "Item {0} is not in the data view", unsupportedFilterFormat: "The filter format is not supported", multiPropertyKeysNotSupported: "Entities with multiple properties in the primary key are not supported. Entity type: {0}", keyPropertyNotFound: "Key property not found in {0} entity type" })
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                ! function(t) {
                    var i = jQuery;
                    t.opMap = { "==": "equals", doesnotcontain: "notcontain", "!=": "notequal", ">": "greater", "<": "less", ">=": "greaterorequal", "<=": "lessorequal", isnotempty: "notisempty", isnotnull: "notisnull" };

                    function o(i, o) { var n, r; return void 0 === o && (o = !1), i = i.toLowerCase(), n = t.ops[i], n || (r = t.opMap[i]) && (n = t.ops[r]), !n && o && e.errors.unsupportedOperator(i), n }

                    function n(n) {
                        var r, a;
                        if (!i.isPlainObject(n)) return { operator: "==", op: t.ops.equals, value: n };
                        if (a = n.operator || t.ops.equals, e.util.isString(n.operator)) {
                            if ("nofilter" === n.operator.toLowerCase()) return null;
                            a = o(n.operator, !0)
                        } else i.isFunction(a.apply) || e.errors.unsupportedOperator(a);
                        return { operator: n.operator, op: a, value: n.value }
                    }
                    t.normalizeCondition = n;

                    function r(t) { var o, r = { original: t, func: null, normalized: null }; return i.isFunction(t) ? r.func = t : i.isArray(t) ? e.errors.unsupportedFilterFormat(t) : t && (r.normalized = {}, o = !1, e.util.each(t, function(t, a) { i.isArray(a) && e.errors.unsupportedFilterFormat(), (a = n(a)) && (r.normalized[t] = a, o = !0) }), o ? r.func = function(t) { return e.util.every(r.normalized, function(i, o) { var n = e.util.getProperty(t, o); return i.op.apply(n, i.value) }) } : r.normalized = null), r.normalized || r.func || (r.func = function(e) { return !0 }), r } t.compile = r, t.ops = function() {
                        var t = {},
                            i = { str: ["string"], prim: ["string", "number", "datetime", "currency", "boolean"] };

                        function o(e, i, o, n, r) { return t[e.toLowerCase()] = { name: e, displayName: i, arity: o, applicableTo: n, apply: r } }

                        function n(t) { return t instanceof Date && (t = t.getTime()), e.util.isString(t) && (t = t.toLowerCase()), t }

                        function r(e, t, i, r) { o(e, t, 2, i, function(e, t) { return r(n(e), n(t)) }) }

                        function a(e, t, i, n) { o(e, t, 1, i, n) }

                        function s(e, t, o) { r(e, t, i.prim, o) }

                        function l(e, t, o) { r(e, t, i.str, o) }
                        return s("Equals", "Equals", function(e, t) { return e == t }), s("NotEqual", "Not equal", function(e, t) { return e != t }), s("Greater", "Greater than", function(e, t) { return e > t }), s("Less", "Less than", function(e, t) { return e < t }), s("GreaterOrEqual", "Greater or equal", function(e, t) { return e >= t }), s("LessOrEqual", "Less or equal", function(e, t) { return e <= t }), l("Contains", "Contains", function(e, t) { return e == t || e && e.indexOf && e.indexOf(t) >= 0 }), l("NotContain", "Does not contain", function(e, t) { return e != t && (!e || !e.indexOf || e.indexOf(t) < 0) }), l("BeginsWith", "Begins with", function(e, t) { return e == t || e && e.indexOf && 0 == e.indexOf(t) }), l("EndsWith", "Ends with", function(t, i) { var o; return !(!e.util.isString(t) || !e.util.isString(i)) && ((o = t.lastIndexOf(i)) >= 0 && t.length - o === i.length) }), a("IsEmpty", "Is empty", i.str, function(e) { return !e && 0 !== e && !1 !== e }), a("NotIsEmpty", "Is not empty", i.str, function(e) { return !!e || 0 === e || !1 === e }), a("IsNull", "Is null", i.prim, function(e) { return null == e }), a("NotIsNull", "Is not null", i.prim, function(e) { return null != e }), t
                    }()
                }(e.filtering || (e.filtering = {}));
                var t = e.filtering
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                ! function(t) {
                    function i(t) { var i = []; return t = e.util.isString(t) ? t.split(/,\s*/) : $.isArray(t) ? t.slice(0) : [t], t = $.isArray(t) ? t.slice(0) : [t], e.util.each(t, function(t, o) { var n, r, a = !0; if (null != o) { if (!e.util.isString(o)) return void(null != o.property && i.push(o)); "-" === o[0] ? (a = !1, o = o.substr(1)) : (r = /\s(asc|desc)\s*$/.exec(o)) && (o = o.substr(0, r.index), a = !("desc" === r[1])), i.push({ property: o, asc: a }) } }), i }

                    function o(t, o) {
                        var n, r;
                        return void 0 === o && (o = e.util.compare), n = i(t), r = { original: t, propertyCompareTo: o, compare: null, normalized: n }, null != n && (r.compare = function(t, i) {
                            var r = 0,
                                a, s;
                            for (r = 0; r < n.length; r++)
                                if (s = n[r], 0 !== (a = o(e.util.getProperty(t, s.property), e.util.getProperty(i, s.property)))) return s.asc || (a = -a), a;
                            return 0
                        }), r
                    }
                    t.compile = o
                }(e.sorting || (e.sorting = {}));
                var t = e.sorting
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t = jQuery,
                    i = [];

                function o(o) { return t.isFunction(o) || e.errors.argument("factory"), i.push(o), { dispose: function() { e.util.remove(i, o) } } } e.registerDataViewFactory = o, o(function(e) { return r(e) && e }), o(function(i) { return t.isArray(i) && new e.ArrayDataView(i) });

                function n(t) { if (r(t)) return t; var o = e.util.some(i, function(e) { return e(t) }); return o || e.errors.unsupportedDataSource() } e.asDataView = n;

                function r(e) { return e && t.isFunction(e.count) && t.isFunction(e.item) && t.isFunction(e.getProperty) } e.isDataView = r
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t = jQuery,
                    i = function() {
                        function i(i) {
                            this.array = i, this.currentItem = e.observableWithNewValueCheck(null), this.currentPosition = e.observableWithNewValueCheck(-1);
                            var o = !1;

                            function n(e) { return function() { if (!o) { o = !0; try { e.apply(this, arguments) } finally { o = !1 } } } } this.currentItem.subscribe(n(function(e) { this.currentPosition(null == e ? -1 : t.inArray(e, this.array)) }), this), this.currentPosition.subscribe(n(function(t) { e.util.isNumeric(t) || e.errors.argument("value"), (t < -1 || t >= this.array.length) && e.errors.indexOutOfBounds(), this.currentItem(t < 0 ? null : this.array[t]) }), this)
                        }
                        return i.prototype.update = function() {
                            var e = this.currentItem(),
                                i = this.currentPosition(),
                                o = t.inArray(e, this.array);
                            o < 0 && null == e && null != this.la && (o = t.inArray(this.la, this.array)), o >= 0 ? (e && (this.la = e), this.currentPosition(o)) : i >= 0 && i < this.array.length ? this.currentItem(this.array[i]) : i == this.array.length && this.array.length > 0 ? (i = this.array.length - 1, this.currentPosition(i), this.currentItem(this.array[i])) : (this.currentPosition(-1), this.currentItem(null))
                        }, i.prototype.updateDelayed = function() { e.util.executeDelayed(this.update, this) }, i
                    }();
                e.CurrencyManager = i
            }(e.data || (e.data = {}));
            var t = e.data
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t, i, o = jQuery,
                    n = function() {
                        function t(t) {
                            this.onChanged = t, this.filter = e.observable(), this.sort = e.observable(), this.pageIndex = e.observable(0), this.pageSize = e.observable(0), this.ma = 0, this.na = -1, this.filter.subscribe(function(e) { this.onFilterChanged(e), t() }, this), this.sort.subscribe(function() { this.oa = e.sorting.compile(this.sort()), t() }, this);

                            function i() { this.pageSize() > 0 && this.pageIndex() >= 0 ? (this.ma = this.pageSize() * this.pageIndex(), this.na = this.pageSize()) : (this.ma = 0, this.na = -1), t(!0) } this.pageIndex.subscribe(i, this), this.pageSize.subscribe(i, this)
                        }
                        return t.prototype.onFilterChanged = function(t) { this.pa = e.filtering.compile(t) }, t.prototype.setFilter = function(e) { this.filter(e) }, t.prototype.update = function(e) { "filter" in e && this.setFilter(e.filter), "sort" in e && this.sort(e.sort), "pageSize" in e && this.pageSize(e.pageSize), "pageIndex" in e && this.pageIndex(e.pageIndex) }, t.prototype.apply = function(t, i) { var o, n, r; return void 0 === i && (i = !0), o = this, n = [], e.util.each(t, function(e, t) { o.pa && !o.pa.func(t) || n.push(t) }), this.oa && n.sort(this.oa.compare), r = n.length, i && this.na > 0 && (this.ma > 0 && n.splice(0, Math.min(this.ma, n.length)), this.na < n.length && (n.length = this.na)), { results: n, totalCount: r } }, t.prototype.toObj = function() { return { filter: this.pa && this.pa.normalized, sort: this.oa && this.oa.normalized, pageSize: this.pageSize(), pageIndex: this.pageIndex() } }, t
                    }();
                e.Shape = n, t = function() {
                    function t(t) { this.isRemote = !1, this.localPaging = !0, this.local = [], this.qa = !1, this.ra = e.observable(1), this.sa = e.observable(0), this.ta = e.observable(!1), this.ua = e.observable(!1), this.va = e.observable(), this.wa = !1, this.xa = null, this.isLoading = this.ua.read(), this.isLoaded = this.ta.read(), this.ya = new e.Subscribable(this), this.currentEditItem = this.va.read(), this.za(), this.Aa(t) }
                    return t.prototype.dispose = function() {}, t.prototype.count = function() { return this.local.length }, t.prototype.item = function(t) { return (t < 0 || t >= this.local.length) && e.errors.indexOutOfBounds(), this.local[t] }, t.prototype.indexOf = function(e) { return o.inArray(e, this.local) }, t.prototype.getSource = function() { return this.sourceArray }, t.prototype.toObservableArray = function() { return this.Ba || (this.Ba = ko.observableArray(this.local)), this.Ba }, t.Ca = function t(i) { var n = []; return e.util.each(i, function(e, t) { e += "", e.match(/^_/) || o.isFunction(t) && !t.subscribe || n.push({ name: e }) }), n }, t.prototype.getProperties = function() { return this.count() ? t.Ca(this.item(0)) : [] }, t.prototype.Da = function(t, i) { return e.util.getProperty(t, i) }, t.prototype.getProperty = function(e, t) { var i = this.Ea(e); return this.Da(i, t) }, t.prototype.Fa = function(t, i, o) { e.util.setProperty(t, i, o) }, t.prototype.setProperty = function(e, t, i) { var o = this.Ea(e); return o !== this.currentEditItem() || !this.xa || t in this.xa || (this.xa[t] = this.getProperty(e, t)), this.Fa(o, t, i), this }, t.prototype.subscribe = function(e, t) { return this.ya.subscribe(e, t) }, t.prototype.trigger = function() { this.Ga.update(), this.ya.trigger(this.local), this.Ba && this.Ba.notifySubscribers(this.local) }, t.prototype.canFilter = function() { return !0 }, t.prototype.canSort = function() { return !0 }, t.prototype.Ha = function(e) { this.qa = !0; try { this.Ia.update(e) } finally { this.qa = !1 } }, t.prototype.prevPage = function() { return !(this.pageIndex() < 1) && (this.pageIndex(this.pageIndex() - 1), !0) }, t.prototype.nextPage = function() { return !(this.pageCount() > 0 && this.pageIndex() + 1 >= this.pageCount()) && (this.pageIndex(this.pageIndex() + 1), !0) }, t.prototype.Ja = function(e) { return new n(e) }, t.prototype.Aa = function(e) {
                        var t = this,
                            i = function(e) { void 0 === e && (e = !1), t.qa || t.refresh(null, e && t.localPaging) };
                        this.Ia = this.Ja(i), e && this.Ha(e), this.filter = this.Ia.filter, this.sort = this.Ia.sort, this.pageIndex = this.Ia.pageIndex, this.pageSize = this.Ia.pageSize, this.pageCount = this.ra.read(), this.totalItemCount = this.sa.read()
                    }, t.prototype.Ka = function(t) { var i, n; return void 0 === t && (t = this.localPaging), i = this, n = this.Ia.apply(this.sourceArray, t), this.local.length = 0, o.each(n.results, function(e, t) { return i.local.push(t) }), t && this.sa(n.totalCount), this.ra(e.util.pageCount(this.totalItemCount(), this.pageSize())), this.trigger(), o.Deferred().resolve().promise() }, t.prototype.La = function() { return this.Ka() }, t.prototype.refresh = function(e, t) { var i, o; return void 0 === t && (t = !1), i = this, this.cancelRefresh(), e && this.Ha(e), this.ua(!0), o = t ? this.Ka() : this.La(), o.then(function() { i.ta(!0), i.ua(!1) }) }, t.prototype.cancelRefresh = function() {}, t.prototype.za = function() { this.Ga = new e.CurrencyManager(this.local), this.currentItem = this.Ga.currentItem, this.currentPosition = this.Ga.currentPosition }, t.prototype.isCurrentEditItemNew = function() { return this.wa }, t.prototype.Ma = function(e, t) { this.commitEdit(), this.xa = {}, this.wa = t, this.va(e) }, t.prototype.canAdd = function() { return !0 }, t.prototype.add = function(t) { t || e.errors.argument("item"), this.commitEdit(), this.local.push(t), this.Ma(t, !0), this.trigger() }, t.prototype.canAddNew = function() { return !1 }, t.prototype.addNew = function() { return e.errors.unsupportedOperation() }, t.prototype.editItem = function(e) { void 0 === e && (e = this.currentItem()), this.commitEdit(), (e = this.Ea(e)) && this.Ma(e, !1) }, t.prototype.canRemove = function() { return !0 }, t.prototype.Na = function(t) { this.local.splice(t.index, 1), e.util.remove(this.sourceArray, t.item), this.trigger() }, t.prototype.remove = function(e) { void 0 === e && (e = this.currentItem()), this.commitEdit(); var t = this.Oa(e); return !!t && (this.Na(t), !0) }, t.prototype.canCancelEdit = function() { return !0 }, t.prototype.cancelEdit = function() {
                        var t, i, n = this;
                        this.currentEditItem() && (i = this.currentEditItem(), this.va(null), this.wa ? e.util.remove(this.local, this.item) : this.xa && o.each(this.xa, function(e, t) { return n.Fa(i, e, t) }), this.trigger())
                    }, t.prototype.canCommitEdit = function() { return !0 }, t.prototype.commitEdit = function() {
                        var t, i;
                        this.currentEditItem() && (t = this.currentEditItem, this.va(null), this.wa && this.sourceArray.push(t), i = this.Ia.pa && this.Ia.pa.func, i && !i(t) && e.util.remove(this.local, t), this.trigger())
                    }, t.prototype.Ea = function(t) { var i; return e.util.isNumeric(t) ? this.item(t) : t }, t.prototype.Oa = function(t, i) { void 0 === i && (i = !1); var o; return e.util.isNumeric(t) ? { index: t, item: this.item(t) } : (o = this.indexOf(t), o < 0 ? (i && e.errors.itemNotInView(t), null) : { index: o, item: t }) }, t
                }(), e.ArrayDataViewBase = t, i = function(e) {
                    __extends(t, e);

                    function t(t, i) { e.call(this, i), this.sourceArray = t, this.refresh() }
                    return t
                }(t), e.ArrayDataView = i
            }(e.data || (e.data = {}))
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t = jQuery,
                    i = function(e) {
                        __extends(i, e);

                        function i(t) { e.call(this), this.isRemote = !0, this.sourceArray = [], t && this.Pa(t) }
                        return i.prototype.Pa = function(e) { this.options = e = t.extend({ localPaging: !1 }, e), this.localPaging = e.localPaging, this.Ha(e) }, i
                    }(e.ArrayDataViewBase);
                e.RemoteDataView = i
            }(e.data || (e.data = {}))
        }(gcui || (gcui = {})),
        function(e) {
            ! function(e) {
                var t = jQuery,
                    i = function() {
                        function e(e) { this.Qa = e }
                        return e.prototype.read = function(e) { if (e.items = null, this.Qa && t.isFunction(this.Qa.read) && this.Qa.read(e), t.isArray(e.items) || (t.isArray(e.data) ? e.items = e.data : e.data && t.isArray(e.data.rows) ? e.items = e.data.rows : e.items = []), e.dynamic && (!e.data || isNaN(e.data.totalRows))) throw "totalRows value is missing" }, e
                    }(),
                    o = function(o) {
                        __extends(n, o);

                        function n(e) {
                            var n, r = this;
                            o.call(this), this.dataSource = e, this.isRemote = !0, this.localPaging = !0, this.Ra = e.loaded, this.Sa = e.reader, e.loaded = function(e, i) { r.Ta(), t.isFunction(r.Ra) && r.Ra.apply(r, arguments) }, e.reader = new i(e.reader), n = e.items && e.items.length > 0, t.isArray(e.data) && !n && e.read(), e.items && this.Ta()
                        }
                        return n.prototype.dispose = function() { this.dataSource.loaded = this.Ra, this.dataSource.reader = this.Sa, o.prototype.dispose.call(this) }, n.prototype.getProperties = function() { return this.sourceArray && this.sourceArray.length ? e.ArrayDataViewBase.Ca(this.sourceArray[0]) : [] }, n.prototype.Ta = function() {
                            this.sourceArray = this.dataSource.items, this.dataSource.data && e.util.isNumeric(this.dataSource.data.totalRows) && this.sa(this.dataSource.data.totalRows);
                            var t = o.prototype.Ka.call(this, !this.dataSource.dynamic);
                            this.Ua && t.then(this.Ua.resolve)
                        }, n.prototype.La = function() {
                            this.Ua && "pending" === this.Ua.state() && this.Ua.fail(), this.Ua = t.Deferred();
                            var e = {},
                                i = !1;
                            return this.dataSource.dynamic && (i = !0, e.data = this.Va(), this.dataSource.proxy && (this.Wa || (this.Wa = t.extend({}, this.dataSource.proxy.options.data)), this.dataSource.proxy.options.data = t.extend({}, this.Wa, e.data))), this.dataSource.load(e, i), this.Ua
                        }, n.prototype.Va = function() { return { filtering: this.Xa(), paging: this.Ya(), sorting: this.Za() } }, n.prototype.Xa = function() { var e = []; return this.Ia.pa && this.Ia.pa.normalized && t.each(this.Ia.pa.normalized, function(t, i) { e.push({ dataKey: t, filterOperator: i.op.Name, filterValue: i.value }) }), e }, n.prototype.Ya = function() { return { pageIndex: this.Ia.pageIndex(), pageSize: this.Ia.pageSize() } }, n.prototype.Za = function() { return this.Ia.oa && this.Ia.oa.normalized && 0 != this.Ia.oa.normalized.length ? t.map(this.Ia.oa.normalized, function(e) { return { dataKey: e.property, sortDirection: e.asc ? "ascending" : "descending" } }) : [] }, n
                    }(e.ArrayDataViewBase);
                e.registerDataViewFactory(function(e) { if ("function" == typeof gcuidatasource && e instanceof gcuidatasource) return new o(e) })
            }(e.data || (e.data = {}))
        }(gcui || (gcui = {})),
        function(e) {
            ! function(t) {
                "use strict";
                var i, o = jQuery,
                    n = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments) }
                        return t.prototype._create = function() { window.applyTouchUtilEvents && (o = window.applyTouchUtilEvents(o)), this.element.addClass(this.options.uiCSS.widget + " gcui-pager " + this.options.uiCSS.helperClearFix), this.options.disabled && this.disable(), this.$a() }, t.prototype._a = function() { this.element.removeClass(this.options.uiCSS.widget + " gcui-pager " + this.options.uiCSS.helperClearFix), this.$ul.remove() }, t.prototype._setOption = function(e, t) { this.ab(e, t), this.$a() }, t.prototype.$a = function() {
                            switch (this.bb(), this.$ul && this.$ul.remove(), this.element.append(this.$ul = o('<ul class="ui-list ' + this.options.uiCSS.cornerAll + " " + this.options.uiCSS.content + " " + this.options.uiCSS.helperClearFix + '" role="tablist"></ul>')), (this.options.mode || "").toLowerCase()) {
                                case "nextprevious":
                                    this.cb(!1);
                                    break;
                                case "nextpreviousfirstlast":
                                    this.cb(!0);
                                    break;
                                case "numeric":
                                    this.eb(!1);
                                    break;
                                case "numericfirstlast":
                                    this.eb(!0)
                            }
                        }, t.prototype.bb = function() {
                            var e = this.options;
                            (isNaN(e.pageCount) || e.pageCount < 1) && (e.pageCount = 1), isNaN(e.pageIndex) || e.pageIndex < 0 ? e.pageIndex = 0 : e.pageIndex >= e.pageCount && (e.pageIndex = e.pageCount - 1), (isNaN(e.pageButtonCount) || e.pageButtonCount < 1) && (e.pageButtonCount = 1)
                        }, t.prototype.cb = function(e) {
                            var t = this.options;
                            e && t.pageIndex && this.$ul.append(this.fb(!1, t.firstPageText, 1, t.firstPageClass)), t.pageIndex && this.$ul.append(this.fb(!1, t.previousPageText, t.pageIndex, t.previousPageClass)), t.pageIndex + 1 < t.pageCount && this.$ul.append(this.fb(!1, t.nextPageText, t.pageIndex + 2, t.nextPageClass)), e && t.pageIndex + 1 < t.pageCount && this.$ul.append(this.fb(!1, t.lastPageText, t.pageCount, t.lastPageClass))
                        }, t.prototype.eb = function(e) {
                            var t = this.options,
                                i = t.pageIndex + 1,
                                o = 1,
                                n = Math.min(t.pageCount, t.pageButtonCount),
                                r;
                            for (i > n && (o = Math.floor(t.pageIndex / t.pageButtonCount) * t.pageButtonCount + 1, n = o + t.pageButtonCount - 1, (n = Math.min(n, t.pageCount)) - o + 1 < t.pageButtonCount && (o = Math.max(1, n - t.pageButtonCount + 1))), 1 !== o && (e && this.$ul.append(this.fb(!1, t.firstPageText, 1, t.firstPageClass)), this.$ul.append(this.fb(!1, "...", o - 1, ""))), r = o; r <= n; r++) this.$ul.append(this.fb(r === i, "" + r, r, ""));
                            t.pageCount > n && (this.$ul.append(this.fb(!1, "...", n + 1, "")), e && this.$ul.append(this.fb(!1, t.lastPageText, t.pageCount, t.lastPageClass)))
                        }, t.prototype.fb = function(e, t, i, n) {
                            var r, a = this.options.uiCSS,
                                s = this,
                                l = o("<li />").addClass("gcui-pager-button " + a.cornerAll).attr({ role: "tab", "aria-label": t, title: t });
                            return e ? l.addClass(a.stateActive).attr("aria-selected", "true") : l.addClass(a.stateDefault).hover(function() { s.options.disabled || o(this).addClass(a.stateHover) }, function() { s.options.disabled || o(this).removeClass(a.stateHover) }).bind("click." + this.widgetName, { newPageIndex: i - 1 }, o.proxy(this.gb, this)), r = e ? o("<span />") : n ? o("<span />").addClass(a.icon + " " + n) : o("<a/>").attr("href", "#"), r.text(t), l.append(r), l
                        }, t.prototype.gb = function(e) { var t, i; return !this.options.disabled && (t = { newPageIndex: e.data.newPageIndex, handled: !1 }, !1 !== this._trigger("pageIndexChanging", null, t) && this.options.pageIndex !== t.newPageIndex && (this.options.pageIndex = t.newPageIndex, t.handled || this.$a(), i = { newPageIndex: t.newPageIndex }, this._trigger("pageIndexChanged", null, i)), !1) }, t
                    }(e.gcuiWidget);
                t.gcuipager = n, n.prototype.widgetEventPrefix = "gcuipager", i = function() {
                    function e() { this.mobileCSS = { header: "ui-header ui-bar-a", content: "ui-body-c", stateDefault: "ui-btn-up-c", stateHover: "ui-btn-down-b", stateActive: "ui-btn-down-c" }, this.firstPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekFirst, this.firstPageText = "First", this.lastPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekEnd, this.lastPageText = "Last", this.mode = "numeric", this.nextPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekNext, this.nextPageText = "Next", this.pageButtonCount = 10, this.previousPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekPrev, this.previousPageText = "Previous", this.pageCount = 1, this.pageIndex = 0, this.pageIndexChanging = null, this.pageIndexChanged = null }
                    return e
                }(), n.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i), o.gcui.registerWidget("gcuipager", n.prototype)
            }(e.pager || (e.pager = {}))
        }(gcui || (gcui = {})),
        function(e) {
            ! function(t) {
                "use strict";
                var i, o = jQuery,
                    n = 0,
                    r = 0,
                    a = o.effects ? o.effects : o,
                    s = a.save,
                    l = a.restore,
                    c = a.createWrapper,
                    d = a.removeWrapper,
                    p = function() {
                        return ++n
                    },
                    u = function() { return ++r },
                    h = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments) }
                        return t.prototype._setOption = function(t, i) {
                            switch (e.prototype._setOption.call(this, t, i), t) {
                                case "selected":
                                    if (this.options.collapsible && i === this.options.selected) return;
                                    this.select(i);
                                    break;
                                case "alignment":
                                    this.hb(!0), this.ib(!0);
                                    break;
                                default:
                                    this.ib(!1)
                            }
                        }, t.prototype._create = function() {
                            var t = this,
                                i = this.options;
                            this.element.is(":hidden") && this.element.addVisibilityObserver && this.element.addVisibilityObserver(function() {
                                t.element.removeVisibilityObserver && t.element.removeVisibilityObserver();
                                var e = t.element.data("gcuitabs"),
                                    i = t.element.data("gcuiUITabs");
                                t.hb(!0), t.element.data("gcuitabs", e), t.element.data("gcuiUITabs", i), t.ib(!0)
                            }, "gcuitabs"), this.ib(!0), (i.disabledstate || i.disabled) && this.disable(), e.prototype._create.call(this)
                        }, t.prototype.destroy = function() { this.hb(), e.prototype.destroy.call(this) }, t.prototype.ib = function(e) {
                            this.list = this.element.children("ol,ul").eq(0), this.lis = o("li:has(a)", this.list), this.anchors = this.lis.map(function() { return o("a", this)[0] }), this.panels = o([]);
                            var t = this,
                                i = t.options,
                                n = /^#.+/,
                                r, a, s, l, c, d, p, u, h;
                            if (o.each(t.anchors, function(e, r) {
                                    var a = o(r).attr("href") || "",
                                        s = a.split("#")[0],
                                        l, c, d;
                                    s && (s === ("" + location).split("#")[0] || (l = o("base")[0]) && s === l.href) && (a = r.hash, r.href = a), n.test(a) ? t.panels = t.panels.add(t.jb(a), t.element) : "#" !== a ? (o.data(r, "href.tabs", a), o.data(r, "load.tabs", a.replace(/#.*$/, "")), c = t.kb(r), r.href = "#" + c, d = o("#" + c), d.length || (d = o(i.panelTemplate || t.lb.panelTemplate).attr("id", c).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.content).addClass(i.uiCSS.cornerBottom).insertAfter(t.panels[e - 1] || t.list), d.data("destroy.tabs", !0)), t.panels = t.panels.add(d)) : i.disabledIndexes.push(e)
                                }), r = this.mb(!0), a = this.mb(!1), e) {
                                switch (this.list.attr("role", "tablist"), this.lis.attr("role", "tab"), this.panels.attr("role", "tabpanel"), this.element.addClass(i.uiCSS.tabs).addClass(i.uiCSS.gcuitabs).addClass(i.uiCSS.widget).addClass(i.uiCSS.content).addClass(i.uiCSS.cornerAll).addClass(i.uiCSS.helperClearFix).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS["tabs" + r]), this.list.addClass(i.uiCSS.tabsNav).addClass(i.uiCSS.helperReset).addClass(i.uiCSS.helperClearFix).addClass(i.uiCSS.header).addClass(i.uiCSS.cornerAll), this.lis.addClass(i.uiCSS.stateDefault).addClass(i.uiCSS["corner" + r]), this.panels.addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.content).addClass(i.uiCSS["corner" + a]), r) {
                                    case "Bottom":
                                        this.list.appendTo(this.element);
                                        break;
                                    case "Left":
                                        s = o("<div/>").addClass(i.uiCSS.tabsContent).appendTo(this.element), this.panels.appendTo(s);
                                        break;
                                    case "Right":
                                        s = o("<div/>").addClass(i.uiCSS.tabsContent).insertBefore(this.list), this.panels.appendTo(s);
                                        break;
                                    case "Top":
                                        this.list.prependTo(this.element)
                                }
                                i.sortable && this.list.sortable && this.list.sortable({ axis: "Top" === r || "Bottom" === r ? "x" : "y" }), void 0 === i.selected ? (location.hash && o.each(this.anchors, function(e, t) { if (t.hash === location.hash) return i.selected = e, !1 }), "number" != typeof i.selected && i.cookie && (i.selected = parseInt(t.nb(void 0, void 0), 10)), "number" != typeof i.selected && this.lis.filter("." + i.uiCSS.tabsActive).length && (i.selected = this.lis.index(this.lis.filter("." + i.uiCSS.tabsActive))), i.selected = i.selected || (this.lis.length ? 0 : -1)) : null === i.selected && (i.selected = -1), i.selected = i.selected >= 0 && this.anchors[i.selected] || i.selected < 0 ? i.selected : 0, i.disabledIndexes = o.unique(i.disabledIndexes.concat(o.map(this.lis.filter("." + i.uiCSS.stateDisabled), function(e, i) { return t.lis.index(e) }))).sort(), -1 !== o.inArray(i.selected, i.disabledIndexes) && i.disabledIndexes.splice(o.inArray(i.selected, i.disabledIndexes), 1), this.panels.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0), this.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1), i.selected >= 0 && this.anchors.length && (this.panels.eq(i.selected).removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1), this.lis.eq(i.selected).addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0), t.element.queue("tabs", function() { t.element.triggerVisibility && o(t.panels[i.selected]).triggerVisibility(), t._trigger("show", null, t.ob(t.anchors[i.selected], t.panels[i.selected])) }), this.load(i.selected)), o(window).bind("unload", function() { t.lis && t.lis.add(t.anchors).unbind(".tabs"), t.lis = t.anchors = t.panels = null })
                            } else i.selected = this.lis.index(this.lis.filter("." + i.uiCSS.tabsActive));
                            for (this.element[i.collapsible ? "addClass" : "removeClass"](i.uiCSS.tabsCollapsible), i.cookie && this.nb(i.selected, i.cookie), l = 0; l < this.lis.length; l++) c = this.lis[l], o(c)[-1 === o.inArray(l, i.disabledIndexes) || o(c).hasClass(i.uiCSS.tabsActive) ? "removeClass" : "addClass"](i.uiCSS.stateDisabled), o(c).hasClass(i.uiCSS.stateDisabled) && o(c).attr("aria-disabled", !0);
                            !1 === i.cache && this.anchors.removeData("cache.tabs"), this.lis.add(this.anchors).unbind(".tabs"), i.disabledState || i.disabled || "mouseover" === i.event || (d = function(e, t) { t.is(":not(." + i.uiCSS.stateDisabled + ")") && t.addClass(e) }, p = function(e, t) { t.removeClass(e) }, this.lis.bind("mouseover.tabs", function() { d(i.uiCSS.stateHover, o(this)) }), this.lis.bind("mouseout.tabs", function() { p(i.uiCSS.stateHover, o(this)) }), this.anchors.bind("focus.tabs", function() { t.lis.filter("." + i.uiCSS.stateFocus).removeClass(i.uiCSS.stateFocus), d(i.uiCSS.stateFocus, o(this).closest("li")) }), this.anchors.bind("blur.tabs", function() { p(i.uiCSS.stateFocus, o(this).closest("li")) })), void 0 !== i.showOption && null !== i.showOption || (i.showOption = {}), this.pb(i.showOption), void 0 !== i.hideOption && null !== i.hideOption || (i.hideOption = {}), this.pb(i.hideOption), u = (i.showOption.blind || i.showOption.fade) && i.showOption.duration > 0 ? function(e, n) {
                                if (o(e).closest("li").addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0), t.qb(), n.removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1), "Top" === r || "Bottom" === r) {
                                    var a = { duration: i.showOption.duration, height: "toggle", opacity: "toggle" };
                                    i.showOption.blind || delete a.height, i.showOption.fade || delete a.opacity, n.hide().removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1).animate(a, i.showOption.duration || "normal", function() { t.rb(n), n.triggerVisibility && n.triggerVisibility(), t._trigger("show", null, t.ob(e, n[0])) })
                                } else t.qb(), t.sb(n, "show")
                            } : function(e, n) { o(e).closest("li").addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0), t.qb(), n.removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1), n.triggerVisibility && n.triggerVisibility(), t._trigger("show", null, t.ob(e, n[0])) }, h = (i.hideOption.blind || i.hideOption.fade) && i.hideOption.duration > 0 ? function(e, o) {
                                if ("Top" === r || "Bottom" === r) {
                                    var n = { duration: i.hideOption.duration, height: "toggle", opacity: "toggle" };
                                    i.hideOption.blind || delete n.height, i.hideOption.fade || delete n.opacity, o.animate(n, i.hideOption.duration || "normal", function() { t.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1), o.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0), t.rb(o), t.element.dequeue("tabs") })
                                } else t.tb(), t.sb(o, "hide")
                            } : function(e, o, n) { t.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1), t.ub(), o.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0), t.element.dequeue("tabs") }, i.disabledState || i.disabled || this.anchors.bind(i.event + ".tabs", function() {
                                var e = this,
                                    n = o(this).closest("li"),
                                    r = t.panels.filter(":not(." + i.uiCSS.tabsHide + ")"),
                                    a = o(t.jb(this.hash), t.element);
                                if (n.hasClass(i.uiCSS.tabsActive) && !i.collapsible || n.hasClass(i.uiCSS.stateDisabled) || n.hasClass(i.uiCSS.tabsLoading) || !1 === t._trigger("select", null, t.ob(this, a[0]))) return this.blur(), !1;
                                if (i.selected = t.anchors.index(this), t.abort(), i.collapsible) { if (n.hasClass(i.uiCSS.tabsActive)) return i.selected = -1, i.cookie && t.nb(i.selected, i.cookie), t.element.queue("tabs", function() { h(e, r) }).dequeue("tabs"), this.blur(), !1; if (!r.length) return i.cookie && t.nb(i.selected, i.cookie), t.element.queue("tabs", function() { u(e, a) }), t.load(t.anchors.index(this)), this.blur(), !1 }
                                if (i.cookie && t.nb(i.selected, i.cookie), !a.length) throw "jQuery UI Tabs: Mismatching fragment identifier.";
                                r.length && t.element.queue("tabs", function() { h(e, r) }), t.element.queue("tabs", function() { u(e, a) }), t.load(t.anchors.index(this)), GC.Spread.Sheets.util.browser.msie && this.blur()
                            }), this.vb(), this.anchors.bind("click.tabs", function() { return !1 })
                        }, t.prototype.sb = function(e, t) {
                            var i = this,
                                n = i.options,
                                r = e.parent("." + n.uiCSS.tabsContent),
                                a = ["position", "top", "left", "width"],
                                l = "show" === t ? n.showOption : n.hideOption,
                                p, u, h;
                            r.length && (i.list.width(i.list.width()), s && s(e, a), e.show(), "show" === t ? (e.removeClass(n.uiCSS.tabsHide).attr("aria-hidden", !1), e.width(i.element.data("panel.width"))) : e.width(e.width()), p = c ? c(e).css({ overflow: "hidden" }) : o("<div></div>"), "show" === t && p.css(o.extend({ width: 0 }, l.fade ? { opacity: 0 } : {})), u = o.extend({ width: "show" === t ? i.element.data("panel.outerWidth") : 0 }, l.fade ? { opacity: "show" === t ? 1 : 0 } : {}), h = i.list.outerWidth(!0), p.animate(u, {
                                duration: l.duration,
                                step: function() {
                                    var e = p.outerWidth(!0);
                                    i.element.width(h + e), r.width(Math.max(0, i.element.innerWidth() - h - 6))
                                },
                                complete: function() { "hide" === t ? (i.lis.removeClass(n.uiCSS.tabsActive).removeClass(n.uiCSS.stateActive).attr("aria-selected", !1), e.addClass(n.uiCSS.tabsHide).attr("aria-hidden", !0)) : e.css("width", ""), d && d(e), "show" === t && i.wb(), i.rb(e), e.dequeue(), i.element.dequeue("tabs") }
                            }))
                        }, t.prototype.ub = function() {
                            var e = this.options.uiCSS,
                                t = this.element.find("." + e.tabsContent);
                            t.length && (this.tb(), t.addClass(e.tabsHide).attr("aria-hidden", !0), this.element.width(this.list.outerWidth(!0)))
                        }, t.prototype.qb = function() {
                            var e = this.options.uiCSS,
                                t = this.element.find("." + e.tabsContent);
                            t.length && (this.wb(), t.removeClass(e.tabsHide).attr("aria-hidden", !1))
                        }, t.prototype.tb = function() {
                            var e = this.options.uiCSS,
                                t = ["width", "height", "overflow"],
                                i = this.panels.filter(":not(." + e.tabsHide + ")");
                            s && (s(this.element, t), s(this.list, t), s(this.element.find("." + e.tabsContent), t)), this.list.width(this.list.width()), this.element.data("panel.width", i.width()), this.element.data("panel.outerWidth", i.outerWidth(!0))
                        }, t.prototype.wb = function() {
                            var e = this.options.uiCSS,
                                t = ["width", "height", "overflow"];
                            l && (l(this.element, t), l(this.list, t), l(this.element.find("." + e.tabsContent), t))
                        }, t.prototype.rb = function(e) { e.css({ display: "" }), o.support.opacity || e[0].style.removeAttribute("filter") }, t.prototype.pb = function(e) { if (void 0 === e.blind && (e.blind = !1), void 0 === e.fade && (e.fade = !1), void 0 === e.duration && (e.duration = 200), "string" == typeof e.duration) try { e.duration = parseInt(e.duration, 10) } catch (t) { e.duration = 200 } }, t.prototype.vb = function() {
                            var e = this,
                                t = -1 !== o.inArray(this.mb(!0), ["Top", "Bottom"]),
                                i = 0;
                            t && (o.each(this.lis, function(t, n) {
                                var r = o(n),
                                    a, s = 0,
                                    l = 0;
                                GC.Spread.Sheets.util.browser.msie && e.options.scrollable && (o.each(r.children(), function(e, t) {
                                    var i = o(t);
                                    i.is("a") && i.width(i.width()), s += i.outerWidth(!0)
                                }), l = s - r.width(), r.width(s)), i += e.xb(o(n)) + l
                            }), this.options.scrollable && this.element.innerWidth() < i ? (void 0 === this.scrollWrap && (this.list.wrap("<div class='scrollWrap'></div>"), this.scrollWrap = this.list.parent(), s && s(this.list, ["width", "height", "overflow"])), this.list.width(Math.ceil(i) + 2), this.scrollWrap.height(this.list.outerHeight(!0)), this.scrollWrap.superpanel({ allowResize: !1, hScroller: { scrollMode: "edge" }, vScroller: { scrollBarVisibility: "hidden" } })) : this.yb())
                        }, t.prototype.ob = function(e, t) { return { tab: e, panel: t, index: this.anchors.index(e) } }, t.prototype.kb = function(e) {
                            var t = o(e),
                                i, n;
                            return t.data && t.data("tabid") ? t.data("tabid") : e.href && e.href.length && (n = this.zb(e.href), n.tabId) ? (i = n.tabId, t.data("tabid", i), i) : (i = e.title && e.title.replace(/\s/g, "_").replace(/[^A-Za-z0-9\-_:\.]/g, "") || this.options.idPrefix + p(), t.data("tabid", i), i)
                        }, t.prototype.zb = function(e) {
                            var t = {},
                                i, n;
                            return e.indexOf("?") > -1 && (i = e.split("?")[1], n = i.split("&"), o.each(n, function(e, i) {
                                var o = i.split("=");
                                o.length > 1 && (t[o[0]] = o[1])
                            })), t
                        }, t.prototype.mb = function(e) {
                            var t = this.options.alignment || "top";
                            if (e) return t.charAt(0).toUpperCase() + t.substr(1);
                            switch (t) {
                                case "top":
                                    t = "Bottom";
                                    break;
                                case "bottom":
                                    t = "Top";
                                    break;
                                case "left":
                                    t = "Right";
                                    break;
                                case "right":
                                    t = "Left"
                            }
                            return t
                        }, t.prototype.jb = function(e) { return e.replace(/:/g, "\\:") }, t.prototype.hb = function(e) {
                            var t = this.options,
                                i = o("." + t.uiCSS.tabsContent);
                            return this.abort(), this.yb(), this.element.unbind(".tabs").removeClass(t.uiCSS.gcuitabs).removeClass(t.uiCSS.tabsTop).removeClass(t.uiCSS.tabsBottom).removeClass(t.uiCSS.tabsLeft).removeClass(t.uiCSS.tabsRight).removeClass(t.uiCSS.tabs).removeClass(t.uiCSS.widget).removeClass(t.uiCSS.content).removeClass(t.uiCSS.cornerAll).removeClass(t.uiCSS.tabsCollapsible).removeClass(t.uiCSS.helperClearFix).removeData("tabs").removeAttr("role"), this.list.removeClass(t.uiCSS.tabsNav).removeClass(t.uiCSS.helperReset).removeClass(t.uiCSS.helperClearFix).removeClass(t.uiCSS.header).removeClass(t.uiCSS.cornerAll).removeAttr("role"), o.each(this.anchors, function(e, t) {
                                var i = o(t),
                                    n = i.data("href.tabs");
                                n && (t.href = n), i.unbind(".tabs"), o.each(["href", "load", "cache"], function(e, t) { i.removeData(t + ".tabs") })
                            }), this.lis.unbind(".tabs").add(this.panels).each(function(i, n) {
                                var r = o(n);
                                r.data("destroy.tabs") && !e ? r.remove() : r.removeClass(t.uiCSS.stateDefault).removeClass(t.uiCSS.cornerTop).removeClass(t.uiCSS.cornerBottom).removeClass(t.uiCSS.cornerLeft).removeClass(t.uiCSS.cornerRight).removeClass(t.uiCSS.tabsActive).removeClass(t.uiCSS.stateActive).removeClass(t.uiCSS.stateHover).removeClass(t.uiCSS.stateFocus).removeClass(t.uiCSS.stateDisabled).removeClass(t.uiCSS.tabsPanel).removeClass(t.uiCSS.content).removeClass(t.uiCSS.tabsHide).css({ position: "", left: "", top: "" }).removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-selected").removeAttr("aria-disabled")
                            }), i.length && i.replaceWith(i.contents()), t.cookie && this.nb(null, t.cookie), this
                        }, t.prototype.Ab = function() {
                            var e = this.options.uiCSS;
                            this.lis.filter("." + e.tabsLoading).removeClass(e.tabsLoading).find("span:data(label.tabs)").each(function() {
                                var e = o(this);
                                e.html(e.data("label.tabs")).removeData("label.tabs")
                            })
                        }, t.prototype.yb = function() { this.scrollWrap && (this.scrollWrap.superpanel("destroy").replaceWith(this.scrollWrap.contents()), this.scrollWrap = void 0, l && l(this.list, ["width", "height", "overflow"])) }, t.prototype.nb = function(e, t) { var i = this.cookie || (this.cookie = this.options.cookie.name || "ui-tabs-" + u()); return o.cookie.apply(null, [i].concat(o.makeArray(arguments))) }, t.prototype.xb = function(e) { return this.Bb(e.css("margin-left")) + this.Bb(e.css("border-left-width")) + this.Bb(e.css("padding-left")) + this.Bb(e.css("width")) + this.Bb(e.css("margin-right")) + this.Bb(e.css("border-right-width")) + this.Bb(e.css("padding-right")) }, t.prototype.Bb = function(e) { var t = e.indexOf("px"); return t && -1 !== t ? parseFloat(e.substr(0, t)) : 0 }, t.prototype.abort = function() { return this.element.queue([]), this.panels.stop(!1, !0), this.element.queue("tabs", this.element.queue("tabs").splice(-2, 2)), this.xhr && (this.xhr.abort(), delete this.xhr), this.Ab(), this }, t.prototype.select = function(e) { return "string" == typeof e ? e = this.anchors.index(this.anchors.filter("[href$=" + e + "]")) : null === e && (e = -1), -1 === e && this.options.collapsible && (e = this.options.selected), this.anchors.eq(e).trigger(this.options.event + ".tabs"), this }, t.prototype.load = function(e) {
                            var t = this,
                                i = t.options,
                                n = t.anchors.eq(e)[0],
                                r = o.data(n, "load.tabs"),
                                a = o("span", n);
                            return t.abort(), !1 === t._trigger("beforeShow", null, t.ob(t.anchors[e], t.panels[e])) ? void t.element.dequeue("tabs") : !r || 0 !== t.element.queue("tabs").length && o.data(n, "cache.tabs") ? void t.element.dequeue("tabs") : (t.lis.eq(e).addClass(i.uiCSS.tabsLoading), (i.spinner || t.lb.spinner) && a.data("label.tabs", a.html()).html(i.spinner || t.lb.spinner), t.xhr = o.ajax(o.extend({}, i.ajaxOptions, { url: r, success: function(r, a) { o(t.jb(n.hash), t.element).html(r), t.Ab(), i.cache && o.data(n, "cache.tabs", !0), t._trigger("load", null, t.ob(t.anchors[e], t.panels[e])); try { i.ajaxOptions.success(r, a) } catch (e) {} }, error: function(o, r, a) { t.Ab(), t._trigger("load", null, t.ob(t.anchors[e], t.panels[e])); try { i.ajaxOptions.error(o, r, e, n) } catch (e) {} } })), t.element.dequeue("tabs"), t)
                        }, t.prototype.add = function(e, t, i) {
                            void 0 === i && (i = this.anchors.length);
                            var n = this,
                                r = n.options,
                                a = o((r.tabTemplate || n.lb.tabTemplate).replace(/#\{href\}/g, e).replace(/#\{label\}/g, t)),
                                s = e.indexOf("#") ? n.kb(o("a", a)[0]) : e.replace("#", ""),
                                l = n.mb(!0),
                                c = n.mb(!1),
                                d = o("#" + s),
                                p;
                            return a.addClass(r.uiCSS.stateDefault).addClass(r.uiCSS["corner" + l]).data("destroy.tabs", !0).attr("role", "tab").attr("aria-selected", !1), d.length || (d = o(r.panelTemplate || n.lb.panelTemplate).attr("id", s).data("destroy.tabs", !0).attr("role", "tabpanel")), d.addClass(r.uiCSS.tabsPanel).addClass(r.uiCSS.content).addClass(r.uiCSS["corner" + c] + " " + r.uiCSS.tabsHide).attr("aria-hidden", !0), i >= n.lis.length ? (a.appendTo(n.list), n.panels.length > 0 ? d.insertAfter(n.panels[n.panels.length - 1]) : (p = n.element.find("." + r.uiCSS.tabsContent), 0 === p.length && (p = n.element), d.appendTo(p))) : (a.insertBefore(n.lis[i]), d.insertBefore(n.panels[i])), r.disabledIndexes = o.map(r.disabledIndexes, function(e, t) { return e >= i ? ++e : e }), n.yb(), n.ib(!1), 1 === n.anchors.length && (r.selected = 0, a.addClass(r.uiCSS.tabsActive).addClass(r.uiCSS.stateActive).attr("aria-selected", !0), d.removeClass(r.uiCSS.tabsHide).attr("aria-hidden", !1), n.element.queue("tabs", function() { n.element.triggerVisibility && o(n.panels[0]).triggerVisibility(), n._trigger("show", null, n.ob(n.anchors[0], n.panels[0])) }), n.load(0)), n._trigger("add", null, n.ob(n.anchors[i], n.panels[i])), n
                        }, t.prototype.remove = function(e) {
                            var t = this.options,
                                i = this.lis.eq(e).remove(),
                                n = this.panels.eq(e).remove();
                            return i.hasClass(t.uiCSS.tabsActive) && this.anchors.length > 1 && this.select(e + (e + 1 < this.anchors.length ? 1 : -1)), t.disabledIndexes = o.map(o.grep(t.disabledIndexes, function(t, i) { return t !== e }, !1), function(t, i) { return t >= e ? --t : t }), this.yb(), this.ib(!1), this._trigger("remove", null, this.ob(i.find("a")[0], n[0])), this
                        }, t.prototype.enableTab = function(e) { var t = this.options; if (-1 !== o.inArray(e, t.disabledIndexes)) return this.lis.eq(e).removeClass(t.uiCSS.stateDisabled).removeAttr("aria-disabled"), t.disabledIndexes = o.grep(t.disabledIndexes, function(t, i) { return t !== e }, !1), this._trigger("enable", null, this.ob(this.anchors[e], this.panels[e])), this }, t.prototype.disableTab = function(e) { var t = this.options; return e !== t.selected && (this.lis.eq(e).addClass(t.uiCSS.stateDisabled).attr("aria-disabled", !0), t.disabledIndexes.push(e), t.disabledIndexes.sort(), this._trigger("disable", null, this.ob(this.anchors[e], this.panels[e]))), this }, t.prototype.url = function(e, t) { return this.anchors.eq(e).removeData("cache.tabs").data("load.tabs", t), this }, t.prototype.length = function() { return this.anchors.length }, t
                    }(e.gcuiWidget);
                t.gcuitabs = h, h.prototype.lb = { panelTemplate: "<div></div>", spinner: "<em>Loading&#8230;</em>", tabTemplate: '<li><a href="#{href}"><span>#{label}</span></a></li>' }, i = function() {
                    function e() { this.uiCSS = { gcuitabs: "gcui-gcuitabs", tabsContent: "gcui-gcuitabs-content", tabsHide: "gcui-gcuitabs-hide" }, this.mobileCSS = { header: "ui-header ui-bar-c", content: "ui-content ui-body ui-body-c", stateDefault: "ui-btn-up-a", stateActive: "ui-btn-down-b" }, this.alignment = "top", this.sortable = !1, this.scrollable = !1, this.ajaxOptions = null, this.cache = !1, this.cookie = null, this.collapsible = !1, this.hideOption = null, this.showOption = null, this.disabledIndexes = [], this.event = "click", this.idPrefix = "ui-tabs-", this.panelTemplate = "", this.spinner = "", this.tabTemplate = "", this.add = null, this.remove = null, this.select = null, this.beforeShow = null, this.show = null, this.load = null, this.disable = null, this.enable = null }
                    return e
                }(), h.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i), o.gcui.registerWidget("gcuitabs", h.prototype)
            }(e.tabs || (e.tabs = {}));
            var t = e.tabs
        }(gcui || (gcui = {})), $.fn.extend({ getBounds: function() { return $.extend({}, $(this).offset(), { width: $(this).outerWidth(!0), height: $(this).outerHeight(!0) }) }, setBounds: function(e) { return $(this).css({ left: e.left, top: e.top }).width(e.width).height(e.height), this }, getMaxZIndex: function() { var e = 1 * ("auto" == $(this).css("z-index") ? 0 : $(this).css("z-index")); return $(this).siblings().each(function(t, i) { e = Math.max(e, 1 * ("auto" == $(i).css("z-index") ? 0 : $(i).css("z-index"))) }), Math.max(e, $(this).zIndex()) } }),
            function(e) {
                ! function(t) {
                    var i, o = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments) }
                        return t.prototype._init = function() {
                            if (this.elementZIndex = this.element.zIndex(), this.options.ensureOutermost) {
                                var e = $("form");
                                0 === e.length && (e = $(document.body)), this.element.appendTo(e)
                            }
                            this.element.data("visible.gcuipopup", !1), this.element.css("position", "absolute"), this.element.position({ of: $(document.body) }), this.element.hide(), this.Cb = this.Db.bind(this)
                        }, t.prototype._setOption = function(t, i) {
                            if (e.prototype._setOption.call(this, t, i), "autoHide" === t) {
                                var o = this.isVisible();
                                this.hide(), o && this.show()
                            }
                        }, t.prototype.destroy = function() {
                            var t, i, o;
                            e.prototype.destroy.call(this), this.isVisible() && this.hide(), t = GC.Spread.Sheets.util.browser, t.msie && parseInt(t.version) < 7 && ((i = this.element.data("backframe.gcuipopup")) || i.remove()), o = this, this.element.unbind(".gcuipopup"), $.each(["visible", "backframe", "animating", "width"], function(e, t) { o.element.removeData(t + ".gcuipopup") })
                        }, t.prototype.isVisible = function() { return !!this.element.data("visible.gcuipopup") && this.element.is(":visible") }, t.prototype.isAnimating = function() { return !!this.element.data("animating.gcuipopup") }, t.prototype.show = function(e) {
                            var t, i, o;
                            this.Eb(e), this.isVisible() || !1 !== this._trigger("showing") && (this.options.autoHide && document.addEventListener("mouseup", this.Cb, !0), t = this.options.showEffect || "show", i = this.options.showDuration || 300, o = this.options.showOptions || {}, this.element.data("animating.gcuipopup", !0), $.effects && $.effects.effect[t] ? this.element.show(t, o, i, $.proxy(this.Fb, this)) : this.element[t]("show" === t ? null : i, $.proxy(this.Fb, this)), (!t || !i || "show" === t || i <= 0) && this.Fb())
                        }, t.prototype.Fb = function() { this.element.removeData("animating.gcuipopup"), this.element.data("visible.gcuipopup", !0), this._trigger("shown") }, t.prototype.showAt = function(e, t) { this.show({ my: "left+" + e + " top+" + t, at: "left top", of: document.body }) }, t.prototype.hide = function() {
                            var e, t, i;
                            this.isVisible() && !1 !== this._trigger("hiding") && (document.removeEventListener("mouseup", this.Cb, !0), e = this.options.hideEffect || "hide", t = this.options.hideDuration || 300, i = this.options.hideOptions || {}, this.element.data("animating.gcuipopup", !0), $.effects && $.effects.effect[e] ? this.element.hide(e, i, t, $.proxy(this.Gb, this)) : this.element[e]("hide" === e ? null : t, $.proxy(this.Gb, this)), (!e || !t || "hide" === e || t <= 0) && this.Gb())
                        }, t.prototype.Gb = function() {
                            var e, t;
                            void 0 !== this.element.data("width.gcuipopup") && (this.element.width(this.element.data("width.gcuipopup")), this.element.removeData("width.gcuipopup")), this.element.unbind("move.gcuipopup"), this.element.removeData("animating.gcuipopup"), e = GC.Spread.Sheets.util.browser, e.msie && parseInt(e.version) < 7 && (t = this.element.data("backframe.gcuipopup")) && t.hide(), this._trigger("hidden")
                        }, t.prototype.Db = function(e) {
                            var t = e.target ? e.target : e.srcElement;
                            this.isVisible() && this.options.autoHide && t != this.element.get(0) && $(t).parents().index(this.element) < 0 && this.hide()
                        }, t.prototype.Hb = function(e) {
                            var t = this.element.data("backframe.gcuipopup");
                            t && (this.element.before(t), t.css({ top: this.element.css("top"), left: this.element.css("left") }))
                        }, t.prototype.Ib = function() {
                            var e, t = GC.Spread.Sheets.util.browser;
                            t.msie && parseInt(t.version) < 7 && (e = this.element.data("backframe.gcuipopup"), e || (e = jQuery("<iframe/>").css({ position: "absolute", display: "none", filter: "progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)" }).attr({ src: "javascript:'<html></html>';", scrolling: "no", frameborder: "0", "tabIndex ": -1 }), this.element.before(e), this.element.data("backframe.gcuipopup", e), this.element.bind("move.gcuipopup", $.proxy(this.Hb, this))), e.setBounds(this.element.getBounds()), e.css({ display: "block", left: this.element.css("left"), top: this.element.css("top"), "z-index": this.element.css("z-index") - 1 }))
                        }, t.prototype.Jb = function(e) {
                            this.element.css("z-index", e);
                            var t = this.element.data("backframe.gcuipopup");
                            t && t.css("z-index", this.element.css("z-index") - 1)
                        }, t.prototype.Eb = function(e) {
                            var t, i, o = this.element.is(":visible");
                            this.element.show(), this.element.position($.extend({}, this.options.position, e || {})), o || this.element.hide(), e && (t = e.of), t || (t = this.options.position.of), this.Ib(), i = Math.max(1e3, this.elementZIndex), t && (i = Math.max(i, $(t).getMaxZIndex())), this.Jb(i + 10), this._trigger("posChanged")
                        }, t
                    }(e.GCUIWidget);
                    t.gcuipopup = o, i = function() {
                        function e() { this.ensureOutermost = !1, this.showEffect = "show", this.showOptions = {}, this.showDuration = 300, this.hideEffect = "hide", this.hideOptions = {}, this.hideDuration = 100, this.autoHide = !1, this.position = { at: "left bottom", my: "left top" }, this.showing = null, this.shown = null, this.hiding = null, this.hidden = null, this.posChanged = null }
                        return e
                    }(), o.prototype.options = $.extend(!0, {}, e.gcuiWidget.prototype.options, new i), $.gcui.registerWidget("gcuipopup", o.prototype)
                }(e.popup || (e.popup = {}));
                var t = e.popup
            }(gcui || (gcui = {})), jQuery.extend(jQuery.support, { isTouchEnabled: function() { return "ontouchstart" in window || "ontouchend" in document || void 0 !== window.navigator.msMaxTouchPoints && window.navigator.msMaxTouchPoints > 0 } });

        function applyTouchUtilEvents(e) { return e }! function(e) {
            ! function(e) {
                "use strict";
                var t, i, o, n, r, a, s, l, c, d = jQuery,
                    p = "virtualMouseBindings",
                    u = "virtualTouchID",
                    h = "gcuimouseover gcuimousedown gcuimousemove gcuimouseup gcuiclick gcuitap gcuidoubletap gcuitaphold gcuimouseout gcuimousecancel".split(" "),
                    f = window.navigator.msPointerEnabled,
                    g = { gcuimouseover: f ? "MSPointerOver" : "mouseover", gcuimousedown: f ? "MSPointerDown" : "mousedown", gcuijmousemove: f ? "MSPointerMove" : "mousemove", gcuimouseup: f ? "MSPointerUp" : "mouseup", gcuimouseout: f ? "MSPointerOut" : "mouseout", gcuimousecancel: "mousecancel", gcuiclick: f ? "MSGestureTap" : "click", gcuidoubletap: f ? "MSGestureDoubleTap" : "dblclick", gcuitaphold: f ? "MSGestureHold" : "gesturehold" },
                    m = "clientX clientY pageX pageY screenX screenY".split(" "),
                    b = "clientX clientY pageX pageY screenX screenY".split(" "),
                    v = d.event.mouseHooks ? d.event.mouseHooks.props : [],
                    y = (d.event.props)? d.event.props?.concat(v):v,
                    w = {},
                    x = 0,
                    C = 0,
                    S = 0,
                    k = !1,
                    T = [],
                    A = !1,
                    E = !1,
                    I = "addEventListener" in document,
                    D = d(document),
                    $ = 1,
                    L = 0,
                    F = f ? "MSPointerDown" : "touchstart",
                    R = f ? "MSPointerUp" : "touchend",
                    B = f ? "MSPointerMove" : "touchmove",
                    O = "scroll";
                d.gcuimouse = { moveDistanceThreshold: 10, clickDistanceThreshold: 10, resetTimerDuration: 1500 };

                function P(e) { for (; e && void 0 !== e.originalEvent;) e = e.originalEvent; return e }

                function N(e, t) {
                    var i = e.type,
                        o, n, r, a, s, l, c, p, u;
                    if (e = d.Event(e), e.nativeType = e.type, e.type = t, o = e.originalEvent, n = d.event.props, i.search(/^(mouse|click)/) > -1 && (n = y), o)
                        for (c = n.length, a; c;) a = n[--c], e[a] = o[a];
                    for (i.search(/mouse(down|up)|click/) > -1 && !e.which && (e.which = 1), r = P(o), p = 0, u = b.length; p < u; p++) a = b[p], void 0 === e[a] && (e[a] = r[a]);
                    if (-1 !== i.search(/^touch/) && (i = r.touches, s = r.changedTouches, l = i && i.length ? i[0] : s && s.length ? s[0] : void 0))
                        for (p = 0, u = m.length; p < u; p++) a = m[p], e[a] = l[a];
                    return e
                }

                function z(e) {
                    for (var t = {}, i, o; e;) {
                        i = d.data(e, p);
                        for (o in i) i[o] && (t[o] = t.hasVirtualBinding = !0);
                        e = e.parentNode
                    }
                    return t
                }

                function M(e, t) {
                    for (var i; e;) {
                        if ((i = d.data(e, p)) && (!t || i[t])) return e;
                        e = e.parentNode
                    }
                    return null
                }

                function V() { E = !1 }

                function G() { E = !0 }

                function j() { L = 0, T.length = 0, A = !1, G() }

                function H() { V() }

                function W() { U(), x = setTimeout(function() { x = 0, j() }, d.gcuimouse.resetTimerDuration) }

                function U() { x && (clearTimeout(x), x = 0) }

                function q(e, t, i) { var o; return (i && i[e] || !i && M(t.target, e)) && (o = N(t, e), d(t.target).trigger(o)), o }

                function _(e) {
                    var t, i, o, n = d.data(e.target, u);
                    if (!(A || L && L === n)) {
                        t = "gcui" + e.type;
                        for (i in g) g[i] === e.type && (t = i);
                        o = q(t, e), o && (o.isDefaultPrevented() && e.preventDefault(), o.isPropagationStopped() && e.stopPropagation(), o.isImmediatePropagationStopped() && e.stopImmediatePropagation())
                    }
                }

                function K(e) {
                    var t, i, o, n, r = P(e).touches;
                    (r && 1 === r.length || f) && (t = e.target, i = z(t), i.hasVirtualBinding && (L = $++, d.data(t, u, L), U(), H(), k = !1, o = P(e), n = o.touches ? o.touches[0] : o, C = n.pageX, S = n.pageY, q("gcuimouseover", e, i), q("gcuimousedown", e, i)))
                }

                function X(e) { E || (k || q("gcuimousecancel", e, z(e.target)), k = !0, W()) }

                function J(e) {
                    var t, i, o, n, r;
                    E || (t = P(e), i = t.touches ? t.touches[0] : t, o = k, n = d.gcuimouse.moveDistanceThreshold, k = k || Math.abs(i.pageX - C) > n || Math.abs(i.pageY - S) > n, r = z(e.target), k && !o && q("gcuimousecancel", e, r), q("gcuimousemove", e, r), W())
                }

                function Y(e) {
                    var t, i, o, n;
                    E || (G(), t = z(e.target), q("gcuimouseup", e, t), k || (n = q("gcuiclick", e, t)) && n.isDefaultPrevented() && (i = P(e), o = i.changedTouches ? i.changedTouches[0] : i, T.push({ touchID: L, x: o.clientX, y: o.clientY }), A = !0), q("gcuimouseout", e, t), k = !1, W())
                }

                function Q(e) {
                    var t = d.data(e, p),
                        i;
                    if (t)
                        for (i in t)
                            if (t[i]) return !0;
                    return !1
                }

                function Z() {}

                function ee(e) {
                    var t = g[e];
                    return {
                        setup: function(i, o) {
                            var n, r;
                            Q(this) || d.data(this, p, {}), n = d.data(this, p), n[e] = !0, d(this).bind(t, Z), r = !1, I && (w[F] = (w[F] || 0) + 1, 1 === w[F] && (r = !0, D.bind(F, K).bind(R, Y).bind(B, J).bind(O, X))), r && F === t || (w[e] = (w[e] || 0) + 1, 1 === w[e] && D.bind(t, _))
                        },
                        teardown: function(i, o) {
                            --w[e], w[e] || D.unbind(t, _), I && (--w[F] || D.unbind(F, K).unbind(B, J).unbind(R, Y).unbind(O, X));
                            var n = d(this),
                                r = d.data(this, p);
                            r && (r[e] = !1), n.unbind(t, Z), Q(this) || n.removeData(p)
                        }
                    }
                }
                for (t = 0; t < h.length; t++) d.event.special[h[t]] = ee(h[t]);
                I && document.addEventListener("click", function(e) {
                    var t, i, o, n, r, a, s, l = T.length,
                        c = e.target;
                    if (l)
                        for (t = e.clientX, i = e.clientY, s = d.gcuimouse.clickDistanceThreshold, o = c; o;) {
                            for (n = 0; n < l; n++)
                                if (r = T[n], a = 0, o === c && Math.abs(r.x - t) < s && Math.abs(r.y - i) < s || d.data(o, u) === r.touchID) return e.preventDefault(), void e.stopPropagation();
                            o = o.parentNode
                        }
                }, !0), d.each("touchstart touchmove touchend orientationchange throttledresize gcuitap gcuitaphold gcuiswipe gcuiswipeleft gcuiswiperight gcuiscrollstart gcuiscrollstop".split(" "), function(e, t) { d.fn[t] = function(e) { return e ? this.bind(t, e) : this.trigger(t) }, d.attrFn && (d.attrFn[t] = !0) }), i = "ontouchend" in document, o = i ? "touchstart" : "mousedown", n = i ? "touchend" : "mouseup", r = i ? "touchmove" : "mousemove", a = "gesturestart", s = "gesturechange", l = "gestureend", window.navigator.msPointerEnabled && (o = "MSPointerDown", n = "MSPointerUp", r = "MSPointerMove", a = "MSGestureStart", s = "MSGestureChange", l = "MSGestureEnd");

                function te(e, t, i) {
                    var o = i.type;
                    i.nativeType = i.type, i.type = t;
                    try { d([e]).trigger(i) } finally { i.type = o }
                }
                d.event.special.gcuiscrollstart = {
                    enabled: !0,
                    setup: function() {
                        var e = this,
                            t = d(e),
                            i, o;

                        function n(t, o) { i = o, te(e, i ? "gcuiscrollstart" : "gciscrollstop", t) } t.bind("touchmove scroll", function(e) { d.event.special.gcuiscrollstart.enabled && (i || n(e, !0), clearTimeout(o), o = setTimeout(function() { n(e, !1) }, 50)) })
                    }
                }, d.event.special.gcuitap = {
                    setup: function() {
                        var e = this,
                            t = d(e);
                        t.bind("gcuimousedown", function(i) {
                            if (i.which && 1 !== i.which) return !1;
                            var o = i.target,
                                n = i.originalEvent,
                                r;

                            function a() { clearTimeout(r) }

                            function s() { a(), t.unbind("gcuiclick", l).unbind("gcuimouseup", a), d(document).unbind("gcuimousecancel", s) }

                            function l(t) { s(), o == t.target && te(e, "gcuitap", t) } t.bind("gcuimouseup", a).bind("gcuiclick", l), d(document).bind("gcuimousecancel", s), r = setTimeout(function() { te(e, "gcuitaphold", d.Event("gcuitaphold", { target: o })) }, 750)
                        })
                    }
                }, d.event.special.gcuiswipe = {
                    scrollSupressionThreshold: 10,
                    durationThreshold: 1e3,
                    horizontalDistanceThreshold: 30,
                    verticalDistanceThreshold: 75,
                    setup: function() {
                        var e = this,
                            t = d(e);
                        t.bind(o, function(e) {
                            var i = e.originalEvent.touches ? e.originalEvent.touches[0] : e,
                                o = { time: (new Date).getTime(), coords: [i.pageX, i.pageY], origin: d(e.target) },
                                a;

                            function s(e) {
                                if (o) {
                                    var t = e.originalEvent.touches ? e.originalEvent.touches[0] : e;
                                    a = { time: (new Date).getTime(), coords: [t.pageX, t.pageY] }, Math.abs(o.coords[0] - a.coords[0]) > d.event.special.gcuiswipe.scrollSupressionThreshold && e.preventDefault()
                                }
                            }
                            t.bind(r, s).one(n, function(e) { t.unbind(r, s), o && a && a.time - o.time < d.event.special.gcuiswipe.durationThreshold && Math.abs(o.coords[0] - a.coords[0]) > d.event.special.gcuiswipe.horizontalDistanceThreshold && Math.abs(o.coords[1] - a.coords[1]) < d.event.special.gcuiswipe.verticalDistanceThreshold && o.origin.trigger("gcuiswipe").trigger(o.coords[0] > a.coords[0] ? "gcuiswipeleft" : "gcuiswiperight"), o = a = void 0 })
                        })
                    }
                }, c = "altKey ctrlKey metaKey rotation scale shiftKey target velocityX velocityY translationX translationY".split(" ");

                function ie(e, t) {
                    if (window.navigator.msPointerEnabled && !e.Kb) {
                        e.Kb = !0;
                        var i = new MSGesture;
                        i.target = e, e.addEventListener("MSPointerDown", function(e) { i.addPointer(e.pointerId) }, !1)
                    }
                }

                function oe(e, t) { var i = ne(t, e); return d(t.target).trigger(i), i }

                function ne(e, t) {
                    var i = e.type,
                        o, n, r, a, s, l, p, u, h;
                    if (o = e.originalEvent, e = d.Event(e), e.nativeType = e.type, e.type = t, n = d.event.props, o)
                        for (p = n.length, a; p;) a = n[--p], e[a] = e[a] || o[a];
                    for (u = 0, h = c.length; u < h; u++) a = c[u], e[a] = e[a] || o[a];
                    return window.navigator.msPointerEnabled && e.rotation && (e.rotation = 360 * e.rotation / Math.PI), e
                }
                d.event.special.gcuigesturestart = {
                        setup: function() {
                            var e = this,
                                t = d(e);
                            ie(e, "gcuigesturestart"), t.bind(a, function(e) { oe("gcuigesturestart", e) })
                        }
                    }, d.event.special.gcuigesturechange = {
                        setup: function() {
                            var e = this,
                                t = d(e);
                            ie(e, "gcuigesturechange"), t.bind(s, function(e) { oe("gcuigesturechange", e) })
                        }
                    }, d.event.special.gcuigestureend = {
                        setup: function() {
                            var e = this,
                                t = d(e);
                            ie(e, "gcuigestureend"), t.bind(l, function(e) { oe("gcuigestureend", e) })
                        }
                    },
                    function(e, t) {
                        var i, o, n, r, a, s, l, c, d = e(t),
                            p = { 0: !0, 180: !0 };
                        "orientation" in t && "onorientationchange" in t && (s = t.innerWidth || e(t).width(), l = t.innerHeight || e(t).height(), c = 50, r = s > l && s - l > c, a = p[t.orientation], (r && a || !r && !a) && (p = { "-90": !0, 90: !0 })), e.event.special.orientationchange = i = {
                            setup: function() {
                                if ("orientation" in t && "onorientationchange" in t && e.mobile.orientationChangeEnabled) return !1;
                                n = o(), d.bind("throttledresize", u)
                            },
                            teardown: function() {
                                if ("orientation" in t && "onorientationchange" in t && e.mobile.orientationChangeEnabled) return !1;
                                d.unbind("throttledresize", u)
                            },
                            add: function(e) {
                                var t = e.handler;
                                e.handler = function(e) { return e.orientation = o(), t.apply(this, arguments) }
                            }
                        };

                        function u() {
                            var e = o();
                            e !== n && (n = e, d.trigger("orientationchange"))
                        }
                        e.event.special.orientationchange.orientation = o = function() {
                            var e = !0,
                                i = document.documentElement;
                            return e = "orientation" in t && "onorientationchange" in t ? p[t.orientation] : i && i.clientWidth / i.clientHeight < 1.1, e ? "portrait" : "landscape"
                        }
                    }(jQuery, window),
                    function() {
                        d.event.special.throttledresize = { setup: function() { d(this).bind("resize", t) }, teardown: function() { d(this).unbind("resize", t) } };
                        var e = 250,
                            t = function() { n = (new Date).getTime(), r = n - i, r >= e ? (i = n, d(this).trigger("throttledresize")) : (o && clearTimeout(o), o = setTimeout(t, e - r)) },
                            i = 0,
                            o, n, r
                    }(), d.each({ gcuiscrollstop: "gcuiscrollstart", gcuitaphold: "gcuitap", gcuiswipeleft: "gcuiswipe", gcuiswiperight: "gcuiswipe" }, function(e, t) { d.event.special[e] = { setup: function() { d(this).bind(t, d.noop) } } })
            }(e.touch || (e.touch = {}))
        }(gcui || (gcui = {})), $(document).ready(function() {
                var e, t, i = window.navigator.userAgent,
                    o = i.match(RegExp("android ((1\\.)|(2\\.([^345]+)))", "i")),
                    n = !!window.WebKitCSSMatrix && !o,
                    r = !("string" != typeof i || !i.match(/applewebkit/)),
                    a = "ontouchend" in document,
                    s = document.createElement("div");
                s.setAttribute("style", "transition:top 1s ease;-webkit-transition:top 1s ease;-moz-transition:top 1s ease;-o-transition:top 1s ease;"), document.body.appendChild(s), e = !!(s.style.transition || s.style.webkitTransition || s.style.MozTransition || s.style.OTransitionDuration), s.parentNode.removeChild(s), s = null;

                function l(e, t, i) {
                    var o = "-webkit-transform",
                        n = "translate3d(0,0,0)",
                        r = e.css(o),
                        a = !(r && r.match(/^\s*none\s*$/i));
                    e.css(o, a ? n : r + " " + n);
                    try { return t.apply(this, i) } finally { e.css(o, r) }
                }
                t = jQuery.fn.animate, jQuery.fn.animate = function(e, i, o, n) { if (!r || !c.apply(this, arguments)) return l.call(this, this, function() { return t.apply(this, arguments) }, arguments) };

                function c(e, t, i, o) {
                    var n, r, a, s = !1,
                        l = $.speed(t, i, o),
                        c = this;
                    if (!e) return !1;
                    for (a in e) n = e[a], "height" === a ? "hide" === n ? (this.css("display", "none"), s = !0, l.complete()) : "show" === n && (this.css("display", ""), s = !0, l.complete()) : "width" === a ? "hide" === n ? (this.css("display", "none"), s = !0, l.complete()) : "show" === n && (this.css("display", ""), s = !0, l.complete()) : "left" === a && (r = 1 * this.css("left").replace("px", ""), "string" == typeof n && (0 === n.indexOf("-=") ? r -= 1 * n.replace("-=", "") : 0 === n.indexOf("+=") && (r += 1 * n.replace("+=", ""))), s = !0, this.css("-webkit-perspective", 1e3), this.css("-webkit-backface-visibility", "hidden"), u(this[0], r, l.duration, "linear", l.complete));
                    return s
                }

                function d(t, i, o, n) { e && (o || (o = "ease"), y(t, "opacity", i, o), h(t, 0), t.addEventListener("webkitTransitionEnd", $.proxy(function() { w(t), t.style.display = "none", h(t, 1), n && n() }, this), !1)) }

                function p(t, i, o, n) { e && (o || (o = "ease"), y(t, "opacity", i, o), h(t, 1), t.addEventListener("webkitTransitionEnd", $.proxy(function() { w(t), "none" === t.style.display && (t.style.display = ""), n && n() }, this), !1)) }

                function u(t, i, o, n, r) { e && (v(t, o, n), f(t, i), t.Lb = r, t.Mb = $.proxy(x, {}), t.addEventListener("webkitTransitionEnd", t.Mb, !1)) }

                function h(t, i) {
                    var o;
                    e && (o = t.style || t, o.opacity = i)
                }

                function f(t, i) {
                    var o;
                    e ? (t.Nb = i, o = t.style || t, o.webkitTransform = "translateX(" + i + "px)") : t.style.left = i + "px"
                }

                function g(t, i) {
                    var o;
                    e ? (t.Ob = i, o = t.style || t, o.webkitTransform = "translateY(" + i + "px)") : t.style.top = i + "px"
                }

                function m(t) { var i, o, n, r, a; if (!t) return 0; if (e) { if (i = t.style || t, "string" == typeof(o = i.webkitTransform) && (n = RegExp("translate(3d|X|)\\(-*(\\d+)"), (r = n.exec(o)) && (a = parseFloat(r[1]), isFinite(a)))) return a } else if (a = parseInt($(t).css("left")), isFinite(a)) return a; return 0 }

                function b(t) { var i, o, n, r, a; if (!t) return 0; if (e) { if (i = t.style || t, "string" == typeof(o = i.webkitTransform) && (n = RegExp("translate(3d|X|)\\(.*,\\s*-*(\\d+)"), (r = n.exec(o)) && (a = parseFloat(r[1]), isFinite(a)))) return a } else if (a = parseInt(jQuery(t).css("top")), isFinite(a)) return a; return 0 }

                function v(e, t, i) { i || (i = "ease"), y(e, "-webkit-transform", t, i) }

                function y(t, i, o, n) {
                    if (e) {
                        var r = t.style;
                        r.webkitTransitionProperty = i, r.webkitTransitionDuration = o + "ms", r.webkitTransitionTimingFunction = n
                    }
                }

                function w(t) {
                    var i, o;
                    e && (i = t.style, i.webkitTransitionProperty = "none", (o = t.Mb) && (delete t.Mb, t.removeEventListener("webkitTransitionEnd", o, !1)))
                }

                function x(e) {
                    try {
                        var t, i;
                        switch (e.type) {
                            case "webkitTransitionEnd":
                                t = e.target, t && (w(t), t.Lb && (i = t.Lb, t.Lb = null, i(e)))
                        }
                    } catch (t) { window.console && window.console.log && window.console.log("[ew219290] error: " + (t.message ? t.message : t) + ", event: " + e) }
                    return !0
                }
            }),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o, n, r, a, s, l, c, d, p, u = jQuery,
                        h = function() {
                            function e() { this.mobileCSS = { header: "ui-header ui-bar-a", content: "ui-body-c", stateDefault: "ui-btn-up-c", stateHover: "ui-btn-down-c", stateActive: "ui-btn-down-c" }, this.initSelector = ":jqmData(role='superpanel')", this.allowResize = !1, this.autoRefresh = !1, this.animationOptions = { queue: !1, disabled: !1, duration: 250, easing: void 0 }, this.hScrollerActivating = null, this.hScroller = { scrollBarPosition: "bottom", scrollBarVisibility: "auto", scrollMode: "scrollBar", scrollValue: null, scrollMax: 100, scrollMin: 0, scrollLargeChange: null, scrollSmallChange: null, scrollMinDragLength: 6, increaseButtonPosition: null, decreaseButtonPosition: null, hoverEdgeSpan: 20, firstStepChangeFix: 0 }, this.keyboardSupport = !1, this.keyDownInterval = 100, this.mouseWheelSupport = !0, this.bubbleScrollingEvent = !0, this.resizableOptions = { handles: "all", helper: "ui-widget-content gcui-superpanel-helper" }, this.resized = null, this.dragStop = null, this.painted = null, this.scrolling = null, this.scroll = null, this.scrolled = null, this.showRounder = !0, this.vScrollerActivating = null, this.vScroller = { scrollBarPosition: "right", scrollBarVisibility: "auto", scrollMode: "scrollBar", scrollValue: null, scrollMax: 100, scrollMin: 0, scrollLargeChange: null, scrollSmallChange: null, scrollMinDragLength: 6, increaseButtonPosition: null, decreaseButtonPosition: null, hoverEdgeSpan: 20, firstStepChangeFix: 0 }, this.customScrolling = !1, this.listenContentScroll = !1 }
                            return e
                        }();
                    t = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments) }
                        return t
                    }(e.gcuiWidget), t.superpanel = t, u.support.isTouchEnabled && u.support.isTouchEnabled() ? (o = "gcui-superpanel-handle", s = "<div class='gcui-superpanel-statecontainer'><div class='gcui-superpanel-contentwrapper-touch'></div></div>", t.prototype = u.extend(!0, {}, u.Widget.prototype, {
                        widgetEventPrefix: "gcuisuperpanel",
                        _setOption: function(e, t) {
                            var i = this,
                                o = i.options,
                                n = i.Pb();
                            switch ("animationOptions" === e || "resizableOptions" === e ? t = u.extend(o[e], t) : "hScroller" !== e && "vScroller" !== e || (t = u.extend(o[e], t), i.refresh()), u.Widget.prototype._setOption.apply(i, arguments), e) {
                                case "allowResize":
                                    i.Sb();
                                    break;
                                case "disabled":
                                    i.kd(t, i.element);
                                    break;
                                case "mouseWheelSupport":
                                case "keyboardSupport":
                                    i.Tb(i, n, i.element, o)
                            }
                        },
                        _create: function() {
                            var e = this,
                                t = e.options;
                            t.vScroller.dir = "v", t.hScroller.dir = "h", e.ld(), e.options.disabled && e.disable(), e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() { e.refresh(), e.element.removeVisibilityObserver && e.element.removeVisibilityObserver() }, "gcuisuperpanel")
                        },
                        kd: function(e, t) {
                            var i = this;
                            e ? (i.disabledDiv || (i.disabledDiv = i.md(t)), i.disabledDiv.appendTo("body")) : i.disabledDiv && (i.disabledDiv.remove(), i.disabledDiv = null)
                        },
                        md: function(e) {
                            var t = this,
                                i = e || t.element,
                                o = i.offset(),
                                n = i.outerWidth(),
                                r = i.outerHeight();
                            return u("<div></div>").addClass("ui-disabled").css({ "z-index": "99999", position: "absolute", width: n, height: r, left: o.left, top: o.top })
                        },
                        ld: function() {
                            var e = this,
                                t = e.element;
                            e.paintPanel(), e.Sb(), e.Tb()
                        },
                        nd: function(e) {
                            var t = {},
                                i = this.options,
                                o = i.hScroller.scrollBarVisibility,
                                n = i.vScroller.scrollBarVisibility;
                            t["overflow-x"] = o, t["overflow-y"] = n, u.support.isTouchEnabled && u.support.isTouchEnabled() && "visible" === o && "visible" === n && (t["overflow-x"] = "auto", t["overflow-y"] = "auto"), e.css(t)
                        },
                        Wc: function(e, t, i) {
                            i.attr("tabindex") || (i.attr("tabindex", "-1"), t.tabindex = !0);
                            var o = t.stateContainer = u(s),
                                n;
                            e.nd(t.stateContainer), t.contentWrapper = o.children(), i.contents().each(function(e, i) { var o = u(i); return o.hasClass("gcui-superpanel-header") ? void(t.header = o) : o.hasClass("gcui-superpanel-footer") ? void(t.footer = o) : void t.contentWrapper[0].appendChild(i) }), void 0 !== t.header && i.prepend(t.header), i[0].appendChild(o[0]), void 0 !== t.footer && t.footer.insertAfter(o), e.od(), t.contentWrapper.css("float", "left"), t.contentWidth = t.contentWrapper.width(), t.contentHeight = t.contentWrapper.height(), t.contentWrapper.css("float", "")
                        },
                        Tb: function() {
                            var e = this,
                                t = e.element,
                                i = e.options,
                                o = e.widgetName,
                                n = t.find(".gcui-superpanel-statecontainer"),
                                r = n.scrollTop();
                            n.bind("scroll", function(t, i) {
                                var o = u(this).scrollTop();
                                o === r ? (e.$c(u(this).scrollLeft(), "h"), e.tc(u(this).scrollLeft(), "h")) : (e.$c(o, "v"), e.tc(o, "v"), r = o)
                            }), i.keyboardSupport ? void 0 === e.gc && (e.gc = !0, t.bind("keydown." + o, e, e.hc)) : (t.unbind("keydown." + o, e.hc), e.gc = void 0), i.mouseWheelSupport || t.bind("mousewheel", function(e) { return e.stopPropagation(), !1 })
                        },
                        jc: function(e, t, i, o) {
                            var n = i.options;
                            t.length > 0 && (e.internalFuncID = window.setInterval(function() { i.kc(t, i, o) }, n.keyDownInterval))
                        },
                        $c: function(e, t) {
                            var i = { position: e, dir: t };
                            this._trigger("scroll", null, i)
                        },
                        hc: function(t) {
                            var i = t.data,
                                o = i.options,
                                n, r, a = e.getKeyCodeEnum();
                            o.keyboardSupport && !o.disabled && (n = t.shiftKey, r = t.keyCode, r === a.LEFT ? i.kc("left", i, n) : r === a.RIGHT ? i.kc("right", i, n) : r === a.UP ? i.kc("top", i, n) : r === a.DOWN && i.kc("bottom", i, n), t.stopPropagation(), t.preventDefault())
                        },
                        kc: function(e, t, i) {
                            var o, n, r, a = t.Pb(),
                                s = a.stateContainer[0],
                                l = {},
                                c;
                            "top" === e || "bottom" === e ? (n = "v", r = "scrollTop") : "left" !== e && "right" !== e || (n = "h", r = "scrollLeft"), o = i ? t.Nc(n) : t.pd(n), c = s[r], l[r] = "top" === e || "left" === e ? c - o : c + o, t.qd(l)
                        },
                        Nc: function(e) {
                            var t = this,
                                i = t.Pb(),
                                o, n = "h" == e ? i.clientWidth : i.clientHeight;
                            return o = n || i.stateContainer["h" == e ? "width" : "height"]()
                        },
                        pd: function() { return this.Nc() / 2 },
                        Rc: function(e, t) {
                            var i, o, n, r, a, s = this.options.uiCSS.cornerAll;
                            if (this.options.showRounder) {
                                if (t.addClass(s), e.jd) return;
                                if (i = GC.Spread.Sheets.util.browser, i.msie) return;
                                o = "", n = "", i.webkit ? (n = "WebkitBorderTopLeftRadius", o = "WebkitBorderRadius") : i.mozilla ? (n = "MozBorderRadiusBottomleft", o = "MozBorderRadius") : (n = "border-top-left-radius", o = "border-radius"), r = t.css(n), a = parseInt(r, 10), t.css(o, a + 1), e.jd = !0, e.Zb = o
                            } else t.removeClass(s)
                        },
                        Sb: function() {
                            var e = this,
                                t = e.options,
                                i = e.Pb(),
                                o = i.resizer,
                                n, r;
                            u.fn.resizable && (!o && t.allowResize && (n = t.resizableOptions, r = n.stop, n.stop = function(t) { e.od(), e._trigger("resized"), u.isFunction(r) && r(t) }, i.resizer = o = e.element.resizable(n)), !t.allowResize && i.resizer && (o.resizable("destroy"), i.resizer = null))
                        },
                        od: function() {
                            var e = this,
                                t = e.options,
                                i = e.element,
                                o = e.Pb(),
                                n = i.width(),
                                r = i.height();
                            void 0 !== o.header && (r -= o.header.outerHeight()), void 0 !== o.footer && (r -= o.footer.outerHeight()), o.stateContainer.length && (o.stateContainer.css({ width: n, height: r }), o.clientWidth = o.stateContainer[0].clientWidth, o.clientHeight = o.stateContainer[0].clientHeight)
                        },
                        Pb: function() {
                            var e = this,
                                t = e.element,
                                i = e.widgetName + "-fields",
                                o = e.$b;
                            return void 0 === o && (o = {}, t.data(i, o), e.$b = o), o
                        },
                        Mc: function(e) {
                            var t = u(e),
                                i, o, n, r, a, s, l, c, d, p = { left: null, top: null };
                            return 0 === t.length ? p : (i = this.Pb(), o = i.contentWrapper, n = t.offset(), n.leftWidth = n.left + t.outerWidth(), n.topHeight = n.top + t.outerHeight(), a = o.offset(), a.leftWidth = a.left + i.clientWidth, a.topHeight = a.top + i.clientHeight, c = n.left - a.left, n.left < a.left ? p.left = c : n.leftWidth > a.leftWidth && (d = n.leftWidth - a.left - i.clientWidth, p.left = c < d ? c : d), s = n.top - a.top, n.top < a.top ? p.top = s : n.topHeight > a.topHeight && (l = n.topHeight - a.top - i.clientHeight, p.top = s < l ? s : l), p)
                        },
                        Pc: function(e, t, i) {
                            var o = i.options.uiCSS;
                            e.initialized = !0, t.addClass(["gcui-superpanel", o.widget, o.content].join(" ")), i.Rc(i, t), i.Wc(i, e, t), i._trigger("painted"), i.rd()
                        },
                        rd: function() {
                            var e = this.options,
                                t = e.hScroller,
                                i = e.vScroller,
                                o = t.scrollValue,
                                n = i.scrollValue,
                                r = this.Pb(),
                                a = o ? this.sd(o, "h") : 0,
                                s = n ? this.sd(n, "v") : 0;
                            o && r.stateContainer.prop("scrollLeft", a), n && r.stateContainer.prop("scrollTop", s)
                        },
                        tc: function(e, t) {
                            var i = this.scrollPxToValue(e, t),
                                o = this.options,
                                n = "h" === t ? "hScroller" : "vScroller",
                                r = u.Event("scrollValueChanged");
                            o[n].scrollValue = i, this._trigger("scrollValueChanged", r, { dir: t, value: i })
                        },
                        scrollPxToValue: function(e, t) {
                            var i = this.options,
                                o = "h" === t ? "width" : "height",
                                n = "h" === t ? "contentWidth" : "contentHeight",
                                r = "h" === t ? "hScroller" : "vScroller",
                                a = this.Pb(),
                                s = a.stateContainer,
                                l = a[n],
                                c = s[o](),
                                d = i[r].scrollMin,
                                p = i[r].scrollMax,
                                u = p - d,
                                h = u * e / (l - c) + d;
                            return h
                        },
                        sd: function(e, t) {
                            var i = this.options,
                                o = "h" === t ? "width" : "height",
                                n = "h" === t ? "contentWidth" : "contentHeight",
                                r = "h" === t ? "hScroller" : "vScroller",
                                a = this.Pb(),
                                s = a.stateContainer,
                                l = a[n],
                                c = s[o](),
                                d = i[r].scrollMin,
                                p = i[r].scrollMax,
                                u = p - d,
                                h = (e - d) * (l - c) / u;
                            return h
                        },
                        qd: function(e) {
                            var t = this,
                                i = t.element,
                                o = t.options,
                                n = o.animationOptions,
                                r = t.Pb();
                            r.stateContainer.animate(e, n)
                        },
                        destroy: function() {
                            var e = this,
                                t = e.element,
                                i = e.options,
                                o = e.Pb(),
                                n, r = i.uiCSS;
                            e.disabledDiv && (e.disabledDiv.remove(), e.disabledDiv = null), void 0 !== o.resizer && o.resizer.resizable("destroy"), t.unbind("." + e.widgetName), t.removeClass(["gcui-superpanel", r.widget, r.content, r.cornerAll].join(" ")), n = o.contentWrapper, n.contents().each(function(e, i) { t.append(i) }), o.stateContainer.remove(), u.Widget.prototype.destroy.apply(e, arguments)
                        },
                        doScrolling: function(e, t) { this.kc(e, this, t) },
                        paintPanel: function(e) {
                            var t = this,
                                i = t.element,
                                o = t.Pb();
                            o.initialized || this.Pc(o, i, t)
                        },
                        needToScroll: function(e) { var t = this.Mc(e); return null !== t.top || null !== t.left },
                        scrollChildIntoView: function(e) {
                            var t = this.Mc(e),
                                i = t.left,
                                o = t.top;
                            this.scrollTo(i, o)
                        },
                        getContentElement: function() { return this.Pb().contentWrapper },
                        hScrollTo: function(e, t) {
                            var i = t ? this.sd(e) : e;
                            this.tc(i, "h"), this.qd({ scrollLeft: i })
                        },
                        vScrollTo: function(e, t) {
                            var i = t ? this.sd(e) : e;
                            this.tc(i, "v"), this.qd({ scrollTop: i })
                        },
                        refresh: function() {
                            var e = this,
                                t = e.Pb();
                            e.nd(t.stateContainer), e.od()
                        },
                        scrollTo: function(e, t, i) {
                            var o = i ? this.sd(e) : e,
                                n = i ? this.sd(t) : t;
                            this.tc(o, "h"), this.tc(n, "v"), this.qd({ scrollTop: n, scrollLeft: o })
                        }
                    }), t.prototype.options = u.extend(!0, {}, e.gcuiWidget.prototype.options, { mobileCSS: { header: "ui-header ui-bar-a", content: "ui-body-c", stateDefault: "ui-btn-up-c", stateHover: "ui-btn-down-c", stateActive: "ui-btn-down-c" }, initSelector: ":jqmData(role='superpanel')", allowResize: !1, animationOptions: { queue: !1, disabled: !1, duration: 250, easing: void 0 }, hScroller: { scrollBarVisibility: "auto", scrollValue: null, scrollMax: 100, firstStepChangeFix: 0, scrollMin: 0, hoverEdgeSpan: 20 }, keyboardSupport: !1, keyDownInterval: 100, mouseWheelSupport: !0, resizableOptions: { handles: "all", helper: "ui-widget-content gcui-superpanel-helper" }, resized: null, painted: null, scroll: null, showRounder: !0, vScroller: { scrollBarVisibility: "auto", scrollValue: null, scrollMax: 100, scrollMin: 0, firstStepChangeFix: 0, hoverEdgeSpan: 20 } }), u.gcui.registerWidget("superpanel", t.prototype)) : (s = "<div class='gcui-superpanel-statecontainer'><div class='gcui-superpanel-contentwrapper'><div class='gcui-superpanel-templateouterwrapper'></div></div></div>", l = "<div class='gcui-superpanel-hbarcontainer {header}'><div class='gcui-superpanel-handle {stateDefault} {cornerAll}'><span class='{icon} {iconVGripSolid}'></span></div><div class='gcui-superpanel-hbar-buttonleft {stateDefault} {cornerBL}'><span class='{icon} {iconArrowLeft}'></span></div><div class='gcui-superpanel-hbar-buttonright {stateDefault} {cornerBR}'><span class='{icon} {iconArrowRight}'></span></div></div>", c = "<div class='gcui-superpanel-vbarcontainer {header}'><div class='gcui-superpanel-handle {stateDefault} {cornerAll}'><span class='{icon} {iconHGripSolid}'></span></div><div class='gcui-superpanel-vbar-buttontop {stateDefault} {cornerTR}'><span class='{icon} {iconArrowUp}'></span></div><div class='gcui-superpanel-vbar-buttonbottom {stateDefault} {cornerBR}'><span class='{icon} {iconArrowDown}'></span></div></div>", d = "<div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonleft'><span class='{icon} {iconCaratLeft}'></span></div><div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonright'><span class='{icon} {iconCaratRight}'></span></div>", p = "<div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttontop'><span class='{icon} {iconCaratUp}'></span></div><div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonbottom'><span class='{icon} {iconCaratDown}'> </span></div>", o = "gcui-superpanel-handle", n = "gcui-superpanel-hbarcontainer", r = "gcui-superpanel-vbarcontainer", a = "", t.prototype = u.extend(!0, {}, u.Widget.prototype, {
                        widgetEventPrefix: "gcuisuperpanel",
                        _setOption: function(e, t) {
                            var i = this,
                                o = i.options,
                                n = i.Pb(),
                                r = n.hbarDrag,
                                a = n.vbarDrag,
                                s = n.resizer;
                            switch ("animationOptions" === e ? t = u.extend(o.animationOptions, t) : "hScroller" === e ? (void 0 !== t.scrollLargeChange && null !== t.scrollLargeChange && (i.Qb = !1), t = u.extend(o.hScroller, t), i.refresh()) : "vScroller" === e ? (void 0 !== t.scrollLargeChange && null !== t.scrollLargeChange && (i.Rb = !1), t = u.extend(o.vScroller, t), i.refresh()) : "resizableOptions" === e && (t = u.extend(i.resizableOptions, t)), u.Widget.prototype._setOption.apply(i, arguments), u.isPlainObject(t) && (i.options[e] = t), e) {
                                case "allowResize":
                                    i.Sb();
                                    break;
                                case "disabled":
                                    t ? (void 0 !== r && r.draggable("disable"), void 0 !== a && a.draggable("disable"), void 0 !== s && s.resizable("disable")) : (void 0 !== r && r.draggable("enable"), void 0 !== a && a.draggable("enable"), void 0 !== s && s.resizable("enable"));
                                    break;
                                case "mouseWheelSupport":
                                case "keyboardSupport":
                                    i.Tb(i, n, i.element, o)
                            }
                            return i
                        },
                        _create: function() {
                            var e = this,
                                t = e.options;
                            t.vScroller.dir = "v", t.hScroller.dir = "h", e.Ub(), e.paintPanel(), e.Sb(), e.options.disabled && e.disable(), e.Vb(), t.listenContentScroll && e.Wb(), e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() { e.element.removeVisibilityObserver && e.element.removeVisibilityObserver(), e.refresh() }, "gcuisuperpanel")
                        },
                        Ub: function() {
                            var e = this.options.uiCSS,
                                t = /\{(\w+?)\}/gi,
                                i = function(t, i) { return e[i] };
                            a = e.stateActive, l = l.replace(t, i), c = c.replace(t, i), d = d.replace(t, i), p = p.replace(t, i)
                        },
                        Vb: function() {
                            var e = this,
                                t = u.gcui.superpanel.panels;
                            void 0 === t && (t = [], u.gcui.superpanel.panels = t), t.push(e), e.options.autoRefresh && (u.gcui.superpanel.setAutoRefreshInterval || (u.gcui.superpanel.setAutoRefreshInterval = e.Xb, u.gcui.superpanel.setAutoRefreshInterval()))
                        },
                        Xb: function() {
                            var e = u.gcui.superpanel.autoRereshInterval,
                                t = u.gcui.superpanel.panels,
                                i;
                            i = window.setInterval(function() {
                                window.clearInterval(i);
                                var e = t.length,
                                    o = !1,
                                    n, r, a, s, l, c;
                                for (n = 0; n < e; n++) r = t[n], a = r.element[0], s = r.options.autoRefresh, s && (o = !0), l = r.getContentElement(), c = r.Yb, s && l.is(":visible") && (void 0 === c || c.width !== l[0].offsetWidth || c.height !== l[0].offsetHeight || c.mainWidth !== a.offsetWidth || c.mainHeight !== a.offsetHeight) && r.paintPanel();
                                o && window.setTimeout(u.gcui.superpanel.setAutoRefreshInterval, 0)
                            }, void 0 === e ? 500 : e)
                        },
                        destroy: function() {
                            var e = this,
                                t = e.Pb(),
                                i = e.element,
                                o, n, r = e.options.uiCSS;
                            u.gcui.superpanel.panels = u.grep(u.gcui.superpanel.panels, function(t) { return t !== e }, !1), t.initialized && (e.Zb && e.element.css(e.Zb, ""), void 0 !== t.intervalID && (window.clearInterval(t.intervalID), t.intervalID = void 0), void 0 !== t.resizer && t.resizer.resizable("destroy"), void 0 !== t.hbarContainer && (t.hbarDrag.remove(), t.hbarContainer.unbind("." + e.widgetName)), void 0 !== t.vbarContainer && (t.vbarDrag.remove(), t.vbarContainer.unbind("." + e.widgetName)), i.unbind("." + e.widgetName), t.contentWrapper.unbind("." + e.widgetName), o = t.stateContainer.find(">.gcui-superpanel-button"), o.unbind("." + e.widgetName), n = t.templateWrapper, n.contents().each(function(e, t) { i.append(t) }), t.stateContainer.remove(), t.tabindex && i.removeAttr("tabindex"), i.removeClass(["gcui-superpanel", r.widget, r.content, r.cornerAll].join(" ")), u.Widget.prototype.destroy.apply(e, arguments))
                        },
                        Pb: function() {
                            var e = this,
                                t = e.element,
                                i = e.widgetName + "-fields",
                                o = e.$b;
                            return void 0 === o && (o = {}, t.data(i, o), e.$b = o), o
                        },
                        _b: function(e, t) { var i = e.scrollMode.split(","); return i = u.map(i, function(e) { return u.trim(e).toLowerCase() }), u.inArray(t.toLowerCase(), i) > -1 },
                        Tb: function(e, t, i, o) {
                            var n = e._b(o.hScroller, "edge"),
                                r = e._b(o.vScroller, "edge"),
                                a = e.widgetName;
                            n || r ? void 0 === e.bc && (e.bc = !0, i.bind("mousemove." + a, e, e.cc), i.bind("mouseleave." + a, null, function() { e.dc() })) : (i.unbind("mousemove", e.cc), e.bc = void 0), o.mouseWheelSupport ? void 0 === e.ec && (e.ec = !0, i.bind("mousewheel." + a, e, e.fc)) : (i.unbind("mousewheel", e.fc), e.ec = void 0), o.keyboardSupport ? void 0 === e.gc && (e.gc = !0, i.bind("keydown." + a, e, e.hc)) : (i.unbind("keydown", e.hc), e.gc = void 0)
                        },
                        ic: function(e, t, i) {
                            var o = { dragHandle: i };
                            t._trigger("dragStop", e, o)
                        },
                        cc: function(e) {
                            if (!e.data.options.disabled) {
                                var t = e.data,
                                    i = t.options,
                                    o = i.hScroller,
                                    n = i.vScroller,
                                    r = u(e.currentTarget),
                                    a = t.Pb(),
                                    s = t._b(o, "edge"),
                                    l = t._b(n, "edge"),
                                    c = { X: e.pageX, Y: e.pageY },
                                    d = r.offset(),
                                    p = d.left,
                                    h = d.top,
                                    f = o.hoverEdgeSpan,
                                    g = n.hoverEdgeSpan,
                                    m = r.innerHeight(),
                                    b = r.innerWidth(),
                                    v = "";
                                p = c.X - p, h = c.Y - h, t.dc(), s && (p < f && (v = "left"), p > b - f && (v = "right")), l && (h < g && (v = "top"), h > m - g && (v = "bottom")), t.jc(a, v, t, !1)
                            }
                        },
                        jc: function(e, t, i, o) {
                            var n = i.options;
                            t.length > 0 && (e.internalFuncID = window.setInterval(function() { i.kc(t, i, o) }, n.keyDownInterval))
                        },
                        lc: function(e) {
                            var t = e.data,
                                i = t.options,
                                o = u(e.currentTarget);
                            i.disabled || o.hasClass(i.uiCSS.stateDisabled) || (o.bind("mouseout." + t.widgetName, t, t.oc).bind("mousedown." + t.widgetName, t, t.pc).bind("mouseup." + t.widgetName, t, t.qc).addClass(i.uiCSS.stateHover), t.rc(o, t, "buttonshover"))
                        },
                        rc: function(e, t, i) {
                            var o = "",
                                n = t.options,
                                r = t.Pb(),
                                a = t._b(n.hScroller, i),
                                s = t._b(n.vScroller, i);
                            e.hasClass("gcui-superpanel-buttonleft") && a ? o = "left" : e.hasClass("gcui-superpanel-buttonright") && a ? o = "right" : e.hasClass("gcui-superpanel-buttontop") && s ? o = "top" : e.hasClass("gcui-superpanel-buttonbottom") && s && (o = "bottom"), o.length > 0 && (t.dc(), t.kc(o, t, !0), t.jc(r, o, t, !0))
                        },
                        Wb: function() {
                            var e = this,
                                t = e.options,
                                i = e.Pb(),
                                o = i.hbarContainer,
                                n = i.hbarDrag,
                                r = i.vbarContainer,
                                a = i.vbarDrag,
                                s = i.templateWrapper,
                                l = i.contentWrapper,
                                c = l.width(),
                                d = l.height(),
                                p = s && s.offset(),
                                u = p && p.left,
                                h = p && p.top,
                                f = i.contentWidth,
                                g = i.contentHeight;
                            l.bind("scroll", function(i) {
                                var p = s.position(),
                                    u = p.left,
                                    h = p.top;
                                l.scrollTop(0).scrollLeft(0), s.css({ left: u, top: h }), u <= 0 && u > c - f && (e.tc(e.scrollPxToValue(-u, "h"), t.hScroller), e.uc("h", o, n, !0)), h <= 0 && h > d - g && (e.tc(e.scrollPxToValue(-h, "v"), t.vScroller), e.uc("v", r, a, !0))
                            })
                        },
                        pc: function(e) {
                            var t = e.data,
                                i = u(e.currentTarget),
                                o = t.options.uiCSS;
                            t.options.disabled || i.hasClass(o.stateDisabled) || (i.addClass(o.stateActive), t.rc(i, t, "buttons"))
                        },
                        qc: function(e) {
                            var t = e.data,
                                i = u(e.currentTarget);
                            i.removeClass(t.options.css.stateActive), t.dc()
                        },
                        oc: function(e) {
                            var t = e.data,
                                i = t.options.uiCSS,
                                o = u(e.currentTarget);
                            o.unbind("mouseout", t.oc).unbind("mousedown", t.pc).unbind("mouseup", t.qc).removeClass(i.stateHover).removeClass(i.stateActive), t.dc()
                        },
                        tc: function(e, t) {
                            var i = u.Event("scrollValueChanged");
                            t.scrollValue = e, this._trigger("scrollValueChanged", i, t)
                        },
                        hc: function(t) {
                            var i = t.data,
                                o = i.options,
                                n = t.shiftKey,
                                r = t.keyCode,
                                a = e.getKeyCodeEnum();
                            o.keyboardSupport && !o.disabled && (r === a.LEFT ? i.kc("left", i, n) : r === a.RIGHT ? i.kc("right", i, n) : r === a.UP ? i.kc("top", i, n) : r === a.DOWN && i.kc("bottom", i, n), t.stopPropagation(), t.preventDefault())
                        },
                        vc: function(e, t, i, o) {
                            var n = i.dir,
                                r = "h" === n,
                                a = r ? "left" : "top",
                                s = e.position[a] - t.wc(a),
                                l = t.xc(n) - o[r ? "outerWidth" : "outerHeight"](!0),
                                c = s / l,
                                d = i.scrollMax - i.scrollLargeChange + 1,
                                p = c * d,
                                u, h, f;
                            p < i.scrollMin && (p = i.scrollMin), p > d && (p = d), u = { oldValue: i.scrollValue, newValue: p, dir: n }, t.yc(!0, t, u) && (t.customScroll && (f = Math.abs(t.customScroll), h = t.scrollPxToValue(f, i.dir)), t.tc(h || p, i), t.customScroll = void 0, t.zc(!0, !1, n, "dragging"))
                        },
                        Ac: function(e, t, i) {
                            var o = i.options,
                                r = u(e.target),
                                a = r.parent();
                            a.hasClass(n) ? i.vc(t, i, o.hScroller, r) : i.vc(t, i, o.vScroller, r)
                        },
                        fc: function(e, t) {
                            var i = e.data,
                                o = i.options,
                                r, a = "",
                                s, l = o.hScroller,
                                c = o.vScroller,
                                d;
                            o.mouseWheelSupport && !o.disabled && (r = u(e.srcElement || e.originalEvent.target), s = r.closest("." + n, i.element).size() > 0, a = t > 0 ? s ? "left" : "top" : s ? "right" : "bottom", a.length > 0 && i.kc(a, i), d = !1, "left" === a && (d = !i.hNeedScrollBar || Math.abs(l.scrollValue - l.scrollMin) < .001), "right" === a && (d = !i.hNeedScrollBar || Math.abs(l.scrollValue - (l.scrollMax - i.Bc() + 1)) < .001), "top" === a && (d = !i.vNeedScrollBar || Math.abs(c.scrollValue - c.scrollMin) < .001), "bottom" === a && (d = !i.vNeedScrollBar || Math.abs(c.scrollValue - (c.scrollMax - i.Cc() + 1)) < .001), d && o.bubbleScrollingEvent && "left" !== a && "right" !== a || (e.stopPropagation(), e.preventDefault()))
                        },
                        Dc: function(e) {
                            var t = e.data.self,
                                i = e.data.ele;
                            i.removeClass(t.options.uiCSS.stateActive), t.dc(), u(document).unbind("mouseup", t.Dc)
                        },
                        Ec: function(e) {
                            var t = e.data,
                                i = t.options,
                                o, a = null,
                                s = !1;
                            i.disabled || (o = u(e.srcElement || e.originalEvent.target || e.originalEvent.srcElement), o.hasClass(i.uiCSS.stateDefault) ? (a = o, s = !0) : o.parent().hasClass(i.uiCSS.stateDefault) ? (a = o.parent(), s = !0) : (o.hasClass(r) || o.hasClass(n)) && (a = o), a && (s && a.addClass(i.uiCSS.stateHover), a.bind("mouseout." + t.widgetName, t, t.Fc), a.bind("mousedown." + t.widgetName, t, t.Gc), a.bind("mouseup." + t.widgetName, t, t.Hc)))
                        },
                        Hc: function(e) {
                            var t = u(e.currentTarget);
                            t.removeClass(a)
                        },
                        Gc: function(e) {
                            var t = u(e.currentTarget),
                                i = e.data,
                                s, l, c = "",
                                d = !1,
                                p = !1,
                                h, f, g;
                            if (!i.options.disabled && 1 === e.which) {
                                if (t.hasClass("gcui-superpanel-vbar-buttontop")) c = "top", p = !0;
                                else if (t.hasClass("gcui-superpanel-vbar-buttonbottom")) c = "bottom", p = !0;
                                else if (t.hasClass("gcui-superpanel-hbar-buttonleft")) c = "left", p = !0;
                                else if (t.hasClass("gcui-superpanel-hbar-buttonright")) c = "right", p = !0;
                                else {
                                    if (t.hasClass(o)) return void t.addClass(a);
                                    t.hasClass(n) ? (s = t.find("." + o), h = s.offset(), c = e.pageX < h.left ? "left" : "right", d = !0) : t.hasClass(r) && (l = t.find("." + o), f = l.offset(), c = e.pageY < f.top ? "top" : "bottom", d = !0)
                                }
                                i.dc(), i.kc(c, i, d), g = i.Pb(), i.jc(g, c, i, d), p && t.addClass(a), u(document).bind("mouseup." + i.widgetName, { self: i, ele: t }, i.Dc)
                            }
                        },
                        doScrolling: function(e, t) { this.kc(e, this, t) },
                        Ic: function(e, t, i, o, n, r, a) {
                            var s = t.scrollMin,
                                l = r ? o : i,
                                c = t.scrollValue,
                                d = 0,
                                p, u, h, f, g;
                            if (c || (c = s), n) {
                                if (p = t.scrollMax - o + 1, Math.abs(c - p) < .001) return a.dc(), !1;
                                u = t.firstStepChangeFix, d = c + l, !r && Math.abs(c - s) < 1e-4 && !isNaN(u) && (d += u), d > p && (d = p)
                            } else {
                                if (Math.abs(c - s) < .001) return a.dc(), !1;
                                d = c - l, d < 0 && (d = s)
                            }
                            return h = { oldValue: t.scrollValue, newValue: d, direction: e, dir: t.dir }, !!a.yc(!0, a, h) && (a.customScroll && (g = Math.abs(a.customScroll), f = a.scrollPxToValue(g, t.dir)), a.tc(f || d, t), a.customScroll = void 0, !0)
                        },
                        kc: function(e, t, i) {
                            var o = t.options,
                                n = o.vScroller,
                                r = o.hScroller,
                                a = t.Jc(),
                                s = t.Cc(),
                                l = t.Bc(),
                                c = t.Kc();
                            if ("top" === e || "bottom" === e) {
                                if (!t.Ic(e, n, a, s, "bottom" === e, i, t)) return;
                                e = "v"
                            } else if ("left" === e || "right" === e) {
                                if (!t.Ic(e, r, c, l, "right" === e, i, t)) return;
                                e = "h"
                            }
                            t.zc(!0, !0, e)
                        },
                        Lc: function(e) {
                            var t = e.Pb(),
                                i = e.options,
                                o = t.buttonLeft,
                                n = t.buttonRight,
                                r = t.buttonTop,
                                a = t.buttonBottom,
                                s, l, c, d, p, u, h, f;
                            t.intervalID > 0 && window.clearInterval(t.intervalID), void 0 !== o && (s = e.Bc(), l = i.hScroller.scrollMax - s + 1, c = i.hScroller.scrollValue, d = i.hScroller.scrollMin, void 0 === c && (c = d), Math.abs(c - d) < .001 || !t.hScrolling ? o.addClass(i.uiCSS.stateDisabled) : o.removeClass(i.uiCSS.stateDisabled), Math.abs(c - l) < .001 || !t.hScrolling ? n.addClass(i.uiCSS.stateDisabled) : n.removeClass(i.uiCSS.stateDisabled)), void 0 !== r && (p = e.Cc(), u = i.vScroller.scrollMax - p + 1, h = i.vScroller.scrollValue, f = i.vScroller.scrollMin, void 0 === h && (h = f), Math.abs(h - f) < .001 || !t.vScrolling ? r.addClass(i.uiCSS.stateDisabled) : r.removeClass(i.uiCSS.stateDisabled), Math.abs(h - u) < .001 || !t.vScrolling ? a.addClass(i.uiCSS.stateDisabled) : a.removeClass(i.uiCSS.stateDisabled))
                        },
                        dc: function() {
                            var e = this.Pb(),
                                t = e.internalFuncID;
                            t > 0 && (window.clearInterval(t), e.internalFuncID = -1)
                        },
                        Fc: function(e) {
                            var t = u(e.currentTarget),
                                i = e.data;
                            t.unbind("mouseout", i.Fc), t.unbind("mousedown", i.Gc), t.unbind("mouseup", i.Hc), t.removeClass(i.options.uiCSS.stateHover)
                        },
                        Mc: function(e) {
                            var t = u(e),
                                i = this.Pb(),
                                o = i.contentWrapper,
                                n = i.templateWrapper,
                                r, a, s, l, c, d, p, h = { left: null, top: null };
                            return 0 === t.length ? h : (r = t.offset(), a = n.offset(), r.leftWidth = r.left + t.outerWidth(), r.topHeight = r.top + t.outerHeight(), s = o.offset(), s.leftWidth = s.left + o.outerWidth(), s.topHeight = s.top + o.outerHeight(), d = r.left - a.left, r.left < s.left ? h.left = d : r.leftWidth > s.leftWidth && (p = r.leftWidth - a.left - o.innerWidth(), h.left = d < p ? d : p), l = r.top - a.top, r.top < s.top ? h.top = l : r.topHeight > s.topHeight && (c = r.topHeight - a.top - o.innerHeight(), h.top = l < c ? l : c), h)
                        },
                        uc: function(e, t, i, o) {
                            var n = this,
                                r = n.options,
                                a = "v" === e,
                                s = a ? r.vScroller : r.hScroller,
                                l = s.scrollMin,
                                c = s.scrollMax,
                                d = void 0 === s.scrollValue ? l : s.scrollValue - l,
                                p = n.Nc(e),
                                u = c - l - p + 1,
                                h = -1,
                                f, g, m;
                            d > u && (d = u), void 0 !== t && (f = n.xc(e), g = i[a ? "outerHeight" : "outerWidth"](), m = n.wc(a ? "top" : "left"), h = d / u * (f - g) + m), h >= 0 && i.css(a ? "top" : "left", h + "px"), n.Oc(o, n, e)
                        },
                        needToScroll: function(e) { var t = this.Mc(e); return null !== t.top || null !== t.left },
                        scrollChildIntoView: function(e) {
                            var t = this.Mc(e),
                                i = t.left,
                                o = t.top;
                            null !== i && this.hScrollTo(i), null !== o && this.vScrollTo(o)
                        },
                        hScrollTo: function(e, t) {
                            var i = this.options;
                            this.tc(t ? e : this.scrollPxToValue(e, "h"), i.hScroller), this.zc(!0, !0, "h", "nonestop")
                        },
                        vScrollTo: function(e, t) {
                            var i = this.options;
                            this.tc(t ? e : this.scrollPxToValue(e, "v"), i.vScroller), this.zc(!0, !0, "v", "nonestop")
                        },
                        scrollPxToValue: function(e, t) {
                            var i = this.options,
                                o = "h" === t ? "outerWidth" : "outerHeight",
                                n = "h" === t ? "contentWidth" : "contentHeight",
                                r = "h" === t ? "hScroller" : "vScroller",
                                a = this.Pb(),
                                s = a.contentWrapper,
                                l = a[n],
                                c = s[o](),
                                d = i[r].scrollMin,
                                p = i[r].scrollMax,
                                u = p - d,
                                h = "h" === t ? this.Bc() : this.Cc(),
                                f = u - h + 1,
                                g = f * (e / (l - c));
                            return g < d && (g = d), g > f && (g = f), g
                        },
                        scrollTo: function(e, t, i) { this.hScrollTo(e, i), this.vScrollTo(t, i) },
                        refresh: function() { this.paintPanel() },
                        paintPanel: function(e) {
                            var t = this,
                                i = t.element,
                                o, n, r, a;
                            return !!i.is(":visible") && (o = "unknown" != typeof document.activeElement ? document.activeElement : void 0, n = t.options, r = t.Pb(), r.initialized || t.Pc(r, i, t), t.Qc(t, r, n), t.Tb(t, r, i, n), a = r.templateWrapper, a.css({ float: "left", left: "0px", top: "0px", width: "auto", height: "auto" }), a.hide(), a.show(), r.contentWidth = a.width(), r.contentHeight = a.height(), a.css("float", ""), t.Rc(t, i), t.Sc(r, i), !1 !== t.Tc(t, r, n) && (t.Uc(t, r, n), t.Vc(t, r, n), t._trigger("painted"), t.Yb = { date: new Date, mainWidth: i[0].offsetWidth, mainHeight: i[0].offsetHeight, width: r.contentWidth, height: r.contentWidth }, void 0 === o || e || u(o).focus(), !0))
                        },
                        Qc: function(e, t, i) {
                            var n;
                            e.Rb && (i.vScroller.scrollLargeChange = null), e.Qb && (i.hScroller.scrollLargeChange = null), t.vTrackLen = void 0, t.hTrackLen = void 0, t.vbarContainer && (n = t.vbarContainer.children("." + o + ":eq(0)"), n.detach(), t.vbarContainer.remove(), t.vbarContainer = void 0), t.hbarContainer && (n = t.hbarContainer.children("." + o + ":eq(0)"), n.detach(), t.hbarContainer.remove(), t.hbarContainer = void 0)
                        },
                        Pc: function(e, t, i) {
                            var o, n = i.options.uiCSS;
                            e.initialized = !0, t.addClass(["gcui-superpanel", n.widget, n.content].join(" ")), e.oldHeight = t.css("height"), o = t.css("overflow"), t.css("overflow", ""), t.height(t.height()), t.css("overflow", o), i.Wc(i, e, t)
                        },
                        getContentElement: function() { return this.Pb().templateWrapper },
                        Xc: function(e, t, i, o, n, r, a) {
                            var s = "h" === o,
                                l = "mouseover." + e.widgetName,
                                c = s ? "buttonLeft" : "buttonTop",
                                h = s ? "buttonRight" : "buttonBottom",
                                f = r[c],
                                g = r[h],
                                m, b, v;
                            e._b(i, "buttons") || e._b(i, "buttonshover") ? (m = s ? d : p, void 0 === f && (b = u(m).appendTo(a), b.bind(l, e, e.lc), r[c] = f = a.children(s ? ".gcui-superpanel-buttonleft" : ".gcui-superpanel-buttontop"), r[h] = g = a.children(s ? ".gcui-superpanel-buttonright" : ".gcui-superpanel-buttonbottom")), v = { my: s ? "left" : "top", of: n, at: s ? "left" : "top", collision: "none" }, u.extend(v, i.decreaseButtonPosition), f.position(v), v = { my: s ? "right" : "bottom", of: n, at: s ? "right" : "bottom", collision: "none" }, u.extend(v, i.increaseButtonPosition), g.position(v)) : void 0 !== f && (f.remove(), g.remove(), r[c] = r[h] = void 0)
                        },
                        Vc: function(e, t, i) {
                            var o = t.contentWrapper,
                                n = t.stateContainer;
                            e.Xc(e, i, i.hScroller, "h", o, t, n), e.Xc(e, i, i.vScroller, "v", o, t, n)
                        },
                        Jc: function() {
                            var e = this.options,
                                t;
                            return e.vScroller.scrollSmallChange || (t = this.Cc(), e.vScroller.scrollSmallChange = t / 2), e.vScroller.scrollSmallChange
                        },
                        Cc: function() { return this.Nc("v") },
                        Nc: function(e) {
                            var t = this,
                                i = t.options,
                                o = t.Pb(),
                                n = "v" === e,
                                r = n ? i.vScroller : i.hScroller,
                                a = n ? "innerHeight" : "innerWidth",
                                s = n ? "contentHeight" : "contentWidth",
                                l = n ? "_autoVLarge" : "_autoHLarge",
                                c, d, p, u, h, f, g, m;
                            return r.scrollLargeChange ? r.scrollLargeChange : (c = r.scrollMax, d = r.scrollMin, p = c - d, u = o.contentWrapper, h = u[a](), f = o[s], g = h / (f - h), m = (p + 1) * g / (1 + g), isNaN(m) && (m = 0), r.scrollLargeChange = m, t[l] = !0, r.scrollLargeChange)
                        },
                        Kc: function() {
                            var e = this.options,
                                t;
                            return e.hScroller.scrollSmallChange || (t = this.Bc(), e.hScroller.scrollSmallChange = t / 2), e.hScroller.scrollSmallChange
                        },
                        Bc: function() { return this.Nc("h") },
                        Uc: function(e, t, i) {
                            var o = i.hScroller,
                                n = o.scrollMax,
                                r = o.scrollMin,
                                a = n - r,
                                s = i.vScroller,
                                l = s.scrollMax,
                                c = s.scrollMin,
                                d = l - c,
                                p = t.hbarDrag,
                                h = t.vbarDrag,
                                f, g, m, b, v, y, w, x, C, S;
                            e.hNeedScrollBar && p.is(":visible") && (f = e.Bc(), g = e.xc("h"), m = e.Yc(a, f, g, i.hScroller.scrollMinDragLength), p.width(m), b = p.outerWidth(!0) - p.width(), p.width(m - b), v = p.children("span"), v.css("margin-left", (p.width() - v[0].offsetWidth) / 2), g <= p.outerWidth(!0) ? p.hide() : p.show(), 1 == e.Zc && (u(document).trigger("mouseup"), e.Zc = !1)), e.vNeedScrollBar && h.is(":visible") && (y = e.Cc(), w = e.xc("v"), x = e.Yc(d, y, w, i.vScroller.scrollMinDragLength), h.height(x), C = h.outerHeight(!0) - h.height(), h.height(x - C), S = h.children("span"), S.css("margin-top", (h.height() - S[0].offsetHeight) / 2), w <= h.outerHeight(!0) ? h.hide() : h.show(), 1 == e.Zc && (u(document).trigger("mouseup"), e.Zc = !1)), e.zc(!1, !1, "both")
                        },
                        xc: function(e) {
                            var t = this,
                                i = t.Pb(),
                                o = e + "TrackLen",
                                n = i.hbarContainer,
                                r = i.vbarContainer,
                                a = 0,
                                s = 0;
                            return void 0 !== i[o] ? i[o] : ("h" === e && (s = t.wc("h"), a = n.innerWidth()), "v" === e && (s = t.wc("v"), a = r.innerHeight()), i[o] = a - s, i[o])
                        },
                        wc: function(e) {
                            var t = this,
                                i = t.Pb(),
                                o = 0,
                                n, r;
                            if ("h" === e) o = t.wc("left") + t.wc("right");
                            else if ("v" === e) o = t.wc("top") + t.wc("bottom");
                            else {
                                if (n = "left" === e || "right" === e ? i.hbarContainer : i.vbarContainer, r = e + "Padding", void 0 !== i[r]) return o = i[r];
                                n && n.css && (o = parseFloat(n.css("padding-" + e))), i[r] = o
                            }
                            return o
                        },
                        $c: function(e, t, i) {
                            var o = { position: e, dir: t, animationOptions: i };
                            this._trigger("scroll", null, o)
                        },
                        _c: function(e, t, i, o, n, r, a) {
                            var s = this,
                                l = s.options,
                                c = "v" === e,
                                d = c ? l.vScroller : l.hScroller,
                                p = c ? "outerHeight" : "outerWidth",
                                h = c ? "innerHeight" : "innerWidth",
                                f = c ? "contentHeight" : "contentWidth",
                                g = c ? "top" : "left",
                                m = d.scrollMin,
                                b = d.scrollMax,
                                v = b - m,
                                y = void 0 === d.scrollValue ? m : d.scrollValue - m,
                                w = s.Nc(e),
                                x = v - w + 1,
                                C = s.Pb(),
                                S = C.contentWrapper,
                                k = C.templateWrapper,
                                T, A, E, I, D, $, L, F, R, B, O, P;
                            y > x && (y = x), T = (C[f] - S[h]()) * (y / x), Math.abs(T) < .001 && (T = 0), T = Math.round(T), A = -1, void 0 !== i && (t && o.is(":animated") && "nonestop" !== n && o.stop(!0, !1), E = s.xc(e), I = o[p](!0), D = E - I, $ = s.wc(g), A = y / x * D + $), t && l.animationOptions && !l.animationOptions.disabled ? (A >= 0 && "dragging" !== a && (L = u.extend({}, l.animationOptions), L.complete = void 0, F = c ? { top: A } : { left: A }, o.animate(F, L)), R = u.extend({}, l.animationOptions), B = l.animationOptions.complete, R.complete = function() { s.Oc(r, s, e), u.isFunction(B) && B(arguments) }, t && k.is(":animated") && "nonestop" !== n && k.stop(!0, !1), O = c ? { top: -T } : { left: -T }, l.customScrolling ? s.Oc(r, s, e, y) : k.animate(O, R), s.$c(T, e, R)) : "hidden" !== d.scrollBarVisibility && (P = c ? "top" : "left", A >= 0 && "dragging" !== a && (o[0].style[P] = A + "px"), l.customScrolling || (k[0].style[P] = -T + "px"), s.$c(T, e), s.Oc(r, s, e, y))
                        },
                        zc: function(e, t, i, o, n) {
                            var r = this,
                                a = r.Pb(),
                                s = a.hbarContainer,
                                l = a.hbarDrag,
                                c = a.vbarContainer,
                                d = a.vbarDrag;
                            "both" !== i && "h" !== i || !a.hScrolling || r._c("h", t, s, l, o, e, n), "both" !== i && "v" !== i || !a.vScrolling || r._c("v", t, c, d, o, e, n), a.intervalID > 0 && window.clearInterval(a.intervalID), a.intervalID = window.setInterval(function() { r.Lc(r) }, 500)
                        },
                        yc: function(e, t, i) { var o = !0; return e && (i.beforePosition = t.getContentElement().position(), t.ad = i.beforePosition, o = t._trigger("scrolling", null, i), t.customScroll = i.customScroll), o },
                        Oc: function(e, t, i, o) {
                            e && window.setTimeout(function() {
                                var e = t.getContentElement(),
                                    n, r;
                                e.is(":visible") && (n = t.getContentElement().position(), r = { dir: i, beforePosition: t.ad, afterPosition: n }, isNaN(o) || (r.newValue = o), t._trigger("scrolled", null, r))
                            }, 0)
                        },
                        Yc: function(e, t, i, o) {
                            var n = e / t,
                                r = i / n,
                                a = o;
                            return r < a ? r = a : r + 1 >= i && (r = i - 1), Math.round(r)
                        },
                        bd: function(e, t) {
                            var i = this._b(e, "scrollbar"),
                                o = e.scrollBarVisibility,
                                n = i && ("visible" === o || "auto" === o && t);
                            return n
                        },
                        dd: function(e, t, i) {
                            var o = this;
                            e.bind("mouseover." + o.widgetName, o, o.Ec), u.fn.draggable && t.draggable({
                                axis: "h" === i ? "x" : "y",
                                start: function(e, t) {
                                    if (o.options.disabled) return !1;
                                    o.Zc = !0
                                },
                                drag: function(e, t) { o.Ac(e, t, o) },
                                containment: "parent",
                                stop: function(e) { o.ic(e, o, i), u(e.target).removeClass(a), o.Zc = !1 }
                            })
                        },
                        ed: function(e, t, i, n, r) {
                            if (e) {
                                var a = this,
                                    s, l = a.Pb(),
                                    c = i + "barContainer",
                                    d = i + "barDrag",
                                    p = "h" === i,
                                    h = r[p ? "innerHeight" : "innerWidth"](),
                                    f = l[c] = u(n),
                                    g, m;
                                if (t.append(f), g = f[0][p ? "offsetHeight" : "offsetWidth"], h -= g, s = { direction: p ? "horizontal" : "vertical", targetBarLen: g, contentLength: h }, !1 === a._trigger(p ? "hScrollerActivating" : "vScrollerActivating", null, s)) return !1;
                                m = l[d] = f.find("." + o), a.dd(f, m, i), r[p ? "height" : "width"](h)
                            }
                        },
                        fd: function(e, t, i, o, n, r, a, s, l, c, d) {
                            var p = "h" === c,
                                u, h, f, g, m, b, v, y, w, x = t.options.uiCSS;
                            r ? (u = o[0][p ? "offsetHeight" : "offsetWidth"], h = t.wc(c), f = p ? "top" : "left", g = p ? { top: "0px", bottom: "auto", left: "auto", right: "auto" } : { left: "0px", right: "auto", top: "auto", bottom: "auto" }, m = p ? { top: u + "px", left: null } : { left: u + "px" }, b = p ? { top: "auto", right: "auto", left: "auto", bottom: "0px" } : { left: "auto", right: "0px", top: "auto", bottom: "auto" }, v = p ? { top: "", left: null } : { left: "" }, y = i[p ? "innerWidth" : "innerHeight"](), s === f ? (o.css(g), i.css(m), p ? (o.children(".gcui-superpanel-hbar-buttonleft").removeClass(x.cornerBL).addClass(x.cornerTL), o.children(".gcui-superpanel-hbar-buttonright").removeClass(x.cornerBR).addClass(x.cornerTR), o.removeClass(x.cornerBottom).addClass(x.cornerTop)) : (o.children(".gcui-superpanel-vbar-buttontop").removeClass(x.cornerTR).addClass(x.cornerTL), o.children(".gcui-superpanel-vbar-buttonbottom").removeClass(x.cornerBR).addClass(x.cornerBL), o.removeClass(x.cornerRight).addClass(x.cornerLeft))) : (o.css(b), i.css(v), p ? (o.children(".gcui-superpanel-hbar-buttonleft").removeClass(x.cornerTL).addClass(x.cornerBL), o.children(".gcui-superpanel-hbar-buttonright").removeClass(x.cornerBL).addClass(x.cornerBR), o.removeClass(x.cornerTop).addClass(x.cornerBottom)) : (o.children(".gcui-superpanel-vbar-buttontop").removeClass(x.cornerTL).addClass(x.cornerTR), o.children(".gcui-superpanel-vbar-buttonbottom").removeClass(x.cornerBL).addClass(x.cornerBR), o.removeClass(x.cornerLeft).addClass(x.cornerRight))), w = 0, a && (w = n[0][p ? "offsetWidth" : "offsetHeight"], "left" === l ? o.css("right", "0px") : "right" === l ? o.css("left", "0px") : "top" === l ? o.css("bottom", "0px") : "bottom" === l && o.css("top", "0px")), !p && a && (w = 0), o[p ? "width" : "height"](y - h), t.gd(c, o, !d)) : e.css(p ? "left" : "top", "")
                        },
                        Tc: function(e, t, i) {
                            var o = t.templateWrapper,
                                n = t.contentWrapper,
                                r = t.stateContainer,
                                a = n.innerWidth(),
                                s = n.innerHeight(),
                                d = t.contentWidth,
                                p = t.contentHeight,
                                u, h, f, g, m, b;
                            return t.hScrolling = d > a, t.vScrolling = p > s, u = e.hNeedScrollBar = e.bd(i.hScroller, t.hScrolling), !1 !== e.ed(u, r, "h", l, n) && (u && !t.vScrolling && (o.css("float", "left"), t.contentHeight = o.height(), t.vScrolling = t.contentHeight > s - t.hbarContainer[0].offsetHeight, o.css("float", "")), h = e.vNeedScrollBar = e.bd(i.vScroller, t.vScrolling), !1 !== e.ed(h, r, "v", c, n) && (!(h && !t.hScrolling && (o.css("float", "left"), t.contentWidth = o.width(), t.hScrolling = t.contentWidth > a - t.vbarContainer[0].offsetWidth, o.css("float", ""), t.hScrolling && !u && (u = e.hNeedScrollBar = e.bd(i.hScroller, t.hScrolling), !1 === e.ed(u, r, "h", l, n)))) && (f = t.hbarContainer, g = t.vbarContainer, m = i.hScroller.scrollBarPosition, b = i.vScroller.scrollBarPosition, e.fd(o, e, n, f, g, u, h, m, b, "h", t.hScrolling), void e.fd(o, e, n, g, f, h, u, b, m, "v", t.vScrolling))))
                        },
                        gd: function(e, t, i) { var n = this.options; "v" === e ? (t[i ? "addClass" : "removeClass"]("gcui-superpanel-vbarcontainer-disabled"), t.find("." + n.uiCSS.stateDefault)[i ? "addClass" : "removeClass"](n.uiCSS.stateDisabled)) : "h" === e && (t[i ? "addClass" : "removeClass"]("gcui-superpanel-hbarcontainer-disabled"), t.find("." + n.uiCSS.stateDefault)[i ? "addClass" : "removeClass"](n.uiCSS.stateDisabled)), t.children("." + o)[i ? "hide" : "show"]() },
                        Sb: function() {
                            var e = this,
                                t = e.options,
                                i = e.Pb(),
                                o = i.resizer,
                                n, r;
                            u.fn.resizable && (!o && t.allowResize && (n = t.resizableOptions, r = n.stop, n.stop = function(t) { e.hd(t, e), u.isFunction(r) && r(t) }, i.resizer = o = e.element.resizable(n)), !t.allowResize && i.resizer && (o.resizable("destroy"), i.resizer = null))
                        },
                        hd: function(e, t) { this.options.autoRefresh || t.paintPanel(!0), t._trigger("resized") },
                        Wc: function(e, t, i) {
                            i.attr("tabindex") || (i.attr("tabindex", "-1"), t.tabindex = !0);
                            var o = t.stateContainer = u(s),
                                n;
                            t.contentWrapper = o.children(), n = t.templateWrapper = t.contentWrapper.children(), i.contents().each(function(e, i) { var o = u(i); return o.hasClass("gcui-superpanel-header") ? void(t.header = o) : o.hasClass("gcui-superpanel-footer") ? void(t.footer = o) : void n[0].appendChild(i) }), void 0 !== t.header && i.prepend(t.header), i[0].appendChild(o[0]), void 0 !== t.footer && t.footer.insertAfter(o)
                        },
                        Rc: function(e, t) {
                            var i, o, n, r, a;
                            if (this.options.showRounder) {
                                if (t.addClass(this.options.uiCSS.cornerAll), e.jd) return;
                                if (i = GC.Spread.Sheets.util.browser, i.msie) return;
                                o = "", n = "", i.webkit ? (n = "WebkitBorderTopLeftRadius", o = "WebkitBorderRadius") : i.mozilla ? (n = "MozBorderRadiusBottomleft", o = "MozBorderRadius") : (n = "border-top-left-radius", o = "border-radius"), r = t.css(n), a = parseInt(r, 10), t.css(o, a + 1), e.jd = !0, e.Zb = o
                            } else t.removeClass(this.options.uiCSS.cornerAll)
                        },
                        Sc: function(e, t) {
                            var i = e.stateContainer,
                                o = e.contentWrapper,
                                n = 0,
                                r, a, s, l;
                            void 0 !== e.header && (n += e.header.outerHeight()), void 0 !== e.footer && (n += e.footer.outerHeight()), r = i[0].style, a = t.innerHeight() - n, s = t.innerWidth(), r.display = "none", r.height = a + "px", r.width = s + "px", l = o[0].style, l.height = a + "px", l.width = s + "px", r.display = ""
                        }
                    }), t.prototype.options = u.extend(!0, {}, e.gcuiWidget.prototype.options, new h), u.gcui.registerWidget("superpanel", t.prototype))
                }(e.superpanel || (e.superpanel = {}))
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o, n = jQuery;

                    function r(e, t) { var i = n.extend(!0, {}, e, t); return delete i.constructor, i } t.extendWidgetOptions = r, i = function(i) {
                        __extends(o, i);

                        function o() { i.apply(this, arguments), this.ud = 0, this.vd = { x: null, y: null, index: 0 }, this.wd = 0 }
                        return o.prototype.aa = function(t, o) {
                            var n = t && e.data.util.isClassInstance(t.data) && !("function" == typeof gcuidatasource && t.data instanceof gcuidatasource) && t.data;
                            n && delete t.data, i.prototype.aa.apply(this, arguments), n && (t.data = n, this.option("data", n))
                        }, o.prototype._create = function() {
                            var t, i, o, r, a = this;
                            if (!this.element.is("table")) throw "invalid markup";
                            this.wd = 0, this.ud = 0, this.vd = { x: null, y: null, index: 0 }, this.xd = !1, this.yd = !1, this.zd = !1, this.Ad = void 0, this.Bd = void 0, this.Cd = void 0, this.Dd = void 0, this.Ed = void 0, this.Fd = void 0, this.Gd = void 0, this.Hd = 0, this.$superPanelHeader = void 0, this.$topPagerDiv = void 0, this.$bottomPagerDiv = void 0, this.$groupArea = void 0, this.Id = void 0, this.Jd = void 0, this.outerDiv = void 0, this.sketchTable = void 0, this.cellFormatter = void 0, this.rowStyleFormatter = void 0, this.cellStyleFormatter = void 0, this.Ad = e.grid.getUID(), this.Kd = !1, this.deficientFilters = {}, t = "data" in this.options, i = t && this.options.data, t && delete this.options.data, this.options = n.extend(!0, {}, this.options), t && (this.options.data = i), window.applyTouchUtilEvents && (n = window.applyTouchUtilEvents(n)), n.isFunction(window.gcuiASPNetParseOptions) && window.gcuiASPNetParseOptions(this.options), this.xd = !1, this.yd = !1, this.Ld("closestCulture", Globalize.findClosestCulture(this.options.culture) || Globalize.findClosestCulture("default")), this.Bd = new e.grid.dataViewWrapper(this), this.Cd = this.element.html(), this.Dd = {}, this.Ed = this.element[0].style.cssText, this.element.addClass("gcui-gcuigrid-root"), this.element.wrap('<div class="' + this.options.uiCSS.widget + " gcui-gcuigrid " + this.options.uiCSS.content + " " + this.options.uiCSS.cornerAll + '"></div>'), this.outerDiv = this.element.parent(), o = this.element[0].style.height, r = this.element[0].style.width, o && this.outerDiv.css("height", o), this.Fd = "" == o || "auto" == o, r && this.outerDiv.css("width", this.element[0].style.width), this.Gd = "" == r || "auto" == r, this.element.css({ height: "", width: "" }), this.options.disabled && this.disable(), this.cellFormatter = new e.grid.cellFormatterHelper, this.rowStyleFormatter = new e.grid.rowStyleFormatterHelper(this), this.cellStyleFormatter = new e.grid.cellStyleFormatterHelper(this), this.Ld("viewRenderBounds", { start: 0, end: 0 }), this.Md() && (this.Ld("viewRenderBounds").start = this.vd.index, this.Nd() && (this.ud = this.vd.index)), this.element.addVisibilityObserver && this.element.addVisibilityObserver(function() { a.xd && !a.yd && a.setSize() }, "gcuigrid"), this.Hd = 0
                        }, o.prototype._a = function() { var t, i = this; try { this.Od().dispose(), this.Pd(!0), (t = this.Ld("resizer")) && t.dispose(), (t = this.Ld("frozener")) && t.dispose(), (t = this.Ld("selectionui")) && t.dispose(), (t = this.Ld("dragndrop")) && t.dispose(), this.Bd.dispose(), e.grid.remove$dataByPrefix(this.element, this.Qd), this.element.removeVisibilityObserver && this.element.removeVisibilityObserver(), this.element.insertBefore(this.outerDiv), this.outerDiv.remove(), this.element.html(this.Cd), n.each(this.Dd, function(e, t) { void 0 === t ? i.element.removeAttr(e) : i.element.attr(e, t) }), this.element.removeClass("gcui-gcuigrid-root"), this.element[0].style.cssText = this.Ed } finally { this.yd = !0 } }, o.prototype._init = function() { this.$superPanelHeader = null, this.$topPagerDiv = null, this.$bottomPagerDiv = null, this.$groupArea = null, this.Ld("closestCulture", Globalize.findClosestCulture(this.options.culture) || Globalize.findClosestCulture("default")), this.options.data || (this.Ld("thead") || this.Ld("thead", e.grid.readTableSection(this.element, 1)), this.Ld("tfoot") || this.Ld("tfoot", e.grid.readTableSection(this.element, 3))), this.xd = this.xd || !1, this.ensureControl(!0) }, o.prototype._setOption = function(e, t) {
                            var o = this["preset_" + e],
                                n = this.options[e],
                                r, a;
                            void 0 !== o && (t = o.apply(this, [t, n])), r = t !== n, i.prototype._setOption.apply(this, [e, t]), r && void 0 !== (a = this["postset_" + e]) && a.apply(this, [t, n])
                        }, o.prototype.columns = function() { return this.Ld("columns") || [] }, o.prototype.currentCell = function(t, i, o) {
                            var n, r = this.Od(),
                                a = this.Rd();
                            if (0 === arguments.length) return n = this.Ld("currentCell"), n || this.Ld("currentCell", n = e.grid.cellInfo.outsideValue), n;
                            if (n = "number" != typeof t ? t.Sd() : new e.grid.cellInfo(t, i), !n.isEqual(e.grid.cellInfo.outsideValue)) { if (!n.Td()) throw "invalid arguments"; if (n.Ud(this.Vd()), n.rowIndex() >= 0 && !(r.Wd(a.item(n.rowIndex())).type & e.grid.rowType.data)) return }
                            return n.Xd(this), this.Yd(null, n, { changeSelection: o || !1, setFocus: !1 }), this.Ld("currentCell")
                        }, o.prototype.data = function() { return this.Bd.dataView().getSource() }, o.prototype.dataView = function() { return this.Bd.dataView() }, o.prototype.doRefresh = function(t) { var i, o, r, a, s, l; if (n.isPlainObject(t) || (t = {}), o = this, r = e.grid.EXPANDO, a = t && t.virtualScrollData, !this.xd) try { this.Zd(this.options.columns, this.options.columnsAutogenerationMode, this.Bd.getFieldsInfo(), !0, !0) } catch (e) { throw e } finally { this.$d(!0), this.xd = !0 } a || (this._d(), s = this.Bd.data(), l = this.Bd.dataView(), n.each(this.Ld("leaves"), function() { this.ae = s.totals ? s.totals[this.dataKey] : void 0 }), this.sketchTable = [], s.data && s.data.length ? (i = this.Ld("leaves"), n.each(s.data, function(e, t) { o.sketchTable.push(o.be(t, i)) })) : s.emptyData && (i = this.Ld("visibleLeaves"), n.each(s.emptyData, function(e, t) { o.sketchTable.push(o.ce(t, i, e === s.emptyData.length - 1)) }))), this.de(t), a ? this.ee(t) : this.$a(t), this.fe(t), t && n.isFunction(t.afterRefresh) && t.afterRefresh.apply(this, [t]) }, o.prototype.beginEdit = function() { return this.ge(null) }, o.prototype.endEdit = function() { return this.he(null) }, o.prototype.ensureControl = function(t, i) { this.ie(), n.isPlainObject(i) || (i = { data: null, afterRefresh: null, beforeRefresh: null }), i.je = !0, this.xd ? this.ke() : (this.Zd(this.options.columns, this.options.columnsAutogenerationMode, this.Bd.isDataLoaded() && this.Bd.getFieldsInfo(), this.Bd.isDataLoaded(), !1), this.Bd.isOwnDataView() || new e.grid.settingsManager(this).MapDVToWG()), this.$d(!0), this.xd && i && n.isFunction(i.beforeRefresh) && i.beforeRefresh.apply(this), this.Ld("allowVirtualScrolling", null), !0 === t ? this.Bd.load(i) : (this.doRefresh(i), this.Ta()) }, o.prototype.getCellInfo = function(e) { var t = null; return e && (e = this.le(e, { td: !0, th: !0 })) && (t = this.Od().getAbsoluteCellInfo(e)), t }, o.prototype.getFilterOperatorsByDataType = function(t) { return new e.grid.filterOperatorsCache(this).getByDataType(t || "string") }, o.prototype.pageCount = function() { return this.me() ? Math.ceil(this.options.totalRows / this.options.pageSize) || 1 : this.options.allowPaging ? this.Bd.dataView().pageCount() : 1 }, o.prototype.oe = function() { return !1 }, o.prototype.pe = function() { return this.options.pageIndex }, o.prototype.setSize = function(e, t) {
                            var i = this.Od(),
                                o = { type: "", hScrollValue: null, vScrollValue: null },
                                r = this.outerDiv,
                                a = this.Ld("frozener"),
                                s = this.Ld("visibleLeaves"),
                                l = [];
                            i && i.getScrollValue && (o = i.getScrollValue()), (e || 0 === e) && (this.Gd = !1, r.width(e)), (t || 0 === t) && (this.Fd = !1, r.height(t)), n.each(s, function(e, t) {
                                var o = i.getHeaderCell(e),
                                    r = i.getJoinedCols(e);
                                n(o).css("width", ""), n.each(r, function(e, t) { n(t).css("width", "") })
                            }), this.Od().updateSplits(o), a && a.refresh()
                        }, o.prototype.selection = function() { var t = this.Ld("selection"); return t || this.Ld("selection", t = new e.grid.selection(this)), t }, o.prototype.qe = function(e, t) {
                            var i = this.re(this.currentCell().cellIndex()),
                                o = this.selection();
                            i = this.currentCell(i, null, !0)
                        }, o.prototype.te = function() {
                            this.options.pageIndex = 0;
                            var e = this.Ld("viewRenderBounds");
                            e.start = e.end = 0
                        }, o.prototype.ue = function() { this.ve(), this._trigger("dataLoading") }, o.prototype.we = function(t) { new e.grid.settingsManager(this).MapDVToWG(), this._trigger("dataLoaded"), this.doRefresh(t), this.Ta() }, o.prototype.xe = function() {}, o.prototype.ie = function() { this.ve(), this._trigger("loading") }, o.prototype.Ta = function() { this.ye(), this._trigger("loaded") }, o.prototype.be = function(t, i) {
                            var o, n, r, a, s, l, c = [],
                                d = e.data.Expando.getFrom(t.values, !1),
                                p = d ? d[e.grid.EXPANDO] : null;
                            for (o = 0, n = i.length; o < n; o++) r = i[o], e.grid.validDataKey(r.dataKey) && (a = p && p.cellsAttributes ? p.cellsAttributes[r.dataKey] : {}, s = this.Bd.getValue(t.values, r.dataKey), c.push({ value: this.parse(r, s), ze: a || {}, Ae: {} }));
                            return c.originalRowIndex = t.originalRowIndex, c.rowType = e.grid.rowType.data, t.originalRowIndex % 2 != 0 && (c.rowType |= e.grid.rowType.dataAlt), c.Ae = {}, c.ze = p && p.rowAttributes ? p.rowAttributes : {}, c
                        }, o.prototype.ce = function(t, i, o) {
                            var n, r, a = [],
                                s = i.length;
                            for (n = 0, r = t.length; n < r; n++) a.push({ html: t[n], ze: { colSpan: s > 0 && o ? s : 1 }, Ae: {} });
                            return a.rowType = e.grid.rowType.emptyDataRow, a.Ae = {}, a.ze = {}, a
                        }, o.prototype.Zd = function(i, o, r, a, s) {
                            e.grid.traverse(i, function(e) { e.isBand = n.isArray(e.columns) || "c1band" === e.clientType, e.Be = e.dataKey, e.Ce = e.headerText }), (new e.grid.bandProcessor).getVisibleHeight(i, !0);
                            var l = [],
                                c = this.De(),
                                d = this.Ee(),
                                p = (o || "").toLowerCase(),
                                u = this;
                            a && e.grid.columnsGenerator.generate(p, r, i), e.grid.setTraverseIndex(i), e.grid.traverse(i, function(i) { i.isBand = n.isArray(i.columns) || "c1band" === i.clientType, e.grid.shallowMerge(i, t.c1basefield.prototype.options), i.isBand ? i.clientType = "c1band" : (e.grid.shallowMerge(i, t.c1field.prototype.options), i.groupInfo = i.groupInfo || {}, e.grid.shallowMerge(i.groupInfo, t.c1field.prototype.options.groupInfo), i.clientType || (i.clientType = "c1field")), i.isLeaf && !i.isBand && l.push(i) }), this.Ld("leaves", l), a && n.each(l, n.proxy(function(t, i) { var o = "number" == typeof i.dataKey ? i.dataKey : t; "merge" !== p && !0 !== i.dynamic || void 0 === i.headerText && (u.Bd && u.Bd.isBoundedToDOM() && c && o < c.length ? i.headerText = n.trim(c[o]) : e.grid.validDataKey(i.dataKey) && (i.headerText = "" + i.dataKey)), u.Bd && u.Bd.isBoundedToDOM() && d && o < d.length && (i.Fe = n.trim(d[o])) }, this))
                        }, o.prototype._d = function() {
                            var t = [],
                                i = [],
                                o;
                            this.Ge() && (o = e.grid.createDynamicField({ clientType: "c1basefield", dataIndex: -1, travIdx: -1, parentVis: !0, allowMoving: !1, allowSizing: !1, allowSort: !1, isRowHeader: !0 }), o.owner = this, t.push(o)), n.each(this.options.columns, function(e, i) { t.push(i) }), this.He((new e.grid.bandProcessor).generateSpanTable(t, i)), this.Ld("leaves", i), this.Ie()
                        }, o.prototype.Ie = function() {
                            var t = this.Ld("leaves"),
                                i = this.Bd.getFieldsInfo(),
                                o, r = 0,
                                a = 0,
                                s = this;
                            this.Ld("visibleLeaves", n.grep(t, function(t, s) { return t.leavesIdx = s, e.grid.validDataKey(t.dataKey) ? t.dataIndex = r++ : t.dataIndex = -1, t.isBand || (o = i[t.dataKey], o && (t.Je = o.type, t.Ke = o.format), n.isFunction(t.dataParser) && (t.dataParser = new t.dataParser)), !!t.parentVis && (t.visLeavesIdx = a++, !0) }))
                        }, o.prototype.Md = function() { var e = this.Ld("allowVirtualScrolling"); return e || (e = this.Ld("allowVirtualScrolling", !this.options.allowPaging && this.options.allowVirtualScrolling && this.options.staticRowIndex < 0 && "none" !== this.options.scrollMode && !this.Le())), e }, o.prototype.Me = function(t) { void 0 === t && (t = !1); var i = this.Ld("dragndrop"); return !i && t && this.Ld("dragndrop", i = new e.grid.uiDragndrop(this)), i }, o.prototype.Ne = function() { return this.Od().headerRows() }, o.prototype.Oe = function() { return this.Od().filterRow() }, o.prototype.Rd = function() { return this.Od().bodyRows() }, o.prototype.Pe = function(t) {
                            var i = this,
                                o = new e.grid.filterOperatorsCache(this);
                            n.each(t, function(e, t) {
                                if (t.name) {
                                    var i = o.getByName(t.name);
                                    i && (i.displayName = t.displayName)
                                }
                            })
                        }, o.prototype.Qe = function(t) { var i = this.Ld("selectionui"); return !i && t && this.Ld("selectionui", i = new e.grid.uiSelection(this)), i }, o.prototype.postset_allowColMoving = function(e, t) {
                            var i, o = this;
                            n.each(this.columns(), function(t, i) { e ? o.Me(!0).attach(i) : o.Me(!0).detach(i) }), (i = this.Ld("groupedWidgets")) && n.each(i, function(t, i) { e ? o.Me(!0).attach(i) : o.Me(!0).detach(i) })
                        }, o.prototype.postset_allowSorting = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_columns = function(e, t) { this.xd = !1, this.ensureControl(!0) }, o.prototype.postset_allowPaging = function(e, t) { this.ensureControl(!0) }, o.prototype.postset_culture = function(e, t) { throw "read-only" }, o.prototype.postset_customFilterOperators = function(e, t) { var i = this.Bd.dataView() }, o.prototype.postset_data = function(t, i) {
                            this.$d(!1), e.grid.traverse(this.options.columns, function(e, t) {
                                if (e.dynamic) {
                                    var i = n.inArray(e, t);
                                    i >= 0 && t.splice(i, 1)
                                } else e.dataKey = e.Be, e.headerText = e.Ce
                            }), this.xd = !1, this.Bd && this.Bd.dispose(), this.Bd = new e.grid.dataViewWrapper(this), this.ensureControl(!0)
                        }, o.prototype.postset_disabled = function(t, i) {
                            var o = this,
                                n = this.Od();
                            e.grid.iterateChildrenWidgets(this.outerDiv, function(e, i) { i !== o && i.option("disabled", t) }), n && n.ensureDisabledState()
                        }, o.prototype.postset_groupIndent = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_groupAreaCaption = function(e, t) { var i = this.Re();!this.$groupArea || i && i.length || this.$groupArea.html(e || "&nbsp;") }, o.prototype.postset_highlightCurrentCell = function(e, t) {
                            var i = this.currentCell();
                            i && i.Td() && this.Se(i, e)
                        }, o.prototype.preset_pageIndex = function(e, t) {
                            if (isNaN(e)) throw "out of range";
                            var i = this.pageCount(),
                                o = function(e) { return e > i - 1 && (e = i - 1), e < 0 && (e = 0), e },
                                n;
                            return e = o(e), this.options.allowPaging && e !== t && (n = { newPageIndex: e }, e = this.Te(n) ? o(n.newPageIndex) : t), e
                        }, o.prototype.postset_pageIndex = function(e, t) {
                            if (this.options.allowPaging) {
                                var i = { newPageIndex: e };
                                this.me() ? (this.ke(), this.Ue(i)) : this.ensureControl(!0, { afterRefresh: function() { this.Ue(i) } })
                            }
                        }, o.prototype.preset_pageSize = function(e, t) { if (isNaN(e)) throw "out of range"; return e <= 0 && (e = 1), e }, o.prototype.postset_pageSize = function(e, t) { this.te(), this.options.allowPaging && !this.me() && this.ensureControl(!0) }, o.prototype.postset_pagerSettings = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_scrollMode = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_selectionMode = function(t, i) {
                            var o = this.selection(),
                                n = this.currentCell(),
                                r = this.selection().selectedCells().length();
                            o.beginUpdate(), o.clear(), n && n.Td() && r && o.Ve(new e.grid.cellInfoRange(n, n), !1, !1, e.grid.cellRangeExtendMode.none, null), o.endUpdate(), this.Od().toggleDOMSelection("none" === t)
                        }, o.prototype.postset_showFilter = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_showGroupArea = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_showRowHeader = function(e, t) { this.ensureControl(!1) }, o.prototype.postset_staticRowIndex = function() { "none" !== this.options.scrollMode && this.ensureControl(!1) }, o.prototype.postset_staticColumnIndex = function() { "none" !== this.options.scrollMode && this.ensureControl(!1) }, o.prototype.postset_allowVirtualScrolling = function(e, t) { this.ensureControl(!1) }, o.prototype.preset_allowVirtualScrolling = function(e, t) { if (isNaN(e) || e < 0) throw "out of range"; return e }, o.prototype.ve = function() {
                            if (!this.Kd) {
                                var e = this.options.uiCSS,
                                    t = this.outerDiv.append('<div class="gcui-gcuigrid-overlay ' + e.overlay + '"></div><span class="gcui-gcuigrid-loadingtext ' + e.content + " " + e.cornerAll + '"><span class="' + e.icon + ' ui-icon-clock"></span>' + this.options.loadingText + "</span>").find("> .gcui-gcuigrid-loadingtext");
                                t.position({ my: "center", at: "center center", of: this.outerDiv, collision: "none" }), this.Kd = !0
                            }
                        }, o.prototype.me = function() { return this.options.allowPaging && this.options.totalRows >= 0 }, o.prototype.ye = function() { if (this.Kd) try { this.outerDiv.find("> .gcui-gcuigrid-overlay, > .gcui-gcuigrid-loadingtext").remove() } finally { this.Kd = !1 } }, o.prototype.We = function(e, t) {
                            var i, o = t.clientType;
                            !o && t.isBand && (o = "c1band"), t = n.extend({}, t, { disabled: this.options.disabled });
                            try {
                                switch (n.data(e[0], "gcuigridowner", this), o) {
                                    case "c1basefield":
                                        i = e.c1basefield(t);
                                        break;
                                    case "c1band":
                                        i = e.c1band(t);
                                        break;
                                    default:
                                        i = e.c1field(t)
                                }
                            } finally { n.removeData(e[0], "gcuigridowner") }
                            return i
                        }, o.prototype.ke = function() { this.xd && this.Xe && (this.$d(!1), this.Ye(), this.$d(!0)) }, o.prototype.Ld = function(t, i) { return e.grid.dataPrefix(this.element, this.Qd, t, i) }, o.prototype.Ze = function(e) {
                            var t = this.Qd + e;
                            this.element.removeData(t)
                        }, o.prototype.$e = function(t) {
                            var i = this.Ld("leaves"),
                                o, r;
                            return i && this.options.showFooter ? o = n.map(i, function(i, o) { return !i.isBand && e.grid.validDataKey(i.dataKey) && i.aggregate && "none" !== i.aggregate ? t ? [{ column: i, aggregate: i.aggregate }] : [{ dataKey: i.dataKey, aggregate: i.aggregate }] : null }) : []
                        }, o.prototype.Ye = function() {
                            var t = e.grid.flatten(this.options.columns);
                            n.each(this.columns(), function(e, i) {
                                delete i.options.columns;
                                var o = t[i.options.travIdx];
                                n.extend(!0, o, i.options), o.filterValue = i.options.filterValue, o.filterOperator = i.options.filterOperator
                            })
                        }, o.prototype._e = function() {
                            n.each(this.columns(), function(e, t) { t.destroy() });
                            var t = [],
                                i = this.Ne(),
                                o, r, a, s, l, c, d;
                            if (i && i.length())
                                for (o = [], e.grid.traverse(this.options.columns, function(e) { e.parentVis && o.push(e) }), r = 0, a = o.length; r < a; r++) s = o[r], l = i.item(s.thY), c = e.grid.rowAccessor.getCell(l, s.thX), d = this.We(n(c), s), t.push(d.data(e.grid.widgetName(d)));
                            this.Ld("columns", t)
                        }, o.prototype.Re = function(e) { var t, i, o, r; return e = !(t = this.Ld("groupedColumns")) || e, e && (t = [], i = this.Ld("leaves") || [], o = !1, r = function(e) { return e.groupInfo && e.groupInfo.position && "none" !== e.groupInfo.position }, n.each(i, function(e, i) { r(i) ? (o = o || void 0 === i.groupedIndex) || t.push(i) : delete i.groupedIndex }), o ? n.each(i, function(e, i) { r(i) && (i.groupedIndex = t.length, t.push(i)) }) : (t.sort(function(e, t) { return e.groupedIndex - t.groupedIndex }), n.each(t, function(e, t) { t.groupedIndex = e })), this.Ld("groupedColumns", t)), t || [] }, o.prototype.$d = function(t) {
                            if (t) {
                                var i = this;
                                e.grid.traverse(this.options.columns, function(e) {
                                    e.owner = i;
                                    var t, o, n;
                                    if ((t = e.groupInfo) && (t.owner = e, t.expandInfo))
                                        for (o = 0, n = t.expandInfo.length; o < n; o++) t.expandInfo[o].owner = t
                                })
                            } else e.grid.traverse(this.options.columns, function(e) {
                                delete e.owner;
                                var t, i, o;
                                if ((t = e.groupInfo) && (delete t.owner, t.expandInfo))
                                    for (i = 0, o = t.expandInfo.length; i < o; i++) delete t.expandInfo[i].owner
                            })
                        }, o.prototype.af = function(e) { var t = this.bf(); return e.start < 0 && (e.start = 0), e.start = Math.min(e.start, t - 1), e.end < 0 && (e.end = 0), e.end = Math.min(e.end, t - 1), e }, o.prototype.$a = function(t) {
                            (new e.grid.grouper).group(this, this.sketchTable, this.Ld("leaves")), (new e.grid.merger).merge(this.sketchTable, this.Ld("visibleLeaves"));
                            var i = this.Ld("viewRenderBounds");
                            this.af(i), "none" !== this.options.scrollMode ? this.Ld("view", new e.grid.fixedView(this, this.Ld("viewRenderBounds"))) : this.Ld("view", new e.grid.flatView(this, this.Ld("viewRenderBounds"))), this.cf(), this.$d(!1), this._e(), this.$d(!0), this.options.allowPaging && (this.$topPagerDiv && this.$topPagerDiv.gcuipager(this.df()).css("zIndex", 5), this.$bottomPagerDiv && this.$bottomPagerDiv.gcuipager(this.df()).css("zIndex", 5))
                        }, o.prototype.ee = function(e) {
                            var t = e.virtualScrollData,
                                i = { top: 0, bottom: 0 };
                            t.data && (i = this.ef(t)), this.ff(t, i), this.gf(t)
                        }, o.prototype.ff = function(e, t) {
                            var i = this.Ld("viewRenderBounds"),
                                o = this.Od(),
                                n = e.newBounds,
                                r = this.Od().bodyRows(),
                                a, s, l, c;
                            switch (e.mode) {
                                case "reset":
                                    break;
                                case "overlapBottom":
                                    for (a = { start: n.start - i.start, end: i.end - i.start }, l = n.start - i.start, s = a.start; s <= a.end; s++) c = o.Wd(r.item(s), !1), c.sectionRowIndex -= l, c.dataItemIndex += t.top, o.hf(c.$rows, c);
                                    break;
                                case "overlapTop":
                                    for (a = { start: i.start - i.start, end: n.end - i.start }, l = i.start - n.start, s = a.start; s <= a.end; s++) c = o.Wd(r.item(s), !1), c.sectionRowIndex += l, c.dataItemIndex += t.top, o.hf(c.$rows, c)
                            }
                        }, o.prototype.gf = function(t) {
                            var i = this.Ld("viewRenderBounds"),
                                o = this.Od(),
                                n = function(t) { return t.rowType & e.grid.rowType.data ? t.originalRowIndex : -1 },
                                r, a, s, l;
                            switch (t.mode) {
                                case "reset":
                                    for (o.if(), a = t.newBounds.start; a <= t.newBounds.end; a++) s = this.sketchTable[a - this.ud], o.jf(s, -1, n(s), a);
                                    o.kf();
                                    break;
                                case "overlapBottom":
                                    for (r = { start: t.newBounds.start, end: i.end }, a = 0; a < r.start - i.start; a++) o.lf(0, !1);
                                    for (a = r.end + 1; a <= t.newBounds.end; a++) s = this.sketchTable[a - this.ud], o.jf(s, -1, n(s), a);
                                    break;
                                case "overlapTop":
                                    for (r = { start: i.start, end: t.newBounds.end }, a = 0; a < i.end - t.newBounds.end; a++) o.lf(r.end - r.start + 1, !1);
                                    for (l = 0, a = t.newBounds.start; a < i.start; a++) s = this.sketchTable[a - this.ud], o.jf(s, l++, n(s), a)
                            }
                        }, o.prototype.ef = function(e) {
                            var t = this.Bd,
                                i = t.dataView().getSource(),
                                o, n = this.Ld("leaves"),
                                r, a, s, l = 0,
                                c = { top: 0, bottom: 0 },
                                d, p = this.mf();
                            switch (e.mode) {
                                case "reset":
                                    for (this.sketchTable.splice(0, this.sketchTable.length), t.nf(0, i.length), this.ud = e.request.index, r = 0; r < e.data.length; r++) t.pf(o = e.data[r]), this.sketchTable.push(this.be(t.qf(o, r), n));
                                    break;
                                case "overlapBottom":
                                    for (r = 0; r < e.data.length; r++) t.pf(o = e.data[r]), this.sketchTable.push(this.be(t.qf(o, i.length - 1), n));
                                    c.bottom = e.data.length;
                                    break;
                                case "overlapTop":
                                    for (r = e.data.length - 1; r >= 0; r--) t.nf(0, 0, o = e.data[r]), this.sketchTable.splice(0, 0, this.be(t.qf(o, r), n));
                                    this.ud = e.request.index, c.top = e.data.length
                            }
                            for (a = this.af({ start: e.newBounds.start, end: e.newBounds.end }), s = { start: this.ud, end: this.ud + i.length - 1 }, l = s.end - a.end - p, l > 0 && (c.bottom -= l, t.nf(i.length - l, l), this.sketchTable.splice(this.sketchTable.length - l, l)), l = a.start - s.start - p, l > 0 && (c.top -= l, t.nf(0, l), this.sketchTable.splice(0, l), this.ud += l), r = 0; r < this.sketchTable.length; r++) this.sketchTable[r].originalRowIndex = r;
                            return t.rf(), c
                        }, o.prototype.tf = function() { return !0 === this.options.allowPaging }, o.prototype.uf = function() { return this._ }, o.prototype.cf = function() {
                            var e = this.Od(),
                                t = this.options,
                                i = this.options.uiCSS,
                                o;
                            e.render(), o = this.outerDiv, "none" !== t.scrollMode && (o = this.outerDiv.find("div.gcui-gcuigrid-scroller:first")), this.$superPanelHeader = null, this.$topPagerDiv && (this.$topPagerDiv.data("gcui-gcuipager") && this.$topPagerDiv.gcuipager("destroy"), this.$topPagerDiv.remove()), this.$topPagerDiv = null, !this.tf() || "top" !== t.pagerSettings.position && "topAndBottom" !== t.pagerSettings.position || this.$topPagerDiv || (o.prepend(this.$superPanelHeader = n('<div class="gcui-superpanel-header"></div>')),
                                this.$superPanelHeader.prepend(this.$topPagerDiv = n('<div class="gcui-gcuigrid-header ' + i.header + " " + i.cornerTop + '"></div>'))), t.showGroupArea ? this.vf(o) : this.$groupArea = null, this.$bottomPagerDiv && (this.$bottomPagerDiv.data("gcui-gcuipager") && this.$bottomPagerDiv.gcuipager("destroy"), this.$bottomPagerDiv.remove()), this.$bottomPagerDiv = null, !this.tf() || "bottom" !== t.pagerSettings.position && "topAndBottom" !== t.pagerSettings.position || this.$bottomPagerDiv || o.append(this.$bottomPagerDiv = n('<div class="gcui-gcuigrid-footer gcui-superpanel-footer ' + i.stateDefault + " " + i.cornerBottom + '"></div>'))
                        }, o.prototype.vf = function(e) {
                            var t = this,
                                i = this.Re(),
                                o = [];
                            this.$groupArea = n('<div class="' + this.options.uiCSS.content + " " + this.options.uiCSS.helperClearFix + '"></div>'), i.length > 0 ? n.each(i, function(e, i) { var r = n('<a href="#"></a>').appendTo(t.$groupArea); try { n.data(r[0], "gcuigridowner", t), r.c1groupedfield(n.extend({}, { allowMoving: i.allowMoving, allowSort: i.allowSort, dataIndex: i.dataIndex, headerText: i.headerText, isBand: i.isBand, isLeaf: i.isLeaf, linearIdx: i.linearIdx, parentIdx: i.parentIdx, sortDirection: i.sortDirection, travIdx: i.travIdx, groupedIndex: i.groupedIndex }, { disabled: t.options.disabled })) } finally { n.removeData(r[0], "gcuigridowner") } o.push(r.data("gcui-c1groupedfield")) }) : this.$groupArea.addClass("gcui-gcuigrid-group-area").css("padding", 0).html(this.options.groupAreaCaption || "&nbsp;"), this.Ld("groupedWidgets", o), this.$superPanelHeader || e.prepend(this.$superPanelHeader = n('<div class="gcui-superpanel-header"></div>')), this.$superPanelHeader.prepend(this.$groupArea), this.Me(!0).attachGroupArea(this.$groupArea)
                        }, o.prototype.df = function() { return n.extend({}, this.options.pagerSettings, { disabled: this.options.disabled, pageCount: this.pageCount(), pageIndex: this.options.pageIndex, pageIndexChanging: n.proxy(this.wf, this), pageIndexChanged: n.proxy(this.xf, this) }) }, o.prototype.Ge = function() { return !0 === this.options.showRowHeader && "right" !== this.options.staticColumnsAlignment }, o.prototype.yf = function() {
                            var e = this.Od(),
                                t = e.focusableElement(),
                                i = this;
                            t.bind("keydown." + this.widgetName, n.proxy(this.zf, this)), t.bind("keypress." + this.widgetName, n.proxy(this.Af, this)), n.each(e.subTables(), function(e, t) {
                                var o = t.element();
                                o && (o.tHead && n(o.tHead).bind("click." + i.widgetName, n.proxy(i.gb, i)), o.tBodies.length && n(o.tBodies[0]).bind("click." + i.widgetName, n.proxy(i.gb, i)).bind("dblclick." + i.widgetName, n.proxy(i.Bf, i)).bind("mousemove." + i.widgetName, n.proxy(i.Cf, i)).bind("mouseout." + i.widgetName, n.proxy(i.Df, i)))
                            }), n(window).bind("resize." + this.widgetName + "." + this.Ad, n.proxy(this.Ef, this))
                        }, o.prototype.Pd = function(e) {
                            var t = this.Od(),
                                i = this,
                                o;
                            this.wd = 0, n(window).unbind("resize." + this.widgetName + "." + this.Ad), t && (o = t.focusableElement(), o.unbind("keydown." + this.widgetName), o.unbind("keypress." + this.widgetName), n.each(t.subTables(), function() {
                                var e = this.element();
                                e && (e.tHead && n(e.tHead).unbind("." + i.widgetName), e.tBodies.length && n(e.tBodies[0]).unbind("." + i.widgetName))
                            }))
                        }, o.prototype.Ff = function(t, i) {
                            var o = this.options.columns,
                                r = t.travIdx,
                                a, s;
                            t && this.options.allowSorting && (a = "none" === t.sortDirection ? "ascending" : "ascending" === t.sortDirection ? "descending" : "ascending", s = { column: t, sortDirection: a, sortCommand: t.dataKey + " " + ("ascending" === a ? "asc" : "desc") }, this.Gf(s) && (t.sortDirection = s.sortDirection, i ? t.sortOrder = this.Hf++ : (this.Hf = 1e3, n.each(this.columns(), function(e, t) { t.options.sortOrder = 0, t.options.travIdx === r || t.options.groupInfo && "none" !== t.options.groupInfo.position || (t.options.sortDirection = "none") }), e.grid.traverse(o, function(e) { e.sortOrder = 0, e.travIdx === r || e.groupInfo && "none" !== e.groupInfo.position || (e.sortDirection = "none") })), s = { column: t, sortDirection: t.sortDirection, sortCommand: t.dataKey + " " + ("ascending" === t.sortDirection ? "asc" : "desc") }, this.me() ? (this.ke(), this.If(s)) : this.ensureControl(!0, { afterRefresh: function() { this.If(s) } })))
                        }, o.prototype.Jf = function(t, i, o, r, a) {
                            var s = e.grid.getColumnByTravIdx(this.options.columns, t),
                                l = e.grid.getColumnByTravIdx(this.options.columns, i),
                                c = r ? "groupArea" : "columns",
                                d = a ? "groupArea" : "columns";
                            a ? this.Kf({ drag: s.found, drop: l ? l.found : null, dragSource: c, dropSource: d, at: o }) && this.ensureControl(!0, {
                                beforeRefresh: function() {
                                    if (l) switch (o) {
                                        case "left":
                                            s.found.groupedIndex = l.found.groupedIndex - .5;
                                            break;
                                        case "right":
                                            s.found.groupedIndex = l.found.groupedIndex + .5
                                    } else s.found.groupedIndex = 0;
                                    r || n.extend(!0, s.found, { groupInfo: { position: "header" } })
                                },
                                afterRefresh: function() { this.Lf({ drag: s.found, drop: l ? l.found : null, dragSource: c, dropSource: d, at: o }) }
                            }) : this.Mf({ drag: s.found, drop: l.found, at: o }) && this.ensureControl(!1, {
                                beforeRefresh: function() {
                                    switch (s.at.splice(s.found.linearIdx, 1), o) {
                                        case "left":
                                            s.at === l.at && s.found.linearIdx < l.found.linearIdx ? l.at.splice(l.found.linearIdx - 1, 0, s.found) : l.at.splice(l.found.linearIdx, 0, s.found);
                                            break;
                                        case "right":
                                            s.at === l.at && s.found.linearIdx < l.found.linearIdx ? l.at.splice(l.found.linearIdx, 0, s.found) : l.at.splice(l.found.linearIdx + 1, 0, s.found);
                                            break;
                                        case "center":
                                            l.found.columns.push(s.found)
                                    }
                                    e.grid.setTraverseIndex(this.options.columns)
                                },
                                afterRefresh: function() { this.Nf({ drag: s.found, drop: l.found, at: o }) }
                            })
                        }, o.prototype.Of = function(t, i, o) {
                            var n = new e.grid.filterOperatorsCache(this).getByName(i),
                                r, a, s;
                            n && (n.arity > 1 ? (r = this.parse(t.options, o), a = null !== r && ("string" === e.grid.getDataType(t.options) || !isNaN(r))) : a = !0, a && (s = { column: t.options, operator: n.name, value: r }, this.Pf(s) && (t.options.filterValue = s.value, t.options.filterOperator = s.operator, this.te(), this.me() ? (this.ke(), this.Qf({ column: t.options })) : this.ensureControl(!0, { afterRefresh: function() { this.Qf({ column: t.options }) } }))))
                        }, o.prototype.Rf = function(t) {
                            var i = e.grid.getColumnByTravIdx(this.options.columns, t),
                                o;
                            i && i.found && (o = i.found, this.Sf({ column: o }) && this.ensureControl(!0, { beforeRefresh: function() { delete o.groupedIndex, n.extend(!0, o, { groupInfo: { position: "none" } }) }, afterRefresh: function() { this.Tf({ column: o }) } }))
                        }, o.prototype.Uf = function(e, t, i, o, r, a) {
                            this.ensureControl(this.Nd(), {
                                virtualScrollData: { newBounds: e, request: t, mode: i, data: a },
                                afterRefresh: function(e) {
                                    var t = this.Ld("viewRenderBounds");
                                    n.extend(t, e.virtualScrollData.newBounds), this.Od().Vf(), r(o)
                                }
                            })
                        }, o.prototype.Wf = function(e, t) {
                            var i = this.Ld("viewRenderBounds"),
                                o = this.af({ start: e, end: e + this.options.pageSize - 1 }),
                                n = this.af({ start: this.ud, end: this.ud + this.Bd.dataView().count() - 1 }),
                                r = null,
                                a;
                            if (o.start > i.end || o.end < i.start ? a = "reset" : o.start > i.start ? a = "overlapBottom" : o.start < i.start && (a = "overlapTop"), this.Nd()) switch (a) {
                                case "reset":
                                    r = { index: e, maxCount: this.options.pageSize };
                                    break;
                                case "overlapBottom":
                                    o.end > n.end && (r = { index: n.end + 1, maxCount: this.options.pageSize });
                                    break;
                                case "overlapTop":
                                    o.start < n.start && (r = { index: Math.max(0, n.start - this.options.pageSize), maxCount: 0 }, r.maxCount = n.start - r.index)
                            }
                            "none" !== a && this.Uf(o, r, a, e, t)
                        }, o.prototype.Nd = function() { return !1 }, o.prototype.mf = function() { return 2 * this.options.pageSize }, o.prototype.Mf = function(e) { return this._trigger("columnDropping", null, e) }, o.prototype.Nf = function(e) { this._trigger("columnDropped", null, e) }, o.prototype.Kf = function(e) { return this._trigger("columnGrouping", null, e) }, o.prototype.Lf = function(e) { this._trigger("columnGrouped", null, e) }, o.prototype.Sf = function(e) { return this._trigger("columnUngrouping", null, e) }, o.prototype.Tf = function(e) { this._trigger("columnUngrouped", null, e) }, o.prototype.Pf = function(e) { return this._trigger("filtering", null, e) }, o.prototype.Qf = function(e) { this._trigger("filtered", null, e) }, o.prototype.Xf = function(e) { this._trigger("filterOperatorsListShowing", null, e) }, o.prototype.Gf = function(e) { return this._trigger("sorting", null, e) }, o.prototype.If = function(e) { this._trigger("sorted", null, e) }, o.prototype.Yf = function(t, i) {
                            var o, n, r, a, s = this.options,
                                l = this.currentCell(),
                                c = this.Zf(l.rowIndex());
                            if (this.Bd.currentPosition(c), "none" !== s.scrollMode && l && !l.isEqual(e.grid.cellInfo.outsideValue) && this.Od().scrollTo(l), this._trigger("currentCellChanged"), o = t && (t.type || "").toLowerCase() || "", i.changeSelection) {
                                if (n = this.selection(), r = this.options.selectionMode.toLowerCase(), a = i.selectionExtendMode || e.grid.cellRangeExtendMode.none, n.beginUpdate(), o) {
                                    if (l.Td()) switch (o) {
                                        case "click":
                                            t.shiftKey && (n.$f() || "singlerange" === r) || n._f(l), t.shiftKey && t.ctrlKey ? n.ag(new e.grid.cellInfoRange(l, l), a) : n.Ve(new e.grid.cellInfoRange(n.bg(), l), t.ctrlKey, t.shiftKey, a, null);
                                            break;
                                        case "keydown":
                                            t.shiftKey && (n.$f() || "singlerange" === r) || n._f(l), n.Ve(new e.grid.cellInfoRange(n.bg(), l), !1, t.shiftKey, e.grid.cellRangeExtendMode.none, null)
                                    }
                                } else n.clear(), l.Td() && (n._f(l), n.Ve(new e.grid.cellInfoRange(l, l), !1, !1, e.grid.cellRangeExtendMode.none, null));
                                n.endUpdate()
                            }
                            "click" === o && this.cg() && this.ge(t)
                        }, o.prototype.Te = function(e) { return this._trigger("pageIndexChanging", null, e) }, o.prototype.Ue = function(e) { this._trigger("pageIndexChanged", null, e) }, o.prototype.wf = function(e, t) { t.handled = !0 }, o.prototype.xf = function(e, t) { this._setOption("pageIndex", t.newPageIndex) }, o.prototype.de = function(t) {
                            var i, o = this.Od();
                            this.zd = !1, t.virtualScrollData ? (this.selection().clear(), this.options.highlightCurrentCell && this.Se(this.currentCell(), !1)) : (o && o.dispose(), this.Pd(!1), this.element.detach(), this.element.empty(), this.outerDiv.empty(), this.outerDiv.append(this.element), this.Ld("selectionui") && (this.Ld("selectionui").dispose(), this.Ld("selectionui", null)), this.Ld("resizer") && (this.Ld("resizer").dispose(), this.Ld("resizer", null)), this.Ld("frozener") && (this.Ld("frozener").dispose(), this.Ld("frozener", null))), i = (this.Ld("currentCell") || e.grid.cellInfo.outsideValue).Sd(), i.Xd(null), this.Ld("currentCellPrev", i), this.Ld("currentCell", null), this._trigger("rendering")
                        }, o.prototype.fe = function(t) {
                            var i = this.Od(),
                                o, r, a = this.selection().selectedCells().length() > 0;
                            this.zd = !0, this.Ld("selection", null), this.dg(i.focusableElement(), "tabIndex", 0), o = this.Ld("currentCellPrev"), o = this.re(o.cellIndex()), o.eg(!1), !o.Td() && this.options.showSelectionOnRender && (o = this.fg(0)), this.currentCell(o, null, !0), t.virtualScrollData || (this.yf(), this.Qe(!0), r = new e.grid.uiResizer(this), n.each(this.columns(), function(e, t) {
                                var i = t.options;
                                i.visible && i.parentVis && i.isLeaf && r.addElement(t)
                            }), this.Ld("resizer", r), i.updateSplits(this.vd), "none" !== this.options.scrollMode && this.Ld("frozener", new e.grid.uiFrozener(this))), this.Hd++, this._trigger("rendered")
                        }, o.prototype.gb = function(t) {
                            var i, o, r, a, s, l, c, d;
                            if (this.gg() && t.target && (i = this.Od(), o = this.le(t.target, { td: !0, th: !0 }), s = e.grid.cellRangeExtendMode.none, o)) {
                                if (n(t.target).hasClass("gcui-gcuigrid-grouptogglebtn")) return this.hg(t), t.stopPropagation(), !1;
                                if (r = n(o).closest("tr"), !r.length) return;
                                a = i.getAbsoluteCellInfo(o), (r.hasClass("gcui-gcuigrid-datarow") || r.hasClass("gcui-gcuigrid-headerrow")) && ((a.cellIndex() < 0 || a.rowIndex() < 0) && (a.rowIndex() >= 0 ? (a = new e.grid.cellInfo(0, a.rowIndex()), s = e.grid.cellRangeExtendMode.row) : (a = this.fg(a.cellIndex()), s = e.grid.cellRangeExtendMode.column)), this.Yd(t, a, { changeSelection: !0, setFocus: !n(t.target).is(":focus"), selectionExtendMode: s })), d = { cell: a }, this._trigger("cellClicked", null, d)
                            }
                        }, o.prototype.Bf = function(e) { this.cg() || this.ge(e) }, o.prototype.hg = function(t) {
                            if (this.gg()) {
                                var i = n(t.target).closest("tr"),
                                    o = e.grid.groupHelper,
                                    r = o.getGroupInfo(i[0]),
                                    a, s;
                                r && (a = o.getColumnByGroupLevel(this.Ld("leaves"), r.level)) && (s = a.groupInfo.expandInfo[r.index], s.isExpanded ? s.collapse() : s.expand(t.shiftKey), this.setSize())
                            }
                        }, o.prototype.zf = function(t) {
                            var i, o, r, a, s, l, c, d, p, u, h, f, g, m, b;
                            if (!this.gg()) return !0;
                            if (i = t.target.tagName.toLowerCase(), o = !1, a = this.currentCell(), l = e.getKeyCodeEnum(), ("input" === i || "option" === i || "select" === i || "textarea" === i) && 0 === n(t.target).closest("tr.gcui-gcuigrid-datarow").length) return !0;
                            if (this.options.allowEditing) { if ((t.which === l.ESCAPE || 113 === t.which) && a.Td() && a.eg()) return this.he(t), !1; if (113 === t.which) return this.ge(t), !1 }
                            if (!this.options.allowKeyboardNavigation || t.which === l.TAB) return !0;
                            switch (p = 0, this.Md ? (p = this.vd.index, c = new e.grid.cellInfo(a.cellIndex(), a.rowIndex() + p), d = this.Vd(!0)) : (c = a, d = this.Vd(!1)), u = !1, h = !1, t.which) {
                                case l.DOWN:
                                case l.PAGE_DOWN:
                                    u = !0;
                                case l.UP:
                                case l.PAGE_UP:
                                    h = !0;
                                case l.LEFT:
                                case l.RIGHT:
                                case l.HOME:
                                case l.END:
                                case l.TAB:
                                    r = this.ig(d, c, t.keyCode, t.shiftKey), o = this.jg(t.target, t.which)
                            }
                            return !o || (f = this.Vd(!1), g = this, this.Md() && u && r.rowIndex > f.bottomRight().rowIndex() + p || h && r.rowIndex - p < f.topLeft().rowIndex() ? (b = r.rowIndex, u && (b -= f.kg()), this.Od().vsUI.scrollTo(b, function() { g.Yd(t, new e.grid.cellInfo(r.cellIndex, r.rowIndex - g.vd.index), { changeSelection: !0, setFocus: !0 }), n(g.Od().focusableElement()).focus() })) : this.Yd(t, new e.grid.cellInfo(r.cellIndex, r.rowIndex - p), { changeSelection: !0, setFocus: !0 }), !1)
                        }, o.prototype.Af = function(e) {
                            if (this.gg() && this.options.allowEditing) {
                                var t = e.which,
                                    i = this.currentCell(),
                                    o, r, a;
                                if (t && i.Td() && !i.eg() && "input" !== (o = e.target.tagName.toLowerCase()) && "option" !== o && "select" !== o && "textarea" !== o && (r = n(e.target).closest(".gcui-gcuigrid-table"), r.length && (a = n.map(this.Od().subTables(), function(e, t) { return e.element() }), n.inArray(r[0], a) >= 0 && n.gcuiutil.charValidator.isPrintableChar(String.fromCharCode(t))))) return this.ge(e), !1
                            }
                        }, o.prototype.Cf = function(t) {
                            var i = this.Od(),
                                o = this.Ld("frozener"),
                                r, a, s, l, c, d, p = e.grid.renderState;
                            if (this.options.highlightOnHover && this.gg() && (!o || !o.inProgress()) && (r = this.le(t.target, { td: !0, th: !0 }))) {
                                if (a = n(r).closest("tr"), !a.length || !a.hasClass("gcui-gcuigrid-datarow") && !a.hasClass("gcui-gcuigrid-headerrow")) return;
                                s = i.getAbsoluteCellInfo(r), l = this.Ld("hoveredRow"), s.rowIndex() !== l && (void 0 !== l && (c = this.Rd().item(l)) && (d = i.Wd(c), i.lg(d, p.hovered, !1), this.rowStyleFormatter.format(d)), l = s.rowIndex(), this.Ld("hoveredRow", l), l >= 0 && (c = this.Rd().item(l)) && (d = i.Wd(c), i.lg(d, p.hovered, !0), this.rowStyleFormatter.format(d)))
                            }
                        }, o.prototype.Df = function(t) {
                            if (this.gg() && 0 === n(t.relatedTarget).closest(".gcui-gcuigrid-data").length) {
                                var i = this.Ld("hoveredRow"),
                                    o, r, a = this.Od();
                                i >= 0 && (o = this.Rd().item(i)) && (r = a.Wd(o), a.lg(r, e.grid.renderState.hovered, !1), this.rowStyleFormatter.format(r))
                            }
                        }, o.prototype.Ef = function(e) {
                            var t = this;
                            this.wd > 0 && (window.clearTimeout(this.wd), this.wd = 0), -1 !== this.wd && (this.wd = window.setTimeout(function() { t.wd = -1; try {!t.yd && t.xd && t.element.parent().length && t.setSize() } finally { t.wd = 0 } }, 50))
                        }, o.prototype.mg = function(e, t, i) {
                            var o, n;
                            t < 0 && (t = 0), i <= 0 && (i = 1), o = { column: e.options, oldWidth: t, newWidth: i }, !1 !== this._trigger("columnResizing", null, o) && ((isNaN(o.newWidth) || o.newWidth < 0) && (o.newWidth = 1), e.option("width", o.newWidth), n = { column: e.options }, this._trigger("columnResized", null, n))
                        }, o.prototype.Yd = function(t, i, o) {
                            var r = this.currentCell(),
                                a = this.Vd(),
                                s, l, c = this.options.highlightCurrentCell,
                                d;
                            if (a.Td() && a.ng(i) || i.isEqual(e.grid.cellInfo.outsideValue))
                                if (r.cellIndex() !== i.cellIndex() || r.rowIndex() !== i.rowIndex()) {
                                    if (s = { cellIndex: i.cellIndex(), rowIndex: i.rowIndex(), oldCellIndex: r.cellIndex(), oldRowIndex: r.rowIndex() }, !this._trigger("currentCellChanging", null, s)) return !1;
                                    l = !1, this.options.allowEditing && r.eg() && !(l = this.he(null)) || (a.ng(r) && (c && this.Se(r, !1), (d = r.tableCell()) && n(d).removeAttr("tabIndex")), r = i.Sd(), r.Xd(this), c && this.Se(r, !0), (d = r.tableCell()) && (n(d).attr("tabIndex", 0), o.setFocus && r.eg()), this.Ld("currentCell", r), this.Yf(t, o))
                                } else c && this.Se(r, !0), (d = r.tableCell()) && n(d).attr("tabIndex", 0), t && !r.eg() && this.cg() && this.ge(t);
                            return !0
                        }, o.prototype.Se = function(t, i) {
                            if (t && t.Td()) {
                                var o = t.cellIndexAbs(),
                                    r = t.rowIndexAbs(),
                                    a = e.grid.renderState,
                                    s = this.Od(),
                                    l, c, d;
                                c = s.getHeaderCell(o), c && (l = s.Wd(this.Ne().item(t.column().thY)), c = n(c), d = s.og(c, a.current, i), this.cellStyleFormatter.format(c, o, t.column(), l, d)), c = s.getJoinedRows(r, 0), c && (l = s.Wd(c), s.lg(l, a.current, i), this.rowStyleFormatter.format(l)), c = s.getCell(o, r), c && (c = n(c), d = s.og(c, a.current, i), this.cellStyleFormatter.format(c, o, t.column(), l, d))
                            }
                        }, o.prototype.ge = function(t) {
                            if (this.gg() && this.options.allowEditing) {
                                var i = this.currentCell().column(),
                                    o;
                                if (i && !i.readOnly) return o = (new e.grid.cellEditorHelper).currentCellEditStart(this, t)
                            }
                            return !1
                        }, o.prototype.he = function(t) { if (this.gg() && this.options.allowEditing) { var i = (new e.grid.cellEditorHelper).currentCellEditEnd(this, t); return i && !this.Md() && this.Od().ensureHeight(this.currentCell().rowIndex()), i } return !1 }, o.prototype.pg = function(e, t, i, o, n) { return null }, o.prototype.qg = function(e, t, i) { return null }, o.prototype.rg = function(e, t, i, o) {}, o.prototype.sg = function(e) {}, o.prototype.tg = function(t) { return t.dataParser || e.data.defaultParsers[t.dataType] || e.data.defaultParsers.string }, o.prototype.parse = function(t, i) {
                            var o = e.grid.getDataType(t),
                                r = e.grid.getDataType(t);
                            return n.isFunction(i) && (i = i()), i = e.data.convert(i, o, r, { culture: this.Ld("closestCulture"), format: t.dataFormatString || t.Ke, nullString: this.options.nullString, parser: t.dataParser })
                        }, o.prototype.toStr = function(t, i) {
                            var o = this.Bd.dataView(),
                                n = e.grid.getDataType(t),
                                r = "string";
                            return i = e.data.convert(i, n, r, { culture: this.Ld("closestCulture"), format: t.dataFormatString || t.Ke, nullString: this.options.nullString, parser: t.dataParser })
                        }, o.prototype.parseFailed = function(e, t, i, o) { return t }, o.prototype.ug = function() { return ["cellStyleFormatter", "rowStyleFormatter", "afterCellEdit", "afterCellUpdate", "beforeCellEdit", "beforeCellUpdate", "cellClicked", "columnDragging", "columnDragged", "columnDropping", "columnDropped", "columnResizing", "columnResized", "columnGrouping", "columnGrouped", "columnUngrouping", "columnUngrouped", "currentCellChanging", "currentCellChanged", "filtering", "filtered", "filterOperatorsListShowing", "groupAggregate", "groupText", "invalidCellValue", "pageIndexChanging", "pageIndexChanged", "selectionChanged", "sorting", "sorted", "dataLoading", "dataLoaded", "loading", "loaded", "rendering", "rendered"] }, o.prototype.gg = function() { return !this.options.disabled }, o.prototype.jg = function(t, i) {
                            var o, r, a, s, l, c = t.tagName.toLowerCase();
                            switch (c) {
                                case "input":
                                    return !!n(t).hasClass("gridinput") && (l = t, "text" !== l.type || (o = l.value.length, r = new e.grid.domSelection(l).getSelection(), a = e.getKeyCodeEnum(), s = i === a.UP || i === a.DOWN || i === a.PAGE_DOWN || i === a.PAGE_UP || 0 === r.length && (0 === r.start && (i === a.LEFT || i === a.HOME) || r.end >= o && (i === a.RIGHT || i === a.END))));
                                case "textarea":
                                case "select":
                                    return !1
                            }
                            return !0
                        }, o.prototype.cg = function() {
                            var e = (this.options.editingInitOption || "").toLowerCase();
                            switch (e) {
                                case "click":
                                case "doubleclick":
                                    break;
                                case "auto":
                                default:
                                    e = this.uf() ? "click" : "doubleclick"
                            }
                            return "click" === e
                        }, o.prototype.vg = function() {
                            var e = 0,
                                t = 0,
                                i = this.Ne();
                            return this.Ge() && e++, i && (t += i.length()), this.Oe() && t++, { x: e, y: t }
                        }, o.prototype.Zf = function(t) {
                            var i = -1,
                                o = e.grid.rowType,
                                n;
                            return t < 0 ? i : (n = this.Od().Wd(this.Rd().item(t)), n.type & e.grid.rowType.data ? n.dataItemIndex : -1)
                        }, o.prototype.re = function(t) {
                            var i = this.Bd.currentPosition(),
                                o = new e.grid.cellInfo(t, this.wg(i), null);
                            return o.rowIndex() < 0 ? o.cellIndex(-1) : o.cellIndex() < 0 && o.cellIndex(0), o
                        }, o.prototype.wg = function(t) {
                            var i = e.grid.rowType,
                                o = this.Od(),
                                n = this.Rd(),
                                r, a, s;
                            if (t < 0) return -1;
                            for (r = 0, a = n.length(); r < a; r++)
                                if (s = o.Wd(n.item(r)), s.type & i.data && s.dataItemIndex === t) return s.sectionRowIndex;
                            return -1
                        }, o.prototype.Vd = function(t) {
                            var i = 0,
                                o = 0,
                                n = this.Ld("visibleLeaves").length - 1,
                                r = t || !this.zd ? this.bf() - 1 : this.Rd().length() - 1;
                            return this.Ge() && n--, (n < 0 || r < 0) && (i = o = n = r = -1), new e.grid.cellInfoRange(new e.grid.cellInfo(i, o, null), new e.grid.cellInfo(n, r, null))
                        }, o.prototype.xg = function(e) { return this.dataView().item(e) }, o.prototype.fg = function(t) {
                            var i, o, n, r = this.Od(),
                                a = this.Rd(),
                                s = e.grid.rowType;
                            for (i = 0, o = a.length(); i < o; i++)
                                if (n = r.Wd(a.item(i)), n.type & s.data) return new e.grid.cellInfo(t, i);
                            return e.grid.cellInfo.outsideValue
                        }, o.prototype.ig = function(t, i, o, n) {
                            var r = i.cellIndex(),
                                a = i.rowIndex(),
                                s, l = e.getKeyCodeEnum();
                            switch (o) {
                                case l.PAGE_UP:
                                    this.yg && a === t.topLeft().rowIndex() ? a = t.bottomRight().rowIndex() : (a -= this.zg) < (s = t.topLeft().rowIndex()) && (a = s);
                                    break;
                                case l.PAGE_DOWN:
                                    this.yg && a === t.bottomRight().rowIndex() ? a = t.topLeft().rowIndex() : (a += this.zg) > (s = t.bottomRight().rowIndex()) && (a = s);
                                    break;
                                case l.END:
                                    r = this.yg && r === t.bottomRight().cellIndex() ? t.topLeft().cellIndex() : t.bottomRight().cellIndex();
                                    break;
                                case l.HOME:
                                    r = this.yg && r === t.topLeft().cellIndex() ? t.bottomRight().cellIndex() : t.topLeft().cellIndex();
                                    break;
                                case l.LEFT:
                                    r > t.topLeft().cellIndex() ? r-- : this.yg && (r = t.bottomRight().cellIndex());
                                    break;
                                case l.UP:
                                    a > t.topLeft().rowIndex() ? a-- : this.yg && (a = t.bottomRight().rowIndex());
                                    break;
                                case l.RIGHT:
                                    r < t.bottomRight().cellIndex() ? r++ : this.yg && (r = t.topLeft().cellIndex());
                                    break;
                                case l.ENTER:
                                case l.DOWN:
                                    a < t.bottomRight().rowIndex() ? a++ : this.yg && (a = t.topLeft().rowIndex());
                                    break;
                                case l.TAB:
                            }
                            return { cellIndex: r, rowIndex: a }
                        }, o.prototype.le = function(e, t) {
                            for (var i = e, o, n, r = null; i; i = i.parentNode)
                                if (n = i.nodeName.toLowerCase()) { if (i === this.outerDiv[0]) { o = i; break } t[n] && (r = i) } return o ? r : null
                        }, o.prototype.Ag = function(e) { var t, i = this.Vd(); return this.Bg() ? -1 : (t = e ? Math.min(this.options.staticRowIndex, i.bottomRight().rowIndex()) : Math.min(this.options.staticColumnIndex, i.bottomRight().cellIndex()), t < -1 && (t = -1), t) }, o.prototype.Cg = function(e) { var t = 0; return e ? this.Ge() && t++ : (t = this.He().length, this.options.showFilter && t++), t }, o.prototype.Dg = function() {
                            var e, t, i = this.Cg(!0),
                                o = this.Ag(!1),
                                n, r;
                            if (n = o + i, o >= 0) {
                                for (e = this.Ld("visibleLeaves"), t = e.length, r = n; n < t; n++)
                                    if (-1 === e[n].parentIdx) { n > r && n--; break } n >= t && (n = t - 1)
                            }
                            return n
                        }, o.prototype.Eg = function() { var e = this.Cg(!1); return this.Ag(!0) + e }, o.prototype.Le = function() {
                            var e = this.Ld("leaves"),
                                t, i, o, n = !1;
                            if (e)
                                for (t = 0, i = e.length; t < i && !n; t++) o = e[t], n = n || o.parentVis && "none" !== o.rowMerge;
                            return n
                        }, o.prototype.Fg = function() {
                            var e = this.Ld("leaves"),
                                t, i, o, n = !1;
                            for (t = 0, i = e.length; t < i && !n; t++) o = e[t], n = o.groupInfo && "none" !== o.groupInfo.position;
                            return n
                        }, o.prototype.Bg = function() { return this.Fg() || this.Le() }, o.prototype.He = function(e) { return arguments.length && this.Ld("columnsHeadersTable", e), this.Ld("columnsHeadersTable") }, o.prototype.Od = function() { return this.Ld("view") }, o.prototype.Ee = function() { var e = this.Ld("tfoot"); return e && e.length ? e[0] : null }, o.prototype.De = function() { var e = this.Ld("thead"); return e && e.length ? e[0] : null }, o.prototype.dg = function(e, t, i) { var o = this; return e === this.element ? 2 === arguments.length ? (n.each(t, function(t, i) { t in o.Dd || (o.Dd[t] = e.attr(t)) }), e.attr(t)) : (t in this.Dd || (this.Dd[t] = e.attr(t)), e.attr(t, i)) : 3 === arguments.length ? e.attr(t, i) : e.attr(t) }, o.prototype.bf = function() { return this.sketchTable.length }, o.prototype.Gg = function(e, t) { this.vd.x = e, this.vd.y = t }, o.prototype.Hg = function(e) { this.vd.index = e }, o.prototype.Ig = function() { return void 0 === this.Id && (this.Id = e.grid.getUID()), "gcuigrid" + this.Id }, o
                    }(e.gcuiWidget), t.gcuigrid = i, i.prototype.widgetEventPrefix = "gcuigrid", i.prototype.Qd = "gcuigrid", i.prototype.Hf = 1e3, i.prototype.yg = !1, i.prototype.zg = 10, i.prototype.Xe = !0, o = function() {
                        function e() { this.mobileCSS = { header: "ui-header ui-bar-a", content: "ui-body-c", stateHover: "ui-btn-down-c", stateActive: "ui-btn-down-c" }, this.allowColMoving = !1, this.allowColSizing = !1, this.allowEditing = !1, this.allowKeyboardNavigation = !0, this.allowPaging = !1, this.allowSorting = !1, this.allowVirtualScrolling = !1, this.cellStyleFormatter = void 0, this.columns = [], this.columnsAutogenerationMode = "merge", this.culture = "", this.customFilterOperators = [], this.data = null, this.editingInitOption = "auto", this.ensureColumnsPxWidth = !1, this.filterOperatorsSortMode = "alphabeticalCustomFirst", this.groupAreaCaption = "Drag a column here to group by that column.", this.groupIndent = 10, this.highlightCurrentCell = !1, this.highlightOnHover = !0, this.loadingText = "Loading...", this.nullString = "", this.pageIndex = 0, this.pageSize = 10, this.pagerSettings = { mode: "numeric", pageButtonCount: 10, position: "bottom" }, this.readAttributesFromData = !1, this.rowStyleFormatter = void 0, this.scrollMode = "none", this.selectionMode = "singleRow", this.showFilter = !1, this.showFooter = !1, this.showGroupArea = !1, this.showSelectionOnRender = !0, this.showRowHeader = !1, this.staticColumnIndex = -1, this.staticColumnsAlignment = "left", this.staticRowIndex = -1, this.totalRows = -1, this.afterCellEdit = null, this.afterCellUpdate = null, this.beforeCellEdit = null, this.beforeCellUpdate = null, this.cellClicked = null, this.columnDragging = null, this.columnDragged = null, this.columnDropping = null, this.columnDropped = null, this.columnGrouping = null, this.columnGrouped = null, this.columnResizing = null, this.columnResized = null, this.columnUngrouping = null, this.columnUngrouped = null, this.currentCellChanging = null, this.currentCellChanged = null, this.filterOperatorsListShowing = null, this.filtering = null, this.filtered = null, this.groupAggregate = null, this.groupText = null, this.invalidCellValue = null, this.pageIndexChanging = null, this.pageIndexChanged = null, this.selectionChanged = null, this.sorting = null, this.sorted = null, this.dataLoading = null, this.dataLoaded = null, this.loading = null, this.loaded = null, this.rendering = null, this.rendered = null }
                        return e
                    }(), i.prototype.options = e.grid.extendWidgetOptions(e.gcuiWidget.prototype.options, new o), n.gcui.registerWidget("gcuigrid", i.prototype)
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function(t) {
                            __extends(i, t);

                            function i() { t.apply(this, arguments) }
                            return i.prototype._create = function() {
                                var t = o.data(this.element[0], "gcuigridowner");
                                this.Ld("owner", t), e.grid.widgetName(this.element[0], this.widgetFullName), this.yd = !1, this.element.addClass(t.options.uiCSS.widget + " gcui-c1basefield " + t.options.uiCSS.stateDefault), this.options.disabled && this.disable(), t.options.allowColMoving && t.Me(!0).attach(this)
                            }, i.prototype._init = function() { this.element.wrapInner("<div class='gcui-gcuigrid-innercell'></div>"), this.Jg() }, i.prototype.destroy = function() { try { t.prototype.destroy.apply(this, arguments) } finally { this.yd = !0 } }, i.prototype._a = function() {
                                if (!this.Kg()) {
                                    var t = this.Lg();
                                    t && t.Me(!1) && t.Me(!1).detach(this), e.grid.remove$dataByPrefix(this.element, this.Qd), this.element.removeClass(t.options.uiCSS.widget + " gcui-c1basefield " + t.options.uiCSS.stateDefault).html(this.element.find(".gcui-gcuigrid-headertext").html())
                                }
                            }, i.prototype.Ld = function(t, i) { return e.grid.dataPrefix(this.element, this.Qd, t, i) }, i.prototype.Ze = function(e) {
                                var t = this.Qd + e;
                                this.element.removeData(t)
                            }, i.prototype._setOption = function(e, i) {
                                var o, n, r, a = this["preset_" + e],
                                    s = this.options[e];
                                void 0 !== a && (i = a.apply(this, [i, s])), o = i !== s, t.prototype._setOption.apply(this, [e, i]), o && (void 0 !== this.options.groupedIndex && (r = this.Lg().Ld("groupedWidgets")[this.options.groupedIndex]) && e in r.options && r._setOption(e, i), void 0 !== (n = this["postset_" + e]) && n.apply(this, [i, s]))
                            }, i.prototype.postset_allowMoving = function(e, t) {}, i.prototype.preset_clientType = function(e, t) { throw "read-only" }, i.prototype.postset_headerText = function(e, t) { this.Jg() }, i.prototype.postset_visible = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_width = function(t, i) {
                                var o, n = this.Lg();
                                n && (this.options.ensurePxWidth = !0, o = e.grid.getColumnByTravIdx(n.options.columns, this.options.travIdx), o && (o.found.width = t, o.found.ensurePxWidth = !0), n.setSize())
                            }, i.prototype.Lg = function() { return this.Ld("owner") }, i.prototype.Mg = function() { return this.options.allowSizing && this.Lg().options.allowColSizing }, i.prototype.Ng = function() { return !0 === this.options.allowMoving }, i.prototype.Og = function(t) { return !e.grid.isChildOf(this.Lg().options.columns, t, this) }, i.prototype.Pg = function(e) { return e.html(this.options.headerText || "&nbsp;") }, i.prototype.Qg = function(e) { return e.wrapInner('<span class="gcui-gcuigrid-headertext" />') }, i.prototype.Jg = function() {
                                var e = this.element.children(".gcui-gcuigrid-innercell").empty();
                                this.Pg(e), this.Qg(e)
                            }, i.prototype.Kg = function() { return this.yd }, i
                        }(e.gcuiWidget);
                    t.c1basefield = n, n.prototype.Qd = "c1basefield", i = function() {
                        function e() { this.allowMoving = !0, this.allowSizing = !0, this.cellFormatter = void 0, this.dataKey = void 0, this.ensurePxWidth = void 0, this.footerText = void 0, this.headerText = void 0, this.textAlignment = void 0, this.visible = !0, this.width = void 0 }
                        return e
                    }(), t.c1basefield_options = i, n.prototype.options = e.grid.extendWidgetOptions(e.gcuiWidget.prototype.options, new i), o.gcui.registerWidget("c1basefield", n.prototype)
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function(t) {
                            __extends(i, t);

                            function i() { t.apply(this, arguments) }
                            return i.prototype._create = function() {
                                t.prototype._create.apply(this, arguments);
                                var e = this.Lg();
                                this.element.addClass(e.options.uiCSS.widget + " gcui-c1field")
                            }, i.prototype._a = function() {
                                if (!this.Kg()) {
                                    var e = this.Lg();
                                    if (this.element.find("*").unbind("." + this.widgetName), this.$filterEditor) {
                                        switch (this.$filterEditor.closest("td").find("*").unbind("." + this.widgetName), this.Rg(this.options)) {
                                            case "date":
                                                this.$filterEditor.data("gcui-inputdate") && this.$filterEditor.gcuiinputdate("destroy");
                                                break;
                                            case "mask":
                                                this.$filterEditor.data("gcui-inputmask") && this.$filterEditor.gcuiinputmask("destroy");
                                                break;
                                            case "numberCurrency":
                                            case "numberNumber":
                                            case "numberPercent":
                                                this.$filterEditor.data("gcui-inputnumber") && this.$filterEditor.gcuiinputnumber("destroy")
                                        }
                                        this.$filterEditor = null
                                    }
                                    this.element.removeClass(e.options.uiCSS.widget + " gcui-c1field"), this.Sg(), t.prototype._a.apply(this, arguments)
                                }
                            }, i.prototype._init = function() {
                                t.prototype._init.apply(this, arguments), this.$filterEditor = null;
                                var e = this.Lg();
                                this.filterRow = e.Oe(), e.options.showFilter && this.options.showFilter && this.options.dataIndex >= 0 && this.Tg()
                            }, i.prototype.postset_aggregate = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_allowSort = function(e, t) { this.Jg() }, i.prototype.postset_dataType = function(e, t) { throw "read-only" }, i.prototype.postset_dataParser = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_dataFormatString = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_filterOperator = function(e, t) { this.Lg().ensureControl(!0) }, i.prototype.postset_filterValue = function(e, t) { this.Lg().ensureControl(!0) }, i.prototype.postset_groupInfo = function(e, t) { this.Lg().ensureControl(!0) }, i.prototype.postset_rowMerge = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_showFilter = function(e, t) { this.Lg().ensureControl(!1) }, i.prototype.postset_sortDirection = function(e, t) { this.options.sortOrder = 0, this.Lg().ensureControl(!0) }, i.prototype.postset_width = function(e, i) { t.prototype.postset_width.apply(this, arguments) }, i.prototype.Og = function(e) { return !!t.prototype.Og.apply(this, arguments) && !(void 0 !== this.options.groupedIndex && e instanceof o.gcui.c1groupedfield) }, i.prototype.Ug = function() { var e = this.Lg(); return e && e.options.allowSorting && this.options.allowSort && this.options.dataIndex >= 0 }, i.prototype.Qg = function(e) {
                                if (this.Ug()) {
                                    var i = this.Lg(),
                                        n = e.wrapInner('<a class="gcui-gcuigrid-headertext" href="#" role="button" />').children("a");
                                    switch (n.bind("click." + this.widgetName, this, o.proxy(this.Vg, this)), this.options.sortDirection) {
                                        case "ascending":
                                            e.append(o('<span class="gcui-gcuigrid-sort-icon ' + i.options.uiCSS.icon + " " + i.options.uiCSS.iconArrowUp + '">ascending</span>'));
                                            break;
                                        case "descending":
                                            e.append(o('<span class="gcui-gcuigrid-sort-icon ' + i.options.uiCSS.icon + " " + i.options.uiCSS.iconArrowDown + '">descending</span>'))
                                    }
                                } else t.prototype.Qg.apply(this, arguments)
                            }, i.prototype.Tg = function() {
                                var t = this.options.visLeavesIdx,
                                    i = this.Lg(),
                                    n = null,
                                    r, a, s = this,
                                    l, c = e.grid.HTML5InputSupport.getDefaultInputType(i.uf(), this.options);
                                if (t >= 0) {
                                    if (i = this.Lg(), !this.filterRow) throw "exception";
                                    if (n = o(e.grid.rowAccessor.getCell(this.filterRow, t)), this.$filterEditor = n.find("input"), n.bind(o.support.selectstart ? "selectstart" : "mousedown", function(e) { e.stopPropagation() }), null === (r = i.parse(this.options, e.grid.filterHelper.getSingleValue(this.options.filterValue))) || "undefined" === r) switch (e.grid.getDataType(this.options)) {
                                        case "boolean":
                                            r = !1;
                                            break;
                                        case "number":
                                        case "currency":
                                        case "datetime":
                                            r = 0;
                                            break;
                                        default:
                                            r = ""
                                    }
                                    switch (a = { culture: i.options.culture, disabled: i.options.disabled, decimalPlaces: function(e) { var t = /^(n|p|c){1}(\d*)$/.exec(e); return t && t[2] ? parseInt(t[2], 10) : (t = /^(d){1}(\d*)$/.exec(e), t ? 0 : 2) }(this.options.dataFormatString) }, l = this.Rg(this.options)) {
                                        case "date":
                                            "text" === c ? this.$filterEditor.gcuiinputdate(o.extend(a, { date: r, dateFormat: this.options.dataFormatString || void 0, showTrigger: !0 })) : this.Wg(this.$filterEditor, c, e.grid.HTML5InputSupport.toStr(r || new Date, c));
                                            break;
                                        case "mask":
                                            this.$filterEditor.gcuiinputmask({ text: r + "" });
                                            break;
                                        case "numberCurrency":
                                            this.$filterEditor.gcuiinputnumber(o.extend(a, { type: "currency", value: r }));
                                            break;
                                        case "numberNumber":
                                            "text" === c ? this.$filterEditor.gcuiinputnumber(o.extend(a, { value: r })) : this.Wg(this.$filterEditor, c, e.grid.HTML5InputSupport.toStr(r, c));
                                            break;
                                        case "numberPercent":
                                            this.$filterEditor.gcuiinputnumber(o.extend(a, { type: "percent", value: 100 * r }));
                                            break;
                                        default:
                                            throw e.grid.stringFormat('Unsupported editor type: "{0}"', l)
                                    }
                                    n.find(".gcui-gcuigrid-filter-trigger").attr({ role: "button", "aria-haspopup": "true" }).bind("mouseenter." + this.widgetName, function(e) { s.options.disabled || o(this).addClass(i.options.uiCSS.stateHover) }).bind("mouseleave." + this.widgetName, function(e) { s.options.disabled || o(this).removeClass(i.options.uiCSS.stateHover + " " + i.options.uiCSS.stateActive) }).bind("mouseup." + this.widgetName, this, function(e) { s.options.disabled || o(this).removeClass(i.options.uiCSS.stateActive) }).bind("mousedown." + this.widgetName, { column: this }, this.Xg).bind("click." + this.widgetName, function(e) { e.preventDefault() })
                                }
                            }, i.prototype.Wg = function(e, t, i) { return e.wrap('<span class="gcuigrid-input-wrapper"></span').attr("type", t).val(i) }, i.prototype.Xg = function(t) {
                                var i = t.data.column,
                                    n = 8,
                                    r = i.Lg(),
                                    a, s, l, c, d, p, u, h, f, g = e.grid.HTML5InputSupport.getDefaultInputType(r.uf(), i.options);
                                return !i.options.disabled && (i.$dropDownFilterList ? (i.Sg(), !1) : (t.target.focus(), a = e.grid.filterHelper.getSingleOperatorName(i.options.filterOperator).toLowerCase(), s = r.getFilterOperatorsByDataType(e.grid.getDataType(i.options)), l = { operators: o.extend(!0, [], s), column: i.options }, r.Xf(l), c = [], l.operators && o.each(l.operators, function(e, t) { c.push({ label: t.displayName || t.name, value: t.name, selected: t.name.toLowerCase() === a }) }), i.$dropDownFilterList = o('<div class="gcui-gcuigrid-filterlist"></div').appendTo(document.body).gcuilist({
                                    autoSize: !0,
                                    maxItemsCount: n,
                                    selected: function(t, o) {
                                        var n, a;
                                        switch (a = i.Rg(i.options)) {
                                            case "date":
                                                n = "text" === g ? i.$filterEditor.gcuiinputdate("option", "date") || new Date : e.grid.HTML5InputSupport.parse(i.$filterEditor.val(), g) || new Date;
                                                break;
                                            case "mask":
                                                n = i.$filterEditor.gcuiinputmask("option", "text");
                                                break;
                                            case "numberNumber":
                                                if ("text" !== g) { n = e.grid.HTML5InputSupport.parse(i.$filterEditor.val(), g) || 0; break }
                                            case "numberCurrency":
                                            case "numberPercent":
                                                n = i.$filterEditor.gcuiinputnumber("option", "value"), "numberPercent" === a && (n /= 100)
                                        }
                                        i.Sg(), r.Of(i, o.item.value, n)
                                    }
                                }), o.ui && o.fn.zIndex && (f = r.outerDiv.zIndex()) && f++, i.$dropDownFilterList.css("z-index", Math.max(f || 0, 9999)), i.$dropDownFilterList.gcuilist("setItems", c).gcuilist("renderList"), u = 150 | i.$dropDownFilterList.width(), i.$dropDownFilterList.width(c.length > n ? u + 20 : u).gcuilist("refreshSuperPanel").position({ of: o(this), my: "left top", at: "left bottom" }), i.$dropDownFilterList.$button = o(this), h = i.$dropDownFilterList.eventUID = e.grid.getUID(), void o(document).bind("mousedown." + i.widgetName + "." + h, { column: i }, i.Yg)))
                            }, i.prototype.Yg = function(e) {
                                var t = o(e.target),
                                    i = t.parents(".gcui-gcuigrid-filterlist:first"),
                                    n = t.is(".gcui-gcuigrid-filter-trigger") ? t : t.parents(".gcui-gcuigrid-filter-trigger:first");
                                n.length && n[0] === e.data.column.$dropDownFilterList.$button[0] || i.length && i[0] === e.data.column.$dropDownFilterList[0] || e.data.column.Sg()
                            }, i.prototype.Vg = function(e) {
                                if (e.data.options.disabled) return !1;
                                if (e.data.options.allowSort) {
                                    var t = e.data.Lg();
                                    t.Ff(e.data.options, e.ctrlKey)
                                }
                                return !1
                            }, i.prototype.Sg = function() {
                                if (this.$dropDownFilterList) {
                                    var e = this.$dropDownFilterList.eventUID;
                                    this.$dropDownFilterList.remove(), this.$dropDownFilterList = null, o(document).unbind("mousedown." + this.widgetName + "." + e, this.Yg)
                                }
                            }, i.prototype.Rg = function(t) {
                                switch (e.grid.getDataType(t)) {
                                    case "number":
                                        return t.dataFormatString && 0 === t.dataFormatString.indexOf("p") ? "numberPercent" : "numberNumber";
                                    case "currency":
                                        return "numberCurrency";
                                    case "datetime":
                                        return "date";
                                    default:
                                        return "mask"
                                }
                            }, i
                        }(t.c1basefield);
                    t.c1field = n, i = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments), this.aggregate = "none", this.allowSort = !0, this.dataType = void 0, this.inputType = void 0, this.dataParser = void 0, this.dataFormatString = void 0, this.filterOperator = "nofilter", this.filterValue = void 0, this.groupInfo = { expandInfo: [], level: void 0, groupSingleRow: !0, collapsedImageClass: o.gcui.uiCSS.iconArrowRight, expandedImageClass: o.gcui.uiCSS.iconArrowRightDown, position: "none", outlineMode: "startExpanded", headerText: void 0, footerText: void 0 }, this.readOnly = !1, this.rowMerge = "none", this.showFilter = !0, this.sortDirection = "none", this.valueRequired = !1 }
                        return t
                    }(t.c1basefield_options), t.c1field_options = i, n.prototype.options = e.grid.extendWidgetOptions(t.c1basefield.prototype.options, new i), o.gcui.registerWidget("c1field", o.gcui.c1basefield, n.prototype)
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function(e) {
                            __extends(t, e);

                            function t() { e.apply(this, arguments) }
                            return t.prototype._create = function() {
                                e.prototype._create.apply(this, arguments);
                                var t = this.Lg();
                                this.element.addClass(t.options.uiCSS.widget + " gcui-c1band")
                            }, t.prototype.Og = function(t) { return !!e.prototype.Og.apply(this, arguments) && !(t instanceof o.gcui.c1groupedfield) }, t
                        }(t.c1basefield);
                    t.c1band = n, i = function(e) {
                        __extends(t, e);

                        function t() { e.apply(this, arguments), this.columns = [] }
                        return t
                    }(t.c1field_options), n.prototype.options = e.grid.extendWidgetOptions(t.c1basefield.prototype.options, new i), o.gcui.registerWidget("c1band", o.gcui.c1basefield, n.prototype)
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function(t) {
                            __extends(o, t);

                            function o() { t.apply(this, arguments) }
                            return o.prototype._create = function() {
                                var t = i.data(this.element[0], "gcuigridowner");
                                this.Ld("owner", t), e.grid.widgetName(this.element[0], this.widgetFullName), this.yd = !1, this.element.addClass("gcui-gcuigrid-group-button " + t.options.uiCSS.stateDefault + " " + t.options.uiCSS.cornerAll), this.options.disabled && this.disable(), t.options.allowColMoving && t.Me(!0).attach(this)
                            }, o.prototype._init = function() { this.Jg() }, o.prototype.destroy = function() { try { t.prototype.destroy.apply(this, arguments) } finally { this.yd = !0 } }, o.prototype._a = function() {
                                if (!this.Kg()) {
                                    this.element.find("*").unbind("." + this.widgetName);
                                    var t = this.Lg();
                                    t && t.Me(!1) && t.Me(!1).detach(this), e.grid.remove$dataByPrefix(this.element, this.Qd)
                                }
                            }, o.prototype.Ld = function(t, i) { return e.grid.dataPrefix(this.element, this.Qd, t, i) }, o.prototype.Ze = function(e) {
                                var t = this.Qd + e;
                                this.element.removeData(t)
                            }, o.prototype._setOption = function(e, i) {
                                var o = this["preset_" + e],
                                    n = this.options[e],
                                    r, a;
                                void 0 !== o && (i = o.apply(this, [i, n])), r = i !== n, t.prototype._setOption.apply(this, [e, i]), r && void 0 !== (a = this["postset_" + e]) && a.apply(this, [i, n])
                            }, o.prototype.postset_headerText = function(e, t, i) { this.Jg() }, o.prototype.postset_allowSort = function(e, t, i) { this.Jg() }, o.prototype.Lg = function() { return this.Ld("owner") }, o.prototype.Mg = function() { return this.options.allowSizing && this.Lg().options.allowColSizing }, o.prototype.Ng = function() { return !0 === this.options.allowMoving }, o.prototype.Og = function(t) { return t instanceof i.gcui.c1groupedfield && !e.grid.isChildOf(this.Lg().options.columns, t, this) }, o.prototype.Ug = function() { var e = this.Lg(); return e && e.options.allowSorting && this.options.allowSort && this.options.dataIndex >= 0 }, o.prototype.Jg = function() {
                                var e = this.Lg().options.uiCSS,
                                    t = i('<span class="gcui-gcuigrid-group-button-close ' + e.stateDefault + " " + e.cornerAll + '"><span class="' + e.icon + " " + e.iconClose + '"></span></span>').bind("click." + this.widgetName, this, this.Zg);
                                if (this.element.html(this.options.headerText || "").prepend(t).bind("click." + this.widgetName, this, i.proxy(this.Vg, this)), this.Ug()) switch (this.options.sortDirection) {
                                    case "ascending":
                                        this.element.append(i('<span class="gcui-gcuigrid-group-button-sort ' + e.icon + " " + e.iconArrowUp + '"></span>'));
                                        break;
                                    case "descending":
                                        this.element.append(i('<span class="gcui-gcuigrid-group-button-sort ' + e.icon + " " + e.iconArrowDown + '"></span>'))
                                }
                            }, o.prototype.Zg = function(e) { var t = e.data.options; return t.disabled || e.data.Lg().Rf(e.data.options.travIdx), !1 }, o.prototype.Vg = function(t) {
                                var i = t.data.Lg(),
                                    o = t.data.options,
                                    n;
                                return !o.disabled && o.allowSort && (n = e.grid.search(i.columns(), function(e) { return e.options.travIdx === o.travIdx }), (n = n.found ? n.found.options : e.grid.getColumnByTravIdx(i.options.columns, o.travIdx).found) && i.Ff(n, t.ctrlKey)), !1
                            }, o.prototype.Kg = function() { return this.yd }, o
                        }(e.gcuiWidget);
                    t.c1groupedfield = o, o.prototype.Qd = "c1groupedfield", o.prototype.options = i.extend(!0, {}, e.gcuiWidget.prototype.options, { uiCSS: { header: "ui-header ui-bar-a", content: "ui-body-c", stateDefault: "ui-btn-up-c", stateHover: "ui-btn-down-c", stateActive: "ui-btn-down-c" }, allowMoving: !0, allowSort: !0, headerText: void 0, sortDirection: "none" }), i.gcui.registerWidget("c1groupedfield", o.prototype)
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t() {}
                            return t.prototype.generateSpanTable = function(e, t) { this.kg = this.$g = this.ah = this.bh = 0, this.eh = [], this.fh = [], this.gh = []; var i = this.hh(e, t, !0); return i }, t.prototype.hh = function(t, i, o) {
                                var n, r, a = this;
                                for (this.kg = this.getVisibleHeight(t, o), i = i || [], e.grid.traverse(t, function(e) { e.isLeaf && i.push(e), a.fh.push(e) }), this.$g = i.length, n = 0; n < this.kg; n++)
                                    for (this.eh[n] = [], r = 0; r < this.$g; r++) this.eh[n][r] = { column: null, colSpan: 0, rowSpan: 0 };
                                return this.ih(t, 0, 0), this.eh
                            }, t.prototype.getVisibleHeight = function(e, t) {
                                var o, n, r, a, s = 0;
                                if (i.isArray(e))
                                    for (o = 0, n = e.length; o < n; o++) a = this.getVisibleHeight(e[o], t), s = Math.max(s, a);
                                else if (r = void 0 === e.visible || e.visible, e.parentVis = r && t, e.isBand) {
                                    for (o = 0, n = e.columns.length; o < n; o++) a = this.getVisibleHeight(e.columns[o], e.parentVis), s = Math.max(s, a);
                                    if (!e.parentVis) return s;
                                    e.isLeaf = 0 === s, s++
                                } else e.isLeaf = !0, e.parentVis && (s = 1);
                                return s
                            }, t.prototype.jh = function(e) {
                                for (; e;)
                                    if ((e = this.fh[e.parentIdx]) && (e.parentVis || void 0 === e.parentVis)) return e;
                                return null
                            }, t.prototype.ih = function(e, t, o) {
                                var n, r, a, s, l, c;
                                if (i.isArray(e))
                                    for (n = 0, r = e.length; n < r; n++) this.ih(e[n], t, o);
                                else {
                                    if (void 0 === e.travIdx) throw "undefined travIdx";
                                    if (a = o + this.bh, e.parentVis && (s = a + this.ah, this.eh[t][s].column = e, this.gh[e.travIdx] = s), e.isBand)
                                        for (n = 0, r = e.columns.length; n < r; n++) this.ih(e.columns[n], t + 1, o);
                                    e.parentVis ? this.bh - a == 0 ? (this.eh[t][this.gh[e.travIdx]].rowSpan = this.kg - t, this.bh++) : this.eh[t][this.gh[e.travIdx]].colSpan = this.bh - a : !e.isBand && this.kg > 0 && (c = this.jh(e), l = !!c && c.isLeaf, l && this.ah++, t >= this.kg && (t = this.kg - 1), s = o + this.bh + this.ah, this.eh[t][s].column = e, l || (c && this.gh[c.travIdx] === s && this.kh(s, t), this.ah++))
                                }
                            }, t.prototype.kh = function(e, t) { var i; for (i = 0; i < t; i++) this.eh[i][e + 1] = this.eh[i][e], this.eh[i][e] = { column: null, colSpan: 0, rowSpan: 0 }, this.eh[i][e + 1].column && this.gh[this.eh[i][e + 1].column.travIdx]++ }, t
                        }();
                    t.bandProcessor = o;

                    function n(e) { var t = []; return r(e, t), t } t.getAllLeaves = n;

                    function r(e, t) {
                        var i, o, n, a;
                        if (e)
                            for (i = 0, o = e.length; i < o; i++) n = e[i], n.options && (n = n.options), a = n.columns, a && a.length ? r(a, t) : t.push(n)
                    }

                    function a(e, t) {
                        var i, o, n, r = null;
                        if (e && t >= 0)
                            for (i = 0, o = e.length; i < o && !r; i++) {
                                if (n = e[i], n.options && (n = n.options), n.travIdx === t) return { found: n, at: e };
                                n.columns && (r = this.getColumnByTravIdx(n.columns, t))
                            }
                        return r
                    }
                    t.getColumnByTravIdx = a;

                    function s(e, t, i) {
                        if (t.options && (t = t.options), i.options && (i = i.options), i.isBand && t.parentIdx >= 0) {
                            if (t.parentIdx === i.travIdx) return !0;
                            if (t.parentIdx > i.travIdx)
                                for (var o = this.flatten(e);;) { if (t = o[t.parentIdx], t.travIdx === i.travIdx) return !0; if (-1 === t.parentIdx) break }
                        }
                        return !1
                    }
                    t.isChildOf = s;

                    function l(e) { var t = []; return c(e, t), t } t.getLeaves = l;

                    function c(e, t) {
                        var i, o, n;
                        if (e)
                            for (i = 0, o = e.length; i < o; i++) n = e[i], n.isLeaf && t.push(n), n.columns && c(n.columns, t)
                    }

                    function d(e) { return p(e, 0, -1) } t.setTraverseIndex = d;

                    function p(e, t, i) {
                        var o, n, r;
                        if (e)
                            for (o = 0, n = e.length; o < n; o++) r = e[o], r.options && (r = r.options), r.linearIdx = o, r.travIdx = t++, r.parentIdx = i, r.columns && (t = p(r.columns, t, t - 1));
                        return t
                    }

                    function u(t) { var i = []; return e.grid.traverse(t, function(e) { i.push(e) }), i } t.flatten = u;

                    function h(t, o) {
                        var n, r, a;
                        if (t && i.isFunction(o))
                            for (n = 0; n < t.length; n++) a = t[n], a.options && (a = a.options), r = t.length, o(a, t), t.length === r ? a.columns && e.grid.traverse(a.columns, o) : n--
                    }
                    t.traverse = h
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(t) {
                                if (this.lh = void 0, this.mh = void 0, this.nh = void 0, this.oh = void 0, this.ph = void 0, this.qh = void 0, !t) throw "exception";
                                this.rh = t, this.Jd = t.Bd.dataView(), this.uh = new e.grid.filterOperatorsCache(t)
                            }
                            return t.prototype.compareSettings = function() {
                                var t = !0,
                                    i, o, n, r;
                                if (t = (i = this.DVPagingSettings()) === (o = this.WGPagingSettings()), !t && i && o && (t = i.pageSize === o.pageSize && i.pageIndex === o.pageIndex), t && !(t = (i = this.DVSortingSettings()) === (o = this.WGSortingSettings())) && i && o && (r = i.length) === o.length)
                                    for (t = !0, n = 0; n < r && t; n++) t = i[n].dataKey === o[n].dataKey && i[n].sortDirection === o[n].sortDirection;
                                return t && (i = this.DVFilteringSettings(), o = this.WGFilteringSettings(), t = e.grid.compareObj(i, o)), t
                            }, t.prototype.DVFilteringSettings = function() {
                                function e(t, o) {
                                    var n;
                                    i.each(t, function(t, r) { "string" == typeof r ? n = r : i.isArray(r) ? e(r, o) : (o.filterValue.push(r.value), o.filterOperator.push({ name: r.originalOperator || r.operator, condition: n })) })
                                }
                                if (void 0 === this.lh) {
                                    var t = [],
                                        o = this.Jd.filter();
                                    o && i.each(o, function(o, n) {
                                        var r = { dataKey: o };
                                        i.isArray(n) ? (r.filterValue = [], r.filterOperator = [], e(n, r)) : i.isPlainObject(n) ? (r.filterValue = n.value, r.filterOperator = n.originalOperator || n.operator || "Equals") : (r.filterValue = n, r.filterOperator = "Equals"), t.push(r)
                                    }), this.lh = t.length ? t : null
                                }
                                return this.lh
                            }, t.prototype.DVPagingSettings = function() { var t, i; return void 0 === this.mh && (t = e.grid.asPagedDataView(this.Jd)) && (i = t.pageSize(), this.mh = i > 0 ? { pageSize: t.pageSize(), pageIndex: t.pageIndex() } : null), this.mh }, t.prototype.DVSortingSettings = function() { var t, o; return void 0 === this.nh && (t = [], (o = e.data.sorting.compile(this.Jd.sort()).normalized) && i.each(o, function(e, i) { null !== i && t.push({ dataKey: "string" == typeof i ? i : i.property, sortDirection: i.asc || void 0 === i.asc ? "ascending" : "descending" }) }), this.nh = t.length ? t : null), this.nh }, t.prototype.WGFilteringSettings = function() {
                                if (void 0 === this.oh) {
                                    var t = [],
                                        o = this.rh.Ld("leaves"),
                                        n = this;
                                    o && i.each(o, function(i, o) {
                                        if (e.grid.validDataKey(o.dataKey) && o.filterOperator) {
                                            var r = e.grid.deepExtend({}, { foo: o.filterValue }).foo,
                                                a = e.grid.deepExtend({}, { foo: o.filterOperator }).foo,
                                                s = e.grid.filterHelper.verify(a, r, o.dataType, n.uh);
                                            s && t.push({ owner: o, dataKey: o.dataKey, filterValue: s.filterValue, filterOperator: s.filterOperator })
                                        }
                                    }), this.oh = t.length ? t : null
                                }
                                return this.oh
                            }, t.prototype.WGPagingSettings = function() { return void 0 === this.ph && (this.ph = this.rh.options.allowPaging ? { pageSize: this.rh.options.pageSize, pageIndex: this.rh.options.pageIndex } : null), this.ph }, t.prototype.WGSortingSettings = function() {
                                if (void 0 === this.qh) {
                                    var t = {},
                                        o = [],
                                        n = this.rh.Re(!0),
                                        r = this.rh.Ld("leaves") || [],
                                        a = function(t) { return !t.isBand && t.allowSort && e.grid.validDataKey(t.dataKey) },
                                        s = 0;
                                    this.rh.options.allowSorting && (i.each(n, function(e, i) { a(i) && ("none" === i.sortDirection && (i.sortDirection = "ascending"), t[i.dataKey] = { dataKey: i.dataKey, sortDirection: i.sortDirection, sortOrder: s++ }) }), s++, i.each(r, function(e, i) { a(i) && ("ascending" !== i.sortDirection && "descending" !== i.sortDirection || t[i.dataKey] || (t[i.dataKey] = { dataKey: i.dataKey, sortDirection: i.sortDirection, sortOrder: (i.sortOrder || 0) + s })) }), i.each(t, function(e, t) { o.push(t) }), o.sort(function(e, t) { return e.sortOrder - t.sortOrder }), i.each(o, function(e, t) { delete t.sortOrder })), this.qh = o.length ? o : null
                                }
                                return this.qh
                            }, t.prototype.MapWGToDV = function() {
                                var t, o, n = this,
                                    r = {};
                                return this.vh() && (t = this.WGPagingSettings()) ? (r.pageIndex = t.pageIndex, r.pageSize = t.pageSize) : r.pageSize = -1, this.wh() && (r.sort = [], (t = this.WGSortingSettings()) && (r.sort = [], i.each(t, function(e, t) { r.sort.push({ property: t.dataKey, asc: "ascending" === t.sortDirection }) }))), this.rh.deficientFilters = {}, this.xh() && (i.each(this.rh.Ld("leaves"), function(t, i) { e.grid.validDataKey(i.dataKey) && void 0 === i.filterOperator ^ void 0 === i.filterValue && (n.rh.deficientFilters[i.dataKey] = { filterOperator: i.filterOperator, filterValue: i.filterValue }) }), r.filter = {}, (t = this.WGFilteringSettings()) && (r.filter = this.yh(t)), i.isEmptyObject(r.filter) && (r.filter = null)), r
                            }, t.prototype.MapDVToWG = function() {
                                var t, o = {},
                                    n = this.wh(),
                                    r = this.vh(),
                                    a = this.xh(),
                                    s = e.grid.asPagedDataView(this.Jd),
                                    l = this;
                                i.each(this.rh.Ld("leaves"), function(e, t) { n && (t.sortOrder = 0, t.sortDirection = "none"), a && (t.filterOperator = "nofilter", t.filterValue = void 0), o[t.dataKey] = t }), r && s && (this.rh.options.pageSize = s.pageSize(), this.rh.options.pageIndex = s.pageIndex()), n && (t = this.DVSortingSettings()) && i.each(t, function(e, t) {
                                    var i;
                                    (i = o[t.dataKey]) && (i.sortDirection = t.sortDirection, i.sortOrder = e)
                                }), a && ((t = this.DVFilteringSettings()) && i.each(t, function(e, t) {
                                    var n;
                                    (n = o[t.dataKey]) && (n.filterValue = t.filterValue, n.filterOperator = t.filterOperator, i.isPlainObject(n.filterOperator) && (n.filterOperator = n.filterOperator.name), delete l.rh.deficientFilters[n.dataKey])
                                }), i.each(this.rh.deficientFilters, function(e, t) { o[e].filterOperator = t.filterOperator, o[e].filterValue = t.filterValue }))
                            }, t.prototype.vh = function() { return this.rh.options.allowPaging && !this.rh.me() && !this.rh.oe() }, t.prototype.wh = function() { return this.rh.options.allowSorting && !this.rh.oe() }, t.prototype.xh = function() { return !this.rh.oe() }, t.prototype.makeProxyFilter = function(t, o, n, r) { var a, s, l, c, d, p; return n = n.toLowerCase(), a = this, s = "datetime" === t.dataType, l = { originalOperator: void 0, property: o, operator: n, value: r }, c = this.uh.getByNameInt(n), d = e.data.filtering.ops[n], "nofilter" !== n && (c.isCustom || s) && (l.originalOperator = l.operator, c.isCustom ? (l.operator = i.extend(!0, {}, c.op), l.operator.apply = l.operator.operator) : (l.operator = i.extend(!0, {}, d), p = t.inputType ? e.grid.TimeUnitConverter.convertInputType(t.inputType) : e.grid.TimeUnitConverter.convertFormatString(t.dataFormatString || "d"), l.operator.apply = function(i, o) { return i instanceof Date || (i = a.rh.parse(t, i)), o instanceof Date || (o = a.rh.parse(t, o)), e.grid.TimeUnitConverter.cutDate(i, p), e.grid.TimeUnitConverter.cutDate(o, p), d.apply(i, o) })), l }, t.prototype.yh = function(e) {
                                var t = {},
                                    o = this;
                                return i.each(e, function(e, n) {
                                    var r = n.dataKey,
                                        a = [],
                                        s = "and",
                                        l, c, d, p;
                                    if (i.isPlainObject(n) && (c = n.filterOperator, d = n.filterValue, null != c)) {
                                        if (i.isArray(c) || (c = [c]), i.isArray(d) || (d = [d]), c.length != d.length) throw "The number of filter operators must match the number of filter values";
                                        0 != c.length && (i.each(c, function(e, t) {
                                            var c;
                                            if ("string" == typeof t && (t = { name: t }), !i.isPlainObject(t) || !t.name) throw "Invalid filter operator";
                                            c = d[e], i.isArray(c) || (c = [c]), p = i.map(c, function(e) { return o.makeProxyFilter(n.owner, r, t.name, e) });

                                            function u() { p.length > 1 ? p.splice(0, 0, "or") : p = p[0] }

                                            function h() { null == s && (s = l, a.splice(0, 0, l)) } s = null, l = t.condition || "or", a.length <= 1 || s == l ? 1 == p.length || a.length <= 1 || "or" == s ? (a = a.concat(p), h()) : (u(), a.push(p), h()) : (u(), a = [a, p], h())
                                        }), i.each(a, function(e, t) { i.isArray(t) && 2 == t.length && (a[e] = t[1]) }), 2 != a.length || (a[0], 0) || a.shift(), 1 == a.length && (a = a[0]), t[r] = a)
                                    }
                                }), t
                            }, t
                        }();
                    t.settingsManager = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function t(e) { this.zh = null, this.Ah = !1, this.Bh = !1, this.Ch = !1, this.Dh = null, this.Eh = null, this.Fh = null, this.Gh = 0, this.Hh = [], this.Ih = !1, this.Jh = !1, this.Kh = !1, this.rh = e, this.Lh() }
                            return t.prototype.data = function() {
                                var t = this.Mh(),
                                    i = e.grid.asPagedDataView(t);
                                return { data: this.Nh(), totalRows: null != i ? i.totalItemCount() : (t.getSource() || []).length, totals: this.Oh(), emptyData: this.isBoundedToDOM() ? this.zh.emptyData : null }
                            }, t.prototype.dataView = function() { return this.Mh() }, t.prototype.dispose = function() {
                                var e = this.Mh();
                                this.Ph.dispose(), o.each(this.Hh, function(e, t) { t.dispose() }), e && this.Ih && e.dispose(), this.rh.Jd = null
                            }, t.prototype.ignoreChangeEvent = function(e) {
                                if (!arguments.length) return this.Bh;
                                this.Bh = !0 === e
                            }, t.prototype.ignoreCurrentChangedEvent = function(e) {
                                if (!arguments.length) return this.Ch;
                                this.Ch = !0 === e
                            }, t.prototype.isDataLoaded = function() { var e = this.Mh(); return e.isLoaded() }, t.prototype.isOwnDataView = function() { return this.Ih }, t.prototype.getFieldsInfo = function() { var e = this.Mh(); return this.Qh(e.getProperties()) }, t.prototype.Qh = function(e) { var t = {}; return e && o.each(e, function(e, i) { "$$hash" !== i.name && (t[i.name] = { name: i.name, type: i.type || "string" }) }), t }, t.prototype.isBoundedToDOM = function() { return null !== this.zh }, t.prototype.load = function(t) {
                                var i, o, n, r;
                                this.Eh = t, i = this.Mh(), i || (this.Lh(), i = this.Mh()), this.ue(), o = new e.grid.settingsManager(this.rh), this.Rh(o) ? (n = o.MapWGToDV(), r = !1, this.Jh && !this.Kh && i.isLoaded() && (r = !0), this.ignoreCurrentChangedEvent(!0), i.refresh(n, r)) : this.isDataLoaded() && (this.xe(), this.we())
                            }, t.prototype.currentPosition = function(e) {
                                var t = this.Mh();
                                if (!arguments.length) return t.currentPosition();
                                this.ignoreCurrentChangedEvent(!0);
                                try { t.currentPosition(e) } finally { this.ignoreCurrentChangedEvent(!1) }
                            }, t.prototype.getValue = function(e, t) { var i = this.Mh(); return "number" == typeof t && (t += ""), i.getProperty(e, t) }, t.prototype.setValue = function(e, t, i) {
                                var o = this.Mh();
                                this.ignoreChangeEvent(!0);
                                try { "number" == typeof t && (t += ""), o.setProperty(e, t, i) } finally { this.ignoreChangeEvent(!1) }
                            }, t.prototype.makeDirty = function() { this.Ph.removeAll(), this.Fh = null, this.Dh = null }, t.prototype.Lh = function() {
                                var t, i, n = this.rh.options.data,
                                    r = this.Mh(),
                                    a = !1;
                                r || (n || (this.zh = this.Sh(this.rh.element, this.rh.options.readAttributesFromData), n = this.zh.items), a = "undefined" != typeof gcuidatasource && n instanceof gcuidatasource, this.Ih = o.isArray(n) || a, this.Jh = !(!this.Ih || !a), this.Kh = !!(this.Ih && a && n.dynamic), this.Ih ? (!this.zh && this.rh.options.readAttributesFromData && this.Th(n), i = this.isBoundedToDOM() && e.grid.getTableSection(this.rh.element, e.grid.rowScope.body), r = e.grid.GridDataView.create(e.data.asDataView(this.Uh(n, i)))) : r = n, this.rh.Jd = r, this.Hh.push(r.isLoading.subscribe(o.proxy(this.Vh, this))), this.Hh.push(r.isLoaded.subscribe(o.proxy(this.Wh, this))), this.Hh.push(r.subscribe(o.proxy(this.Xh, this))), this.Hh.push(r.currentPosition.subscribe(o.proxy(this.Yh, this))), this.Ph = new e.grid.propChangeListener(o.proxy(this.Zh, this)))
                            }, t.prototype.Uh = function(t, i) { var n, r, a, s, l = this; return t && t.length && (n = o.extend(!0, [], this.rh.options.columns), r = e.data.ArrayDataViewBase.Ca(t[0]) || [], a = this.Qh(r), s = [], this.rh.Zd(n, "merge", a, !0, !0), e.grid.traverse(n, function(t) { e.grid.validDataKey(t.dataKey) && s.push(t) }), n.length && o.each(t, function(t, o) { e.grid.dataViewWrapper.$h(l.rh, o, i && i.rows[t], s) })), t }, t.$h = function t(i, n, r, a) { return o.each(a, function(t, o) { var a, s, l; "string" !== e.grid.getDataType(o) && e.grid.validDataKey(o.dataKey) && (a = n[o.dataKey], s = i.parse(o, a), isNaN(s) && (l = null, r && (l = r.cells[o.dataKey]), s = i.parseFailed(o, a, n, l)), n[o.dataKey] = s) }), n }, t.prototype.Mh = function() { return this.rh.Jd }, t.prototype.Rh = function(e) { var t = this.Mh(); return !!(this.Kh || this.Jh && !t.isLoaded()) || (!(!this.Ih || this.Jh || !this.isDataLoaded()) || (!this.isDataLoaded() && !t.isLoading() || !e.compareSettings())) }, t.prototype._h = function(e) { if (!this.Ih && this.rh.options.allowPaging && (e.DVPagingSettings() || {}).pageSize !== (e.WGPagingSettings() || {}).pageSize) throw "The pageSize option of the external dataView can't be changed." }, t.prototype.Vh = function(e) { this.Ah || e && (this.Eh || this.ue()) }, t.prototype.Wh = function(e) { this.Ah || e && this.xe() }, t.prototype.Xh = function(e) {
                                var t = this;
                                if (!this.Ah && !this.Bh) {
                                    if (e.changes) {
                                        if (e.length && "detached" === e[0].entityState()) return;
                                        o.each(e.changes, function(e, i) {
                                            switch (i.changeType) {
                                                case "remove":
                                                    t.Ph.remove(i.index);
                                                    break;
                                                case "add":
                                                    t.Ph.insert(i.index, i.element)
                                            }
                                        })
                                    }
                                    this.ai.apply(this, arguments)
                                }
                            }, t.prototype.Yh = function() { this.Ah || this.Ch || this.bi.apply(this, arguments) }, t.prototype.we = function() { try { this.ignoreCurrentChangedEvent(!1), this.makeDirty(), this.rh.we(this.Eh) } finally { this.Eh = null } }, t.prototype.Zh = function(e) {
                                var t = this;
                                this.Gh > 0 && (window.clearTimeout(this.Gh), this.Gh = 0), -1 != this.Gh && (this.Gh = window.setTimeout(function() { t.Gh = -1, t.rh.yd || t.ai(), t.Gh = 0 }, 100))
                            }, t.prototype.ai = function(e) { this.we() }, t.prototype.bi = function(e, t) { this.rh.qe(e, t) }, t.prototype.ue = function() { this.rh.ue() }, t.prototype.xe = function() { this.rh.xe() }, t.prototype.Nh = function() {
                                var e, t, i, o, n;
                                if (!this.Dh)
                                    for (e = this.Mh(), t = e.count(), this.Dh = [], i = !0, o = 0; o < t; o++) n = e.item(o), i && (this.Ph.insert(o, n) || 0 !== o || (i = !1)), this.Dh.push(this.qf(n, o));
                                return this.Dh || (this.Dh = []), this.Dh
                            }, t.prototype.Oh = function() {
                                if (!this.Fh) {
                                    var e = this.Mh();
                                    this.Fh = this.ci(e, this.rh.$e(!0))
                                }
                                return this.Fh || (this.Fh = {}), this.Fh
                            }, t.prototype.ci = function(t, i) {
                                if (!i || 0 === i.length) return {};
                                var o, n, r, a, s = [],
                                    l = {};
                                for (o = 0, n = i.length; o < n; o++) s.push(new e.grid.tally);
                                for (o = 0, n = t.count(); o < n; o++)
                                    for (r = 0, a = s.length; r < a; r++) s[r].add(this.rh.parse(i[r].column, this.getValue(o, i[r].column.dataKey)));
                                for (o = 0, n = s.length; o < n; o++) l[i[o].column.dataKey] = s[o].getValueString(i[o].column);
                                return l
                            }, t.prototype.Sh = function(t, i) { var n = { items: [], emptyData: [], header: e.grid.readTableSection(t, e.grid.rowScope.head) }; return 1 === e.grid.getTableSectionLength(t, 2) && o(e.grid.getTableSectionRow(t, 2, 0)).hasClass("gcui-gcuigrid-emptydatarow") ? n.emptyData = e.grid.readTableSection(t, e.grid.rowScope.body) : n.items = e.grid.readTableSection(t, e.grid.rowScope.body, i), n }, t.prototype.Th = function(t) {
                                o.each(t, function(t, i) {
                                    var n = e.data.Expando.getFrom(i, !0),
                                        r;
                                    r = n[e.grid.EXPANDO] = { cellsAttributes: {}, rowAttributes: {} }, i.rowAttributes && (r.rowAttributes = i.rowAttributes, delete i.rowAttributes), o.each(i, function(e, t) { o.isArray(t) && (r.cellsAttributes[e] = t[1], i[e] = t[0]) })
                                })
                            }, t.prototype.qf = function(e, t) { return { values: e, originalRowIndex: t } }, t.prototype.rf = function() { var e = this.Mh(); if (e) try { this.Ah = !0, e.refresh() } finally { this.Ah = !1 } }, t.prototype.di = function(t, i) {
                                var o = this.Mh();
                                e.grid.GridDataView, o.di(t, i)
                            }, t.prototype.nf = function(t, i, o) {
                                var n = this.Mh();
                                e.grid.GridDataView, 2 === arguments.length ? n.nf(t, i) : n.nf(t, i, o)
                            }, t.prototype.pf = function(t) {
                                var i = this.Mh();
                                e.grid.GridDataView, i.pf(t)
                            }, t
                        }();
                    t.dataViewWrapper = n;

                    function r(e) { return e && "pageCount" in e ? e : null } t.asPagedDataView = r;

                    function a(e) { return e && "commitEdit" in e ? e : null } t.asEditableDataView = a, i = function() {
                        function e(e) { this.ei = [], this.fi = e }
                        return e.prototype.insert = function(e, t) {
                            var i = null,
                                n = this;
                            return o.each(t, function(e, t) { n.gi(e) && t && o.isFunction(t.subscribe) && (i = i || [], i.push(t.subscribe(n.fi))) }), !!i && (this.ei.length < e && (this.ei.length = e), this.ei.splice(e, 0, i), !0)
                        }, e.prototype.remove = function(e) {
                            var t = this.ei[e];
                            t && o.each(t, function(e, i) { i.dispose(), t[e] = null }), this.ei[e] = null, this.ei.splice(e, 1)
                        }, e.prototype.removeAll = function() {
                            for (var e, t; e = this.ei.length;) this.remove(e - 1);
                            this.ei = []
                        }, e.prototype.dispose = function() { this.removeAll() }, e.prototype.gi = function(e) { return !e || "string" != typeof e || null === e.match(/^entityState|jQuery/) }, e
                    }(), t.propChangeListener = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function i(t, i, o, n, r) { this.cr = new e.grid.cellRange(-1, -1), this.isExpanded = !1, this.hi = -1, this.ii = -1, this.ji = "none", this.ki = !0, void 0 !== t && (this.isExpanded = t), void 0 !== i && (this.cr = i), void 0 !== o && (this.ii = o), void 0 !== n && (this.ji = n), void 0 !== r && (this.ki = r) }
                            return i.prototype.isSubRange = function(e) { return this.cr.r1 >= e.cr.r1 && this.cr.r2 <= e.cr.r2 }, i.prototype.toString = function() { return this.cr.r1 + "-" + this.cr.r2 }, i.prototype.getHeaderImageClass = function(e) { var i = this.owner; return i ? e ? i.expandedImageClass || t.c1field.prototype.options.groupInfo.expandedImageClass : i.collapsedImageClass || t.c1field.prototype.options.groupInfo.collapsedImageClass : null }, i.prototype.collapse = function() {
                                var t, i, o, n, r;
                                (t = this.owner) && (i = t.owner) && (o = i.owner) && (n = o.Ld("leaves"), e.grid.groupHelper.isParentExpanded(n, this.cr, t.level) && "footer" !== t.position && "none" !== t.outlineMode && (r = e.grid.groupHelper.getGroupedColumnsCount(n), this.li(o.Rd(), n, this, r, o.Ld("viewRenderBounds").start)))
                            }, i.prototype.expand = function(t) {
                                var i, o, n, r, a;
                                (i = this.owner) && (o = i.owner) && (n = o.owner) && (r = n.Ld("leaves"), e.grid.groupHelper.isParentExpanded(r, this.cr, i.level) && (a = e.grid.groupHelper.getGroupedColumnsCount(r), this.mi(n.Rd(), r, this, a, t, !0, n.Ld("viewRenderBounds").start)))
                            }, i.prototype.li = function(t, i, o, n, r) {
                                var a = o.owner,
                                    s = o.cr.r1,
                                    l = o.cr.r2,
                                    c, d, p, u, h;
                                switch (a.position) {
                                    case "header":
                                    case "headerAndFooter":
                                        this.ni(t.item(o.cr.r1 - r), void 0, !1), s++
                                }
                                for (c = s; c <= l; c++) this.ni(t.item(c - r), !1);
                                for (o.isExpanded = !1, this.oi(t, o, r), c = a.level + 1; c <= n; c++)
                                    for (p = e.grid.groupHelper.getChildGroupRanges(i, o.cr, c - 1), h = 0, d = p.length; h < d; h++) {
                                        switch (u = p[h], u.isExpanded = !1, u.owner.position) {
                                            case "header":
                                            case "headerAndFooter":
                                                this.ni(t.item(u.cr.r1 - r), void 0, !1)
                                        }
                                        this.oi(t, u, r)
                                    }
                            }, i.prototype.mi = function(t, i, o, n, r, a, s) {
                                var l = o.owner,
                                    c = o.cr.r1,
                                    d = o.cr.r2,
                                    p, u, h, f, g;
                                switch (l.position) {
                                    case "header":
                                        this.ni(t.item(c - s), !0, a || r), c++;
                                        break;
                                    case "footer":
                                        this.ni(t.item(d - s), !0), d--;
                                        break;
                                    case "headerAndFooter":
                                        this.ni(t.item(c - s), !0, a || r), a && this.ni(t.item(d - s), !0), c++, d--
                                }
                                if (a)
                                    if (o.isExpanded = !0, this.oi(t, o, s), o.owner.level === n)
                                        for (p = c; p <= d; p++) this.ni(t.item(p - s), !0);
                                    else {
                                        if (h = e.grid.groupHelper.getChildGroupRanges(i, o.cr, o.owner.level), h.length && c !== h[0].cr.r1)
                                            for (p = c; p < h[0].cr.r1; p++) this.ni(t.item(p - s), !0);
                                        if (r)
                                            for (p = 0, u = h.length; p < u; p++) f = h[p], this.mi(t, i, f, n, r, !0, s);
                                        else
                                            for (p = 0, u = h.length; p < u; p++) f = h[p], g = "footer" === f.owner.position || "none" === f.owner.outlineMode, this.mi(t, i, f, n, !1, g, s)
                                    }
                            }, i.prototype.ni = function(e, t, i) { e && (e[0] && (void 0 !== t && (e[0].style.display = t ? "" : "none", e[0]["aria-hidden"] = t ? "false" : "true"), void 0 !== i && (e[0]["aria-expanded"] = i ? "true" : "false")), e[1] && (void 0 !== t && (e[1].style.display = t ? "" : "none", e[1]["aria-hidden"] = t ? "false" : "true"), void 0 !== i && (e[1]["aria-expanded"] = i ? "true" : "false"))) }, i.prototype.oi = function(e, t, i) {
                                if ("footer" !== t.owner.position) {
                                    var n = e.item(t.cr.r1 - i);
                                    n && o.each(n, function(e, i) {
                                        if (i) {
                                            var n = o(i).find("div.gcui-gcuigrid-grouptogglebtn:first-child");
                                            n && n.length && (n.toggleClass(t.getHeaderImageClass(!t.isExpanded), !1), n.toggleClass(t.getHeaderImageClass(t.isExpanded), !0))
                                        }
                                    })
                                }
                            }, i
                        }();
                    t.groupRange = n, i = function() {
                        function t() { this.pi = 0 }
                        return t.prototype.group = function(e, t, i) {
                            var n, r, a = this;
                            this.rh = e, this.G = t, this.qi = i, this.pi = 0, o.each(i, function(e, t) { t.groupInfo && (delete t.groupInfo.level, delete t.groupInfo.expandInfo) }), n = this.rh.Re(!0), r = 1, o.each(n, function(e, t) { a.pi = 0, t.groupInfo && t.groupInfo.position && "none" !== t.groupInfo.position && t.dataIndex >= 0 && (t.groupInfo.level = r, t.groupInfo.expandInfo = [], a.ri(t, r++)) }), delete this.rh, delete this.G, delete this.qi
                        }, t.prototype.ri = function(t, i) {
                            var n, r, a, s, l, c, d, p, u, h, f = 0,
                                g = !0;
                            for (o.each(this.qi, function(e, t) { if (t.parentVis) return f = e, !1 }), n = 0; n < this.G.length; n++)
                                if (this.G[n].rowType & e.grid.rowType.data) {
                                    if (r = this.si(n, t, i), a = !0, (s = "startCollapsed" === t.groupInfo.outlineMode) || e.grid.groupHelper.isParentCollapsed(this.qi, r, i)) {
                                        if (!1 === t.groupInfo.groupSingleRow && r.r1 === r.r2) continue;
                                        a = !1
                                    }
                                    if (i && this.rh.options.groupIndent)
                                        for (l = r.r1; l <= r.r2; l++) this.ti(this.G[l][f], i);
                                    switch (g = !(!1 === t.groupInfo.groupSingleRow && r.r1 === r.r2), t.groupInfo.position) {
                                        case "header":
                                            for (c = this.vi(t.groupInfo, r, a, g), h = r.r1; h <= r.r2; h++) this.G[h].ze["aria-level"] = i + 1, a || (this.G[h].Ae.display = "none", this.G[h].ze["aria-hidden"] = !0);
                                            if (!g) break;
                                            this.wi(c, i), d = e.grid.groupHelper.isParentCollapsed(this.qi, c.cr, i), p = this.xi(c, r, !0, d), this.G.splice(r.r1, 0, p), p.ze["arial-level"] = i, p.ze["aria-expanded"] = a, d && (p.Ae.display = "none", p.ze["aria-hidden"] = !0), n = r.r2 + 1;
                                            break;
                                        case "footer":
                                            if (c = this.vi(t.groupInfo, r, !0, g), !g) break;
                                            this.wi(c, i), u = this.xi(c, r, !1, !1), u.ze["aria-level"] = i, this.G.splice(r.r2 + 1, 0, u), n = r.r2 + 1, d = e.grid.groupHelper.isParentCollapsed(this.qi, c.cr, i), d && (u.Ae.display = "none", u.ze["aria-hidden"] = !0);
                                            break;
                                        case "headerAndFooter":
                                            for (c = this.vi(t.groupInfo, r, a, g), h = r.r1; h <= r.r2; h++) this.G[h].ze["aria-level"] = i + 1, a || (this.G[h].Ae.display = "none", this.G[h].ze["aria-hidden"] = !0);
                                            if (!g) break;
                                            this.wi(c, i), d = e.grid.groupHelper.isParentCollapsed(this.qi, c.cr, i), p = this.xi(c, r, !0, d), u = this.xi(c, r, !1, !1), this.G.splice(r.r2 + 1, 0, u), u.ze["aria-level"] = i, !d && a || (u.Ae.display = "none", u.ze["aria-hidden"] = !0), this.G.splice(r.r1, 0, p), p.ze["aria-level"] = i, p.ze["aria-expanded"] = a, d && (p.Ae.display = "none", p.ze["aria-hidden"] = !0), n = r.r2 + 2;
                                            break;
                                        default:
                                            throw e.grid.stringFormat('Unknown Position value: "{0}"', t.groupInfo.position)
                                    }
                                    this.pi++
                                }
                        }, t.prototype.xi = function(t, i, o, n) {
                            var r = t.owner,
                                a = r.owner,
                                s = a.owner,
                                l = [],
                                c = "",
                                d = "",
                                p, u, h, f, g, m, b, v;
                            for (l.Ae = {}, l.ze = {}, l.ze.id = (o ? "GH" : "GF") + this.pi + "-" + r.level, l.rowType = o ? e.grid.rowType.groupHeader : e.grid.rowType.groupFooter, a.dataIndex >= 0 && null !== (p = this.G[i.r1][a.dataIndex].value) && (c = s.toStr(a, p)), this.rh.Ge() && l.push({ html: "&nbsp;" }), u = { html: "", ze: {}, Ae: {} }, o && "none" !== r.outlineMode && (t.isExpanded ? u.html = '<div class="' + s.options.uiCSS.icon + " " + t.getHeaderImageClass(!0) + ' gcui-gcuigrid-grouptogglebtn">&nbsp;</div>' : u.html = '<div class="' + s.options.uiCSS.icon + " " + t.getHeaderImageClass(!1) + ' gcui-gcuigrid-grouptogglebtn">&nbsp;</div>'), l.push(u), a.aggregate && "none" !== a.aggregate && (d = this.yi(i, a, a, o, c)), h = o ? r.headerText : r.footerText, "custom" === h ? (f = { data: this.G, column: a, groupByColumn: r.owner, groupText: c, text: "", groupingStart: i.r1, groupingEnd: i.r2, isGroupHeader: o, aggregate: d }, this.rh._trigger("groupText", null, f) && (h = f.text)) : (void 0 !== h && null !== h || (o && (h = "{1}: {0}"), (d || 0 === d) && (h = h ? h + " {2}" : "{2}")), h = e.grid.stringFormat(h, c, a && a.headerText ? a.headerText : "", "" + d)), h || (h = "&nbsp;"), u.html += "<span>" + h + "</span>", this.ti(u, r.level - 1), g = 1, m = this.rh.Ge() ? 1 : 0, b = !0; m < this.qi.length; m++)
                                if (p = this.qi[m], p.parentVis) {
                                    if (b) { b = !1; continue }
                                    if (!0 !== p.dynamic && p.aggregate && "none" !== p.aggregate) break;
                                    g++
                                } for (; m < this.qi.length; m++) p = this.qi[m], p.parentVis && (v = this.yi(i, p, r.owner, o, c), v || 0 === v || (v = "&nbsp;"), l.push({ html: "" + v, ze: { groupInfo: { leafIndex: p.leavesIdx, purpose: e.grid.groupRowCellPurpose.aggregateCell } } }));
                            return u.ze.colSpan = g, u.ze.groupInfo = { leafIndex: a.leavesIdx, purpose: e.grid.groupRowCellPurpose.groupCell }, l
                        }, t.prototype.yi = function(t, i, o, n, r) {
                            var a = "",
                                s, l, c;
                            if (!i.aggregate || "none" === i.aggregate) return a;
                            if ("custom" === i.aggregate) s = { data: this.G, column: i, groupByColumn: o, groupText: r, text: "", groupingStart: t.r1, groupingEnd: t.r2, isGroupHeader: n }, this.rh._trigger("groupAggregate", null, s) && (a = s.text);
                            else {
                                for (l = new e.grid.tally, c = t.r1; c <= t.r2; c++) l.add(this.G[c][i.dataIndex].value);
                                a = l.getValueString(i)
                            }
                            return a
                        }, t.prototype.si = function(t, i, o) {
                            var n = i.leavesIdx,
                                r = new e.grid.cellRange(t, n),
                                a = e.grid.groupHelper.getParentGroupRange(this.qi, r, o),
                                s, l, c;
                            if (this.G[t].rowType & e.grid.rowType.data)
                                for (s = this.G[t][i.dataIndex].value, s instanceof Date && (s = s.getTime()), r.r2 = t, c = this.G.length - 1; r.r2 < c && (this.G[r.r2 + 1].rowType & e.grid.rowType.data && !(a && r.r2 + 1 > a.cr.r2)) && (l = this.G[r.r2 + 1][i.dataIndex].value, l instanceof Date && (l = l.getTime()), s === l); r.r2++);
                            return r
                        }, t.prototype.vi = function(t, i, o, n) {
                            var r = null,
                                a = e.grid.groupHelper.getChildGroupIndex(i, t.expandInfo),
                                s, l, c, d;
                            return a >= 0 && a < t.expandInfo.length ? r = t.expandInfo[a] : (s = new e.grid.cellRange(i.r1, i.r1, i.r2, i.r2), l = "footer" === t.position || !n || o && "startCollapsed" !== t.outlineMode, r = new e.grid.groupRange(l, s, -1, t.position, n), r.owner = t, t.expandInfo.push(r)), r && n && (c = i.r1, d = i.r2, "headerAndFooter" === t.position && (d += 2), "headerAndFooter" !== t.position && d++, r.cr.r2 = d), r
                        }, t.prototype.wi = function(e, t) {
                            var i, o, n, r, a, s, l;
                            for (i = 0, o = this.qi.length; i < o; i++)
                                if ((n = this.qi[i].groupInfo) && n.level < t)
                                    for (r = n.expandInfo ? n.expandInfo.length : 0, a = 0; a < r; a++) s = n.expandInfo[a], l = "headerAndFooter" === e.position ? 2 : 1, s.cr.r1 >= e.cr.r1 && (s.cr.r1 !== e.cr.r1 || "footer" !== s.position) && (s.cr.r1 += l), s.cr.r2 >= e.cr.r1 && (s.cr.r2 += l)
                        }, t.prototype.ti = function(e, t) {
                            var i;
                            t > 0 && (i = this.rh.options.groupIndent) && (e.Ae.paddingLeft = i * t + "px")
                        }, t
                    }(), t.grouper = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t() {}
                            return t.zi = RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"), t.getGroupInfo = function t(i) {
                                if (i) {
                                    var o = e.grid.groupHelper.zi.exec(i.id),
                                        n, r, a;
                                    if (o) return n = parseInt(o[3], 10), r = parseInt(o[2], 10), a = "H" === o[1], { level: n, index: r, isHeader: a, toString: function() { return (a ? "GH" : "GF") + r + "-" + n } }
                                }
                                return null
                            }, t.getColumnByGroupLevel = function e(t, i) {
                                var o, n, r;
                                for (o = 0, n = t.length; o < n; o++)
                                    if (r = t[o], r.groupInfo && r.groupInfo.level === i) return r;
                                return null
                            }, t.getGroupedColumnsCount = function e(t) {
                                var i = 0,
                                    o, n, r;
                                for (o = 0, n = t.length; o < n; o++) !(r = t[o].groupInfo) || "header" !== r.position && "headerAndFooter" !== r.position && "footer" !== r.position || i++;
                                return i
                            }, t.getChildGroupIndex = function e(t, i) {
                                for (var o = 0, n = i.length - 1, r, a; o <= n;) {
                                    if (r = (n - o >> 1) + o, 0 === (a = i[r].cr.r1 - t.r1)) return r;
                                    a < 0 ? o = r + 1 : n = r - 1
                                }
                                return o
                            }, t.getParentGroupIndex = function t(i, o) { var n = e.grid.groupHelper.getChildGroupIndex(i, o); return n > 0 && n--, n < o.length ? n : -1 }, t.getChildGroupRanges = function t(i, o, n) {
                                var r = [],
                                    a, s, l, c, d, p = e.grid.groupHelper.getColumnByGroupLevel(i, n + 1);
                                if (p)
                                    for (a = p.groupInfo.expandInfo, d = e.grid.groupHelper.getChildGroupIndex(o, a), l = d, c = a.length; l < c && (s = a[l], s.cr.r2 <= o.r2); l++) r.push(s);
                                return r
                            }, t.getParentGroupRange = function t(i, o, n) {
                                var r, a, s;
                                if (void 0 === n && (n = 65535), n - 2 >= 0)
                                    for (r = i.length - 1; r >= 0; r--)
                                        if ((a = i[r].groupInfo) && a.expandInfo && !(a.level < 0) && a.level === n - 1 && (s = e.grid.groupHelper.getParentGroupIndex(o, a.expandInfo)) >= 0) return a.expandInfo[s];
                                return null
                            }, t.isParentCollapsed = function t(i, o, n) {
                                var r, a;
                                if (1 === n) return !1;
                                for (r = n; r > 1; r--) {
                                    if ((a = e.grid.groupHelper.getParentGroupRange(i, o, r)) && !a.isExpanded) return !0;
                                    o = a.cr
                                }
                                return !1
                            }, t.isParentExpanded = function t(i, o, n) {
                                var r, a;
                                if (1 === n) return !0;
                                for (r = n; r > 1; r--) {
                                    if ((a = e.grid.groupHelper.getParentGroupRange(i, o, r)) && a.isExpanded) return !0;
                                    o = a.cr
                                }
                                return !1
                            }, t
                        }();
                    t.groupHelper = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function e(e, t, i, o) {
                                switch (arguments.length) {
                                    case 2:
                                        this.r1 = this.r2 = e, this.c1 = this.c2 = t;
                                        break;
                                    case 4:
                                        this.r1 = e, this.r2 = i, this.c1 = t, this.c2 = o;
                                        break;
                                    default:
                                        this.r1 = 0, this.r2 = 0, this.c1 = 0, this.c2 = 0
                                }
                            }
                            return e.prototype.isSingleCell = function() { return this.r1 === this.r2 && this.c1 === this.c2 }, e
                        }();
                    t.cellRange = n, i = function() {
                        function t() {}
                        return t.prototype.merge = function(e, t) {
                            this.qi = t, this.G = e;
                            var i, o, n;
                            for (i = 0, o = this.qi.length; i < o; i++) n = this.qi[i], n.dataIndex >= 0 && !n.isBand && ("free" === n.rowMerge || "restricted" === n.rowMerge) && this.Ai(n);
                            delete this.G, delete this.qi
                        }, t.prototype.Ai = function(t) {
                            var i = t.dataIndex,
                                o, n, r, a, s;
                            for (o = 0, n = this.G.length; o < n; o++)
                                if (this.G[o].rowType & e.grid.rowType.data) {
                                    if (r = this.Bi(o, t), r.r1 !== r.r2)
                                        for (a = r.r2 - r.r1 + 1, this.G[r.r1][i].ze.rowSpan = a, s = r.r1 + 1; s <= r.r2; s++) this.G[s][i].visible = !1;
                                    o = r.r2
                                }
                        }, t.prototype.Bi = function(t, i) {
                            var o = i.dataIndex,
                                n = new e.grid.cellRange(t, o),
                                r = "" + (this.G[t][o].value || ""),
                                a = this.G.length,
                                s, l, c, d;
                            for (n.r2 = t; n.r2 < a - 1 && (s = this.G[n.r2 + 1], s.rowType & e.grid.rowType.data && "" + (s[o].value || "") === r); n.r2++);
                            return l = i.leavesIdx, l > 0 && "restricted" === i.rowMerge && (c = this.qi[l - 1], c.dataIndex >= 0 && (d = this.Bi(t, c), n.r1 = Math.max(n.r1, d.r1), n.r2 = Math.min(n.r2, d.r2))), n
                        }, t
                    }(), t.merger = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o, n, r, a, s, l, c, d, p = jQuery;
                    t.EXPANDO = "__gcuigrid",
                        function(e) { e.Ci = [], e.header = 1, e.data = 2, e.dataAlt = 4, e.filter = 8, e.groupHeader = 16, e.groupFooter = 32, e.footer = 64, e.emptyDataRow = 128 }(t.rowType || (t.rowType = {})), i = t.rowType,
                        function(e) { e.Ci = [], e.none = 0, e.rendering = 1, e.current = 2, e.hovered = 4, e.selected = 8 }(t.renderState || (t.renderState = {})), o = t.renderState,
                        function(e) { e.Ci = [], e.table = 0, e.head = 1, e.body = 2, e.foot = 3 }(t.rowScope || (t.rowScope = {})), n = t.rowScope,
                        function(e) { e.Ci = [], e.none = 0, e.column = 1, e.row = 2 }(t.cellRangeExtendMode || (t.cellRangeExtendMode = {})), r = t.cellRangeExtendMode,
                        function(e) { e.Ci = [], e.createIfNull = 0, e.createAlways = 1, e.dispose = 2 }(t.objectMode || (t.objectMode = {})), a = t.objectMode,
                        function(e) { e.Ci = [], e.groupCell = 0, e.aggregateCell = 1 }(t.groupRowCellPurpose || (t.groupRowCellPurpose = {})), s = t.groupRowCellPurpose;

                    function u(t, i) {
                        var o, n, r;
                        if (p.isArray(t) && p.isArray(i)) { if (t.length === i.length) { for (r = !0, o = 0, n = t.length; o < n && r; o++) r = e.grid.compareObj(t[o], i[o]); return r } } else {
                            if (p.isPlainObject(t) && p.isPlainObject(i)) {
                                for (o in t)
                                    if (t.hasOwnProperty(o) && !e.grid.compareObj(t[o], i[o])) return !1;
                                for (o in i)
                                    if (i.hasOwnProperty(o) && !e.grid.compareObj(t[o], i[o])) return !1;
                                return !0
                            }
                            t instanceof Date && (t = t.getTime()), i instanceof Date && (i = i.getTime())
                        }
                        return t === i
                    }
                    t.compareObj = u;

                    function h(e) { var t, i, o, n = []; for (t = 0; t < arguments.length - 1; t++) n[t] = arguments[t + 1]; if (!e) return ""; for (i = 0, o = n.length; i < o; i++) e = e.replace(RegExp("\\{" + i + "\\}", "gm"), n[i]); return e } t.stringFormat = h;

                    function f(e) { return e && !(e < 0) || 0 === e } t.validDataKey = f;

                    function g(e) { return !!(e && e instanceof Date) && !isNaN(e.getTime()) } t.validDate = g;

                    function m(e) { return e.dataType || e.Je || "string" } t.getDataType = m;

                    function b(e, t) { e && t && e.find(".ui-widget").each(function(e, i) { return p.each(p(i).data(), function(i, o) { o.widgetName && t(e, o) }), !0 }) } t.iterateChildrenWidgets = b;

                    function v(e, t) {
                        var i = [];
                        p.each(e.data(), function(e) { 0 === e.indexOf(t) && i.push(e) }), p.each(i, function(t, i) { e.removeData(i) })
                    }
                    t.remove$dataByPrefix = v, l = function() {
                        function e(e) { this.Di = e }
                        return e.prototype.getSelection = function() {
                            var e = 0,
                                t = 0,
                                i;
                            return void 0 !== this.Di.selectionStart ? (e = this.Di.selectionStart, t = this.Di.selectionEnd) : document.selection && (i = document.selection.createRange().duplicate(), t = i.text.length, e = Math.abs(i.moveStart("character", -this.Di.value.length)), t += e), { start: e, end: t, length: t - e }
                        }, e.prototype.setSelection = function(e) {
                            if (void 0 !== this.Di.selectionStart) this.Di.setSelectionRange(e.start, e.end);
                            else {
                                var t = this.Di.createTextRange();
                                t.collapse(!0), t.moveStart("character", e.start), t.moveEnd("character", e.end), t.select()
                            }
                        }, e.prototype.toggleSelection = function(e) {
                            var t = p(this.Di),
                                i = "onselectstart" in this.Di;
                            e ? i ? t.unbind(".gcuigrid-disableSelection") : t.css({ MozUserSelect: "", WebkitUserSelect: "" }) : i ? t.bind("selectstart.gcuigrid-disableSelection", function(e) { e.preventDefault() }) : t.css({ MozUserSelect: "-moz-none", WebkitUserSelect: "none" })
                        }, e
                    }(), t.domSelection = l;

                    function y(e) { return p.extend(!0, {}, t.c1basefield.prototype.options, t.c1field.prototype.options, { dynamic: !0, isLeaf: !0, isBand: !1, parentIdx: -1 }, e) } t.createDynamicField = y;

                    function w(e, t) {
                        if (e) {
                            var i = e.nodeType ? p(e) : e,
                                o = i.offset();
                            if (o) return t ? { top: o.top, left: o.left, width: i[0].clientWidth || 0, height: i[0].clientHeight || 0 } : { top: o.top, left: o.left, width: i.outerWidth(), height: i.outerHeight() }
                        }
                        return null
                    }
                    t.bounds = w;

                    function x(t, i, o) {
                        if (void 0 === i && (i = 3), t && 0 !== i) {
                            if (!o && 3 === t.nodeType) return t.nodeValue;
                            if (1 === t.nodeType) {
                                switch (t.type) {
                                    case "button":
                                    case "text":
                                    case "textarea":
                                    case "select-one":
                                        return t.value;
                                    case "checkbox":
                                        return "" + t.checked
                                }
                                for (var n = "", r = 0, a; a = t.childNodes[r++];) n += e.grid.Ei(a, i - 1);
                                return n
                            }
                        }
                        return ""
                    }
                    t.Ei = x;

                    function C(e, t, i, o) {
                        var n = e.jquery || p.isArray(e),
                            r, a, s, l = t + i;
                        if (3 === arguments.length) return n ? p.data(e[0], l) : p.data(e, l);
                        if (n) { for (r = 0, a = e.length; r < a; r++) s = p.data(e[r], l, o); return s }
                        return p.data(e, l, o)
                    }
                    t.dataPrefix = C;

                    function S(e, t) { if (t && e) { var i, o, n; for (i in t) t.hasOwnProperty(i) && (o = t[i], "string" !== (n = typeof o) && "boolean" !== n && "number" !== n || void 0 !== e[i] || (e[i] = o)) } } t.shallowMerge = S;

                    function k(e) { return e && "object" == typeof e && !(e instanceof Date) } t.isCustomObject = k;

                    function T(e, t) {
                        var i, o, n = p.isFunction(t);
                        for (i in e)
                            if (e.hasOwnProperty(i) && !0 === (o = n ? t(e[i]) : e[i] === t)) return { at: i, found: e[i] };
                        return { at: null, found: null }
                    }
                    t.search = T;

                    function A(e, t) {
                        if (e) {
                            var i, o, n = 0,
                                r = {},
                                a, s;
                            for (i = 0, o = e.attributes.length; i < o; i++) !(s = e.attributes[i].name) || t && t(s) || (a = e.getAttribute(s), "style" === s && (a = "object" == typeof a ? a.cssText : a), a || "class" !== s || (a = e.getAttribute("className")), a && "function" != typeof a && (r[s] = a, n++));
                            if (n) return r
                        }
                        return null
                    }
                    t.getAttributes = A;

                    function E(t, i) { var o, n, r, a, s; if (t) { "object" == typeof i || p.isFunction(i) || (i = {}); for (o in t) n = t[o], r = i[r], n !== i && (n && (p.isPlainObject(n) || (a = p.isArray(n))) ? (a ? (a = !1, s = r && p.isArray(r) ? r : []) : s = r && p.isPlainObject(r) ? r : {}, i[o] = e.grid.deepExtend(n, s)) : i[o] = n) } return i } t.deepExtend = E;

                    function I(e, t) { if (e && e.jquery && (e = e[0]), e) return 1 === arguments.length ? p.data(e, "gcuigridwidgetName") : p.data(e, "gcuigridwidgetName", t) } t.widgetName = I, c = function() {
                        function t() {}
                        return t.Fi = { date: "", datetime: "", "datetime-local": "", month: "", time: "" }, t.isExtendSupportRequired = function t(i) { return (i = (i || "").toLowerCase()) in e.grid.HTML5InputSupport.Fi }, t.getDefaultInputType = function t(i, o) {
                            var n = o.inputType;
                            if (!n && (n = "text", i)) switch (e.grid.getDataType(o)) {
                                case "number":
                                case "currency":
                                    n = "number";
                                    break;
                                case "datetime":
                                    n = "datetime"
                            }
                            return n
                        }, t.toStr = function t(i, o) {
                            var n = i;
                            if (o = (o || "").toLowerCase(), e.grid.HTML5InputSupport.isExtendSupportRequired(o)) switch (o) {
                                case "datetime":
                                    n = i ? n = Globalize.format(i, "yyyy-MM-ddTHH:mm:ssZ") : "";
                                    break;
                                case "datetime-local":
                                    n = i ? n = Globalize.format(i, "yyyy-MM-ddTHH:mm:ss") : "";
                                    break;
                                case "date":
                                    n = i ? n = Globalize.format(i, "yyyy-MM-dd") : "";
                                    break;
                                case "month":
                                    n = i ? n = Globalize.format(i, "yyyy-MM") : "";
                                    break;
                                case "time":
                                    n = i ? n = Globalize.format(i, "HH:mm:ss") : ""
                            } else n = i + "";
                            return n
                        }, t.parse = function t(i, o) {
                            var n, r = function(t) { return t = new Date(t), e.grid.validDate(t) || (t = null), t };
                            if (o = (o || "").toLowerCase(), e.grid.HTML5InputSupport.isExtendSupportRequired(o)) switch (o) {
                                case "datetime":
                                    n = Globalize.parseDate(i, "yyyy-MM-ddTHH:mm:ssZ") || Globalize.parseDate(i, "yyyy-MM-ddTHH:mmZ") || r(i);
                                    break;
                                case "datetime-local":
                                    n = Globalize.parseDate(i, "yyyy-MM-ddTHH:mm:ss") || Globalize.parseDate(i, "yyyy-MM-ddTHH:mm") || r(i);
                                    break;
                                case "date":
                                    n = Globalize.parseDate(i, "yyyy-MM-dd") || r(i);
                                    break;
                                case "month":
                                    n = Globalize.parseDate(i, "yyyy-MM");
                                    break;
                                case "time":
                                    n = Globalize.parseDate(i, "HH:mm:ss") || Globalize.parseDate(i, "HH:mm");
                                    break;
                                case "number":
                                    n = parseFloat(i)
                            } else n = i;
                            return n
                        }, t.extend = function e(t, i, o) {
                            if (t) switch (o = (o || "").toLowerCase()) {
                                case "date":
                                    t.setFullYear(i.getFullYear(), i.getMonth(), i.getDate());
                                    break;
                                case "month":
                                    t.setFullYear(i.getFullYear(), i.getMonth());
                                    break;
                                case "time":
                                    t.setHours(i.getHours()), t.setMinutes(i.getMinutes()), t.setSeconds(i.getSeconds());
                                    break;
                                default:
                                    t = i
                            } else t = i;
                            return t
                        }, t
                    }(), t.HTML5InputSupport = c;

                    function D(e, t, i) { return e > t && e < t + i } t.isOverAxis = D;

                    function $(t, i, o, n, r, a) { return e.grid.isOverAxis(t, o, r) && e.grid.isOverAxis(i, n, a) } t.isOver = $, d = 0;

                    function L() { return "uid" + d++ } t.getUID = L, p.extend(p.gcui.gcuigrid, { rowType: e.grid.rowType, renderState: e.grid.renderState, bounds: e.grid.bounds })
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    var i, o;
                    ! function(e) { e.Ci = [], e.Millisecond = 1, e.Second = 2, e.Minute = 4, e.Hour = 8, e.Day = 16, e.Month = 32, e.Year = 64, e.DATE = e.Year | e.Month | e.Day, e.TIME = e.Hour | e.Minute | e.Second | e.Millisecond, e.ALL = e.DATE | e.TIME }(t.TimeUnit || (t.TimeUnit = {})), i = t.TimeUnit, o = function() {
                        function t() {}
                        return t.convertInputType = function t(i) {
                            var o = e.grid.TimeUnitConverter.convertInputTypeToFormatString(i),
                                n = e.grid.TimeUnitConverter.convertFormatString(o);
                            return n
                        }, t.convertInputTypeToFormatString = function e(t) {
                            switch ((t || "").toLowerCase()) {
                                case "datetime":
                                case "datetime-local":
                                    return "f";
                                case "date":
                                    return "d";
                                case "month":
                                    return "Y";
                                case "time":
                                    return "t"
                            }
                            return ""
                        }, t.convertFormatString = function e(t) {
                            var o, n, r, a, s = 0;
                            if (t) {
                                if (1 === t.length) switch (t[0]) {
                                    case "t":
                                        return i.Hour | i.Minute;
                                    case "T":
                                        return i.TIME;
                                    case "d":
                                    case "D":
                                        return i.DATE;
                                    case "Y":
                                        return i.Month | i.Year;
                                    case "M":
                                        return i.Month | i.Day;
                                    case "S":
                                        return i.ALL
                                }
                                for ((o = t.indexOf("'")) >= 0 && (n = t.lastIndexOf("'")) >= 0 && o !== n && (t = t.substr(0, o) + t.substring(n + 1, t.length - 1)), r = 0, a = t.length; r < a; r++) switch (t[r]) {
                                    case "d":
                                        s |= i.Day;
                                        break;
                                    case "M":
                                        s |= i.Month;
                                        break;
                                    case "y":
                                        s |= i.Year;
                                        break;
                                    case "m":
                                        s |= i.Minute;
                                        break;
                                    case "h":
                                    case "H":
                                        s |= i.Hour;
                                        break;
                                    case "s":
                                        s |= i.Second;
                                        break;
                                    case "f":
                                        s |= i.Millisecond
                                }
                            }
                            return s || i.ALL
                        }, t.cutDate = function e(t, o) { return t && (o = ~o, o & i.Millisecond && t.setMilliseconds(0), o & i.Second && t.setSeconds(0), o & i.Minute && t.setMinutes(0), o & i.Hour && t.setHours(0), o & i.Day && t.setDate(1), o & i.Month && t.setMonth(0), o & i.Year && t.setFullYear(0)), t }, t
                    }(), t.TimeUnitConverter = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function e() {}
                            return e.NoFilterOp = { applicableTo: null, name: "NoFilter", arity: 1, operator: function() { return !0 } }, e
                        }(),
                        r = function() {
                            function t(t) {
                                this.Gi = {};
                                var i = this;
                                this.rh = t, this.Hi(null, n.NoFilterOp), o.each(e.data.filtering.ops, function(e, t) { i.Hi(e, t) }), o.each(t.options.customFilterOperators, function(e, t) { i.Hi(null, t, !0) })
                            }
                            return t.prototype.getByName = function(e) { var t = this.getByNameInt(e); return t ? t.op : null }, t.prototype.getByNameInt = function(e) { return this.Gi[(e || "").toLowerCase()] }, t.prototype.getByDataType = function(e) {
                                var t = [],
                                    i;
                                switch (o.each(this.Gi, function(i, n) {
                                    var r = n.op;
                                    (!r.applicableTo || o.inArray(e, r.applicableTo) >= 0) && t.push(n)
                                }), this.rh.options.filterOperatorsSortMode.toLowerCase()) {
                                    case "alphabetical":
                                        t.sort(this.Ii);
                                        break;
                                    case "alphabeticalcustomfirst":
                                        t.sort(this.Ji);
                                        break;
                                    case "alphabeticalembeddedFirst":
                                        t.sort(this.Ki)
                                }
                                return i = o.map(t, function(e, t) { return e.op })
                            }, t.prototype.Hi = function(e, t, i) { void 0 === i && (i = !1), e && !t.name && (t.name = e), e = (e || t.name).toLowerCase(), this.Gi[e] || (this.Gi[e] = { op: t, isCustom: !0 === i }) }, t.prototype.Ii = function(e, t) {
                                var i = e.op.name.toLowerCase(),
                                    o = t.op.name.toLowerCase();
                                if (i !== o) { if ("nofilter" === i) return -1; if ("nofilter" === o) return 1 }
                                return i === o ? 0 : i < o ? -1 : 1
                            }, t.prototype.Ki = function(e, t) {
                                var i = e.op.name.toLowerCase(),
                                    o = t.op.name.toLowerCase();
                                if (i !== o) { if ("nofilter" === i) return -1; if ("nofilter" === o) return 1 }
                                if (e.isCustom !== t.isCustom) { if (e.isCustom) return 1; if (t.isCustom) return -1 }
                                return i === o ? 0 : i < o ? -1 : 1
                            }, t.prototype.Ji = function(e, t) {
                                var i = e.op.name.toLowerCase(),
                                    o = t.op.name.toLowerCase();
                                if (i !== o) { if ("nofilter" === i) return -1; if ("nofilter" === o) return 1 }
                                if (e.isCustom !== t.isCustom) { if (e.isCustom) return -1; if (t.isCustom) return 1 }
                                return i === o ? 0 : i < o ? -1 : 1
                            }, t
                        }();
                    t.filterOperatorsCache = r, i = function() {
                        function t() {}
                        return t.marker = "_gcuigrid", t.getSingleValue = function e(t) { return o.isArray(t) && (t = t[0], o.isArray(t) && (t = t[0])), t }, t.getSingleOperatorName = function e(t) { return o.isArray(t) && (t = t[0]), t.name || t || "" }, t.verify = function t(i, n, r, a) {
                            if (i)
                                if (o.isArray(i)) {
                                    var s, l, c = [],
                                        d = [];
                                    for (o.isArray(n) || (n = [n]), s = 0, l = i.length; s < l; s++) e.grid.filterHelper.Li(i[s], n[s], r, a) && (c.push({ name: i[s].name || i[s], condition: i[s].condition || "or" }), d.push(n ? n[s] : void 0));
                                    if (c.length) return { filterOperator: c, filterValue: d }
                                } else if (e.grid.filterHelper.Li(i, n, r, a)) return { filterOperator: i, filterValue: n };
                            return null
                        }, t.Li = function t(i, n, r, a) { if (i && (i = i.name || i)) { var s; if (("nofilter" !== (i = (i || "").toLowerCase()) || void 0 !== n) && (s = a.getByName(i)) && (null === s.applicableTo || o.inArray(r || "string", s.applicableTo) >= 0) && (1 === s.arity || s.arity > 1 && void 0 !== e.grid.filterHelper.getSingleValue(n))) return !0 } return !1 }, t
                    }(), t.filterHelper = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery;

                    function n(t, i) {
                        if (t && !t.nodeType && (t = t[0]), t) switch (i) {
                            case e.grid.rowScope.head:
                                return t.tHead;
                            case e.grid.rowScope.body:
                                if (t.tBodies) return t.tBodies[0] || null;
                                break;
                            case e.grid.rowScope.foot:
                                return t.tFoot;
                            default:
                                return t
                        }
                        return null
                    }
                    t.getTableSection = n;

                    function r(e, t) { var i; return e && !e.nodeType && (e = e[0]), e && (i = this.getTableSection(e, t)) ? i.rows.length : 0 } t.getTableSectionLength = r;

                    function a(e, t, i) { var o; return e && !e.nodeType && (e = e[0]), e && (o = this.getTableSection(e, t)) ? o.rows[i] || null : null } t.getTableSectionRow = a;

                    function s(t, i, n) {
                        var r, a, s, l, c, d, p, u, h = [],
                            f = function(e) { return "rowspan" === (e = e.toLowerCase()) || "colspan" === e },
                            g;
                        if (t && !t.nodeType && (t = t[0]), t && (g = this.getTableSection(t, i)))
                            for (r = 0, a = g.rows.length; r < a; r++) {
                                for (c = g.rows[r], d = [], n && (p = e.data.Expando.getFrom(d, !0), u = p[e.grid.EXPANDO] = { cellsAttributes: {}, rowAttributes: e.grid.getAttributes(c) || {} }), s = 0, l = c.cells.length; s < l; s++) d[s] = o.trim(c.cells[s].innerHTML), n && (u.cellsAttributes[s] = e.grid.getAttributes(c.cells[s], f) || {});
                                h[r] = d
                            }
                        return h
                    }
                    t.readTableSection = s, i = function() {
                        function t(e, t, i, o) { this.$g = 0, this.eh = e, this.Mi = [], o && this.ensureColGroup(), i && this.ensureTBody(), t || this.Ni() }
                        return t.prototype.element = function() { return this.eh }, t.prototype.width = function() { return this.$g }, t.prototype.getCellIdx = function(e, t) { return e < this.$g ? this.Mi[t][e].cellIdx : -1 }, t.prototype.getColumnIdx = function(e, t) {
                            if ("number" != typeof e) {
                                var i = e;
                                e = i.cellIndex, t = i.parentNode.rowIndex
                            }
                            return e < this.$g ? this.Mi[t][e].colIdx : -1
                        }, t.prototype.clearSection = function(t) {
                            var i, o, n = e.grid.getTableSection(this.eh, t);
                            switch (t) {
                                case e.grid.rowScope.body:
                                    i = this.getSectionLength(e.grid.rowScope.table), o = i + this.getSectionLength(t) - 1;
                                    break;
                                case e.grid.rowScope.foot:
                                    i = this.getSectionLength(e.grid.rowScope.table) + this.getSectionLength(e.grid.rowScope.head), o = i + this.getSectionLength(t) - 1;
                                    break;
                                default:
                                    i = 0, o = this.getSectionLength(t) - 1
                            }
                            for (; n.rows.length;) n.deleteRow(0);
                            this.Mi.splice(i, o - i + 1)
                        }, t.prototype.getSectionLength = function(t) { return e.grid.getTableSectionLength(this.eh, t) }, t.prototype.getSectionRow = function(t, i) { return e.grid.getTableSectionRow(this.eh, i, t) }, t.prototype.forEachColumnCellNatural = function(e, t, i) {
                            var o, n, r, a;
                            for (o = 0, n = this.eh.rows.length; o < n; o++)
                                if (r = this.eh.rows[o], e < r.cells.length && !0 !== (a = t(r.cells[e], o, i))) return a;
                            return !0
                        }, t.prototype.forEachColumnCell = function(e, t, i) {
                            var o, n, r, a, s;
                            for (o = 0, n = this.Mi.length; o < n; o++)
                                if (r = this.eh.rows[o], (a = this.getCellIdx(e, o)) >= 0 && !0 !== (s = t(r.cells[a], o, i))) return s;
                            return !0
                        }, t.prototype.forEachRowCell = function(e, t, i) {
                            var o = this.eh.rows[e],
                                n, r, a;
                            for (n = 0, r = o.cells.length; n < r; n++)
                                if (!0 !== (a = t(o.cells[n], n, i))) return a;
                            return !0
                        }, t.prototype.colGroupTag = function() { var e = this.eh.getElementsByTagName("colgroup"); return e && e[0] || null }, t.prototype.colTags = function() { var e = this.colGroupTag(); return e && e.getElementsByTagName("col") || [] }, t.prototype.ensureTBody = function() { return this.eh.tBodies && this.eh.tBodies[0] || this.eh.appendChild(document.createElement("tbody")) }, t.prototype.ensureTHead = function() { return this.eh.tHead && this.eh.tHead[0] || this.eh.createTHead() }, t.prototype.ensureTFoot = function() { return this.eh.tFoot && this.eh.tFoot[0] || this.eh.createTFoot() }, t.prototype.ensureColGroup = function() { var e = this.eh.getElementsByTagName("colgroup"); return e && e[0] || this.eh.appendChild(document.createElement("colgroup")) }, t.prototype.appendCol = function(e) { var t = this.ensureColGroup(); return e && t.appendChild(e) || t.appendChild(document.createElement("col")) }, t.prototype.removeOffset = function(e) { e >= 0 && e < this.Mi.length && ((e < 0 || !e && 0 !== e) && (e = this.Mi.length - 1), this.Mi.splice(e, 1)) }, t.prototype.insertOffset = function(e) {
                            var t, i;
                            if (this.$g > 0) {
                                for (t = [], i = 0; i < this.$g; i++) t.push({ cellIdx: i, colIdx: i });
                                (e < 0 || !e && 0 !== e) && (e = this.Mi.length), this.Mi.splice(e, 0, t)
                            }
                        }, t.prototype.rebuildOffsets = function() { this.Mi = [], this.$g = 0, this.Ni() }, t.prototype.Ni = function() {
                            var e = [],
                                t, i, o, n, r, a, s, l, c, d;
                            for (i = 0, o = this.eh.rows.length; i < o; i++) {
                                for (t = [], this.Mi[i] = t, n = this.eh.rows[i], r = 0, a = 0, s = n.cells.length; r < s; r++, a++) { for (l = n.cells[r]; e[a] > 1; a++) e[a]--, t[a] = { cellIdx: -1, colIdx: -1 }; for (e[a] > 1 || (e[a] = l.rowSpan), t[a] = { cellIdx: r, colIdx: -1 }, t[r].colIdx = a, c = l.colSpan; c > 1; c--) t[++a] = { cellIdx: -1, colIdx: -1 } }
                                for (d = e.length; a < d; a++) e[a]--, t[a] = { cellIdx: -1, colIdx: -1 };
                                this.$g = Math.max(this.$g, d)
                            }
                        }, t
                    }(), t.htmlTableAccessor = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function t(e, t, i, o) { void 0 === i && (i = null), void 0 === o && (o = !1), this.Oi = !1, this.rh = i, o ? (this.Pi = e, this.Qi = t) : (this.Ri = e, this.Si = t) }
                            return t.outsideValue = new t(-1, -1, null, !0), t.prototype.cellIndexAbs = function(e) {
                                if (0 === arguments.length) return this.Ti(), this.Pi;
                                this.Ri = void 0, this.Pi = e
                            }, t.prototype.rowIndexAbs = function(e) {
                                if (0 === arguments.length) return this.Ui(), this.Qi;
                                this.Si = void 0, this.Qi = e
                            }, t.prototype.cellIndex = function(e) {
                                if (0 === arguments.length) return this.Vi(), this.Ri;
                                this.Pi = void 0, this.Ri = e
                            }, t.prototype.column = function() { return this.rh && this.Td() ? this.rh.Ld("visibleLeaves")[this.cellIndexAbs()] : null }, t.prototype.container = function() {
                                var e = this.tableCell(),
                                    t;
                                return e && (t = o(e).children("div.gcui-gcuigrid-innercell")) ? t : null
                            }, t.prototype.isEqual = function(e) { return e && e.rowIndex() === this.rowIndex() && e.cellIndex() === this.cellIndex() }, t.prototype.row = function() {
                                var e = null,
                                    t = null;
                                return this.rh && (e = this.rh.Od().rows().item(this.rowIndexAbs())) && e.length && (t = this.rh.Od().Wd(e)), t
                            }, t.prototype.rowIndex = function(e) {
                                if (0 === arguments.length) return this.Wi(), this.Si;
                                this.Qi = void 0, this.Si = e
                            }, t.prototype.tableCell = function() { return this.rh && this.Td() ? this.rh.Od().getCell(this.cellIndexAbs(), this.rowIndexAbs()) : null }, t.prototype.value = function(t) {
                                var i, o, n;
                                if (this.rh && this.Td() && (o = this.rh.Od().Wd(this.rh.Rd().item(this.rowIndex())), o.type & e.grid.rowType.data)) {
                                    if (i = this.column(), 0 === arguments.length) return n = this.rh.Bd.getValue(o.data, i.dataKey), this.rh.parse(i, n);
                                    if (null === (t = this.rh.parse(i, t)) && i.valueRequired || "string" !== e.grid.getDataType(i) && isNaN(t)) throw "invalid value";
                                    this.rh.Bd.setValue(o.dataItemIndex, i.dataKey, t)
                                }
                            }, t.prototype.toString = function() { return this.cellIndex() + ":" + this.rowIndex() }, t.prototype.Ud = function(e, t) {
                                void 0 === t && (t = !1);
                                var i = !1,
                                    o;
                                return t ? (this.cellIndexAbs() < (o = e.topLeft().cellIndexAbs()) && (i = !0, this.Pi = o, this.Ri = void 0), this.cellIndexAbs() > (o = e.bottomRight().cellIndexAbs()) && (i = !0, this.Pi = o, this.Ri = void 0), this.rowIndexAbs() < (o = e.topLeft().rowIndexAbs()) && (i = !0, this.Qi = o, this.Si = void 0), this.rowIndexAbs() > (o = e.bottomRight().rowIndexAbs()) && (i = !0, this.Qi = o, this.Si = void 0)) : (this.cellIndex() < (o = e.topLeft().cellIndex()) && (i = !0, this.Ri = o, this.Pi = void 0), this.cellIndex() > (o = e.bottomRight().cellIndex()) && (i = !0, this.Ri = o, this.Pi = void 0), this.rowIndex() < (o = e.topLeft().rowIndex()) && (i = !0, this.Si = o, this.Qi = void 0), this.rowIndex() > (o = e.bottomRight().rowIndex()) && (i = !0, this.Si = o, this.Qi = void 0)), i
                            }, t.prototype.Sd = function() { return new e.grid.cellInfo(this.cellIndex(), this.rowIndex(), this.rh) }, t.prototype.Td = function() { return this.cellIndex() >= 0 && this.rowIndex() >= 0 }, t.prototype.eg = function(e) {
                                if (!arguments.length) return this.Oi;
                                this.Oi = e
                            }, t.prototype.Xd = function(e) { this.rh = e }, t.prototype.Ti = function() {
                                if (void 0 === this.Pi) {
                                    if (null === this.Ri) throw "relative index value is undefined";
                                    if (this.Ri >= 0) {
                                        if (!this.rh) throw "gcuigrid is null";
                                        this.Pi = this.Ri + this.rh.vg().x
                                    } else this.Pi = this.Ri;
                                    this.Pi < 0 && (this.Pi = -1)
                                }
                            }, t.prototype.Ui = function() {
                                if (void 0 === this.Qi) {
                                    if (void 0 === this.Si) throw "relative index value is undefined";
                                    if (this.Si >= 0) {
                                        if (!this.rh) throw "gcuigrid is null";
                                        this.Qi = this.Si + this.rh.vg().y
                                    } else this.Qi = this.Si;
                                    this.Qi < 0 && (this.Qi = -1)
                                }
                            }, t.prototype.Vi = function() {
                                if (void 0 === this.Ri) {
                                    if (void 0 === this.Pi) throw "absolute index value is undefined";
                                    if (this.Pi >= 0) {
                                        if (!this.rh) throw "gcuigrid is null";
                                        this.Ri = this.Pi - this.rh.vg().x
                                    } else this.Ri = this.Pi;
                                    this.Ri < 0 && (this.Ri = -1)
                                }
                            }, t.prototype.Wi = function() {
                                if (void 0 === this.Si) {
                                    if (void 0 === this.Qi) throw "relative index value is undefined";
                                    if (this.Qi >= 0) {
                                        if (!this.rh) throw "gcuigrid is null";
                                        this.Si = this.Qi - this.rh.vg().y
                                    } else this.Si = this.Qi;
                                    this.Si < 0 && (this.Si = -1)
                                }
                            }, t
                        }();
                    t.cellInfo = n, i = function() {
                        function t(e, t) {
                            if (!e || !t) throw "invalid arguments";
                            this.Xi = e.Sd(), this.Yi = t.Sd()
                        }
                        return t.prototype.bottomRight = function() { return this.Yi }, t.prototype.isEqual = function(e) { return e && this.Xi.isEqual(e.topLeft()) && this.Yi.isEqual(e.bottomRight()) }, t.prototype.topLeft = function() { return this.Xi }, t.prototype.toString = function() { return this.Xi + " - " + this.Yi }, t.prototype.Zi = function(e) { var t, i, o, n; return !!(e && (t = e.bottomRight().rowIndex() - e.topLeft().rowIndex() + 1, i = this.Yi.rowIndex() - this.Xi.rowIndex() + 1, e.topLeft().rowIndex() + t - this.Xi.rowIndex() < t + i)) && (o = e.bottomRight().cellIndex() - e.topLeft().cellIndex() + 1, n = this.Yi.cellIndex() - this.Xi.cellIndex() + 1, e.topLeft().cellIndex() + o - this.Xi.cellIndex() < o + n) }, t.prototype.Td = function() { return this.Xi.Td() && this.Yi.Td() }, t.prototype.Ud = function(e, t) { var i, o; return void 0 === t && (t = !1), i = this.Xi.Ud(e, t), o = this.Yi.Ud(e, t), i || o }, t.prototype.Sd = function() { return new t(this.Xi.Sd(), this.Yi.Sd()) }, t.prototype.ng = function(e) { return e && e.cellIndex() >= this.Xi.cellIndex() && e.cellIndex() <= this.Yi.cellIndex() && e.rowIndex() >= this.Xi.rowIndex() && e.rowIndex() <= this.Yi.rowIndex() }, t.prototype.$i = function(e) { return e && this.ng(e.topLeft()) && this.ng(e.bottomRight()) }, t.prototype._i = function(t, i) { return t === e.grid.cellRangeExtendMode.column ? (this.Xi.rowIndex(i.topLeft().rowIndex()), this.Yi.rowIndex(i.bottomRight().rowIndex())) : t === e.grid.cellRangeExtendMode.row && (this.Xi.cellIndex(i.topLeft().cellIndex()), this.Yi.cellIndex(i.bottomRight().cellIndex())), this }, t.prototype.aj = function() {
                            var e = this.Xi.cellIndex(),
                                t = this.Xi.rowIndex(),
                                i = this.Yi.cellIndex(),
                                o = this.Yi.rowIndex();
                            this.Xi.cellIndex(Math.min(e, i)), this.Xi.rowIndex(Math.min(t, o)), this.Yi.cellIndex(Math.max(e, i)), this.Yi.rowIndex(Math.max(t, o))
                        }, t.prototype.kg = function() { return this.Yi.rowIndex() - this.Xi.rowIndex() }, t.prototype.$g = function() { return this.Yi.cellIndex() - this.Xi.cellIndex() }, t
                    }(), t.cellInfoRange = i, o.extend(o.gcui.gcuigrid, { cellInfo: e.grid.cellInfo, cellInfoRange: e.grid.cellInfoRange })
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(e, t) {
                                if (this.bj = 22, this.cj = { th: 0, col: 0, subTable: 0 }, !e) throw "'gcuigrid' must be specified";
                                this.rh = e, this.dj = t, this.rh.element.addClass("gcui-gcuigrid-table")
                            }
                            return t.prototype.dispose = function() { this.toggleDOMSelection(!0), this.rh.element.removeClass("gcui-gcuigrid-table") }, t.prototype.ensureDisabledState = function() {
                                var e = "gcui-gcuigrid-disabled " + this.rh.options.uiCSS.stateDisabled,
                                    t = this.rh.options.disabled,
                                    o = this;
                                i.each(this.subTables(), function(n, r) {
                                    if (r) {
                                        var a = i(r.element());
                                        t ? (a.addClass(e), o.rh.dg(a, "aria-disabled", !0)) : (a.removeClass(e), o.rh.dg(a, "aria-disabled", !1))
                                    }
                                })
                            }, t.prototype.ensureWidth = function(e, t, i) { this.ej(e, t) }, t.prototype.ensureHeight = function(e) {}, t.prototype.getScrollValue = function() { return null }, t.prototype.getVisibleAreaBounds = function() { throw "not implemented" }, t.prototype.getFixedAreaVisibleBounds = function() { throw "not implemented" }, t.prototype.render = function() {
                                this.af(), this.fj();
                                var e = this.rh.outerDiv.css("display");
                                this.rh.outerDiv.css("display", "none"), this.gj(), this.rh.outerDiv.css("display", e), this.hj()
                            }, t.prototype.toggleDOMSelection = function(t) { i.each(this.subTables(), function(i, o) { new e.grid.domSelection(o.element()).toggleSelection(t) }), new e.grid.domSelection(this.rh.outerDiv).toggleSelection(t) }, t.prototype.updateSplits = function(e) { throw "not implemented" }, t.prototype.bodyRows = function() { return this.ij || (this.ij = new e.grid.rowAccessor(this, e.grid.rowScope.body, 0, 0)), this.ij }, t.prototype.filterRow = function() { if (this.rh.options.showFilter) { var t = new e.grid.rowAccessor(this, e.grid.rowScope.head, 0, 0); return t.item(t.length() - 1) } return null }, t.prototype.headerRows = function() { var t; return this.jj || (t = this.rh.options.showFilter ? 1 : 0, this.jj = new e.grid.rowAccessor(this, e.grid.rowScope.head, 0, t)), this.jj }, t.prototype.rows = function() { return this.kj || (this.kj = new e.grid.rowAccessor(this, e.grid.rowScope.table, 0, 0)), this.kj }, t.prototype.focusableElement = function() { throw "not implemented" }, t.prototype.forEachColumnCell = function(e, t, i) { throw "not implemented" }, t.prototype.forEachRowCell = function(e, t, i) { throw "not implemented" }, t.prototype.getAbsoluteCellInfo = function(e) { throw "not implemented" }, t.prototype.getAbsoluteRowIndex = function(e) { throw "not implemented" }, t.prototype.getCell = function(e, t) { throw "not implemented" }, t.prototype.getColumnIndex = function(e) { throw "not implemented" }, t.prototype.getHeaderCell = function(e) { throw "not implemented" }, t.prototype.getJoinedCols = function(e) { throw "not implemented" }, t.prototype.getJoinedRows = function(e, t) { throw "not implemented" }, t.prototype.getJoinedTables = function(e, t) { throw "not implemented" }, t.prototype.subTables = function() { throw "not implemented" }, t.prototype.lj = function() {
                                var e = this.rh.options.scrollMode,
                                    t = "auto",
                                    i = "auto";
                                switch (e) {
                                    case "horizontal":
                                        t = "hidden", i = "visible";
                                        break;
                                    case "vertical":
                                        t = "visible", i = "hidden";
                                        break;
                                    case "both":
                                        t = "visible", i = "visible"
                                }
                                return { vScrollBarVisibility: t, hScrollBarVisibility: i }
                            }, t.prototype.hj = function() {
                                var e, t, o, n;
                                this.ensureDisabledState(), this.cj.col = 0, this.cj.th = 0, this.cj.subTable = 0, e = this.rh.Ld("visibleLeaves"), e.length > 0 && (t = this.getHeaderCell(0), o = this.getJoinedCols(0), t && (this.cj.th = i(t).leftBorderWidth() + i(t).rightBorderWidth()),
                                    o && o.length && (this.cj.col = i(o[0]).leftBorderWidth() + i(o[0]).rightBorderWidth())), n = this.subTables()[0], this.cj.subTable = i(n.element()).leftBorderWidth() + i(n.element()).rightBorderWidth()
                            }, t.prototype.fj = function() { throw "not implemented" }, t.prototype.af = function() {
                                var e = this.rh.Vd();
                                this.dj.start = 0, this.dj.end = e.bottomRight().rowIndex()
                            }, t.prototype.gj = function() { this.mj(), this.nj(), this.rh.options.showFilter && this.oj(), this.pj(), this.rh.options.showFooter && this.qj() }, t.prototype.mj = function() {
                                var e = this.rh.Ld("visibleLeaves"),
                                    t, i, o, n;
                                for (o = 0, n = e.length; o < n; o++) t = e[o], i = this.rj(t, o), this.sj(i, t, o)
                            }, t.prototype.nj = function() {
                                var t = e.grid.rowType,
                                    i = this.rh.He(),
                                    o, n, r;
                                if (i && (n = i.length))
                                    for (o = 0; o < n; o++) r = this.tj(t.header, o, -1, -1, -1), this.uj(r, null, i[o])
                            }, t.prototype.oj = function() {
                                var t = this.tj(e.grid.rowType.filter, -1, -1, -1, -1);
                                this.uj(t, this.rh.Ld("visibleLeaves"), null)
                            }, t.prototype.pj = function() {
                                var t = e.grid.rowType,
                                    i = this.rh.Ld("visibleLeaves"),
                                    o = this.rh.sketchTable,
                                    n = -1,
                                    r = 0,
                                    a = 0,
                                    s, l, c, d, p = this.rh.ud;
                                if (this.dj.start >= 0)
                                    for (s = this.dj.start; s <= this.dj.end; s++) c = o[s - p], d = 0 != (c.rowType & t.data), l = this.tj(c.rowType, a++, d ? ++n : -1, d ? c.originalRowIndex : -1, d ? r + c.originalRowIndex : -1), this.uj(l, i, c)
                            }, t.prototype.qj = function() {
                                var t = this.tj(e.grid.rowType.footer, -1, -1, -1, -1);
                                this.uj(t, this.rh.Ld("visibleLeaves"), null)
                            }, t.prototype.tj = function(t, i, o, n, r) {
                                var a = this.rh.pg.apply(this.rh, arguments),
                                    s = this.vj(t, i, a);
                                return this.wj(s, t, e.grid.renderState.rendering, i, o, n, r)
                            }, t.prototype.xj = function(t, i, o) {
                                var n = e.grid.rowType,
                                    r = this.rh.qg.apply(this.rh, arguments);
                                return this.yj(t.type, r)
                            }, t.prototype.vj = function(e, t, i) { throw "not implemented" }, t.prototype.yj = function(t, o) {
                                var n = e.grid.rowType,
                                    r;
                                if (o || (o = t === n.header ? document.createElement("th") : document.createElement("td")), t !== n.filter) {
                                    if (r = document.createElement("div"), r.className = "gcui-gcuigrid-innercell", o.firstChild)
                                        for (; o.firstChild;) r.appendChild(o.firstChild);
                                    o.appendChild(r)
                                }
                                return i(o)
                            }, t.prototype.zj = function(e, t, i) { throw "not implemented" }, t.prototype.rj = function(e, t) { throw "not implemented" }, t.prototype.sj = function(e, t, i) { throw "not implemented" }, t.prototype.uj = function(t, i, o) {
                                var n = e.grid.rowType,
                                    r, a;
                                switch (t.type) {
                                    case n.filter:
                                        this.Aj(t, i);
                                        break;
                                    case n.footer:
                                        this.Bj(t, i);
                                        break;
                                    case n.header:
                                        this.Cj(t, o);
                                        break;
                                    case n.data:
                                    case n.data | n.dataAlt:
                                        this.Dj(t, i, o), r = o.ze, a = o.Ae;
                                        break;
                                    case n.emptyDataRow:
                                    case n.groupHeader:
                                    case n.groupFooter:
                                        this.Ej(t, i, o), r = o.ze, a = o.Ae;
                                        break;
                                    default:
                                        throw "unknown rowType"
                                }
                                this.Fj(t, r, a)
                            }, t.prototype.Gj = function(t, o, n, r, a, s, l) {
                                var c = this.xj(t, a.dataIndex, a),
                                    d = t.type === e.grid.rowType.filter ? c : i(c[0].firstChild);
                                this.zj(t, o, c), r ? d.html(n) : this.rh.cellFormatter.format(d, a, n, t), this.Hj(t, c, o, a, s, l)
                            }, t.prototype.Dj = function(e, t, i) { var o, n, r, a, s, l, c, d = !1; for (o = 0, n = t.length; o < n; o++) r = t[o], a = r.dataIndex, s = null, a >= 0 && (!i[a] || !1 === i[a].visible) || (s = a >= 0 ? this.rh.toStr(r, i[a].value) : null, l = a >= 0 ? i[a].ze : null, c = a >= 0 ? i[a].Ae : null, this.Gj(e, o, s, d, r, l, c)) }, t.prototype.Aj = function(t, i) { var o, n, r; for (o = 0, n = i.length; o < n; o++) r = i[o], this.Gj(t, o, e.grid.filterHelper.getSingleValue(r.filterValue), !1, r) }, t.prototype.Bj = function(e, t) { var i, o; for (i = 0, o = t.length; i < o; i++) this.Gj(e, i, "", !1, t[i]) }, t.prototype.Cj = function(e, t) {
                                var i, o, n = 0,
                                    r;
                                for (i = 0, o = t.length; i < o; i++) r = t[i], r.column && r.column.parentVis && (r.column.thX = n++, r.column.thY = e.sectionRowIndex, this.Gj(e, i, r.column.headerText, !1, r.column, { colSpan: r.colSpan, rowSpan: r.rowSpan }))
                            }, t.prototype.Ej = function(e, t, i) { var o, n, r = Math.min(t.length, i.length); for (o = 0; o < r; o++) this.Gj(e, o, i[o].html, !0, t[o], i[o].ze, i[o].Ae) }, t.prototype.Hj = function(t, i, o, n, r, a) { this.rh.cellStyleFormatter.format(i, o, n, t, e.grid.renderState.rendering, r, a), this.og(i, e.grid.renderState.rendering, !1), this.rh.rg(t, i, o, n) }, t.prototype.Fj = function(t, i, o) { this.rh.rowStyleFormatter.format(t, i, o), t.state &= ~e.grid.renderState.rendering, this.hf(t.$rows, t), this.rh.sg(t) }, t.prototype.Ij = function(t) {
                                var i = e.grid.rowType,
                                    o = t.type;
                                return o & i.data || o === i.groupHeader || o === i.groupFooter || o === i.emptyDataRow
                            }, t.prototype.lg = function(e, t, i) { i ? e.state |= t : e.state &= ~t, this.hf(e.$rows, e) }, t.prototype.og = function(t, i, o) {
                                var n = e.grid.dataPrefix,
                                    r = this.rh.Qd,
                                    a = n(t, r, "renderState");
                                return o ? (i |= a, n(t, r, "renderState", i)) : (i = a & ~i, n(t, r, "renderState", i)), i
                            }, t.prototype.Jj = function(e, t, o, n) {
                                var r = this.Kj(e),
                                    a = this.Kj(t),
                                    s = [],
                                    l, c = 0,
                                    d, p, u = !0;
                                if (r <= o) {
                                    if (i.extend(!0, s, e), r === o || n) return s;
                                    l = o - r
                                } else {
                                    if (i.extend(!0, s, t), a >= o) return s;
                                    l = o - a
                                }
                                return i.each(s, function(e, t) { t.real || c++ }), 0 !== c && (d = Math.floor(l / c), p = l - d * c, i.each(s, function(e, t) { t.real || (t.width += d, u && (t.width += p, u = !1)) })), s
                            }, t.prototype.Lj = function(e) {
                                var t, o, n, r, a, s, l, c, d, p, u, h = this.rh.Ld("visibleLeaves")[e];
                                if (void 0 !== h.Mj) t = { width: h.Mj, real: !0 };
                                else if (h.isRowHeader) t = { width: this.bj, real: !0 };
                                else {
                                    for (u = 0, o = this.getJoinedTables(!0, e), n = o[2], r = 0; r < 2; r++)
                                        if (null !== (a = o[r]) && (s = a.element().rows, p = s.length)) {
                                            for (d = p - 1, c = null; d >= 0; d--)
                                                if (s[d].cells.length === a.width()) { c = s[d]; break } c && (l = c.cells[n], u = Math.max(u, i(l).outerWidth()))
                                        } t = { width: u, real: !1 }
                                }
                                return t
                            }, t.prototype.ej = function(e, t) {
                                var o, n, r = this.getHeaderCell(e),
                                    a = this.getJoinedCols(e);
                                t && (n = this, r && (o = t - this.cj.th, o < 0 && (o = 0), r.style.width = o + "px"), i.each(a, function(e, i) { i && (o = t - n.cj.col, o < 0 && (o = 0), i.style.width = o + "px") }))
                            }, t.prototype.Nj = function(e, t, o, n) {
                                var r, a, s = this;
                                i.each(e, function(e, i) { i[0].style.tableLayout = "fixed", i[0].style.width = t - s.cj.subTable + "px" }), r = e[0].outerWidth(), 0 !== (a = r - t) && this.ej(n, o - a)
                            }, t.prototype.Kj = function(e, t, o) {
                                var n = 0;
                                return i.each(e, function(e, i) {
                                    if (void 0 !== t && void 0 !== o && (e < t || e > o)) return !0;
                                    n += i.width
                                }), n
                            }, t.prototype.if = function() { i.each(this.subTables(), function(e, t) { t.clearSection(2) }) }, t.prototype.kf = function() { i.each(this.subTables(), function(e, t) { t.rebuildOffsets() }) }, t.prototype.lf = function(t, i) {
                                var o = e.grid.rowType,
                                    n = this.rh.Rd(),
                                    r, a, s, l, c, d, p;
                                if (t >= 0 && t < (a = n.length())) {
                                    if (i)
                                        for (r = 0; r < a; r++) s = this.Wd(n.item(r)), c = s.sectionRowIndex - t, s.sectionRowIndex > t && (s.sectionRowIndex--, s.type & o.data && (s.type & o.dataAlt ? s.type &= ~o.dataAlt : s.type |= o.dataAlt, s.dataItemIndex--, s.dataRowIndex--, s.virtualDataItemIndex--), this.hf(s.$rows, s));
                                    s = this.Wd(n.item(t), !1), d = this.getAbsoluteRowIndex(s.$rows[0]), s.$rows.remove(), p = this.getJoinedTables(!1, d), p[0] && p[0].removeOffset(p[2]), p[1] && p[1].removeOffset(p[2])
                                }
                            }, t.prototype.jf = function(t, i, o, n) {
                                var r = this.rh.Ld("visibleLeaves"),
                                    a = e.grid.rowType,
                                    s = this.rh.Od(),
                                    l = this.rh.Rd(),
                                    c = l.length(),
                                    d = 0 != (t.rowType & a.data),
                                    p, u, h;
                                return (i < 0 || i >= c || !i && 0 !== i) && (i = c), p = this.tj(t.rowType, i, -1, o, n), this.uj(p, r, t), u = this.getAbsoluteRowIndex(p.$rows[0]), h = this.getJoinedTables(!1, u), h[0] && h[0].insertOffset(u), h[1] && h[1].insertOffset(u), p
                            }, t.prototype.Oj = function(e) {
                                var t = this.bodyRows(),
                                    o = 0,
                                    n = t.length(),
                                    r;
                                if (i.isFunction(e))
                                    for (o = 0; o < n; o++)
                                        if (r = this.Wd(t.item(o)), !0 === e(r)) return r;
                                return null
                            }, t.prototype.hf = function(t, i) {
                                var o = "$rows" in i,
                                    n = "data" in i,
                                    r, a;
                                o && (r = i.$rows, delete i.$rows), n && (a = i.data, delete i.data), e.grid.dataPrefix(t, this.rh.Qd, "rowInfo", i), o && (i.$rows = r), n && (i.data = a)
                            }, t.prototype.Wd = function(t, o) {
                                void 0 === o && (o = !0);
                                var n = this.rh,
                                    r = i(t[1] ? t : t[0]),
                                    a = e.grid.dataPrefix(r, n.Qd, "rowInfo"),
                                    s;
                                if (a.$rows = r, o && a.dataItemIndex >= 0 && a.type & e.grid.rowType.data) try { a.data = n.xg(a.dataItemIndex) } catch (e) { a.data = null }
                                return a
                            }, t.prototype.wj = function(t, o, n, r, a, s, l) { var c, d = { type: o, state: n, sectionRowIndex: r, dataRowIndex: a, dataItemIndex: s, virtualDataItemIndex: l, $rows: i(t) }; return s >= 0 && o & e.grid.rowType.data && (d.data = this.rh.xg(s)), d }, t
                        }();
                    t.baseView = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function(t) {
                            __extends(o, t);

                            function o(e, i) { t.call(this, e, i), this.Pj = null, this.Qj = null }
                            return o.prototype.dispose = function() { this.rh.outerDiv.unbind("scroll", this.Rj), t.prototype.dispose.call(this) }, o.prototype.ensureWidth = function(e, o, n) {
                                var r = i(this.Pj.element()),
                                    a = r.width() + o - n;
                                t.prototype.ensureWidth.call(this, e, o, n), this.Nj([r], a, o, e)
                            }, o.prototype.getVisibleAreaBounds = function() {
                                var t = e.grid.bounds(this.Pj.element()),
                                    i;
                                return "none" === this.rh.options.scrollMode ? t : (i = e.grid.bounds(this.rh.outerDiv.find(".gcui-gcuigrid-split-area-se:first")[0]), { top: t.top, left: t.left, width: Math.min(i.width, t.width), height: Math.min(i.height, t.height) })
                            }, o.prototype.updateSplits = function(e) {
                                var t = this,
                                    o = this.rh,
                                    n = o.options,
                                    r = o.element,
                                    a = [],
                                    s = [],
                                    l = [],
                                    c = o.Ld("visibleLeaves"),
                                    d = o.outerDiv,
                                    p, u;
                                r.css({ "table-layout": "", width: "" }), i.each(c, function(e, i) {
                                    var o, r = i.width;
                                    (r || 0 === r) && (o = "string" == typeof r && r.length > 1 && "%" === r[r.length - 1], r = o ? d.width() * parseFloat(r) / 100 : parseFloat(r), (i.ensurePxWidth || void 0 === i.ensurePxWidth && n.ensureColumnsPxWidth) && (i.Mj = r), t.ej(e, r))
                                }), i.each(c, function(e, i) { a.push(t.Lj(e)) }), r.css("width", "1px"), i.each(c, function(e, i) { s.push(t.Lj(e)) }), p = d.width(), l = this.Jj(a, s, p, n.ensureColumnsPxWidth), i.each(l, function(e, i) {
                                    var o = c[e];
                                    if (void 0 !== o.Mj) return void delete o.Mj;
                                    t.ej(e, i.width)
                                }), -1 !== (u = l.length - 1) && this.Nj([r], this.Kj(l, 0, u), l[u].width, u)
                            }, o.prototype.focusableElement = function() { return i(this.Pj.element()) }, o.prototype.forEachColumnCell = function(e, t, i) { return this.Pj.forEachColumnCell(e, t, i) }, o.prototype.forEachRowCell = function(e, t, i) { return this.Pj.forEachRowCell(e, t, i) }, o.prototype.getAbsoluteCellInfo = function(t) { return new e.grid.cellInfo(this.getColumnIndex(t), t.parentNode.rowIndex, this.rh, !0) }, o.prototype.getAbsoluteRowIndex = function(e) { return e.rowIndex }, o.prototype.getCell = function(e, t) {
                                var i = this.Pj.getCellIdx(e, t),
                                    o;
                                return i >= 0 && (o = this.getJoinedRows(t, 0), o[0]) ? o[0].cells[i] : null
                            }, o.prototype.getColumnIndex = function(e) { return this.Pj.getColumnIdx(e) }, o.prototype.getHeaderCell = function(t) {
                                var i = this.rh.Ld("visibleLeaves")[t],
                                    o;
                                return i && (o = this.rh.Ne()) ? e.grid.rowAccessor.getCell(o.item(i.thY), i.thX) : null
                            }, o.prototype.getJoinedCols = function(e) { var t = i(this.Pj.element()).find("> colgroup"); return t.length && e < t[0].childNodes.length ? [t[0].childNodes[e], null] : [null, null] }, o.prototype.getJoinedRows = function(e, t) { return [this.Pj.getSectionRow(e, t), null] }, o.prototype.getJoinedTables = function(e, t) { return [this.Pj, null, t] }, o.prototype.subTables = function() { return [this.Pj] }, o.prototype.fj = function() { this.Pj = new e.grid.htmlTableAccessor(this.rh.element[0], !0, !0, !0) }, o.prototype.hj = function() { this.rh.element.find("> tbody").addClass(this.rh.options.uiCSS.content + " gcui-gcuigrid-data"), this.Pj = new e.grid.htmlTableAccessor(this.rh.element[0]), this.rh.dg(this.rh.element, { role: "grid", cellpadding: "0", border: "0", cellspacing: "0" }), this.rh.element.css("border-collapse", "separate"), this.rh.outerDiv.bind("scroll", { gcuigrid: this.rh }, i.proxy(this.Rj, this)), t.prototype.hj.call(this) }, o.prototype.vj = function(t, i, o) {
                                var n = e.grid.rowType,
                                    r;
                                switch (t) {
                                    case n.header:
                                    case n.filter:
                                        r = this.Pj.ensureTHead();
                                        break;
                                    case n.footer:
                                        r = this.Pj.ensureTFoot();
                                        break;
                                    default:
                                        r = this.Pj.ensureTBody()
                                }
                                return o ? [r.appendChild(o)] : (i > r.rows.length && (i = -1), [r.insertRow(i)])
                            }, o.prototype.Fj = function(e, i, o) { var n = e.$rows[0];!n.cells.length && this.Ij(e) ? n.parentNode.removeChild(n) : t.prototype.Fj.call(this, e, i, o) }, o.prototype.zj = function(e, t, i) { e.$rows[0].appendChild(i[0]) }, o.prototype.rj = function(e, t) { return [document.createElement("col")] }, o.prototype.sj = function(e, t, i) { this.Pj.appendCol(e[0]) }, o.prototype.Rj = function(e) { e.data.gcuigrid.$superPanelHeader && e.data.gcuigrid.$superPanelHeader.css("left", e.target.scrollLeft), e.data.gcuigrid.$bottomPagerDiv && e.data.gcuigrid.$bottomPagerDiv.css("left", e.target.scrollLeft) }, o
                        }(t.baseView);
                    t.flatView = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function(t) {
                            __extends(o, t);

                            function o(e, o) { t.call(this, e, o), this.Sj = 18, this.Tj = {}, this.Uj = {}, this.element = e.element, this.Md = e.Md(), this.Vj = e.Ag(!0), this.Wj = e.Eg(), this.Xj = e.Dg(), this.Yj = -1 === this.Xj ? -1 : e.Ld("visibleLeaves")[this.Xj].leavesIdx, this.Zj = i.proxy(this.$j, this) }
                            return o.prototype.dispose = function() { t.prototype.dispose.call(this), this.rh.outerDiv.unbind("mousewheel", this.Zj) }, o.prototype.ensureWidth = function(e, o, n) {
                                var r = this.rh,
                                    a = r.options,
                                    s = this.Xj,
                                    l = e <= s,
                                    c = i(this.Tj.nw.element()),
                                    d = i(this.Tj.ne.element()),
                                    p = i(this.Tj.sw.element()),
                                    u = i(this.Tj.se.element()),
                                    h = l ? [c, p] : [d, u],
                                    f = (l ? c.width() : d.width()) + o - n,
                                    g = r.Ld("frozener"),
                                    m = this.getScrollValue();
                                this._j(), t.prototype.ensureWidth.call(this, e, o, n), this.Nj(h, f, o, e);
                                try { a.splitDistanceX = s >= 0 ? c[0].offsetWidth : 0 } catch (e) {} this.ak(0), this.Vf();
                                try { this.Wj >= 0 ? a.splitDistanceY = Math.max(c[0].offsetHeight, d[0].offsetHeight) : a.splitDistanceY = 0 } catch (e) {} this.ak(1), this.refreshPanel(m), g.refresh()
                            }, o.prototype.ensureHeight = function(e) {
                                var t, o = this.rh,
                                    n = o.options,
                                    r = i(this.Tj.nw.element()),
                                    a = i(this.Tj.ne.element()),
                                    s = i(this.Tj.sw.element()),
                                    l = i(this.Tj.se.element()),
                                    c = o.Ld("frozener"),
                                    d = this.getScrollValue(),
                                    p;
                                this._j(), arguments.length > 0 && (t = this.getJoinedRows(e, 2), this.bk(t, this.ck(t))), l.css("height", ""), s.css("height", ""), p = Math.max(l.height(), s.height()), l.height(p), s.height(p);
                                try { this.Wj >= 0 ? n.splitDistanceY = Math.max(r[0].offsetHeight, a[0].offsetHeight) : n.splitDistanceY = 0 } catch (e) {} this.ak(1), this.refreshPanel(d), c.refresh()
                            }, o.prototype.getScrollValue = function() { var e = this.dk(); return e ? { x: e.options.hScroller.scrollValue, y: e.options.vScroller.scrollValue } : null }, o.prototype.getVisibleAreaBounds = function() { var t = e.grid.bounds(this.rh.outerDiv.find(".gcui-superpanel-contentwrapper:first")); return t || (t = e.grid.bounds(this.rh.outerDiv)), t }, o.prototype.getFixedAreaVisibleBounds = function() {
                                var t = this.getVisibleAreaBounds(),
                                    i = e.grid.bounds(this.Uj.ne),
                                    o = e.grid.bounds(this.Uj.nw),
                                    n = null,
                                    r = null;
                                return (i.height || o.height) && (n = { left: t.left, top: t.top, width: t.width, height: Math.min(i.height || o.height, t.height) }), o.width && (r = { left: o.left, top: t.top, width: Math.min(o.width, t.width), height: t.height }), [n, r]
                            }, o.prototype.refreshPanel = function(t) {
                                var o = this,
                                    n = this.rh,
                                    r = n.options,
                                    a = this.ek(r.scrollMode),
                                    s = this.lj(),
                                    l = this.fk(n.outerDiv, n.element, i(this.Tj.ne.element()), r.scrollMode, n.Fd),
                                    c = l && !u,
                                    d = t ? t.x : null,
                                    p = t ? t.y : null,
                                    u = i.support.isTouchEnabled && i.support.isTouchEnabled();
                                this.gk.width(a), this.Uj.ne.width(a - r.splitDistanceX - (c ? this.Sj : 0)), "right" === r.staticColumnsAlignment && (this.Uj.nw.css({ left: "", right: c ? this.Sj : 0 }), this.Uj.sw.css({ left: "", right: c ? this.Sj : 0 })), this.gk.data("gcui-superpanel") ? this.gk.superpanel("paintPanel") : (this.Md && (this.vsUI = new e.grid.uiVirtualScroller(n, this.Uj.se, r.splitDistanceY)), this.gk.superpanel({
                                    disabled: n.options.disabled,
                                    scroll: i.proxy(this.Rj, this),
                                    bubbleScrollingEvent: !0,
                                    customScrolling: this.Md,
                                    vScroller: { scrollBarVisibility: s.vScrollBarVisibility, scrollValue: t ? t.y : null },
                                    hScroller: { scrollBarVisibility: s.hScrollBarVisibility, scrollValue: t ? t.x : null },
                                    hScrollerActivating: function(e, t) {
                                        var i;
                                        if (n.Fd && (i = n.element.height() + r.splitDistanceY - t.contentLength) > 0) return o.gk.height(o.gk.height() + i), o.gk.superpanel("paintPanel"), !1;
                                        o.Uj.sw.height(t.contentLength - r.splitDistanceY)
                                    }
                                }), this.Md && this.vsUI.attach(this.gk)), this.gk.find(".gcui-superpanel-hbarcontainer, .gcui-superpanel-vbarcontainer").css("zIndex", 5)
                            }, o.prototype.scrollTo = function(e) {
                                var t, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S;
                                e.tableCell() && (t = this.rh, o = t.options, n = this.dk(), r = e.tableCell(), a = r.nodeType ? i(r) : r, s = null, l = null, n && a.is(":visible") && (c = n.getContentElement(), d = c.parent(), p = -1 * parseInt((c.css("left") + "").replace("px", ""), 10), u = -1 * parseInt((c.css("top") + "").replace("px", ""), 10), h = d.outerWidth() - o.splitDistanceX, f = d.outerHeight() - o.splitDistanceY, g = a.position(), m = g.left, b = g.top, v = a.outerWidth(), y = a.outerHeight(), w = t.Ag(!0), x = t.Ag(!1), C = e.rowIndex(), S = e.cellIndex(), C <= w ? S <= x ? (s = 0, l = 0) : (m += p, m + v > p + h && (p = s = m + v - h), m < p && (s = m), l = 0) : S <= x ? (b += this.Uj.sw.scrollTop(), b + y > u + f && (u = l = b + y - f), b < u && (l = b), s = 0) : (m -= o.splitDistanceX, b + y > u + f && (u = l = b + y - f), m + v > p + h && (p = s = m + v - h), b < u && (l = b), m < p && (s = m)), null !== s && n.hScrollTo(s), null !== l && (this.Md || n.vScrollTo(l))))
                            }, o.prototype.updateSplits = function(e) {
                                var t = this.rh,
                                    o = t.options,
                                    n, r = this,
                                    a = [],
                                    s = [],
                                    l = [],
                                    c = this.Xj,
                                    d, p = o.scrollMode,
                                    u = t.Ld("visibleLeaves"),
                                    h = i(this.Tj.se.element()),
                                    f = i(this.Tj.ne.element()),
                                    g = i(this.Tj.sw.element()),
                                    m = i(this.Tj.nw.element()),
                                    b = t.outerDiv,
                                    v, y, w;
                                if (this._j(), b.unbind("mousewheel", this.Zj), (v = r.Tj.se.element().tBodies) && (v = v[0])) {
                                    for (w = !1, y = 0; y < v.rows.length; y++)
                                        if (!i(v.rows[y]).hasClass("gcui-gcuigrid-groupheaderrow")) { w = !0; break } w || t.element.css("width", "100%")
                                }
                                i.each([h, f, g, m], function(e, t) { t.css({ "table-layout": "", width: "" }) }), i.each(u, function(e, t) {
                                    var i, n = t.width;
                                    (n || 0 === n) && (i = "string" == typeof n && n.length > 1 && "%" === n[n.length - 1], n = i ? b.width() * parseFloat(n) / 100 : parseFloat(n), (t.ensurePxWidth || void 0 === t.ensurePxWidth && o.ensureColumnsPxWidth) && (t.Mj = n), r.ej(e, n))
                                }), i.each(u, function(e, t) { l.push(r.Lj(e)) }), i.each([m, f, g, h], function(e, t) { t.css({ width: "1px" }) }), i.each(u, function(e, t) { s.push(r.Lj(e)) }), n = b.width(), a = this.Jj(l, s, n, o.ensureColumnsPxWidth), i.each(a, function(e, t) {
                                    var i = u[e];
                                    if (void 0 !== i.Mj) return void delete i.Mj;
                                    r.ej(e, t.width)
                                }), c >= 0 && (d = c, this.Nj([m, g], this.Kj(a, 0, d), a[d].width, d));
                                try { o.splitDistanceX = c >= 0 ? m[0].offsetWidth : 0 } catch (e) {} this.ak(0), o.ensureColumnsPxWidth || f.parent().width(n - o.splitDistanceX), d = a.length - 1, -1 !== d && this.Nj([f, h], this.Kj(a, c + 1, d), a[d].width, d), this.Vf();
                                try { this.Wj >= 0 ? o.splitDistanceY = Math.max(m[0].offsetHeight, f[0].offsetHeight) : o.splitDistanceY = 0 } catch (e) {}
                                if (this.ak(1), !o.ensureColumnsPxWidth && this.fk(t.outerDiv, h, f, p, t.Fd)) { n -= this.Sj, a = this.Jj(l, s, n, o.ensureColumnsPxWidth), i.each(a, function(e, t) { t.real || r.ej(e, t.width) }), c >= 0 && (d = c, this.Nj([m, g], this.Kj(a, 0, d), a[d].width, d)); try { o.splitDistanceX = c >= 0 ? m[0].offsetWidth : 0 } catch (e) {} this.ak(0), f.parent().width(n - o.splitDistanceX), d = a.length - 1, -1 !== d && this.Nj([f, h], this.Kj(a, c + 1, d), a[d].width, d), this.Vf(); try { this.Wj >= 0 ? o.splitDistanceY = Math.max(m[0].offsetHeight, f[0].offsetHeight) : o.splitDistanceY = 0 } catch (e) {} this.ak(1) } this.refreshPanel(e), b.bind("mousewheel", i.proxy(this.Zj, this))
                            }, o.prototype.if = function() { t.prototype.if.call(this) }, o.prototype.bodyRows = function() { var e = t.prototype.bodyRows.call(this); return e }, o.prototype.focusableElement = function() { return this.rh.outerDiv }, o.prototype.forEachColumnCell = function(e, t, i) {
                                var o = this.getJoinedTables(!0, e),
                                    n, r;
                                if (null !== o[0]) { if (n = o[2], !0 !== (r = o[0].forEachColumnCell(n, t, i))) return r; if (null !== o[1] && !0 !== (r = o[1].forEachColumnCell(n, t, i))) return r }
                                return !0
                            }, o.prototype.forEachRowCell = function(e, t, i) {
                                var o = this.getJoinedTables(!1, e),
                                    n = o[0],
                                    r = o[1],
                                    a, s;
                                if (null !== n) { if ((a = o[2]) < n.element().rows.length && !0 !== (s = n.forEachRowCell(a, t, i))) return s; if (null !== r && a < r.element().rows.length && !0 !== (s = r.forEachRowCell(a, t, i))) return s }
                                return HTMLTableCellElement, !0
                            }, o.prototype.getAbsoluteCellInfo = function(t) { return new e.grid.cellInfo(this.getColumnIndex(t), this.getAbsoluteRowIndex(t.parentNode), this.rh, !0) }, o.prototype.getAbsoluteRowIndex = function(e) {
                                for (var t = e.rowIndex, i = e.parentNode;
                                    "table" !== i.tagName.toLowerCase();) i = i.parentNode;
                                return i === this.Tj.nw.element() || i === this.Tj.ne.element() ? t : t + this.Wj + 1
                            }, o.prototype.getCell = function(e, t) {
                                var i = this.getJoinedTables(!1, t),
                                    o, n, r, a, s;
                                return null !== i[0] && (o = this.getJoinedTables(!0, e), null !== o[0] && (n = i[2], r = o[2], a = null, a = null !== i[1] ? e === r ? i[0] : i[1] : i[0], (s = a.getCellIdx(r, n)) >= 0)) ? a.element().rows[n].cells[s] : null
                            }, o.prototype.getColumnIndex = function(e) {
                                var t = null,
                                    i = null,
                                    o = !1,
                                    n;
                                for (t = e.parentNode;
                                    "table" !== t.tagName.toLowerCase(); t = t.parentNode);
                                return null !== t && (t === this.Tj.nw.element() ? i = this.Tj.nw : t === this.Tj.ne.element() ? (i = this.Tj.ne, o = !0) : t === this.Tj.sw.element() ? i = this.Tj.sw : t === this.Tj.se.element() && (i = this.Tj.se, o = !0), null !== i) ? (n = i.getColumnIdx(e), o && (n += this.Xj + 1), n) : -1
                            }, o.prototype.getHeaderCell = function(t) {
                                var i = this.rh.Ld("visibleLeaves")[t],
                                    o;
                                return i && (o = this.rh.Ne()) ? e.grid.rowAccessor.getCell(o.item(i.thY), i.thX) : null
                            }, o.prototype.getJoinedCols = function(e) {
                                var t = [],
                                    o = this.getJoinedTables(!0, e),
                                    n = o[2];
                                return o.splice(o.length - 1, 1), i.each(o, function(e, o) { t.push(o ? i(o.element()).find("col")[n] : null) }), t
                            }, o.prototype.getJoinedRows = function(e, t) {
                                var i = null,
                                    o = null,
                                    n = null,
                                    r = null,
                                    a = this.Wj,
                                    s = this.Xj,
                                    l = this.rh.Ld("visibleLeaves").length - 1,
                                    c = this.hk() - 1,
                                    d = a === c,
                                    p = a < 0,
                                    u = !d && !p,
                                    h = 0;
                                return (d || u) && (s >= 0 && s < l ? (n = this.Tj.nw, r = this.Tj.ne) : n = s < 0 ? this.Tj.ne : this.Tj.nw, h = n.getSectionLength(t), e < h && (i = n.getSectionRow(e, t), null !== r && (o = r.getSectionRow(e, t)))), (p || u && null === i) && (p || (e -= h), s >= 0 && s < l ? (n = this.Tj.sw, r = this.Tj.se) : n = s < 0 ? this.Tj.se : this.Tj.sw, i = n.getSectionRow(e, t), null !== r && (o = r.getSectionRow(e, t))), null === i && null === o ? null : [i, o]
                            }, o.prototype.getJoinedTables = function(e, t) {
                                var i = null,
                                    o = null,
                                    n = t,
                                    r = this.rh,
                                    a = this.Wj,
                                    s = this.Xj;
                                return e ? (t <= s ? (i = this.Tj.nw, o = this.Tj.sw) : (i = this.Tj.ne, o = this.Tj.se, n -= s + 1), a < 0 && (i = null), a === this.hk() - 1 && (o = null)) : (t <= a ? (i = this.Tj.nw, o = this.Tj.ne) : (i = this.Tj.sw, o = this.Tj.se, n -= a + 1), s < 0 && (i = null), s === r.Ld("leaves").length - 1 && (o = null)), null === i && (i = o, o = null), [i, o, n]
                            }, o.prototype.subTables = function() { return [this.Tj.nw, this.Tj.ne, this.Tj.sw, this.Tj.se] }, o.prototype.ek = function(e) {
                                var t = this.rh,
                                    o = t.element.outerWidth(!0) + t.options.splitDistanceX,
                                    n = t.outerDiv.innerWidth();
                                return this.fk(t.outerDiv, t.element, i(this.Tj.ne.element()), e, t.Fd) && (o += this.Sj), o > n && (o = n), o
                            }, o.prototype.dk = function() { return this.gk ? this.gk.data("gcui-superpanel") : null }, o.prototype.af = function() { this.rh.Md() ? (this.rh.af(this.dj), this.rh.Nd(), this.dj.end = this.dj.start + this.rh.options.pageSize - 1, this.rh.af(this.dj)) : t.prototype.af.call(this) }, o.prototype.gj = function() { t.prototype.gj.call(this) }, o.prototype.fj = function() {
                                var t = document.createDocumentFragment(),
                                    o = e.grid.htmlTableAccessor;
                                this.rh.outerDiv.wrapInner('<div class="gcui-gcuigrid-fixedview"><div class="gcui-gcuigrid-scroller"><div class="gcui-gcuigrid-split-area-se gcui-gcuigrid-content-area"></div></div></div>'), this.gk = this.rh.outerDiv.find(".gcui-gcuigrid-scroller"), this.gk.css("padding", 0), this.gk.after(this.Uj.nw = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')), this.gk.after(this.Uj.ne = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')), this.gk.after(this.Uj.sw = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')), this.Uj.se = this.gk.find(".gcui-gcuigrid-split-area-se:first"), this.Tj = { nw: new o(t.appendChild(document.createElement("table")), !0, !0, !0), ne: new o(t.appendChild(document.createElement("table")), !0, !0, !0), sw: new o(t.appendChild(document.createElement("table")), !0, !0, !0), se: new o(t.appendChild(this.rh.element[0]), !0, !0, !0) }
                            }, o.prototype.hj = function() {
                                var o, n, r, a, s = e.grid.htmlTableAccessor,
                                    l = this;
                                this.Tj = { nw: new s(o = this.Tj.nw.element()), ne: new s(n = this.Tj.ne.element()), sw: new s(r = this.Tj.sw.element()), se: new s(a = this.Tj.se.element()) }, this.Uj.nw.empty().append(o), this.Uj.ne.empty().append(n), this.Uj.sw.empty().append(r), this.Uj.se.empty().append(a), i.each(this.Tj, function(e, t) {
                                    var o = i(t.element());
                                    l.rh.dg(o, { role: "grid", border: "0", cellpadding: "0", cellspacing: "0" }), o.addClass("gcui-gcuigrid-table").css("border-collapse", "separate").find("> tbody").addClass(l.rh.options.uiCSS.content + " gcui-gcuigrid-data")
                                }), t.prototype.hj.call(this)
                            }, o.prototype.hk = function() {
                                var e = this.Tj.nw.element(),
                                    t = this.Tj.ne.element(),
                                    i = this.Tj.sw.element(),
                                    o = this.Tj.se.element(),
                                    n;
                                return n = Math.max(e.rows.length, t.rows.length) + Math.max(i.rows.length, o.rows.length)
                            }, o.prototype.rj = function(e, t) { return [document.createElement("col"), document.createElement("col")] }, o.prototype.sj = function(e, t, i) { i <= this.Xj ? (this.Tj.nw.appendCol(e[0]), this.Tj.sw.appendCol(e[1])) : (this.Tj.ne.appendCol(e[0]), this.Tj.se.appendCol(e[1])) }, o.prototype.vj = function(t, i, o) {
                                var n = e.grid.rowType,
                                    r, a, s = this.Tj;
                                switch (t) {
                                    case n.header:
                                    case n.filter:
                                        r = s.nw.ensureTHead(), a = s.ne.ensureTHead();
                                        break;
                                    case n.footer:
                                        r = s.sw.ensureTFoot(), a = s.se.ensureTFoot();
                                        break;
                                    default:
                                        i <= this.Vj ? (r = s.nw.ensureTBody(), a = s.ne.ensureTBody()) : (i -= this.Vj + 1, r = s.sw.ensureTBody(), a = s.se.ensureTBody())
                                }
                                return o ? [r.appendChild(o), a.appendChild(o.cloneNode(!1))] : [r.insertRow(i > r.rows.length ? -1 : i), a.insertRow(i > a.rows.length ? -1 : i)]
                            }, o.prototype.Fj = function(e, o, n) {
                                var r = e.$rows[0],
                                    a = e.$rows[1];
                                !r.cells.length && this.Ij(e) && (r.parentNode.removeChild(r), r = null), !a.cells.length && this.Ij(e) && (a.parentNode.removeChild(a), a = null), (r || a) && (r && a || (e.$rows = i(r ? r : a)), t.prototype.Fj.call(this, e, o, n))
                            }, o.prototype.zj = function(t, i, o) {
                                var n = t.type !== e.grid.rowType.header ? this.Xj : this.Yj;
                                i <= n ? t.$rows[0].appendChild(o[0]) : t.$rows[1].appendChild(o[0])
                            }, o.prototype.ck = function(e, t) {
                                if (e[0] && e[1]) {
                                    var o = e[0],
                                        n = e[1],
                                        r = i(o),
                                        a = i(n),
                                        s, l, c, d = function(e) {
                                            var t, o = e[0],
                                                n;
                                            for (t = 0; t < o.cells.length; t++)
                                                if (n = o.cells[t], !n.rowSpan || 1 === n.rowSpan) return i(n).outerHeight();
                                            return e.height()
                                        };
                                    return (c = i.data(o, "customHeight")) ? s = l = parseInt(c) : (r.css("height", ""), a.css("height", ""), t ? (s = d(r), l = d(a)) : (s = r.height(), l = a.height())), Math.max(s, l)
                                }
                                return null
                            }, o.prototype.bk = function(e, t) {
                                if (e[0] && e[1]) {
                                    var o = [i(e[0]), i(e[1])],
                                        n;
                                    if (null === t) return;
                                    t += 1, i.each(o, function(e, i) { i.height(t), (n = t - i.height()) && i.height(t + n) })
                                }
                            }, o.prototype.ik = function() {
                                var e = this.rh,
                                    t = this.Xj,
                                    i = e.Ld("visibleLeaves").length - 1,
                                    o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y = [];
                                if (t > -1 && t < i) {
                                    if (o = this.Wj, n = this.hk() - 1, r = this.Tj, o > -1 && o <= n)
                                        for (a = r.ne.element(), s = a.parentNode, l = r.nw.element(), c = l.parentNode, b = l.rows, v = a.rows, f = b.length, g = 0; g < f; g++) y.push(this.ck([b[g], v[g]], !0));
                                    if (o >= -1 && o < n)
                                        for (d = r.se.element(), p = d.parentNode, u = r.sw.element(), h = u.parentNode, b = u.rows, v = d.rows, f = b.length, g = 0; g < f; g++) y.push(this.ck([b[g], v[g]]));
                                    if (o > -1 && o <= n && (c.removeChild(l), s.removeChild(a)), o >= -1 && o < n && (h.removeChild(u), p.removeChild(d)), o > -1 && o <= n)
                                        for (b = l.rows, v = a.rows, f = b.length, g = 0, m = 0; g < f; g++) this.bk([b[g], v[g]], y[m++]);
                                    if (o >= -1 && o < n)
                                        for (b = u.rows, v = d.rows, f = b.length, g = 0; g < f; g++) this.bk([b[g], v[g]], y[m++]);
                                    o > -1 && o <= n && (c.appendChild(l), s.appendChild(a)), o >= -1 && o < n && (h.appendChild(u), p.appendChild(d))
                                }
                            }, o.prototype.Vf = function() {
                                var e = i(this.Tj.sw.element()),
                                    t = i(this.Tj.se.element()),
                                    o;
                                t.css("height", ""), e.css("height", ""), this.ik(), o = Math.max(t.height(), e.height()), e.height(o), t.height(o)
                            }, o.prototype._j = function() { this.gk.data("gcui-superpanel") && (this.vsUI && this.vsUI.dispose(), this.gk.superpanel("destroy")) }, o.prototype.Rj = function(e, t) {
                                var i = this.dk();
                                this.Md ? "h" === t.dir && (this.jk(i.getContentElement(), t.dir, t.position, t.animationOptions, !1), this.jk(this.Uj.ne, t.dir, t.position, t.animationOptions, !0)) : this.jk("h" === t.dir ? this.Uj.ne : this.Uj.sw, t.dir, t.position, t.animationOptions, !0), this.rh.Gg(i.options.hScroller.scrollValue, i.options.vScroller.scrollValue)
                            }, o.prototype.$j = function(t, o) {
                                var n, r = o > 0 ? "top" : "bottom",
                                    a = !1,
                                    s;
                                this.rh.gg() && (n = this.getFixedAreaVisibleBounds(), i.each(n, function(i, o) { if (o && e.grid.isOver(t.pageY, t.pageX, o.top, o.left, o.height, o.width)) return a = !0, !1 }), a && this.gk.data("gcui-superpanel") && (s = this.gk.superpanel("option", "vScroller").scrollValue, this.gk.superpanel("doScrolling", r), s !== this.gk.superpanel("option", "vScroller").scrollValue && (t.stopPropagation(), t.preventDefault())))
                            }, o.prototype.jk = function(e, t, i, o, n) {
                                var r = {},
                                    a;
                                a = "h" === t ? n ? "scrollLeft" : "left" : n ? "scrollTop" : "top", n || (i = -i), o ? (r[a] = i, e.animate(r, o)) : n ? e[0][a] = i : e.css(a, i)
                            }, o.prototype.fk = function(e, t, i, o, n) {
                                var r, a = this.rh,
                                    s = i.width() + a.options.splitDistanceX,
                                    l = t.height() + a.options.splitDistanceY,
                                    c = e.width(),
                                    d = e.height(),
                                    p, u = 0,
                                    h = 0;
                                return !!(this.Md && a.bf() > 1) || (null !== a.$superPanelHeader && (u = a.$superPanelHeader.outerHeight(!0)), null !== a.$bottomPagerDiv && (h = a.$bottomPagerDiv.outerHeight(!0)), p = d - u - h, r = "both" === o || "vertical" === o || "auto" === o && (l > p || !n && s > c && l > p - this.Sj))
                            }, o.prototype.ak = function(e) {
                                var t = this.rh,
                                    i = t.options,
                                    o, n, r = 0,
                                    a = 0;
                                0 !== e && 2 !== e || (this.Uj.nw.width(i.splitDistanceX), this.Uj.sw.width(i.splitDistanceX), "right" === t.options.staticColumnsAlignment ? (this.Uj.se.css("marginRight", i.splitDistanceX), this.Uj.ne.css("marginRight", i.splitDistanceX)) : (this.Uj.se.css("marginLeft", i.splitDistanceX), this.Uj.ne.css("marginLeft", i.splitDistanceX))), 1 !== e && 2 !== e || (this.gk.css("height", ""), this.Uj.se.css("marginTop", 0), o = t.outerDiv.height(), t.Fd ? this.gk.height(o + i.splitDistanceY) : this.gk.height(o), this.Uj.nw.height(i.splitDistanceY), this.Uj.ne.height(i.splitDistanceY), null !== t.$superPanelHeader && (r = t.$superPanelHeader.outerHeight(!0)), null !== t.$bottomPagerDiv && (a = t.$bottomPagerDiv.outerHeight(!0)), n = o - r - a, null !== t.$superPanelHeader && (this.Uj.nw.css("top", r + "px"), this.Uj.ne.css("top", r + "px")), t.Fd ? this.Uj.sw.height(n) : this.Uj.sw.height(n - i.splitDistanceY), this.Uj.sw.css("top", i.splitDistanceY + r), this.Uj.se.css("marginTop", i.splitDistanceY))
                            }, o
                        }(t.baseView);
                    t.fixedView = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = function() {
                            function t(e) {
                                if (this.kk = 0, this.lk = null, this.mk = null, this.nk = { singlecell: [0, 0, 0], singlecolumn: [1, 1, 1], singlerow: [2, 2, 2], singlerange: [0, 1, 2], multicolumn: [1, 1, 1], multirow: [2, 2, 2], multirange: [0, 1, 2] }, !e) throw "invalid arguments";
                                this.rh = e, this.pk = new i(e), this.qk = new i(e), this.rk = new i(e), this.sk = new i(e)
                            }
                            return t.prototype.selectedCells = function() { return this.rk }, t.prototype.addColumns = function(e, t) { t || 0 === t || (t = e), this.addRange(e, 0, t, 16777215) }, t.prototype.addRange = function(t, i, o, n) {
                                if (!t && 1 === arguments.length) throw "invalid argument";
                                var r = 4 === arguments.length ? new e.grid.cellInfoRange(new e.grid.cellInfo(t, i), new e.grid.cellInfo(o, n)) : t.Sd();
                                if (r.aj(), !r.Td()) throw "invalid argument";
                                this.beginUpdate(), this._f(this.rh.Ld("currentCell")), this.Ve(r, !1, !0, e.grid.cellRangeExtendMode.none, null), this.endUpdate()
                            }, t.prototype.addRows = function(e, t) { t || 0 === t || (t = e), this.addRange(0, e, 16777215, t) }, t.prototype.removeRange = function(t, i, o, n) {
                                if (!t && 1 === arguments.length) throw "invalid argument";
                                var r = 4 === arguments.length ? new e.grid.cellInfoRange(new e.grid.cellInfo(t, i), new e.grid.cellInfo(o, n)) : t.Sd();
                                if (r.aj(), !r.Td()) throw "invalid argument";
                                this.beginUpdate(), this._f(this.rh.Ld("currentCell")), this.ag(r, e.grid.cellRangeExtendMode.none), this.endUpdate()
                            }, t.prototype.removeColumns = function(e, t) { t || 0 === t || (t = e), this.removeRange(e, 0, t, 16777215) }, t.prototype.removeRows = function(e, t) { t || 0 === t || (t = e), this.removeRange(0, e, 16777215, t) }, t.prototype.clear = function() { this.beginUpdate(), this.qk.tk(), this.qk.uk(this.rk), this.endUpdate() }, t.prototype.selectAll = function() { this.beginUpdate(), this.Ve(this.rh.Vd(), !1, !1, e.grid.cellRangeExtendMode.none, null), this.endUpdate() }, t.prototype.beginUpdate = function() { this.kk++ }, t.prototype.endUpdate = function() { this.kk > 0 && 0 === --this.kk && (this.doSelection(), (this.pk.length() || this.qk.length()) && (null !== this.lk && this.lk.UnderlyingDataChanged(), null !== this.mk && this.mk.UnderlyingDataChanged(), this.rh._trigger("selectionChanged", null, { addedCells: this.pk, removedCells: this.qk })), this.pk = new e.grid.cellInfoOrderedCollection(this.rh), this.qk.tk()) }, t.prototype.$f = function() { var e = this.rh.options.selectionMode; return e && ("multicolumn" === (e = e.toLowerCase()) || "multirow" === e || "multirange" === e) }, t.prototype.bg = function() { return this.vk }, t.prototype._f = function(t) { t && (this.vk = t.Sd(), this.sk = new e.grid.cellInfoOrderedCollection(this.rh)) }, t.prototype.ag = function(e, t) {
                                var i = this.rh.options.selectionMode.toLowerCase(),
                                    o, n, r, a, s, l, c, d, p, u = this.rh.Vd();
                                if (e.Td() && "none" !== i && this.rk.length() > 0) {
                                    if (o = e.Sd(), o.aj(), o.Ud(u), !e.Td()) return;
                                    for (o._i(this.nk[i][t], u), this.beginUpdate(), c = 0, d = this.rk.length(); c < d; c++) p = this.rk.item(c), o.ng(p) && this.qk.wk(p);
                                    this.endUpdate()
                                }
                            }, t.prototype.Ve = function(t, i, o, n, r) {
                                var a = this.rh.options.selectionMode.toLowerCase(),
                                    s, l = this.rh.Vd();
                                if ("none" !== a && t.Td()) {
                                    if (s = t.Sd(), s.aj(), s.Ud(l), !s.Td()) return;
                                    switch (this.beginUpdate(), this.$f() && (i || o) ? o && (this.qk.tk(), this.qk.uk(this.sk)) : this.clear(), a) {
                                        case "singlecell":
                                        case "singlecolumn":
                                        case "singlerow":
                                            s = null === r ? new e.grid.cellInfoRange(s.topLeft(), s.topLeft()) : new e.grid.cellInfoRange(r, r)
                                    }
                                    s._i(this.nk[a][n], l), this.doRange(s, !0), this.endUpdate()
                                }
                            }, t.prototype.doSelection = function() {
                                var t = this.rh.vg(),
                                    i = t.x,
                                    n = t.y,
                                    r = this.rh.Od(),
                                    a, s, l, c, d, p, u = e.grid.renderState,
                                    h, f, g = -1;
                                for (a = 0, s = this.qk.length(); a < s; a++) l = this.qk.item(a), this.pk.indexOf(l) < 0 ? (c = r.getCell(l.cellIndex() + i, l.rowIndex() + n), c && (g !== l.rowIndex() && (h = l.row(), g = l.rowIndex()), d = o(c), f = r.og(d, u.selected, !1), this.rh.cellStyleFormatter.format(d, l.cellIndex(), l.column(), h, f)), this.rk.Na(l), this.sk.Na(l)) : (this.qk.xk(a), a--, s--);
                                for (g = -1, a = 0, s = this.pk.length(); a < s; a++) l = this.pk.item(a), p = this.rk.indexOf(l), p < 0 ? (c = r.getCell(l.cellIndex() + i, l.rowIndex() + n), c && (g !== l.rowIndex() && (h = l.row(), g = l.rowIndex()), d = o(c), f = r.og(d, u.selected, !0), this.rh.cellStyleFormatter.format(d, l.cellIndex(), l.column(), h, f)), this.rk.yk(l, ~p), this.sk.wk(l)) : (this.pk.xk(a), a--, s--)
                            }, t.prototype.doRange = function(t, i) {
                                var o = t.topLeft().cellIndex(),
                                    n = t.topLeft().rowIndex(),
                                    r = t.bottomRight().cellIndex(),
                                    a = t.bottomRight().rowIndex(),
                                    s, l, c, d, p = this.rh.Od(),
                                    u, h;
                                if (i) {
                                    for (s = this.pk.length(), h = this.rh.Rd(), l = n; l <= a; l++)
                                        if (u = p.Wd(h.item(l)), u.type & e.grid.rowType.data)
                                            for (c = o; c <= r; c++) d = new e.grid.cellInfo(c, l), 0 === s ? this.pk.zk(d) : this.pk.wk(d)
                                } else
                                    for (s = this.qk.length(), l = n; l <= a; l++)
                                        for (c = o; c <= r; c++) d = new e.grid.cellInfo(c, l), 0 === s ? this.qk.zk(d) : this.qk.wk(d)
                            }, t
                        }();
                    t.selection = n, i = function() {
                        function t(e) {
                            if (this.tk = function() { this.Ak.length = 0 }, !e) throw "invalid arguments";
                            this.rh = e, this.Ak = []
                        }
                        return t.prototype.item = function(e) { return this.Ak[e] }, t.prototype.length = function() { return this.Ak.length }, t.prototype.indexOf = function(e, t) {
                            1 === arguments.length && (t = e.rowIndex(), e = e.cellIndex());
                            for (var i = 0, o = this.Ak.length - 1, n, r, a; i <= o;)
                                if (n = i + (o - i >> 1), r = this.Ak[n], a = r.rowIndex() - t, 0 === a && (a = r.cellIndex() - e), a < 0) i = n + 1;
                                else {
                                    if (!(a > 0)) return n;
                                    o = n - 1
                                } return ~i
                        }, t.prototype.toString = function() {
                            var e = "",
                                t, i;
                            for (t = 0, i = this.Ak.length; t < i; t++) e += this.Ak[t] + "\n";
                            return e
                        }, t.prototype.wk = function(e) { var t = this.indexOf(e); return t < 0 && (this.Ak.splice(~t, 0, e), e.Xd(this.rh), !0) }, t.prototype.uk = function(e) {
                            if (e) {
                                var t = e.length(),
                                    i = this.Ak.length,
                                    o;
                                if (0 === i)
                                    for (this.Ak.length = t, o = 0; o < t; o++) this.Ak[o] = e.item(o), this.Ak[o].Xd(this.rh);
                                else
                                    for (o = 0; o < t; o++) this.wk(e.item(o))
                            }
                        }, t.prototype.zk = function(e) { this.Ak[this.Ak.length] = e, e.Xd(this.rh) }, t.prototype.yk = function(e, t) { this.Ak.splice(t, 0, e) }, t.prototype.Na = function(e) { var t = this.indexOf(e); return t >= 0 && (this.Ak.splice(t, 1), !0) }, t.prototype.xk = function(e) { this.Ak.splice(e, 1) }, t.prototype.Bk = function() {
                            var e = [],
                                t = this.Ak.length,
                                i, o, n;
                            if (t) { for (i = [], o = 0; o < t; o++) i[this.Ak[o].cellIndex()] = 1; for (t = i.length, n = 0, o = 0; o < t; o++) i[o] && (e[n++] = o) }
                            return e
                        }, t.prototype.Ck = function() {
                            var e = [],
                                t = this.Ak.length,
                                i, o, n;
                            if (t) { for (i = [], o = 0; o < t; o++) i[this.Ak[o].rowIndex()] = 1; for (t = i.length, n = 0, o = 0; o < t; o++) i[o] && (e[n++] = o) }
                            return e
                        }, t.prototype.Dk = function() {
                            var t = this.Ak.length,
                                i = 4294967295,
                                o = 4294967295,
                                n = 0,
                                r = 0,
                                a, s;
                            if (t) { for (a = 0; a < t; a++) s = this.Ak[a], i = Math.min(i, s.cellIndex()), o = Math.min(o, s.rowIndex()), n = Math.max(n, s.cellIndex()), r = Math.max(r, s.rowIndex()); return new e.grid.cellInfoRange(new e.grid.cellInfo(i, o), new e.grid.cellInfo(n, r)) }
                            return null
                        }, t
                    }(), t.cellInfoOrderedCollection = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(t) { this.Ek = 10, this.Fk = !1, this.Gk = !1, this.rh = t, this.Hk = "{0}." + this.rh.widgetName + ".selectionui", this.pk = new e.grid.cellInfoOrderedCollection(this.rh), this.Od = this.rh.Od(), this.Ik = this.Od.focusableElement(), this.Jk = this.rh.Ld("visibleLeaves").length, this.Ik.bind(this.Kk("mousedown"), i.proxy(this.Lk, this)) }
                            return t.prototype.dispose = function() { this.Ik.unbind(this.Kk("mousedown"), this.Lk), this.Mk() }, t.prototype.Lk = function(e) {
                                if (this.rh.gg() && "none" !== this.rh.options.selectionMode.toLowerCase()) {
                                    var t = this.Od.getVisibleAreaBounds(),
                                        o = { x: e.pageX, y: e.pageY },
                                        n = e.target && void 0 !== e.target.tagName ? e.target.tagName.toLowerCase() : void 0,
                                        r = i(e.target);
                                    (!n || r.is("td.gcuigridtd, th.gcuigridtd, div.gcui-gcuigrid-innercell")) && o.x > t.left && o.x < t.left + t.width && o.y > t.top && o.y < t.top + t.height && (this.Nk(), this.Ok = o, this.Pk = this.Qk(this.Ok))
                                }
                            }, t.prototype.Rk = function(t) {
                                if (this.Pk && this.Pk.Td()) {
                                    var o = { x: t.pageX, y: t.pageY },
                                        n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y = this.rh.Od(),
                                        w = this.rh.Rd(),
                                        x = e.grid.renderState;
                                    if (this.Fk || (this.Fk = Math.abs(this.Ok.x - o.x) > this.Ek || Math.abs(this.Ok.y - o.y) > this.Ek), this.Fk) {
                                        if (n = this.Qk(o), !n.Td()) return;
                                        if (this.Sk = n, a = new e.grid.cellInfoRange(this.Pk, this.Sk), a.aj(), a.Ud(this.rh.Vd()), a.Td() && !a.isEqual(this.Tk)) {
                                            for (s = this.rh.vg(), this.Tk = a, l = new e.grid.cellInfoOrderedCollection(this.rh), c = a.bottomRight().rowIndex(), d = a.bottomRight().cellIndex(), p = a.topLeft().rowIndex(); p <= c; p++)
                                                if (m = y.Wd(w.item(p)), m.type & e.grid.rowType.data)
                                                    for (u = a.topLeft().cellIndex(); u <= d; u++) l.zk(new e.grid.cellInfo(u, p));
                                            for (b = -1, h = 0, f = this.pk.length(); h < f; h++) r = this.pk.item(h), l.indexOf(r) < 0 && (this.rh.selection().selectedCells().indexOf(r) < 0 && (u = this.Od.getCell(r.cellIndex() + s.x, r.rowIndex() + s.y)) && (b !== r.rowIndex() && (m = r.row(), b = r.rowIndex()), g = i(u), v = y.og(g, x.selected, !1), this.rh.cellStyleFormatter.format(g, r.cellIndex(), r.column(), m, v)), this.pk.xk(h), h--, f--);
                                            for (b = -1, h = 0, f = l.length(); h < f; h++) r = l.item(h), this.pk.indexOf(r) < 0 && this.rh.selection().selectedCells().indexOf(r) < 0 && this.pk.wk(r) && (u = this.Od.getCell(r.cellIndex() + s.x, r.rowIndex() + s.y)) && (b !== r.rowIndex() && (m = r.row(), b = r.rowIndex()), g = i(u), v = y.og(g, x.selected, !0), this.rh.cellStyleFormatter.format(g, r.cellIndex(), r.column(), m, v))
                                        }
                                    }
                                }
                            }, t.prototype.Uk = function(t) {
                                if (this.Mk(), this.Fk && (this.Fk = !1, this.Tk && this.Tk.Td())) {
                                    this.rh.Yd(t, this.Sk, { changeSelection: !1, setFocus: !1 }), t.shiftKey && (this.rh.selection().$f() || "singleRange" === this.rh.options.selectionMode.toLowerCase()) || this.rh.selection()._f(this.Pk), this.rh.selection().beginUpdate(), this.rh.selection().Ve(this.Tk, t.shiftKey, t.ctrlKey, e.grid.cellRangeExtendMode.none, this.Sk), this.rh.selection().endUpdate();
                                    var o = this.rh.Od(),
                                        n = this.rh.vg(),
                                        r, a, s, l, c, d = -1,
                                        p, u, h = e.grid.renderState;
                                    for (r = 0, a = this.pk.length(); r < a; r++) s = this.pk.item(r), this.rh.selection().selectedCells().indexOf(s) < 0 && null !== (l = o.getCell(s.cellIndex() + n.x, s.rowIndex() + n.y)) && (d !== s.rowIndex() && (p = s.row(), d = s.rowIndex()), c = i(l), u = o.og(c, h.selected, !1), this.rh.cellStyleFormatter.format(c, s.cellIndex(), s.column(), p, u));
                                    return this.pk.tk(), this.Pk = this.Sk = this.Tk = null, !1
                                }
                            }, t.prototype.Nk = function() { if (!this.Gk) try { this.Od.toggleDOMSelection(!1), i(document).bind(this.Kk("mousemove"), i.proxy(this.Rk, this)).bind(this.Kk("mouseup"), i.proxy(this.Uk, this)) } finally { this.Gk = !0 } }, t.prototype.Mk = function() { if (this.Gk) try { this.Od.toggleDOMSelection(!0), i(document).unbind(this.Kk("mousemove"), this.Rk).unbind(this.Kk("mouseup"), this.Uk) } finally { this.Gk = !1 } }, t.prototype.Kk = function(t) { return e.grid.stringFormat(this.Hk, t) }, t.prototype.Qk = function(t) {
                                for (var i = 0, o = this.Jk - 1, n = 0, r = -1, a, s = new e.grid.rowAccessor(this.Od, 2, 0, 0), l, c, d, p; i <= o && (n = (o - i >> 1) + i, a = e.grid.bounds(this.Od.getHeaderCell(n)), a || (c = s.item(0), a = e.grid.bounds(e.grid.rowAccessor.getCell(c, n))), a);)
                                    if (t.x < a.left) o = n - 1;
                                    else { if (!(t.x > a.left + a.width)) { r = n; break } i = n + 1 } if (-1 === r) return e.grid.cellInfo.outsideValue;
                                for (s = new e.grid.rowAccessor(this.Od, 0, 0, 0), l = -1, i = 0, o = s.length() - 1, n = 0; i <= o;)
                                    if (n = (o - i >> 1) + i, c = s.item(n), a = e.grid.bounds(e.grid.rowAccessor.getCell(c, 0)), t.y < a.top) o = n - 1;
                                    else { if (!(t.y > a.top + a.height)) { l = n; break } i = n + 1 } return -1 === l ? e.grid.cellInfo.outsideValue : (d = this.rh.vg(), p = new e.grid.cellInfo(r - d.x, l - d.y), p.Ud(this.rh.Vd()), p)
                            }, t
                        }();
                    t.uiSelection = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(e) {
                    "use strict";
                    var t = jQuery,
                        i = function() {
                            function e(e, t, i, o) { this.Od = e, this.Vk = t, this.Wk = o, this.Xk = i }
                            return e.prototype.item = function(e) { var t = this.length(); return e < t ? this.Od.getJoinedRows(e + this.Xk, this.Vk) : null }, e.prototype.length = function() {
                                var e = this.Od.getJoinedTables(!0, 0),
                                    t = 0,
                                    i;
                                return (i = e[0]) && (t = i.getSectionLength(this.Vk)), (i = e[1]) && (t += i.getSectionLength(this.Vk)), t -= this.Xk + this.Wk, t < 0 && (t = 0), t
                            }, e.iterateCells = function e(t, i, o) {
                                if (t && i) {
                                    var n = 0,
                                        r, a, s, l, c, d;
                                    for (r = 0, a = t.length; r < a; r++)
                                        if (s = t[r])
                                            for (l = 0, c = s.cells.length; l < c; l++)
                                                if (!0 !== (d = i(s.cells[l], n++, o))) return
                                }
                            }, e.getCell = function e(t, i) { var o, n; if (t && (o = t[0])) { if (n = o.cells.length, i < n) return o.cells[i]; if (i -= n, (o = t[1]) && (n = o.cells.length, i < n)) return o.cells[i] } return null }, e.cellsCount = function e(t) {
                                var i = 0,
                                    o;
                                return t && (o = t[0]) && (i = o.cells.length, (o = t[1]) && (i += o.cells.length)), i
                            }, e
                        }();
                    e.rowAccessor = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t() { this.Yk = 25 }
                            return t.prototype.currentCellEditStart = function(t, o) {
                                var n = !1,
                                    r = t.currentCell(),
                                    a = t.Od(),
                                    s, l, c, d;
                                return r.Td() && !r.eg() && r.column().dataIndex >= 0 && (s = r.row()) && (d = s.type) & e.grid.rowType.data && (l = { cell: r, event: o, handled: !1 }, (n = t._trigger("beforeCellEdit", null, l)) && (l.handled || (n = this.Zk(t, l))), n && (r.eg(!0), t.Ge() && (c = i(s.$rows[0].cells[0]).children("div.gcui-gcuigrid-innercell"), c.length && (c.empty(), c.append(i("<div>&nbsp;</div>").addClass(t.options.uiCSS.icon + " ui-icon-pencil")))))), n
                            }, t.prototype.currentCellEditEnd = function(t, o) {
                                var n, r, a, s, l, c, d, p, u, h, f, g = t.currentCell(),
                                    m = g.column(),
                                    b = !1,
                                    v = t.Od(),
                                    y = e.getKeyCodeEnum();
                                if (g.Td() && g.eg()) {
                                    if (n = g.row()) {
                                        if (!((r = n.type) & e.grid.rowType.data)) return b;
                                        if (a = o && o.which === y.ESCAPE, o && a) b = !0;
                                        else if (p = { cell: g, value: void 0 }, b = t._trigger("beforeCellUpdate", null, p)) { void 0 === p.value && (p.value = this.$k(t, g)), s = p.value, l = g.value(); try { d = this._k(g), e.grid.HTML5InputSupport.isExtendSupportRequired(d) ? (p.value = e.grid.HTML5InputSupport.parse(p.value, d), p.value = e.grid.HTML5InputSupport.extend(l, p.value, d)) : p.value = t.parse(g.column(), p.value), s = p.value } catch (e) { p.value = s } if ("datetime" === e.grid.getDataType(m) && (s instanceof Date && (s = s.getTime()), l instanceof Date && (l = l.getTime())), s !== l) { try { g.value(p.value) } catch (e) { u = { cell: g, value: p.value }, b = !1, t._trigger("invalidCellValue", null, u) } b && (h = { cell: g }, t._trigger("afterCellUpdate", null, h)) } } b && (f = { cell: g, event: o, handled: !1 }, t._trigger("afterCellEdit", null, f), f.handled || (b = this.al(t, f)), b && g.eg(!1), t.Ge() && i(n.$rows[0].cells[0]).children("div.gcui-gcuigrid-innercell").html("&nbsp;"), window.setTimeout(function() { t.yd || (g = t.currentCell(), (c = g.tableCell()) ? i(c).attr("tabIndex", 0).focus() : i(t.Od().focusableElement()).focus()) }, this.Yk))
                                    }
                                    return b
                                }
                            }, t.prototype.Zk = function(t, o) {
                                var n, r, a, s, l, c, d, p = o.cell.column(),
                                    u = !1,
                                    h = e.getKeyCodeEnum(),
                                    f = e.grid.HTML5InputSupport.getDefaultInputType(t.uf(), p);
                                if (p.dataIndex >= 0) {
                                    n = o.cell.value(), u = !0;
                                    try {
                                        if (a = o.cell.container(), "boolean" === e.grid.getDataType(p)) d = a.children("span"), d.length && d.prop("disabled") && (i.data(d[0], "disabledSpan", !0), d.prop("disabled", !1)), s = a.find(":checkbox"), s.prop("disabled", !1), s.focus(), o.event && "keypress" === o.event.type && s.one("keyup", function(e) { e.which === h.SPACE && (e.preventDefault(), s[0].checked = !n) });
                                        else {
                                            if (s = i("<input />").attr("type", f).addClass("gridinput gcui-input " + t.options.uiCSS.stateFocus).bind("keydown", t, i.proxy(this.bl, this)), s.bind(i.support.selectstart ? "selectstart" : "mousedown", function(e) { e.stopPropagation() }), o.event && "keypress" === o.event.type && o.event.which) s.val(String.fromCharCode(o.event.which));
                                            else switch (e.grid.getDataType(p)) {
                                                case "currency":
                                                case "number":
                                                    if (null !== n) { s.val(n); break }
                                                case "datetime":
                                                    if (e.grid.HTML5InputSupport.isExtendSupportRequired(f)) { s.val(e.grid.HTML5InputSupport.toStr(n, f)); break }
                                                default:
                                                    s.val(t.toStr(p, n))
                                            }
                                            a.empty().append(s), l = s.val().length, "text" === f && new e.grid.domSelection(s[0]).setSelection({ start: l, end: l }), s.focus(), setTimeout(function() { s.focus() }, 2 * this.Yk)
                                        }
                                    } catch (e) { alert(e.message), u = !1 }
                                }
                                return u
                            }, t.prototype.al = function(t, o) {
                                var n, r, a, s, l, c, d, p = o.cell.column(),
                                    u = !1;
                                if (p.dataIndex >= 0) { u = !0, l = t.Od(); try { n = o.cell.container(), r = t.toStr(p, o.cell.value()), s = l.Wd(t.Rd().item(o.cell.rowIndex())), "boolean" === e.grid.getDataType(p) ? (c = n.children("span"), d = c.length && i.data(c[0], "disabledSpan"), a = n.find(":checkbox"), "true" === r ? a.attr("checked", "checked") : a.removeAttr("checked"), d && (c.prop("disabled", !0), a.prop("disabled", !0))) : t.cellFormatter.format(n, p, r, s) } catch (e) { alert("defaultAfterCellEdit: " + e.message), u = !1 } }
                                return u
                            }, t.prototype.bl = function(t) { var i, o = e.getKeyCodeEnum(); if (t.which === o.ENTER && (i = t.data)) return i.he(t), !1 }, t.prototype.$k = function(e, t) {
                                var i = t.container().find(":input:first"),
                                    o = null;
                                return i.length && (o = "checkbox" === i.attr("type") ? i[0].checked : i.val()), o
                            }, t.prototype._k = function(e) { return e.container().find(":input:first").attr("type") }, t
                        }();
                    t.cellEditorHelper = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t() {}
                            return t.cl = document.createElement("div"), t.prototype.format = function(t, o, n, r) {
                                r.type & e.grid.rowType.footer && (n = o.aggregate && "none" !== o.aggregate ? e.grid.stringFormat(o.footerText || "{0}", o.ae || "") : o.footerText || o.Fe || "");
                                var a = !0,
                                    s = null,
                                    l = { $container: t, column: o, formattedValue: n, row: r, afterDefaultCallback: null },
                                    c;
                                if (i.isFunction(o.cellFormatter) && (a = !o.cellFormatter(l)), a) {
                                    switch (e.grid.getDataType(o)) {
                                        case "boolean":
                                            s = this.dl;
                                            break;
                                        default:
                                            s = this.el
                                    }
                                    s && (s.call(this, l), i.isFunction(c = l.afterDefaultCallback) && c(l))
                                }
                            }, t.prototype.el = function(t) {
                                var i;
                                switch (t.row.type) {
                                    case e.grid.rowType.filter:
                                        this.fl(t);
                                        break;
                                    default:
                                        if (i = t.$container[0], i.firstChild)
                                            for (; i.firstChild;) i.removeChild(i.firstChild);
                                        for (e.grid.cellFormatterHelper.cl.innerHTML = t.formattedValue || "&nbsp;"; e.grid.cellFormatterHelper.cl.firstChild;) i.appendChild(e.grid.cellFormatterHelper.cl.firstChild)
                                }
                            }, t.prototype.dl = function(t) {
                                var i, o, n = "disabled='disabled'",
                                    r, a, s = e.grid.rowType,
                                    l = e.getKeyCodeEnum();
                                switch (t.row.type) {
                                    case s.data:
                                    case s.data | s.dataAlt:
                                        i = t.column.owner, o = i.options.allowEditing && !0 !== t.column.readOnly, o && (n = ""), !0 === i.parse(t.column, i.Bd.getValue(t.row.data, t.column.dataKey)) ? t.$container.html("<input class='gridinput' type='checkbox' checked='checked' " + n + " />") : t.$container.html("<input class='gridinput' type='checkbox' " + n + " />"), o && t.$container.children("input").bind("mousedown", function(e) { r = t.$container.parent()[0], a = i.currentCell(), a.tableCell() !== r && i.gb({ target: r }), a.eg() || i.beginEdit() }).bind("keydown", function(e) { if (e.which === l.ENTER) return i.he(e), !1 });
                                        break;
                                    default:
                                        this.el(t)
                                }
                            }, t.prototype.fl = function(e) {
                                var t = e.column.owner,
                                    i = t.options.uiCSS;
                                e.$container.addClass(i.widget + " " + i.stateDefault), e.column.dataIndex >= 0 && !e.column.isBand && e.column.showFilter ? e.$container.html('<table cellPadding="0" cellSpacing="0" class="gcui-gcuigrid-filter ' + i.cornerAll + '"><tr><td style="width:100%"><input type="text" class="gcui-gcuigrid-filter-input" style="width:100%" /></td><td class="gcui-gcuigrid-filter-trigger ' + i.cornerRight + " " + i.stateDefault + '"><span class="' + i.icon + " " + i.iconArrowDown + '"></span></td></tr></table>') : e.$container.html("&nbsp;")
                            }, t
                        }();
                    t.cellFormatterHelper = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(e) { this.MIN_WIDTH = 5, this.gl = [], this.hl = 10, this.il = 1, this.Fk = !1, this.jl = null, this.kl = null, this.ll = null, this.ml = null, this.rh = e, this.Hk = "{0}." + this.rh.widgetName + ".resizer" }
                            return t.prototype.addElement = function(e) { e && e.element && (e.element.bind(this.Kk("mousemove"), i.proxy(this.Cf, this)).bind(this.Kk("mousedown"), i.proxy(this.nl, this)).bind(this.Kk("mouseout"), i.proxy(this.Df, this)), this.gl.push(e)) }, t.prototype.dispose = function() {
                                var e = this;
                                i.each(this.gl, function(t, i) { i.element.unbind(e.Kk("mousemove"), e.Cf).unbind(e.Kk("mousedown"), e.nl).unbind(e.Kk("mouseout"), e.Df) }), this.ol()
                            }, t.prototype.inProgress = function() { return this.Fk }, t.prototype.Cf = function(e) {
                                if (!this.Fk) {
                                    var t = this.pl({ x: e.pageX, y: e.pageY });
                                    t && t.Mg() && this.rh.gg() ? (t.element.css("cursor", "e-resize"), this.jl = t, e.stopPropagation()) : this.Df(e)
                                }
                            }, t.prototype.Df = function(e) { this.Fk || this.jl && (this.jl.element.css("cursor", ""), this.jl = null) }, t.prototype.nl = function(t) {
                                if (this.jl = this.pl({ x: t.pageX, y: t.pageY }), this.jl && this.jl.Mg() && this.rh.gg()) try {
                                    this.jl.element.css("cursor", ""), this.ql = document.body.style.cursor, document.body.style.cursor = "e-resize", this.kl = this.ll = e.grid.bounds(this.jl.element), this.ml = i('<div class="gcui-gcuigrid-resizehandle ' + this.rh.options.uiCSS.stateHightlight + '">&nbsp;</div>');
                                    var o = this.rh.Od().getVisibleAreaBounds();
                                    this.ml.css({ left: t.pageX, top: this.kl.top, height: o.height + o.top - this.kl.top }), i(document.body).append(this.ml)
                                } finally { this.rl(), this.Fk = !0, t.stopPropagation() }
                            }, t.prototype.Rk = function(e) {
                                var t = this.il * Math.round((e.pageX - this.ll.left) / this.il);
                                this.ll = { left: this.ll.left + t, top: e.pageY, width: void 0, height: void 0 }, this.ml.css("left", this.ll.left)
                            }, t.prototype.Uk = function(e) { try { document.body.style.cursor = this.ql, this.ml.remove(), this.kl !== this.ll && this.rh.mg(this.jl, this.kl.width, Math.max(this.ll.left - this.kl.left, this.MIN_WIDTH)) } finally { this.jl = null, this.ml = null, this.ol(), this.Fk = !1 } }, t.prototype.sl = function(e) { e.preventDefault() }, t.prototype.rl = function() { this.Fk || (i(document).bind(this.Kk("mousemove"), i.proxy(this.Rk, this)).bind(this.Kk("mouseup"), i.proxy(this.Uk, this)), i.fn.disableSelection && i(document.body).disableSelection(), "onselectstart" in document && i(document.body).bind("selectstart", this.sl)) }, t.prototype.ol = function() { this.Fk && (i(document).unbind(this.Kk("mousemove"), this.Rk).unbind(this.Kk("mouseup"), this.Uk), i.fn.enableSelection && i(document.body).enableSelection(), "onselectstart" in document && i(document.body).unbind("selectstart", this.sl)) }, t.prototype.pl = function(t) {
                                var i, o, n, r, a;
                                for (i = 0, o = this.gl.length; i < o; i++)
                                    if (n = this.gl[i], r = e.grid.bounds(n.element), a = e.grid.isOver(t.y, t.x, r.top, r.left + r.width - this.hl, r.height, this.hl)) return n;
                                return null
                            }, t.prototype.Kk = function(t) { return e.grid.stringFormat(this.Hk, t) }, t
                        }();
                    t.uiResizer = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(t) { this.tl = "scope_" + e.grid.getUID(), this.ul = !1, this.rh = t, this.vl = this.rh.options.uiCSS, this.wl = '<div class="' + this.vl.widget + " gcui-gcuigrid " + this.vl.content + " " + this.vl.cornerAll + '"><table class="gcui-gcuigrid-root gcui-gcuigrid-table"><tr class="gcui-gcuigrid-headerrow"></tr></table></div>' }
                            return t.prototype.attachGroupArea = function(e) {
                                var t, o = this;
                                i.ui.droppable && i.ui.draggable && e.droppable({
                                    scope: this.tl,
                                    tolerance: "pointer",
                                    greedy: !0,
                                    accept: function(e) { return !(!o.rh.options.allowColMoving || !(t = o.xl(e))) && (!(t instanceof i.gcui.c1groupedfield && t.options.groupedIndex === o.rh.Re().length - 1) && (!t.options.isBand && (void 0 === t.options.groupedIndex || t instanceof i.gcui.c1groupedfield))) },
                                    drop: function(e, i) {!o.yl(e, i.draggable) && (t = o.xl(i.draggable)) && (o.ul = !0) },
                                    over: function(t, i) {
                                        var n = o.rh.Ld("groupedWidgets").length;
                                        o.zl = n > 0, o.Al = n > 0 ? o.rh.Ld("groupedWidgets")[n - 1] : e, e.data("thisDroppableField", o.Al)
                                    },
                                    out: function(t, i) { o.Al === e.data("thisDroppableField") && (o.Al = null) }
                                })
                            }, t.prototype.attach = function(t) {
                                var o, n, r = this;
                                i.ui.droppable && i.ui.draggable && t && (o = t.element) && o.draggable({
                                    helper: function(e) { return t instanceof i.gcui.c1groupedfield ? o.clone().addClass("gcui-gcuigrid-dnd-helper") : o.clone().wrap(r.wl).width(o.width()).height(o.height()).closest(".gcui-gcuigrid").addClass("gcui-gcuigrid-dnd-helper") },
                                    appendTo: "body",
                                    scope: r.tl,
                                    drag: function(e, i) {
                                        if (r.Bl(), r.Al && !r.yl(e, o)) {
                                            var n = r.Al.element;
                                            n || (n = r.Al), r.Cl(n, r.Dl(t, r.Al, e, i))
                                        }
                                    },
                                    start: function(o, n) {
                                        if (r.rh.gg() && r.rh.options.allowColMoving && !r.rh.Ld("resizer").inProgress()) {
                                            var a = t.options,
                                                s = t.options.travIdx,
                                                l = t instanceof i.gcui.c1groupedfield,
                                                c = l ? "groupArea" : "columns";
                                            if (l && (a = e.grid.search(r.rh.columns(), function(e) { return e.options.travIdx === s }), a = a.found ? a.found.options : e.grid.getColumnByTravIdx(r.rh.options.columns, s).found), t.Ng() && r.rh._trigger("columnDragging", null, { drag: a, dragSource: c })) return r.rh._trigger("columnDragged", null, { drag: a, dragSource: c }), !0
                                        }
                                        return !1
                                    },
                                    stop: function(e, o) { r.Bl(); try { r.ul && (r.Al.element ? r.rh.Jf(t.options.travIdx, r.Al.options.travIdx, r.Dl(t, r.Al, e, o), t instanceof i.gcui.c1groupedfield, r.Al instanceof i.gcui.c1groupedfield) : r.rh.Jf(t.options.travIdx, -1, "left", t instanceof i.gcui.c1groupedfield, !0)) } finally { r.Al = null, r.ul = !1 } }
                                }).droppable({
                                    hoverClass: r.vl.stateHover,
                                    scope: r.tl,
                                    tolerance: "pointer",
                                    greedy: !0,
                                    accept: function(e) { return !(!r.rh.options.allowColMoving || o[0] === e[0] || !(n = r.xl(e))) && n.Og(t) },
                                    drop: function(e, t) {
                                        (n = r.xl(t.draggable)) && (r.ul = !0)
                                    },
                                    over: function(e, i) { r.zl = !1, r.Al = t, o.data("thisDroppableField", r.Al) },
                                    out: function(e, i) { r.Al === t.element.data("thisDroppableField") && (r.Al = null) }
                                })
                            }, t.prototype.detach = function(e) {
                                var t;
                                e && (t = e.element) && (t.data("ui-draggable") && t.draggable("destroy"), t.data("ui-droppable") && t.droppable("destroy"))
                            }, t.prototype.dispose = function() { this.El && (this.El.remove(), this.El = null), this.Fl && (this.Fl.remove(), this.Fl = null) }, t.prototype.xl = function(t) { var i = e.grid.widgetName(t); if (!i) throw "widgetName is undedined"; return t.data(i) }, t.prototype.Cl = function(e, t) { this.Gl().show().position({ my: "center", at: t + " top", of: e, collision: "none" }), this.Hl().show().position({ my: "center", at: t + " bottom", of: e, collision: "none" }) }, t.prototype.Bl = function() { this.Gl().hide(), this.Hl().hide() }, t.prototype.Gl = function() { return this.El || (this.El = i("<div />").addClass("gcui-gcuigrid-dnd-arrow-top").append(i("<span />").addClass(this.vl.icon + " ui-icon-arrowthick-1-s")).hide().appendTo(document.body)), this.El }, t.prototype.Hl = function() { return this.Fl || (this.Fl = i("<div />").addClass("gcui-gcuigrid-dnd-arrow-bottom").append(i("<span />").addClass(this.vl.icon + " ui-icon-arrowthick-1-n")).hide().appendTo(document.body)), this.Fl }, t.prototype.yl = function(t, i) { var o = e.grid.bounds(i, !1); return t.pageX > o.left && t.pageX < o.left + o.width && t.pageY > o.top && t.pageY < o.top + o.height }, t.prototype.Dl = function(t, o, n, r) {
                                if (!o.element) return "left";
                                if (this.zl) return "right";
                                var a = e.grid.bounds(o.element, !1),
                                    s = a.width / 6,
                                    l = a.left + a.width / 2,
                                    c = "right",
                                    d;
                                return n.pageX < l && (c = "left"), o instanceof i.gcui.c1groupedfield ? (t instanceof i.gcui.c1groupedfield && (d = o.options.groupedIndex - t.options.groupedIndex, 1 === Math.abs(d) && (c = d < 0 ? "left" : "right")), c) : (d = o.options.linearIdx - t.options.linearIdx, o.options.isBand && t.options.parentIdx !== o.options.travIdx && Math.abs(n.pageX - l) < s ? "center" : (t.options.parentIdx === o.options.parentIdx && 1 === Math.abs(d) && (c = d < 0 ? "left" : "right"), c))
                            }, t
                        }();
                    t.uiDragndrop = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(e) {
                                if (!e) throw "invalid arguments";
                                this.rh = e
                            }
                            return t.prototype.format = function(t, o, n, r, a, s, l) {
                                var c = e.grid.renderState,
                                    d = e.grid.rowType,
                                    p = r.type,
                                    u, h = null;
                                0 === o && this.rh.Ge() && (n = null), p !== d.groupHeader && p !== d.groupFooter || (n = null, s && (h = s.groupInfo) && (n = this.rh.Ld("leaves")[h.leafIndex], delete s.groupInfo)), u = { $cell: t, state: a, row: r, column: n, Il: o, Jl: h ? h.purpose : void 0 }, a === c.rendering ? this.Kl(u, s, l) : (this.Ll(u, a & c.current), this.Ml(u, a & c.selected)), i.isFunction(this.rh.options.cellStyleFormatter) && this.rh.options.cellStyleFormatter(u)
                            }, t.prototype.Kl = function(t, i, o) {
                                var n = e.grid.rowType,
                                    r, a, s = t.column,
                                    l = t.row.type;
                                switch (l) {
                                    case n.header:
                                        t.$cell.addClass("gcuigridth");
                                        break;
                                    default:
                                        t.$cell.addClass("gcuigridtd")
                                }
                                if (l & n.data && s && s.textAlignment) switch (s.textAlignment.toLowerCase()) {
                                    case "left":
                                        t.$cell.addClass("gcui-align-left");
                                        break;
                                    case "right":
                                        t.$cell.addClass("gcui-align-right");
                                        break;
                                    case "center":
                                        t.$cell.addClass("gcui-align-center")
                                }
                                if (i)
                                    for (r in i)
                                        if (i.hasOwnProperty(r)) { if (a = i[r], !("colSpan" !== r && "rowSpan" !== r || a > 1)) continue; "class" === r ? t.$cell.addClass(a) : t.$cell.attr(r, a) } if (o)
                                    for (r in o)
                                        if (o.hasOwnProperty(r)) { if ("paddingLeft" === r) { t.$cell.children(".gcui-gcuigrid-innercell").css(r, o[r]); continue } t.$cell.css(r, o[r]) } if (0 === t.Il && this.rh.Ge()) t.$cell.attr({ role: "rowheader", scope: "row" }).addClass(this.rh.options.uiCSS.stateDefault + " " + this.rh.options.uiCSS.content + " gcui-gcuigrid-rowheader");
                                else switch (l) {
                                    case n.header:
                                        t.$cell.attr({ role: "columnheader", scope: "col" });
                                        break;
                                    case n.footer:
                                        t.$cell.attr({ role: "columnfooter", scope: "col" });
                                        break;
                                    default:
                                        t.$cell.attr("role", "gridcell")
                                }
                                l & n.data && t.Il >= 0 && s && (t.$cell.attr("headers", window.escape(s.headerText)), s.readOnly && t.$cell.attr("aria-readonly", !0), s.dataIndex >= 0 && t.$cell.addClass("gcui-data-type-" + e.grid.getDataType(s))), l !== n.groupHeader && l !== n.groupFooter || s && t.Jl === e.grid.groupRowCellPurpose.aggregateCell && t.$cell.addClass("gcui-data-type-" + e.grid.getDataType(s))
                            }, t.prototype.Ll = function(t, i) {
                                var o = e.grid.rowType;
                                i ? (t.$cell.addClass(this.rh.options.uiCSS.stateActive), t.row.type === o.header ? t.$cell.addClass("gcui-gcuigrid-current-headercell") : t.$cell.addClass("gcui-gcuigrid-current-cell")) : (t.$cell.removeClass(this.rh.options.uiCSS.stateActive), t.row.type === o.header ? t.$cell.removeClass("gcui-gcuigrid-current-headercell") : t.$cell.removeClass("gcui-gcuigrid-current-cell"))
                            }, t.prototype.Nl = function(e, t) {}, t.prototype.Ml = function(e, t) { t ? e.$cell.addClass(this.rh.options.uiCSS.stateHightlight).attr("aria-selected", "true") : e.$cell.removeClass(this.rh.options.uiCSS.stateHightlight).removeAttr("aria-selected") }, t
                        }();
                    t.cellStyleFormatterHelper = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(e) {
                                if (!e) throw "invalid arguments";
                                this.rh = e
                            }
                            return t.prototype.format = function(t, o, n) {
                                var r = e.grid.renderState,
                                    a = e.grid.rowType,
                                    s = t.state,
                                    l = t;
                                s === r.rendering ? this.Kl(l, o, n) : (this.Ll(l, 0 != (s & r.current)), this.Nl(l, 0 != (s & r.hovered)), this.Ml(l, 0 != (s & r.selected))), i.isFunction(this.rh.options.rowStyleFormatter) && this.rh.options.rowStyleFormatter(l)
                            }, t.prototype.Kl = function(t, o, n) {
                                var r = "gcui-gcuigrid-row " + this.rh.options.uiCSS.content,
                                    a = "gcui-gcuigrid-row " + this.rh.options.uiCSS.content,
                                    s = e.grid.rowType,
                                    l;
                                if (t.$rows.attr("role", "row"), o)
                                    for (l in o) o.hasOwnProperty(l) && ("class" === l ? t.$rows.addClass(o[l]) : (t.$rows.attr(l, o[l]), t.$rows[0].style.height && t.$rows.each(function() { return i.data(this, "customHeight", this.style.height), !0 })));
                                if (n)
                                    for (l in n) n.hasOwnProperty(l) && t.$rows.css(l, n[l]);
                                switch (t.type & ~s.dataAlt) {
                                    case s.header:
                                        r = "gcui-gcuigrid-headerrow";
                                        break;
                                    case s.data:
                                        r = a + " gcui-gcuigrid-datarow", t.type & s.dataAlt && (r += " gcui-gcuigrid-alternatingrow");
                                        break;
                                    case s.emptyDataRow:
                                        r = a + " gcui-gcuigrid-emptydatarow";
                                        break;
                                    case s.filter:
                                        r = "gcui-gcuigrid-filterrow";
                                        break;
                                    case s.groupHeader:
                                        r = a + " gcui-gcuigrid-groupheaderrow";
                                        break;
                                    case s.groupFooter:
                                        r = a + " gcui-gcuigrid-groupfooterrow";
                                        break;
                                    case s.footer:
                                        r = "gcui-gcuigrid-footerrow " + this.rh.options.uiCSS.stateHightlight;
                                        break;
                                    default:
                                        throw e.grid.stringFormat("unknown rowType: {0}", t.type)
                                }
                                t.$rows.addClass(r)
                            }, t.prototype.Ll = function(e, t) { this.rh.Ge() && (t ? i(e.$rows[0].cells[0]).addClass(this.rh.options.uiCSS.stateActive + " gcui-gcuigrid-current-rowheadercell") : i(e.$rows[0].cells[0]).removeClass(this.rh.options.uiCSS.stateActive + " gcui-gcuigrid-current-rowheadercell")) }, t.prototype.Nl = function(e, t) { t ? e.$rows.addClass(this.rh.options.uiCSS.stateHover) : e.$rows.removeClass(this.rh.options.uiCSS.stateHover) }, t.prototype.Ml = function(e, t) {}, t
                        }();
                    t.rowStyleFormatterHelper = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(e) {
                    "use strict";
                    var t = jQuery,
                        i = function() {
                            function e() { this.ii = 0, this.Ol = 0, this.Pl = 0, this.Ql = 0, this.Rl = 0, this.Sl = 0, this.Tl = 0, this.Ul = 0, this.Vl = 0 }
                            return e.prototype.add = function(e) {
                                if (null !== e && "" !== e) {
                                    var t, i = e instanceof Date ? "datetime" : typeof e;
                                    t = "" + e, 0 == this.Ql++ && (this.Wl = this.Xl = t), t < this.Wl && (this.Wl = t), t > this.Xl && (this.Xl = t), "number" === i ? (0 == this.Pl++ && (this.Tl = this.Sl = e), this.ii += e, this.Ol += e * e, e < this.Tl && (this.Tl = e), e > this.Sl && (this.Sl = e)) : "datetime" === i && (t = e.getTime(), 0 == this.Rl++ && (this.Ul = this.Vl = t), t < this.Ul && (this.Ul = t), t > this.Vl && (this.Vl = t))
                                }
                            }, e.prototype.getValueString = function(e) {
                                var t, i = e.owner;
                                if (this.Pl && ("number" === e.dataType || "currency" === e.dataType)) return t = this.Yl(e.aggregate), i.toStr(e, t);
                                if (this.Rl && "datetime" === e.dataType) switch (e.aggregate) {
                                    case "max":
                                        return i.toStr(e, new Date(this.Vl));
                                    case "min":
                                        return i.toStr(e, new Date(this.Ul));
                                    case "count":
                                        return this.Ql + ""
                                }
                                if (this.Ql) switch (e.aggregate) {
                                    case "max":
                                        return this.Xl;
                                    case "min":
                                        return this.Wl;
                                    case "count":
                                        return this.Ql + ""
                                }
                                return ""
                            }, e.prototype.Yl = function(e) {
                                switch (e) {
                                    case "average":
                                        return 0 === this.Pl ? 0 : this.ii / this.Pl;
                                    case "count":
                                        return this.Ql;
                                    case "max":
                                        return this.Sl;
                                    case "min":
                                        return this.Tl;
                                    case "sum":
                                        return this.ii;
                                    case "std":
                                        return this.Pl <= 1 ? 0 : Math.sqrt(this.Yl("var"));
                                    case "stdPop":
                                        return this.Pl <= 1 ? 0 : Math.sqrt(this.Yl("varPop"));
                                    case "var":
                                        return this.Pl <= 1 ? 0 : this.Yl("varPop") * this.Pl / (this.Pl - 1);
                                    case "vapPop":
                                        if (this.Pl <= 1) return 0;
                                        var t = this.ii / this.Pl;
                                        return this.Ol / this.Pl - t * t
                                }
                                return 0
                            }, e
                        }();
                    e.tally = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t(t) { this.Zl = "gcuigridfrozener" + e.grid.getUID(), this.$l = !1, this._l = -1, this.Xj = -1, this.Wj = -1, this.am = 0, this.bm = 0, this.Fk = !1, this.rh = t, this.refresh() }
                            return t.prototype.inProgress = function() { return this.Fk }, t.prototype.refresh = function() {
                                this.dispose(), this.cm = this.rh.outerDiv.find(".gcui-gcuigrid-fixedview"), this.dm = this.rh.Od().dk(), this.am = this.rh.Cg(!1), this.bm = this.rh.Cg(!0), this.Xj = this.rh.Ag(!1), this.Wj = this.rh.Ag(!0), this.em = this.rh.Od().getVisibleAreaBounds();
                                var t = e.grid.bounds(this.cm.find(".gcui-gcuigrid-split-area-nw")),
                                    i = e.grid.bounds(this.cm);
                                ("right" !== this.rh.options.staticColumnsAlignment || this.Xj >= 0) && this.fm(this.em, t, i), this.rh.Nd() || this.gm(this.em, t, i)
                            }, t.prototype.dispose = function() { this.hm && (this.hm.remove(), this.hm = null), this.im && (this.im.remove(), this.im = null), this.jm && (this.jm.remove(), this.jm = null), this.cm = null, this.dm = null, this.ol() }, t.prototype.fm = function(e, t, o) {
                                var n = "right" !== this.rh.options.staticColumnsAlignment,
                                    r = n ? t.width + t.left : t.left - 2,
                                    a = this;
                                r <= e.left + e.width && (this.im = i("<div><div></div></div>").addClass("gcui-grid-freezing-handle-v").addClass(n ? "" : "not-allowed").css({ left: r - o.left, top: t.top - o.top, height: e.height + e.top - t.top }).bind("mousedown", function(e) { e.data = !0, a.km.apply(a, arguments) }).appendTo(this.cm), this.im.find("div").addClass(this.rh.options.uiCSS.header).css({ width: 0, height: "100%" }))
                            }, t.prototype.gm = function(e, t, o) {
                                var n = t.top + t.height,
                                    r = "right" !== this.rh.options.staticColumnsAlignment,
                                    a = this;
                                n <= e.top + e.height && (this.hm = i("<div><div></div></div>").addClass("gcui-grid-freezing-handle-h").css({ left: r ? t.left - o.left : 0, top: n - o.top, width: r ? e.width + e.left - t.left : e.width }).bind("mousedown", function(e) { e.data = !1, a.km.apply(a, arguments) }).appendTo(this.cm), this.hm.find("div").addClass(this.rh.options.uiCSS.header).css({ width: "100%", height: 0 }))
                            }, t.prototype.km = function(e) {
                                if (this.rh.options.disabled || "right" === this.rh.options.staticColumnsAlignment && e.data) return !1;
                                this.em = this.rh.Od().getVisibleAreaBounds(), this._l = e.data ? this.Xj : this.Wj, this.jm = i('<div class="gcui-gcuigrid-resizehandle ' + this.rh.options.uiCSS.header + '"></div>').appendTo(document.body), this.rl(e.data), this.Fk = !0, e.stopPropagation()
                            }, t.prototype.Rk = function(e) { e.data && this.dm.options.hScroller.scrollValue ? this.dm.hScrollTo(0) : !e.data && this.dm.options.vScroller.scrollValue && this.dm.vScrollTo(0), this.lm(e) }, t.prototype.Uk = function(e) { try { this.jm && this.jm.remove(), this.ol(), e.data ? this._l !== this.Xj && this.rh.option("staticColumnIndex", this._l) : this._l !== this.Wj && this.rh.option("staticRowIndex", this._l) } finally { this.jm = null, this.Fk = !1 } }, t.prototype.rl = function(e) { if (!this.$l) try { i.fn.disableSelection && i(document.body).disableSelection(), this.rh.Od().toggleDOMSelection(!1), i(document).bind(this.mm("mousemove"), e, i.proxy(this.Rk, this)).bind(this.mm("mouseup"), e, i.proxy(this.Uk, this)) } finally { this.$l = !0 } }, t.prototype.ol = function() { if (this.$l) try { i.fn.enableSelection && i(document.body).enableSelection(), this.rh.Od().toggleDOMSelection(!0), i(document).unbind("." + this.Zl) } finally { this.$l = !1 } }, t.prototype.mm = function(t) { return e.grid.stringFormat("{0}.{1}", t, this.Zl) }, t.prototype.lm = function(t) {
                                var i, o, n, r, a, s, l, c, d = "right" !== this.rh.options.staticColumnsAlignment;
                                if (t.data) {
                                    if (c = e.grid.bounds(this.im),
                                        Math.abs(t.pageX - (c.left + c.width / 2)) < c.width) return void this.jm.hide();
                                    if (i = this.pl({ x: t.pageX, y: t.pageY })) {
                                        if (o = e.grid.bounds(i.element), n = o.left + o.width / 2, r = i.options.visLeavesIdx - this.bm, a = Math.max(r - 1, -1), s = t.pageX < n ? a !== this.Xj : r === this.Xj, l = s ? o.left : o.left + o.width, !e.grid.isOverAxis(l, this.em.left - 1, this.em.width + 2)) return;
                                        this._l = s ? a : r, this.jm.show().css({ left: l, top: o.top, width: 3, height: this.em.height + this.em.top - o.top })
                                    }
                                } else {
                                    if (c = e.grid.bounds(this.hm), Math.abs(t.pageY - (c.top + c.height / 2)) < c.height) return void this.jm.hide();
                                    if (i = this.nm({ x: t.pageX, y: t.pageY })) {
                                        if (o = e.grid.bounds(i), n = o.top + o.height / 2, r = this.rh.Od().getAbsoluteRowIndex(i) - this.am, a = Math.max(r - 1, -1), s = t.pageY < n ? a !== this.Wj : r === this.Wj, l = s ? o.top : o.top + o.height, !e.grid.isOverAxis(l, this.em.top - 1, this.em.height + 2)) return;
                                        this._l = s ? a : r, this.jm.show().css({ left: d ? o.left : this.em.left, top: l, width: d ? this.em.width + this.em.left - o.left : this.em.width, height: 3 })
                                    }
                                }
                            }, t.prototype.pl = function(t) {
                                var i = this.rh.columns(),
                                    o, n, r, a, s;
                                for (o = 0, n = i.length; o < n; o++)
                                    if (r = i[o], a = r.options, a.isLeaf && (s = e.grid.bounds(r.element), e.grid.isOverAxis(t.x, s.left, s.width))) return r;
                                return null
                            }, t.prototype.nm = function(t) {
                                var o = this.rh.Rd(),
                                    n, r, a, s;
                                for (n = 0, r = o.length(); n < r; n++)
                                    if (a = o.item(n)[0], s = e.grid.bounds(i(a)), e.grid.isOverAxis(t.y, s.top, s.height)) return a;
                                return null
                            }, t
                        }();
                    t.uiFrozener = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    "use strict";
                    var i = jQuery,
                        o = function() {
                            function t() {}
                            return t.generate = function i(o, n, r) {
                                switch (o) {
                                    case "append":
                                        t.om(n, r);
                                        break;
                                    case "merge":
                                        t.pm(n, r);
                                        break;
                                    case "none":
                                        break;
                                    default:
                                        throw e.grid.stringFormat('Unsupported value: "{0}"', o)
                                }
                            }, t.om = function o(n, r) {
                                var a = {};
                                e.grid.traverse(r, function(t) { t.dynamic && e.grid.validDataKey(t.dataKey) && (a[t.dataKey] = !0) }), i.each(n, function(e, i) {
                                    if ("name" in i && !a[i.name]) {
                                        var o = t.qm(i);
                                        r.push(o)
                                    }
                                })
                            }, t.pm = function o(n, r) {
                                var a = [],
                                    s;
                                e.grid.traverse(r, function(t) {
                                    if (t.isLeaf && !t.isBand) {
                                        var i = t.dataKey;
                                        e.grid.validDataKey(i) ? void 0 !== n[i] && delete n[i] : null !== i && a.push(t)
                                    }
                                }), a.length && (s = 0, i.each(n, function(e, t) {
                                    var i = a[s++];
                                    i && (i.dataKey = t.name, delete n[e])
                                })), i.each(n, function(e, i) {
                                    var o = t.qm(i);
                                    r.push(o)
                                })
                            }, t.qm = function t(i) { return e.grid.createDynamicField({ dataKey: i.name }) }, t
                        }();
                    t.columnsGenerator = o
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(e) {
                    "use strict";
                    var t = jQuery,
                        i = function() {
                            function e(e, t, i) {
                                this.rm = 0, this.Yk = 50, this.tm = !1, this.rh = e, this.um = i, this.Od = this.rh.Od(), this.vm = this.rh.bf();
                                var o = 20,
                                    n = this.rh.outerDiv.height() + this.vm * o;
                                t.height(n - i - (this.vm > 0 ? o : 0)), this.Od.Uj.sw.height(n)
                            }
                            return e.prototype.scrollTo = function(e, t) { this.wm = t, this.xm.vScrollTo(e * this.xm.options.vScroller.scrollSmallChange, !0) }, e.prototype.attach = function(e) {
                                this.ym = e, this.xm = e.data("gcui-superpanel");
                                var i, o = e.find(".gcui-superpanel-contentwrapper:first"),
                                    n = this.xm.getContentElement().height(),
                                    r = this.um + n,
                                    a = o.innerHeight(),
                                    s = 101 / (this.vm - 1) * ((r - a) / r);
                                i = this.xm.options.vScroller, i.scrollSmallChange = s, this.xm.option("vScroller", i), e.bind("superpanelscrolled.gcuigrid", t.proxy(this.zm, this)), e.bind("superpanelscrolling.gcuigrid", t.proxy(this.Am, this)), e.bind("superpanelscrolled.gcuigrid", t.proxy(this.Bm, this))
                            }, e.prototype.dispose = function() { this.ym.unbind(".gcuigrid"), this.Cm() }, e.prototype.Cm = function() { window.clearTimeout(this.rm), this.rm = 0 }, e.prototype.Am = function(e, t) { if (!this.tm && "v" === t.dir) return -1 !== this.rm && void 0 }, e.prototype.zm = function(e, i) {
                                var o, n, r = this;
                                this.tm || "v" !== i.dir || (this.rm > 0 && this.Cm(), -1 !== this.rm && (r.rm = -1, o = Math.round(i.newValue / r.xm.options.vScroller.scrollSmallChange), n = r.Od.dj.start, o < 0 && (o = 0), o >= r.vm && (o = r.vm - 1), o !== n ? r.rh.Wf(o, t.proxy(r.Dm, r)) : (r.Em(), r.Cm())))
                            }, e.prototype.Dm = function(e) { this.rh.Hg(e), this.Em(), this.wm && (this.wm(), this.wm = null), this.Cm() }, e.prototype.Bm = function() { t.isFunction(this.Fm) && this.Fm.apply(this, arguments) }, e.prototype.Em = function() {}, e
                        }();
                    e.uiVirtualScroller = i
                }(e.grid || (e.grid = {}));
                var t = e.grid
            }(gcui || (gcui = {})),
            function(e) {
                ! function(e) {
                    var t = jQuery,
                        i = Globalize;

                    function o(i, o, n, r) {
                        var a = i;
                        r = t.extend({ nullString: "", format: "" }, r);

                        function s(t) { return r.parser = r.parser || e.defaultParsers[t], r.parser || null == i || e.errors.noParser(t), r.parser }
                        if (o = o || null != i && typeof i, !(n = n || o)) return i;
                        if ("string" == n) return s(o), r.parser ? r.parser.toStr(i, r.culture, r.format, r.nullString, !0) : i;
                        if (s(n), !r.parser) return i;
                        if (i = r.parser.parse(i, r.culture, r.format, r.nullString, !0), isNaN(i) && null != i && e.util.isNumeric(i)) {
                            if (r.ignoreError) return a;
                            e.errors.cantConvert(n, a)
                        }
                        return i
                    }
                    e.convert = o, e.defaultParsers = {
                        string: {
                            parse: function(e, t, i, o, n) {
                                switch (e) {
                                    case null:
                                        return null;
                                    case o:
                                        if (n) return null;
                                    case void 0:
                                    case "&nbsp":
                                        return "";
                                    default:
                                        return "" + e
                                }
                            },
                            toStr: function(e, t, i, o, n) { return null === e && n ? o : "" + e }
                        },
                        number: { parse: function(e, t, o, n, r) { var a = typeof e; return "number" === a ? isNaN(e) ? NaN : e : !e && 0 !== e || "&nbsp;" === e || e === n && r ? null : i.parseFloat(e, 10, t.name) }, toStr: function(e, t, o, n, r) { return null === e && r ? n : i.format(e, o || "n", t.name) } },
                        currency: { parse: function(e, t, o, n, r) { var a = typeof e; return "number" === a ? isNaN(e) ? NaN : e : !e && 0 !== e || "&nbsp;" === e || e === n && r ? null : ("string" === a && (e = e.replace(t.numberFormat.currency.symbol, "")), i.parseFloat(e, 10, t.name)) }, toStr: function(e, t, o, n, r) { return null === e && r ? n : i.format(e, o || "c", t.name) } },
                        datetime: { parse: function(e, t, o, n, r) { var a, s; return e instanceof Date ? e : !e || "&nbsp;" === e || e === n && r ? null : (a = /^\/Date\((\d+)\)\/$/.exec(e)) ? new Date(parseInt(a[1], 10)) : (s = i.parseDate(e, o, t.name), (null == s || isNaN(s)) && (s = Date.parse(e), s = isNaN(s) ? NaN : new Date(s)), s) }, toStr: function(e, t, o, n, r) { return null === e && r ? n : i.format(e, o || "d", t.name) } },
                        boolean: {
                            parse: function(e, i, o, n, r) {
                                var a = typeof e;
                                if ("number" === a) return 0 != e;
                                if ("boolean" === a) return e;
                                if ("string" === a && (e = t.trim(e)), !e || "&nbsp;" === e || e === n && r) return null;
                                switch (e.toLowerCase()) {
                                    case "true":
                                        return !0;
                                    case "false":
                                        return !1
                                }
                                return NaN
                            },
                            toStr: function(e, t, i, o, n) { return null === e && n ? o : e ? "true" : "false" }
                        }
                    };

                    function n(t) { return function() { return i || e.util.logError(e.errors.noGlobalize.create().message), t.apply(this, arguments) } } t.each(e.defaultParsers, function(e, t) { t.parse = t.parse && n(t.parse), t.toStr = t.toStr && n(t.toStr) })
                }(e.data || (e.data = {}))
            }(gcui || (gcui = {})),
            function(e) {
                ! function(e) {
                    ! function(t) {
                        ! function(i) {
                            i.Connective = { AND: "and", OR: "or" };

                            function o(o) {
                                function n(o) {
                                    var r, a = [];
                                    return 0 === o.length ? a : (r = i.Connective.AND, e.util.each(o, function(o, s) {
                                        var l, c;
                                        if (0 == o && e.util.isString(s) && ((l = s.toLowerCase()) == i.Connective.AND || l == i.Connective.OR)) return void(r = l);
                                        if ($.isArray(s)) { if (!(s = n(s))) return; if (s[0] === r || 2 == s.length) return s.shift(), void(a = a.concat(s)) } else {
                                            if (!(c = t.normalizeCondition(s))) return;
                                            c.property = s.property, s = c
                                        }
                                        a.push(s)
                                    }), 0 == a.length ? null : (a.unshift(r), a))
                                }
                                return n(o)
                            }

                            function n(t) {
                                if (!$.isArray(t)) return null;
                                var n = { original: t, normalized: o(t), func: null };
                                return null == n.normalized ? n.func = function(e) { return !0 } : n.func = function(t) {
                                    function o(n) {
                                        var r = n[0] === i.Connective.AND,
                                            a = r ? e.util.every : e.util.some;
                                        return a(n, function(i, n) { if (0 === n) return r; if ($.isArray(i)) return o(i); var a = e.util.getProperty(t, i.property); return i.op.apply(a, i.value) })
                                    }
                                    return o(n.normalized)
                                }, n
                            }

                            function r(t) { return n(t) || e.filtering.compile(t) } i.compile = r
                        }(t.extended || (t.extended = {}));
                        var i = t.extended
                    }(e.filtering || (e.filtering = {}))
                }(e.data || (e.data = {}))
            }(gcui || (gcui = {})),
            function(e) {
                ! function(t) {
                    var i = jQuery,
                        o = e.data,
                        n = o.filtering.extended,
                        r = function() {
                            function e(e) { this.real = e, this.Gm = !1, this.Hm(), this.Im() }
                            return e.prototype.Hm = function() {
                                var e = this;
                                this.filter = o.observable(this.real.filter()), this.filter.subscribe(function(t) { e.real.filter() === t || e.Gm || e.refresh({ filter: t }) }), this.real.filter.subscribe(function(t) { t !== e.Jm && e.filter(t) })
                            }, e.prototype.refresh = function(e, t) {
                                void 0 === t && (t = !1), e = i.extend({}, e);
                                var o = e.filter;
                                e.filter = this.Km(e.filter), this.Jm = e.filter, this.Gm = !0;
                                try { i.isFunction(e.filter) && !i.isFunction(o) ? this.filter(o) : this.filter(e.filter) } finally { this.Gm = !1 }
                                return this.real.refresh(e, t)
                            }, e.prototype.Im = function() {
                                var e = this;
                                o.util.each(this.real, function(t, o) { i.isFunction(o) && !e[t] && "_" !== t.charAt(0) && (e[t] = i.isFunction(o.subscribe) ? o : function() { return o.apply(e.real, arguments) }) })
                            }, e.create = function t(i) { return new e(i) }, e.prototype.Lm = function(e) {
                                var t = [];
                                return i.each(e, function(e, r) {
                                    var a, s;
                                    if (i.isArray(r)) { if ((a = o.util.isString(r[0]) && r[0].toLowerCase()) === n.Connective.AND || a === n.Connective.OR) return void t.push(r) } else r = [r];
                                    s = [], i.each(r, function(t, i) {
                                        var n = o.filtering.normalizeCondition(i);
                                        n && (n.property = e, s.push(n))
                                    }), s.length > 0 && t.push(s)
                                }), t.length > 0 ? t : null
                            }, e.prototype.Km = function(e) { var t, r; return i.isArray(e) ? n.compile(e).func : i.isPlainObject(e) ? (e = i.extend(!0, {}, e), t = {}, i.each(e, function(n, r) { if (i.isArray(r) || (r = [r]), t) { var a = o.util.isString(r[0]) && r[0].toLowerCase(); if (1 == r.length || 2 == r.length && ("and" === a || "or" === a)) return void(t[n] = r[r.length - 1]) } e[n] = r, t = null }), t || (r = this.Lm(e), n.compile(r).func)) : e }, e.prototype.di = function(e, t) { this.real.sourceArray[e] = t, this.real.local[e] = t }, e.prototype.nf = function(e, t, i) { 2 === arguments.length ? (this.real.sourceArray.splice(e, t), this.real.local.splice(e, t)) : (this.real.sourceArray.splice(e, t, i), this.real.local.splice(e, t, i)) }, e.prototype.pf = function(e) { this.real.sourceArray.push(e), this.real.local.push(e) }, e
                        }();
                    t.GridDataView = r
                }(e.grid || (e.grid = {}))
            }(gcui || (gcui = {})),

            function(e) {
                ! function(t) {
                    "use strict";
                    var i, o = jQuery,
                        n = "gcuiribbon",
                        r = "gcui-ribbon",
                        a = r + "-disabled",
                        s = r + "-bigbutton",
                        l = r + "-panel",
                        c = r + "-groups",
                        d = r + "-group",
                        p = d + "-content",
                        u = d + "-label",
                        h = r + "-dropdown",
                        f = r + "-dropdowngroup",
                        g = r + "-abbrev",
                        m = g + "group",
                        b = r + "-text",
                        v = r + "-icon",
                        y = r + "-abbrevicon",
                        w = function(e) {
                            __extends(t, e);

                            function t() { e.apply(this, arguments) }
                            return t.prototype._create = function() {
                                var e = this;
                                window.applyTouchUtilEvents && (o = window.applyTouchUtilEvents(o)), e.Mm(), o(window).bind("resize." + this.widgetName, function() { e.updateRibbonSize() }), e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() { e.updateRibbonSize(), e.options.disabled && e.Nm(!0), e.element.removeVisibilityObserver && e.element.removeVisibilityObserver() }, "gcuiribbon"), e.options.disabled && e.Nm(!0)
                            }, t.prototype._setOption = function(e, t) { o.gcui.widget.prototype._setOption.apply(this, arguments), "disabled" === e && this.Nm(t), o(".gcui-ribbon-startmenulink", this.element).unbind("click.tabs") }, t.prototype.Nm = function(e) {
                                var t = this,
                                    i = t.element,
                                    n = i.offset(),
                                    r = n.top,
                                    s = n.left,
                                    l = o("body"),
                                    c = this.options.uiCSS,
                                    d = t.disabledModal;
                                i.data("gcuiUITabs") && i.gcuitabs("option", "disabled", e), 0 !== i.closest(".gcui-editor").length && (r = 0, s = 0, l = i.parent()), e ? (d || (d = o("<div></div>").addClass(c.stateDisabled + " " + a).css({ top: r, left: s, "background-color": "lightgray", position: "absolute" }).appendTo(l).bind("click mousedown mouseup mouseover mouseout focus keydown keypress", function(e) { return e.stopPropagation(), e.preventDefault(), !1 }), t.disabledModal = d), t.disabledModal.width(i.width()).height(i.outerHeight()).show()) : t.disabledModal && t.disabledModal.hide()
                            }, t.prototype.Om = function() {
                                var e = this,
                                    t;
                                o.each(o("[customtype]", e.element), function(i, n) {
                                    (t = o(n).attr("customtype")) && e.options.custombuttons[t] && e.options.custombuttons[t].create(o(n))
                                })
                            }, t.prototype.Mm = function() {
                                var e = this,
                                    t = this.options.uiCSS;
                                e.buttons = {}, e.listUis = {}, e.accessbarBtns = {}, e.Om(), e.Pm(), e.Qm(), e.Rm(), e.Sm(), e.Tm(), e.Um(), e.Vm(), e.Wm(), e.Xm(), e.Ym(), o("." + t.helperReset + ":not(." + c + ", ." + t.tabsNav + ", .gcui-menu-list)", e.element).hover(function() { o(this).addClass(t.stateHover) }, function() { o(this).removeClass(t.stateHover) }), o("." + t.button, e.element).bind("mouseenter", function() { o("." + t.buttonText, this).addClass(t.stateHover) }).bind("mouseleave", function() { o("." + t.buttonText, this).removeClass(t.stateHover) }), o("button." + t.button, e.element).bind("mousedown", function() { e.Zm(this) }).bind("mouseup", function() { e.Zm(this) }), o("label." + t.button, e.element).bind("click", function() { o("span", this) && 1 === o("span", this).length && e.$m(this) })
                            }, t.prototype.Zm = function(e) {
                                var t = this.options.uiCSS;
                                e && (o(e).hasClass(t.stateActive) ? o("." + t.buttonText, e).addClass(t.stateActive) : o("." + t.buttonText, e).removeClass(t.stateActive))
                            }, t.prototype.$m = function(e) {
                                var t = this,
                                    i, n, r;
                                e && (n = o(e).attr("for"), i = o("#" + n, t.element), i.is(":checkbox") ? t.Zm(e) : i.is(":radio") && (r = t.element.find("[name='" + i.attr("name") + "']"), o.each(r, function() { t._m(this) })))
                            }, t.prototype._m = function(e) {
                                var t, i = this.options.uiCSS;
                                e && (t = o("[for='" + o(e).attr("id") + "']", o(e).parent())) && (t.hasClass(i.stateActive) ? t.children("." + i.buttonText).addClass(i.stateActive) : t.children("." + i.buttonText).removeClass(i.stateActive))
                            }, t.prototype.Qm = function() {
                                var e = this,
                                    t;
                                e.groups = [], e.splits = [], e.dropdowns = [], e.inputDropdowns = [], o("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text", e.element).each(function(i, n) { if (!o(n).parents("[customtype]") || 0 === o(n).parents("[customtype]").length) return t = o(n).parent(), 0 !== o(">ul", t).length || t.hasClass("gcui-ribbon-accesstoolbar") ? 2 === o(">button", t).length ? e.splits.push(t) : 1 === o(">button", t).length ? e.dropdowns.push(t) : 1 === o(">input[type='text']", t).length && e.inputDropdowns.push(t) : e.groups.push(t), this }), e.groups = e.an(e.groups), e.splits = e.an(e.splits)
                            }, t.prototype.an = function(e) { var t = o.makeArray(o.map(e, function(e) { return e.get(0) })); return o.map(o.unique(t), function(e) { return o(e) }) }, t.prototype.Rm = function() {
                                var e = this,
                                    t = e.element;
                                o(":checkbox", t).each(function() { if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length) return e.bn(o(this), "checkbox"), o(this).bind("change", function() { e.$m(o(this).button("widget")[0]) }), this }), o(":radio", t).each(function() { if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length) return e.bn(o(this), "radio"), o(this).bind("change", function() { e.$m(o(this).button("widget")[0]) }), this }), o("button", t).each(function() { if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length) return e.bn(o(this), "button"), this })
                            }, t.prototype.bn = function(e, t) {
                                var i = this,
                                    n = this.options.uiCSS,
                                    r = i.cn(e, t),
                                    a = e.data("commandName"),
                                    s;
                                e.button(r), r.text || ("button" === t ? e.children("." + n.buttonText).text(a) : (s = o("[for='" + e.attr("id") + "']", e.parent())) && s.children("." + n.buttonText).text(a)), e.parent().is(".gcui-ribbon-accesstoolbar") && "true" === e.attr("canlocateonaccesstoolbar") && e.button("widget").hide(), i.dn(e)
                            }, t.prototype.Sm = function() { o.each(this.groups, function(e, t) { t.buttonset() }) }, t.prototype.Tm = function() {
                                var e = this,
                                    t = this.options.uiCSS;
                                o.each(e.splits, function(i, n) {
                                    var a = n.children("ul"),
                                        s = n.children("button:eq(0)"),
                                        l = s.data("commandName"),
                                        c = n.children("button:eq(1)"),
                                        d;
                                    a.children("li").addClass(t.cornerAll), n.addClass(r + "-" + l), c.button({ icons: { primary: t.iconArrowDown }, text: !1 }).data("list", a).unbind("click").bind("click", function(e) { e.stopPropagation(), e.preventDefault() }).bind("mouseup", function(t) { a = o(this).data("list"), a.is(":visible") ? (e.showList.hide().css("z-index", ""), e.showList = null) : (a.show().position({ my: "left top", at: "left bottom", of: n }).css("z-index", 9999), e.showList = a), t.stopPropagation(), t.preventDefault() }), c.children("." + t.buttonText).text("foo"), n.after(a), a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(), n.buttonset(), d = { ui: s, defaultValue: s.button("option", "label"), buttons: [], type: "split", trigger: c, list: a }, o("button, :checkbox, :radio", a).bind("click", function(t) { a.hide().css("z-index", ""), e.showList = null, t.preventDefault() }), a.find(">li>button,>li>:radio,>li>:checkbox").each(function(t, i) { var n = o(i).data("commandName"); "" !== n && e.buttons[n] && (e.buttons[n].parent = s, e.buttons[n].type = "split"), d.buttons.push(o(i)) }), "" !== l && (e.listUis[l] = d)
                                })
                            }, t.prototype.Um = function() {
                                var e = this,
                                    t = this.options.uiCSS,
                                    i, n;
                                e.dropdownLabels = {}, o.each(e.dropdowns, function(i, n) {
                                    var a = n.children("ul"),
                                        s = n.children("button:eq(0)"),
                                        l = s.data("commandName"),
                                        c;
                                    a.children("li").addClass(t.cornerAll), n.addClass(r + "-" + l), s.button({ icons: { secondary: t.iconArrowDown } }).unbind("click").bind("click", function(e) { e.stopPropagation(), e.preventDefault() }).bind("mouseup", function(t) { e.gn(a, s), t.stopPropagation(), t.preventDefault() }).bind("keydown", function(t) { a.is(":visible") && e.hn(t, a, s) }), c = { ui: s, defaultValue: s.button("option", "label"), buttons: [], type: "dropdown", list: a }, o("button, :checkbox, :radio", a).bind("click", function(i) {
                                        var n = o(this).data("commandName"),
                                            r, l = s.children("." + t.buttonText).width();
                                        e.dropdownLabels[n] || (e.dropdownLabels[n] = e.in(o(this).button("option", "label"), s.children("." + t.buttonText), l)), r = e.dropdownLabels[n], s.button("option", "label", r), s.attr("title", o(this).button("option", "label")), a.hide().css("z-index", ""), e.showList = null, i.preventDefault()
                                    }), a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(), n.buttonset(), e.jn(a, s, c, l)
                                })
                            }, t.prototype.Vm = function() {
                                var e = this,
                                    t = this.options.uiCSS;
                                e.dropdownLabels = {}, o.each(e.inputDropdowns, function(i, n) {
                                    var a = n.children("ul"),
                                        s = n.children("input[type='text']:eq(0)"),
                                        l = e.kn(s),
                                        c = s.prop("name"),
                                        d;
                                    n.prepend(l), a.children("li").addClass(t.cornerAll), n.addClass(r + "-" + c), s.removeProp("name").data("commandName", c).addClass(t.stateDefault + " " + t.content + " " + t.cornerLeft), l.find("a").bind("mouseup", function(t) { e.gn(a, s), s.focus(), t.stopPropagation(), t.preventDefault() }).bind("keydown", function(t) { e.hn(t, a, l) }), e.ln(s, a), d = { ui: s, defaultValue: s.val(), buttons: [], type: "dropdown", list: a }, o("button, :checkbox, :radio", a).bind("click", function(t) {
                                        var i = o(this).data("commandName"),
                                            n;
                                        e.dropdownLabels[i] || (e.dropdownLabels[i] = o(this).button("option", "label")), n = e.dropdownLabels[i], s.val(o(this).button("option", "label")).attr("title", o(this).button("option", "label")), a.hide().css("z-index", ""), e.showList = null, t.preventDefault(), t.stopPropagation()
                                    }), a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(), e.jn(a, s, d, c)
                                })
                            }, t.prototype.jn = function(e, t, i, n) {
                                var r = this;
                                e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e, n) { var a = o(n).data("commandName"); "" !== a && r.buttons[a] && (r.buttons[a].parent = t, r.buttons[a].type = "dropdown"), i.buttons.push(o(n)) }), "" !== n && (r.listUis[n] = i)
                            }, t.prototype.gn = function(e, t) {
                                var i = this;
                                e.is(":visible") && !e.find("li." + i.options.uiCSS.stateActive) ? (i.showList.hide().css("z-index", ""), i.showList = null) : (i.showList && (i.showList.hide(), i.showList = null), e.show().position({ my: "left top", at: "left bottom", of: t }).css("z-index", 9999), i.showList = e, i.isShow = !0, o("#measureWidth")[0].className.indexOf("update-width") < 0 && e.css("width", o.gcui.getTextAutoWidth(e)))
                            }, t.prototype.ln = function(e, t) {
                                var i = this,
                                    o, n;
                                e.bind("change", function(t) {
                                    var o = { name: void 0, commandName: void 0 };
                                    o.name = e.prop("name"), o.commandName = e.val(), i._trigger("click", t, o)
                                }).bind("keydown", function(o) { i.hn(o, t, e) })
                            }, t.prototype.hn = function(e, t, i) {
                                var o = this,
                                    n = e.keyCode,
                                    r = o.mn();
                                switch (n) {
                                    case r.UP:
                                        o.nn(!1, t, i), e.preventDefault();
                                        break;
                                    case r.DOWN:
                                        o.nn(!0, t, i), e.preventDefault();
                                        break;
                                    case r.ENTER:
                                        t.find("label." + o.options.uiCSS.stateActive).parent("li").find("input").trigger("click"), e.preventDefault()
                                }
                            }, t.prototype.nn = function(e, t, i) {
                                var n = this,
                                    r = t.find("li").length,
                                    a, s;
                                if (!t.is(":visible")) return void n.gn(t, i);
                                s = t.find("label." + n.options.uiCSS.stateActive).parent("li"), s && s.length > 0 && (a = t.find("li").index(s)), n.pn(s, !1), void 0 === a ? a = 0 : e ? ++a == r && (a = void 0) : -1 == --a && (a = r - 1), n.pn(o(t.find("li")[a]), !0)
                            }, t.prototype.pn = function(e, t) {
                                var i = this.options.uiCSS;
                                e && (t ? (o("label", e).addClass(i.stateActive), o("span", e).addClass(i.stateActive)) : (o("label", e).removeClass(i.stateActive), o("span", e).removeClass(i.stateActive)))
                            }, t.prototype.Wm = function() {
                                var e = this,
                                    t = e.options.uiCSS;
                                o(".gcui-ribbon-gallery", e.element).each(function(i, n) {
                                    o(n).children("div").each(function(i, n) {
                                        o(n).bind("mouseenter", function(e) { o(n).hasClass(t.stateDisabled) || o(n).addClass(t.stateHover) }).bind("mouseleave", function(e) { o(n).hasClass(t.stateDisabled) || o(n).removeClass(t.stateHover) }).bind("click", function(i) {
                                            if (!o(n).hasClass(t.stateDisabled)) {
                                                o(n).parent("div.gcui-ribbon-gallery").children("div").removeClass(t.stateActive), o(n).addClass(t.stateActive);
                                                var r = { name: void 0, commandName: void 0 };
                                                r.name = o(n).parent("div.gcui-ribbon-gallery").attr("name"), r.commandName = o(n).attr("name"), e._trigger("click", i, r)
                                            }
                                        }), e.buttons[o(n).attr("name")] = { button: o(n), type: "galleryBtn" }
                                    })
                                })
                            }, t.prototype.mn = function() { if (o.ui && o.ui.keyCode) return o.ui.keyCode; if (o.mobile && o.mobile.keyCode) return o.mobile.keyCode; throw "keyCode object is not found" }, t.prototype.kn = function(e) {
                                var t = this.options.uiCSS,
                                    i = o("<span class='gcui-ribbon-inputdropdownwrapper'></span>").append(e);
                                return o("<a></a>").appendTo(i).button({ icons: { primary: t.iconArrowDown }, text: !1 }).removeClass(t.cornerAll).addClass("gcui-ribbon-inputdropdownbtn " + t.cornerRight), i
                            }, t.prototype.Ym = function() {
                                var e = this,
                                    t = this.options.uiCSS,
                                    i = e.element;
                                return i.addClass(r), e.tabEle = i, o(">ul", i).length > 0 ? (i.gcuitabs({ select: function(t, i) { e.qn() } }), e.rn(), o(".gcui-ribbon-startmenu") && o(".gcui-ribbon-startmenu").length > 0 && (i.gcuitabs("option", "selected", 1), e.tn()), !0) : (i.addClass(r + "-simple").addClass(t.stateDefault).addClass(t.helperClearFix), !1)
                            }, t.prototype.Pm = function() {
                                var e = this,
                                    t, i = o("<div class='gcui-ribbon-accesstoolbar'></div>"),
                                    n;
                                0 === o("*[canlocateonaccesstoolbar='true']", e.element).length && 0 === o("*[locateonaccesstoolbar='true']", e.element).length || (o("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']", e.element).each(function() {
                                    t = o(this).attr("id") + "_accessbar";
                                    var i = o("label[for=" + o(this).attr("id") + "]");
                                    e.accessbarBtns[i.attr("title")] = { button: o(this).clone().attr("id", t), type: o(this).attr("type"), labelEle: i.clone().attr("for", t), selected: "true" === o(this).attr("locateonaccesstoolbar") }
                                }), o("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']", e.element).each(function() { t = o(this).attr("id") + "_accessbar", e.accessbarBtns[o(this).attr("title")] = { button: o(this).clone(), type: "button", selected: "true" === o(this).attr("locateonaccesstoolbar") } }), o.each(e.accessbarBtns, function(e, t) { i.append(t.button), t.labelEle && i.append(t.labelEle) }), n = o('<button title="Customize Access Toolbar" class ="gcui-ribbon-accesstoolbarbtn ' + e.options.uiCSS.iconArrowDown + '" name="quicktoolbar"></button>'), i.append(n), e.accessbarBtns && e.element.prepend(i), e.un(n, i))
                            }, t.prototype.un = function(e, t) {
                                var i = this,
                                    n, r, a = i.options.uiCSS,
                                    s = o('<ul class="gcui-ribbon-accesstoolbarmenu"></ul>');
                                o.each(i.accessbarBtns, function(e, t) { r = t.selected ? " gcui-ribbon-accesstoolbarmenuitemchecked" : " gcui-ribbon-accesstoolbarmenuitemunchecked", n = o('<li><a class="' + a.cornerAll + '" tabindex="-1"><span class="' + a.icon + r + '"></span><span class="gcui-menu-text">' + e + "</span></a></li>"), n.data("accessbarcommand", e), s.append(n) }), s.prepend("<li class='gcui-ribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"), t.append(s), s.gcuimenu({
                                    trigger: e,
                                    triggerEvent: "click",
                                    orientation: "vertical",
                                    select: function(e, t) {
                                        var n = t.item,
                                            r = n.element.data("accessbarcommand"),
                                            l = o("span." + a.icon, n.element),
                                            c = i.accessbarBtns[r].button,
                                            d = c.button("widget");
                                        l.hasClass("gcui-ribbon-accesstoolbarmenuitemchecked") ? (l.removeClass("gcui-ribbon-accesstoolbarmenuitemchecked").addClass("gcui-ribbon-accesstoolbarmenuitemunchecked"), d.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar", "true")) : (l.addClass("gcui-ribbon-accesstoolbarmenuitemchecked").removeClass("gcui-ribbon-accesstoolbarmenuitemunchecked"), d.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar", "true")), s.gcuimenu("deactivate", null)
                                    }
                                }), s.gcuimenu("setItemDisabled", o(".gcui-ribbon-accesstoolbarmenutitleitem"), !0)
                            },
                             t.prototype.updateRibbonSize = function() {
                                   var e = this,
                                    t, i = this.options.uiCSS,
                                    n;
                                    console.log('table', e)
                               // if( e.tabEle?.children !== undefined )
                                e.tabEle?.children("div").not(".gcui-menu").each(function(a, s) {
                                    var l = o(s),
                                        c = l.is(":visible"),
                                        d = l.find(">ul>li:not(.gcui-menu-item)"),
                                        p = [],
                                        u = l.width();
                                    return c || (l.removeClass(i.tabsHide), u = l.width()), d.each(function(i, a) {
                                        var s = o(a),
                                            l = s.find(">div:last"),
                                            c = e.vn(l);
                                        return t = s.children("." + f), n = s.children("." + m), t && (s.addClass(r + "-" + o.gcui.replaceClassName(c.toLowerCase())).prepend(t.children()), t.remove(), n && n.remove()), p.push({ width: s.outerWidth(!0), contentWidth: s.width(), height: s.outerHeight(!0), text: c }), this
                                    }), e.wn(d, p, u), c || l.addClass(i.tabsHide), this
                                }), e.options.disabled && e.Nm(!0)
                            }, t.prototype.rn = function() {
                                var e = this,
                                    t = this.options.uiCSS;
                               // if( e.tabEle?.children !== undefined )
                                e.tabEle?.children("div").each(function(i, n) {
                                    var a = o(n),
                                        s = a.is(":visible"),
                                        h = a.find(">ul:not(.gcui-ribbon-accesstoolbarmenu)>li"),
                                        f = [],
                                        g;
                                    return a.data("destroy.tabs") ? void a.remove() : (s || a.removeClass(t.tabsHide), g = a.width(), a.addClass(l), a.hasClass(t.tabsPanel) || (a.addClass("gcui-ribbon-accesstoolbar"), e.tabEle.prepend(a)), a.find(">ul").addClass(t.helperReset + " " + t.helperClearFix + " " + t.content + " " + t.cornerAll + " " + c), h.each(function(i, n) {
                                        var a = o(n),
                                            s = a.find(">div:last"),
                                            l = s.find("span"),
                                            c = t.stateDefault + " " + d,
                                            h = e.vn(s);
                                        return s && (c += " " + r + "-" + o.gcui.replaceClassName(h.toLowerCase())), a.addClass(c), s.addClass(u).bind("click", function() { return !1 }), a.wrapInner("<div class = '" + p + "'></div>"), a.children().bind("mouseover", function() { o(this).addClass(t.stateHover) }).bind("mouseout", function() { o(this).removeClass(t.stateHover) }), s.appendTo(a), f.push({ width: a.outerWidth(!0), text: h }), this
                                    }), e.xn = f, e.wn(h, f, g), s || a.addClass(t.tabsHide), this)
                                })
                            }, t.prototype.tn = function() {
                                var e = this,
                                    t = o(".gcui-ribbon-startmenulink", e.element),
                                    i = e.options.uiCSS;
                                t.unbind("click"), t.parent("li").addClass("gcui-ribbon-startmenulinkcontainer").hover(function() { o(this).removeClass("gcui-ribbon-startmenulinkcontainer") }, function() { o(this).addClass("gcui-ribbon-startmenulinkcontainer") }), o(".gcui-ribbon-startmenuindicator", e.element).addClass(i.icon + " " + i.iconArrowDown), o(".gcui-ribbon-startmenu", e.element).gcuimenu({
                                    trigger: o(".gcui-ribbon-startmenulink", e.element).parent(),
                                    triggerEvent: "click",
                                    orientation: "vertical",
                                    select: function(t, i) {
                                        var o = { name: void 0, commandName: void 0 };
                                        o.commandName = i.item.yn.attr("name"), e._trigger("click", t, o)
                                    },
                                    hidden: function(e, t) { t.activeItem && t.activeItem.yn.removeClass(i.stateFocus) }
                                })
                            }, t.prototype.vn = function(e) { var t, i; return e && (t = e.find("span"), i = e.attr("displayname") ? e.attr("displayname") : t && t.length > 0 && !e.hasClass(m) ? o(t[0]).text() : o.trim(e.text())), i }, t.prototype.wn = function(e, t, i) {
                                for (var n = this, a = e.length - 1, s = 0, l = 0, c = 0, d, p, u; a >= 0; a--) {
                                    for (c = 0, s = 0; s < a; s++) c += t[s].width;
                                    c + l + t[a].width <= i ? (d = o(e[a]).children("." + f), p = o(e[a]).children("." + m), d && (o(e[a]).addClass(r + "-" + t[a].text.toLowerCase()).prepend(d.children()), d.remove(), p && p.remove())) : (u = t[a], l += n.zn(u, e[a], i))
                                }
                            }, t.prototype.zn = function(e, t, i) {
                                var n = this,
                                    a = e.text,
                                    s = r + "-" + o.gcui.replaceClassName(a.toLowerCase()),
                                    l = this.options.uiCSS,
                                    c = o(t).removeClass(s),
                                    p = n.vn(c.find(">div:last")) || a,
                                    u;
                                return c.wrapInner("<div class='" + f + " " + d + "'></div>").children().hide().addClass(s).bind("mouseup." + n.widget, function(e) { null !== n.showDrpDwnGroup && (n.showDrpDwnGroup.hide().css("z-index", ""), n.showDrpDwnGroup = null) }), u = o("<div class='" + m + "'><span class='" + g + o.gcui.replaceClassName(p.toLowerCase()) + " " + v + " " + y + "'></span><span class='" + b + "'>" + p + "</span><span class='" + l.icon + " " + l.iconArrowDown + " " + v + "'></span></div>").appendTo(c).unbind(n.widget).bind("mouseover." + n.widget, function(e) { o(this).addClass(l.stateHover) }).bind("mouseout." + n.widget, function(e) { o(this).removeClass(l.stateHover) }).bind("click." + n.widget, function(t) {
                                    var i, r, a = o(this).siblings("." + f);
                                    a.is(":visible") ? (a.hide().css("z-index", ""), n.showDrpDwnGroup = null) : (n.showDrpDwnGroup && n.showDrpDwnGroup.hide().css("z-index", ""), i = e.contentWidth + 1, r = e.height, a.css({ width: i, height: r }), a.show().position({ my: "left top", at: "left bottom", of: this }).css("z-index", "10000"), n.showDrpDwnGroup = a, t.stopPropagation())
                                }), c.outerWidth(!0)
                            }, t.prototype.Xm = function() {
                                var e = this;
                                o(document).bind("mouseup", function(t) {
                                    var i = t.target;
                                    e.showList && (o(i).is(document) || i !== e.showList.get(0) && !o.contains(e.showList.get(0), i)) && (e.showList.hide().css("z-index", ""), e.showList = null), e.showDrpDwnGroup && (!o(i).is(document) && o.contains(e.showDrpDwnGroup.get(0), i) || (e.showDrpDwnGroup.hide().css("z-index", ""), e.showDrpDwnGroup = null))
                                })
                            }, t.prototype.cn = function(e, t) {
                                var i = !0,
                                    n = this,
                                    r = e.attr("class"),
                                    a, l, c, d, p, u, h;
                                if (r && "" !== r && r !== s) l = r.split(" ")[0], e.removeClass(l), "" === (p = o.trim(e.text())) && (i = !1);
                                else {
                                    if ("checkbox" === t || "radio" === t) {
                                        if ("" === o.trim(e.attr("id"))) return;
                                        if (u = o("[for='" + e.attr("id") + "']", e.parent()), !u.is("label")) return;
                                        r = u.attr("class"), r && "" !== r && r !== s ? (l = r.split(" ")[0], u.removeClass(l), "" === (p = o.trim(u.text())) && (i = !1)) : a = u.children("span,div")
                                    } else "button" === t && (a = e.children("span,div"));
                                    a && (1 === a.length ? "" !== a.eq(0).attr("class") && (c = a.eq(0), l = c.attr("class"), i = !1) : 2 === a.length ? a.eq(0).attr("class") && (c = a.eq(0), l = c.attr("class"), c.is("span") ? d = "left" : c.is("div") && (d = "top"), p = a.eq(1).text()) : "button" === t && "" !== o.trim(e.text()) && (p = o.trim(e.text())))
                                }
                                return "button" === t ? (e.empty(), "" !== (h = o.trim(e.attr("name"))) && e.removeAttr("name")) : "" !== (h = o.trim(u.attr("name"))) && u.removeAttr("name"), "" !== h && (e.data("commandName", h), n.buttons[h] || (n.buttons[h] = { button: void 0, accessToolbarButton: void 0 }), e.parent().is(".gcui-ribbon-accesstoolbar") ? n.buttons[h].accessToolbarButton = e : n.buttons[h].button = e), { label: p, icons: { primary: l }, position: d, text: i }
                            }, t.prototype.dn = function(e) {
                                var t = this,
                                    i, n, r = t.options.uiCSS;
                                e.bind("click", function(a) {
                                    if (t.options.disabled) return a.preventDefault(), void a.stopPropagation();
                                    t.qn();
                                    var s = !0,
                                        l = e.data("commandName"),
                                        c = t.buttons[l],
                                        d = { name: void 0, commandName: void 0 };
                                    c && c.parent && (d.name = c.parent.data("commandName")), d.commandName = l, t._trigger("click", a, d), i = e.parent().is(".gcui-ribbon-accesstoolbar") ? t.buttons[l].button : t.buttons[l].accessToolbarButton, i && (n = i.button("widget"), i.is("button") || (n && n.hasClass(r.stateActive) && (s = !1), t.An(i, s))), e.is("button") && (a.preventDefault(), a.stopPropagation()), o("." + r.buttonText, this).removeClass(r.stateHover)
                                })
                            }, t.prototype.getDropdownLabelSubstr = function(e, t, i) { return this.in(e, t, i) }, t.prototype.in = function(e, t, i) {
                                var n = this,
                                    r = e.length,
                                    a = 0,
                                    s = r,
                                    l = Math.floor((a + s) / 2),
                                    c = o("<span></span>"),
                                    d = e.substr(0, l),
                                    p;
                                for (c.appendTo(t.parent()), p = n.Bn(d, c); p !== i && s > a;) d = e.substr(0, l + 1), p = n.Bn(d, c), p > i ? s = l - 1 : p < i && (a = l + 1), l = Math.floor((a + s) / 2);
                                return c.remove(), d
                            }, t.prototype.Bn = function(e, t) { return t.text(e), t.width() }, t.prototype.hideDropdown = function(e) {
                                var t = this,
                                    i = t.listUis[e];
                                i && i.list && i.list.hide()
                            }, t.prototype.qn = function() {
                                var e = this;
                                o(".gcui-menu", e.tabEle).hide()
                            }, t.prototype.setTabPageVisible = function(e, t) {
                                var i = this,
                                    n = o("a[href=#" + e + "]", i.element).parent("li"),
                                    r = n.parent("ul"),
                                    a;
                                n && n.length > 0 && (t ? (n.show(), a = o("li[role='tab']", r).index(n)) : (n.hide(), a = o("li", r).index(o('li:visible:not(".gcui-ribbon-startmenulinkcontainer")', r)))), i.element.gcuitabs("option", "selected", a)
                            }, t.prototype.destroy = function() { this.disabledModal && this.disabledModal.remove(), o(window).unbind("resize." + this.widgetName), o.Widget.prototype.destroy.call(this) }, t.prototype.getDropdownList = function(e) {
                                var t = this,
                                    i = t.listUis[e],
                                    n = {};
                                return i && o.each(i.buttons, function(e, t) { n[t.data("commandName")] = t.button("option", "label") }), n
                            }, t.prototype.setButtonDisabled = function(e, t) {
                                var i = this.buttons[e],
                                    n = this.options.uiCSS,
                                    r = !1,
                                    a, s, l;
                                if (i && i.disabled) return void i.disabled(t);
                                if (i && i.button && "galleryBtn" === i.type && i.button.addClass(n.stateDisabled), i && i.button) {
                                    if (a = i.button, s = i.accessToolbarButton, r = a.is("button"), "galleryBtn" === i.type) return void(t ? a.addClass(n.stateDisabled) : a.removeClass(n.stateDisabled));
                                    a.button("option", "disabled", t), s && s.button("option", "disabled", t), r ? "save" !== e && s && a.children("." + n.buttonText).text(e) : o("[for='" + a.attr("id") + "']", a.parent()).children("." + n.buttonText).text(e), l = this.listUis[e], l && "split" === l.type && (l.trigger.button("option", "disabled", t), l.trigger.children("." + n.buttonText).text(e))
                                }
                            }, t.prototype.setButtonsDisabled = function(e) {
                                var t = this;
                                o.each(e, function(e, i) { t.setButtonDisabled(e, i) })
                            }, t.prototype.setButtonsChecked = function(e) {
                                var t = this;
                                o.each(e, function(e, i) { o.isPlainObject(i) ? t.setButtonChecked(e, i.checked, i.name) : t.setButtonChecked(e, i, null) })
                            }, t.prototype.registerButtonInformation = function(e, t) { if (e && t) return this.buttons[e] = t }, t.prototype.ribbonClick = function(e, t) { this._trigger("click", e, t) }, t.prototype.An = function(e, t) {
                                var i = this,
                                    e, o = i.options.uiCSS;
                                e.is("button") ? t ? e.addClass(o.stateActive) : e.removeClass(o.stateActive) : e.is("input[type='text']") || (e.prop("checked", t), e.button("refresh")), i.Zm(e.button("widget"))
                            }, t.prototype.setButtonChecked = function(e, t, i) {
                                var n, r, a, s, l, c, d = this,
                                    p = d.buttons[e],
                                    u = this.options.uiCSS;
                                if (p && p.checked) return void p.checked(t);
                                if (p && p.button) {
                                    if (r = p.button, a = p.accessToolbarButton, r.is("button")) t ? (r.addClass(u.stateActive), a && a.addClass(u.stateActive)) : (r.removeClass(u.stateActive), a && a.removeClass(u.stateActive));
                                    else {
                                        if ("galleryBtn" === p.type) return c = r.parent("div"), o("div", c).removeClass(u.stateActive), void(t ? r.addClass(u.stateActive) : r.removeClass(u.stateActive));
                                        r.is("input[type='text']") || (r.prop("checked", t), r.button("refresh"), a && (a.prop("checked", t), a.button("refresh")))
                                    }
                                    p.parent ? "dropdown" === p.type && t && (d.dropdownLabels[e] || (d.dropdownLabels[e] = d.in(r.button("option", "label"), p.parent.children("." + u.buttonText), p.parent.children("." + u.buttonText).width())), l = d.dropdownLabels[e], p.parent.is("input[type='text']") ? (p.parent.val(l), p.parent.attr("title", l)) : (p.parent.button("option", "label", l), p.parent.attr("title", r.button("option", "label"))), (n = o(":radio", p.button.closest("ul"))) && o.each(n, function() { d._m(this) })) : (d.Zm(r.button("widget")), a && d.Zm(a.button("widget")))
                                } else i && (s = d.listUis[i]) && (s.ui.is("input[type='text']") ? s.ui.val(s.defaultValue) : s.ui.button("option", "label", s.defaultValue), s.buttons && o.each(s.buttons, function(e, t) { t.prop("checked", !1), t.button("refresh"), d.Zm(t.button("widget")) }))
                            }, t
                        }(e.gcuiWidget);
                    t.gcuiribbon = w, i = function() {
                        function e() { this.initSelector = ":jqmData(role='gcuiribbon')", this.uiCSS = { tabsHide: "gcui-gcuitabs-hide", dropDownGroupSpace: 20 }, this.click = null, this.custombuttons = null }
                        return e
                    }(), w.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i), o.gcui.registerWidget("gcuiribbon", w.prototype)
                }
                (e.ribbon || (e.ribbon = {}))
            }(gcui || (gcui = {})), designer.gcui = gcui
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(45), i(47), i(46), i(44), i(48)
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer,
            o = GC.Spread.Sheets,
            n = o.Charts,
            r = o.CalcEngine.rangeToFormula,
            a = i.util.chartHelper;
        ! function(e) {
            "use strict";
            var t, o;

            function r() { t = new GC.Spread.Sheets.Workbook(document.getElementById("chartPreviewer"), { sheetCount: 1 }) }

            function s(e) { t.fromJSON(JSON.parse(JSON.stringify(e.toJSON({ ignoreStyle: !0, ignoreFormula: !0 })))) } e.synchronizeData = s;

            function l() { return t.getActiveSheet() }

            function c(e) {
                var t, i, r, s, c, d, p, u, h, f = e.category;
                try {
                    if (o = l(), i = n.ChartType[e.chartType], r = e.dataFormula, s = e.dataOrientation, f === a.chartTypeDict[52].chartGroup ? t = o.charts.add("", i, 20, 20, 480, 288, r) : i === n.ChartType.pie ? (r || (d = e.series[0], r = d.yValues), r && (t = o.charts.add("", i, 20, 20, 480, 288, r, s))) : r && f !== a.chartTypeDict[0].chartGroup ? t = o.charts.add("", i, 20, 20, 480, 288, r, s) : (t = o.charts.add("", i, 20, 20, 480, 288), p = t.series(), p.add(e.series)), !t) return;
                    if (e.axes && a.getChartGroupString(t.chartType()) !== a.chartTypeDict[3].chartGroup && t.axes(e.axes), e.dataLabels && t.dataLabels(e.dataLabels), e.legend && t.legend(e.legend), e.title && t.title(e.title), e.chartArea && t.chartArea(e.chartArea), t.series().get(8) && t.legend({ visible: !1 }), f === a.chartTypeDict[3].chartGroup && e.series.length > 0)
                        for (u = t.series(), c = 0; c < u.length; c++) u.set(c, e.series[c]);
                    return e.colorAndStyle && e.colorAndStyle.color && (a.applyChartSeriesTheme(t, e.colorAndStyle.color), t.colorAndStyle = { color: e.colorAndStyle.color }), t
                } catch (e) { return h = f === a.chartTypeDict[52].chartGroup ? e.message : "Chart are not available for the data you selected" }
            }

            function d(e) {
                o = l(), o.charts.clear(), t.suspendPaint();
                var i = [],
                    n, r;
                for (n = 0; n < e.length; n++) r = c(e[n]), i.push(r);
                return t.resumePaint(), i
            }
            e.getChartPreviewCharts = d;

            function p(e, i) {
                o = l(), o.charts.clear(), t.suspendPaint();
                var n = [],
                    r, s;
                for (r = 0; r < i.length; r++) s = c(e), a.SetChartStyle(s, i[r], "templetes"), n.push(s);
                return t.resumePaint(), n
            }
            e.getPreviewCharts = p, i.loader.ready(function() { i.wrapper.spread.notWorking || r() }), i.chartPreviewer = e
        }(i.chartPreviewer || {})
    }, function(e, t, i) {
        ! function() {
            "use strict";
            var t = GC.Spread.Sheets.Designer,
                o = t.util.chartHelper,
                n = o.axesItemEnum,
                r = i(3);

            function a(e) { this.H = e, this.container = document.createElement("div"), this.container.className = "add-chart-element-container", this.H.appendChild(this.container), this.Cn = { axes: { title: t.res.addChartElement.axes.axes, key: "axes", subTitle: { axesPrimaryHorizontal: { title: t.res.addChartElement.primaryHorizontal, key: "axesPrimaryHorizontal" }, axesPrimaryVertical: { title: t.res.addChartElement.primaryVertical, key: "axesPrimaryVertical" }, axesSecondaryHorizontal: { title: t.res.addChartElement.secondaryHorizontal, key: "axesSecondaryHorizontal" }, axesSecondaryVertical: { title: t.res.addChartElement.secondaryVertical, key: "axesSecondaryVertical" } }, openPanel: { title: t.res.addChartElement.axes.moreAxisOption, key: "AxesOpenPanel" } }, axisTitles: { title: t.res.addChartElement.axisTitles.axisTitles, key: "axisTitles", subTitle: { axesTitlesPrimaryHorizontal: { title: t.res.addChartElement.primaryHorizontal, key: "axesTitlesPrimaryHorizontal" }, axesTitlesPrimaryVertical: { title: t.res.addChartElement.primaryVertical, key: "axesTitlesPrimaryVertical" }, axesTitlesSecondaryHorizontal: { title: t.res.addChartElement.secondaryHorizontal, key: "axesTitlesSecondaryHorizontal" }, axesTitlesSecondaryVertical: { title: t.res.addChartElement.secondaryVertical, key: "axesTitlesSecondaryVertical" } }, openPanel: { title: t.res.addChartElement.axisTitles.moreAxisTitlesOption, key: "axisTitlesOpenPanel" } }, chartTitle: { title: t.res.addChartElement.chartTitle.chartTitle, key: "chartTitle", subTitle: { chartTitleNone: { title: t.res.addChartElement.none, key: "chartTitleNone" }, chartTitleAboveChart: { title: t.res.addChartElement.aboveChart, key: "chartTitleAboveChart" } }, openPanel: { title: t.res.addChartElement.chartTitle.moreChartTitleOption, key: "chartTitleOpenPanel" } }, gridLines: { title: t.res.addChartElement.gridLines.gridLines, key: "gridLines", subTitle: { gridLinesPrimaryMajorHorizontal: { title: t.res.addChartElement.primaryMajorHorizontal, key: "gridLinesPrimaryMajorHorizontal" }, gridLinesPrimaryMajorVertical: { title: t.res.addChartElement.primaryMajorVertical, key: "gridLinesPrimaryMajorVertical" }, gridLinesPrimaryMinorHorizontal: { title: t.res.addChartElement.primaryMinorHorizontal, key: "gridLinesPrimaryMinorHorizontal" }, gridLinesPrimaryMinorVertical: { title: t.res.addChartElement.primaryMinorVertical, key: "gridLinesPrimaryMinorVertical" }, gridLinesSecondaryMajorHorizontal: { title: t.res.addChartElement.secondaryMajorHorizontal, key: "gridLinesSecondaryMajorHorizontal" }, gridLinesSecondaryMajorVertical: { title: t.res.addChartElement.secondaryMajorVertical, key: "gridLinesSecondaryMajorVertical" }, gridLinesSecondaryMinorHorizontal: { title: t.res.addChartElement.secondaryMinorHorizontal, key: "gridLinesSecondaryMinorHorizontal" }, gridLinesSecondaryMinorVertical: { title: t.res.addChartElement.secondaryMinorVertical, key: "gridLinesSecondaryMinorVertical" } }, openPanel: { title: t.res.addChartElement.gridLines.moreGridLinesOption, key: "gridLinesOpenPanel" } }, dataLabels: { title: t.res.addChartElement.dataLabels.dataLabels, key: "dataLabels", subTitle: { dataLabelsNone: { title: t.res.addChartElement.none, key: "dataLabelsNone" }, dataLabelsCenter: { title: t.res.addChartElement.center, key: "dataLabelsCenter" }, dataLabelsInsideEnd: { title: t.res.addChartElement.insideEnd, key: "dataLabelsInsideEnd" }, dataLabelsOutsideEnd: { title: t.res.addChartElement.outsideEnd, key: "dataLabelsOutsideEnd" }, dataLabelsBestFit: { title: t.res.addChartElement.bestFit, key: "dataLabelsBestFit" }, dataLabelsAbove: { title: t.res.addChartElement.above, key: "dataLabelsAbove" }, dataLabelsBelow: { title: t.res.addChartElement.below, key: "dataLabelsBelow" }, dataLabelsShow: { title: t.res.addChartElement.show, key: "dataLabelsShow" } }, openPanel: { title: t.res.addChartElement.dataLabels.moreDataLabelsOption, key: "dataLabelsOpenPanel" } }, legend: { title: t.res.addChartElement.legend.legend, key: "legend", subTitle: { legendNone: { title: t.res.addChartElement.none, key: "legendNone" }, legendRight: { title: t.res.addChartElement.right, key: "legendRight" }, legendTop: { title: t.res.addChartElement.top, key: "legendTop" }, legendLeft: { title: t.res.addChartElement.left, key: "legendLeft" }, legendBottom: { title: t.res.addChartElement.bottom, key: "legendBottom" } }, openPanel: { title: t.res.addChartElement.legend.moreLegendOption, key: "legendOpenPanel" } } }, this.Dn = { ColumnGroup: { dataLabels: { needShow: !0, subTitle: { dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } } }, LineGroup: { dataLabels: { needShow: !0, subTitle: { dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } } }, PieGroup: { axes: { needShow: !1 }, axisTitles: { needShow: !1 }, dataLabels: { needShow: !0, subTitle: { dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } }, gridLines: { needShow: !1 } }, BarGroup: { dataLabels: { needShow: !0, subTitle: { dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } } }, AreaGroup: { dataLabels: { needShow: !0, subTitle: { dataLabelsCenter: { needShow: !1 }, dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 } } } }, ScatterGroup: { dataLabels: { needShow: !0, subTitle: { dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } } }, StockGroup: { dataLabels: { needShow: !1 }, legend: { needShow: !1 } }, RadarGroup: { axes: { needShow: !0, subTitle: { axesPrimaryHorizontal: { needShow: !1 }, axesSecondaryHorizontal: { needShow: !1 }, axesSecondaryVertical: { needShow: !1 } } }, axisTitles: { needShow: !1 }, dataLabels: { needShow: !0, subTitle: { dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsCenter: { needShow: !1 } } }, gridLines: { needShow: !0, subTitle: { gridLinesPrimaryMajorVertical: { needShow: !1 }, gridLinesPrimaryMinorVertical: { needShow: !1 }, gridLinesSecondaryMajorHorizontal: { needShow: !1 }, gridLinesSecondaryMajorVertical: { needShow: !1 }, gridLinesSecondaryMinorHorizontal: { needShow: !1 }, gridLinesSecondaryMinorVertical: { needShow: !1 } } } }, SunburstGroup: { gridLines: { needShow: !1 }, axes: { needShow: !1 }, axisTitles: { needShow: !1 }, dataLabels: { needShow: !0, subTitle: { dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsShow: { needShow: !1 } } } }, TreemapGroup: { gridLines: { needShow: !1 }, axes: { needShow: !1 }, axisTitles: { needShow: !1 }, dataLabels: { needShow: !0, subTitle: { dataLabelsInsideEnd: { needShow: !1 }, dataLabelsOutsideEnd: { needShow: !1 }, dataLabelsBestFit: { needShow: !1 }, dataLabelsAbove: { needShow: !1 }, dataLabelsBelow: { needShow: !1 }, dataLabelsCenter: { needShow: !1 } } } }, ComboGroup: {} } } a.prototype.En = function() { this.Fn = this.Gn(), this.Hn = this.In(), this.Jn = null, this.Kn(), this.Ln() }, a.prototype.Kn = function() { this.container.innerHTML = ""; for (var e in this.Cn) this.Mn(e) && this.container.appendChild(this.Nn(this.Cn[e])) }, a.prototype.In = function() {
                var e, t, i, n, r, a, s = [],
                    l = o.getChartGroupString(this.Fn.chartType());
                if ("ComboGroup" === l) { for (e = this.Fn.series().get(), t = {}, i = 0; i < e.length; i++) n = e[i], r = o.getChartGroupString(n.chartType), t[r] = !0; for (a in t) t.hasOwnProperty(a) && s.push(a); return s }
                return s.push(l), s
            }, a.prototype.Gn = function() {
                var e, i, o = t.wrapper.spread.getActiveSheet().charts.all();
                for (e = 0; e < o.length; e++)
                    if (i = o[e], i.isSelected()) return i
            }, a.prototype.Nn = function(e) {
                var t = document.createElement("div"),
                    i = document.createElement("div"),
                    o = document.createElement("div"),
                    n = document.createElement("div"),
                    r = document.createElement("div");
                return t.dataset.seriesKey = e.key, t.className = "add-chart-element-item", i.className = "imgItemContainer", o.className = "imgItem", $(o).addClass(e.key), n.className = "textItem", n.innerHTML = e.title, r.className = "trangleItem", i.appendChild(o), t.appendChild(i), t.appendChild(n), t.appendChild(r), t
            }, a.prototype.On = function(e) {
                var t, i, o, n, r, a, s, l = document.getElementById("add-chart-element-submenu");
                l.innerHTML = "", t = document.createElement("div"), t.className = "add-chart-element-container-subMenu", i = this.Cn[e].subTitle, o = this.Cn[e].key;
                for (n in i) this.Pn(e, n) && (r = i[n].key, a = !1, "gridLinesPrimaryMajorHorizontal" === r || "gridLinesPrimaryMajorVertical" === r || "gridLinesPrimaryMinorHorizontal" === r || "gridLinesPrimaryMinorVertical" === r || "axesPrimaryHorizontal" === r || "axesPrimaryVertical" === r || "axesTitlesPrimaryHorizontal" === r || "axesTitlesPrimaryVertical" === r ? (s = this.Fn.axes(), s.primaryCategory && s.primaryValue && (a = this.Qn(o, r), t.appendChild(this.Rn(i[n].title, o, i[n].key, a)))) : "gridLinesSecondaryMajorHorizontal" === r || "gridLinesSecondaryMajorVertical" === r || "gridLinesSecondaryMinorHorizontal" === r || "gridLinesSecondaryMinorVertical" === r || "axesSecondaryHorizontal" === r || "axesSecondaryVertical" === r || "axesTitlesSecondaryHorizontal" === r || "axesTitlesSecondaryVertical" === r ? (s = this.Fn.axes(), s.secondaryCategory && s.secondaryValue && (a = this.Qn(o, r), t.appendChild(this.Rn(i[n].title, o, i[n].key, a)))) : (a = this.Qn(o, r), t.appendChild(this.Rn(i[n].title, o, i[n].key, a))));
                return this.Cn[e].openPanel && t.appendChild(this.Sn(this.Cn[e].openPanel)), l.appendChild(t), this.Tn(), l
            }, a.prototype.Rn = function(e, t, i, n) {
                var r, a, s = this.Fn.chartType(),
                    l = document.createElement("div"),
                    c = document.createElement("div"),
                    d = document.createElement("div"),
                    p = document.createElement("div");
                return l.className = "add-chart-element-subItem", l.dataset.parentKey = t, l.dataset.selfKey = i, c.className = "imgItemContainer", $(c).addClass(n ? "img-item-choosed" : "img-item-no-choose"), p.className = "imgItem", r = i, a = o.getChartGroupString(s), "dataLabels" !== t || null === s || void 0 === s || "ScatterGroup" !== a && "LineGroup" !== a && "PieGroup" !== a || (r = r + "-" + a), $(p).addClass(r), d.className = "textItem", d.innerHTML = e, c.appendChild(p), l.appendChild(c), l.appendChild(d), l
            }, a.prototype.Qn = function(e, t) {
                var i, r, a, s, l, c, d, p = !1,
                    u = this;
                switch (e) {
                    case "axes":
                        switch (t) {
                            case "axesPrimaryHorizontal":
                                i = o.getChartAxesItem(u.Fn, n.axesPrimaryHorizontal);
                                break;
                            case "axesPrimaryVertical":
                                i = o.getChartAxesItem(u.Fn, n.axesPrimaryVertical);
                                break;
                            case "axesSecondaryHorizontal":
                                i = o.getChartAxesItem(u.Fn, n.axesSecondaryHorizontal);
                                break;
                            case "axesSecondaryVertical":
                                i = o.getChartAxesItem(u.Fn, n.axesSecondaryVertical);
                                break;
                            default:
                                i = {}
                        }
                        null !== i.visible && void 0 !== i.visible && (p = i.visible);
                        break;
                    case "axisTitles":
                        switch (t) {
                            case "axesTitlesPrimaryHorizontal":
                                i = o.getChartAxesItem(u.Fn, n.axesPrimaryHorizontal);
                                break;
                            case "axesTitlesPrimaryVertical":
                                i = o.getChartAxesItem(u.Fn, n.axesPrimaryVertical);
                                break;
                            case "axesTitlesSecondaryHorizontal":
                                i = o.getChartAxesItem(u.Fn, n.axesSecondaryHorizontal);
                                break;
                            case "axesTitlesSecondaryVertical":
                                i = o.getChartAxesItem(u.Fn, n.axesSecondaryVertical);
                                break;
                            default:
                                i = {}
                        }
                        i.title && i.title.text && (p = "" !== i.title.text);
                        break;
                    case "chartTitle":
                        switch (r = u.Fn.title(), t) {
                            case "chartTitleNone":
                                p = !r || "" === r.text;
                                break;
                            case "chartTitleAboveChart":
                                p = !!r && "" !== r.text
                        }
                        break;
                    case "dataLabels":
                        if (a = u.Fn.dataLabels(), s = GC.Spread.Sheets.Charts.DataLabelPosition, "dataLabelsNone" !== t && !1 === a.showValue) { p = !1; break }
                        switch (t) {
                            case "dataLabelsNone":
                                p = !1 === a.showValue;
                                break;
                            case "dataLabelsCenter":
                                p = a.position === s.center;
                                break;
                            case "dataLabelsInsideEnd":
                                p = a.position === s.insideEnd;
                                break;
                            case "dataLabelsOutsideEnd":
                                p = a.position === s.outsideEnd;
                                break;
                            case "dataLabelsBestFit":
                                p = a.position === s.bestFit;
                                break;
                            case "dataLabelsLeft":
                                p = a.position === s.left;
                                break;
                            case "dataLabelsRight":
                                p = a.position === s.right;
                                break;
                            case "dataLabelsAbove":
                                p = a.position === s.above;
                                break;
                            case "dataLabelsBelow":
                                p = a.position === s.below;
                                break;
                            case "dataLabelsShow":
                                p = !0 === a.showValue
                        }
                        break;
                    case "gridLines":
                        switch (l = u.Fn.axes(), t) {
                            case "gridLinesPrimaryMajorHorizontal":
                                p = !0 === l.primaryValue.majorGridLine.visible;
                                break;
                            case "gridLinesPrimaryMajorVertical":
                                p = !0 === l.primaryCategory.majorGridLine.visible;
                                break;
                            case "gridLinesPrimaryMinorHorizontal":
                                p = !0 === l.primaryValue.minorGridLine.visible;
                                break;
                            case "gridLinesPrimaryMinorVertical":
                                p = !0 === l.primaryCategory.minorGridLine.visible;
                                break;
                            case "gridLinesSecondaryMajorHorizontal":
                                p = !0 === l.secondaryValue.majorGridLine.visible;
                                break;
                            case "gridLinesSecondaryMajorVertical":
                                p = !0 === l.secondaryCategory.majorGridLine.visible;
                                break;
                            case "gridLinesSecondaryMinorHorizontal":
                                p = !0 === l.secondaryValue.minorGridLine.visible;
                                break;
                            case "gridLinesSecondaryMinorVertical":
                                p = !0 === l.secondaryCategory.minorGridLine.visible
                        }
                        break;
                    case "legend":
                        if (c = u.Fn.legend(), d = GC.Spread.Sheets.Charts.LegendPosition, "legendNone" !== t && !1 === c.visible) { p = !1; break }
                        switch (t) {
                            case "legendNone":
                                p = !1 === c.visible;
                                break;
                            case "legendRight":
                                p = c.position === d.right;
                                break;
                            case "legendTop":
                                p = c.position === d.top;
                                break;
                            case "legendLeft":
                                p = c.position === d.left;
                                break;
                            case "legendBottom":
                                p = c.position === d.bottom
                        }
                }
                return p
            }, a.prototype.Sn = function(e) { var t, i = document.createElement("div"); return i.className = " add-chart-element-subItem add-chart-element-openPanel-MenuItem", i.innerHTML = e.title, i.dataset.selfKey = e.key, i.dataset.type = "openPanelMenuItem", t = this, $(i).click(function() { t.Un(e.key), t.Vn() }), i }, a.prototype.Un = function(e) {
                var i, n, a, s, l = { AxesOpenPanel: "axis", axisTitlesOpenPanel: "axis", chartTitleOpenPanel: "chartTitle", dataLabelsOpenPanel: "dataLabels", gridLinesOpenPanel: "", legendOpenPanel: "legend" };
                e && ("AxesOpenPanel" === e ? (i = l[e], n = "primaryCategory") : "axisTitlesOpenPanel" === e ? (a = this.Fn.axes(), "" !== a.primaryCategory.title.text ? n = "primaryCategoryTitle" : "" !== a.primaryValue.title.text ? n = "primaryValueTitle" : a.secondaryCategory && "" !== a.secondaryCategory.title.text ? n = "secondaryCategoryTitle" : a.secondaryValue && "" !== a.secondaryValue.title.text ? n = "secondaryValueTitle" : (a.primaryCategory.title.text = "Axis Title", a.primaryCategory.title.fontSize = 14, t.actions.doAction("changeChartElement", t.wrapper.spread, { axes: a }), n = "primaryCategoryTitle"), i = l[e]) : (i = l[e], n = l[e]), s = o.getChartSeriesNames(this.Fn), r.initChartSliderPanel(this.Fn, i, n, s))
            }, a.prototype.Wn = function(e, t, i) { e && e.removeClass(i), t && t.addClass(i) }, a.prototype.Xn = function() {
                var e, t = $(this.H).find(".add-chart-element-item");
                this.Wn(t, null, "add-chart-element-item-active"), e = $(this.H).find(".add-chart-element-subItem"), this.Wn(e, null, "add-chart-element-subItem-active"), this.Jn && this.Jn.gcuipopup("hide")
            }, a.prototype.Yn = function(e) {
                var t, i = $(this.H).find(".add-chart-element-item");
                this.Wn(i, $(e.currentTarget), "add-chart-element-item-active"), t = $(e.currentTarget).data("seriesKey"), this.On(t), this.Jn || (this.Jn = $("#add-chart-element-submenu").gcuipopup({ autoHide: !1 })), this.Jn.gcuipopup("show", { of: e.currentTarget, my: "left top", at: "right top" })
            }, a.prototype.Ln = function() {
                var e = this,
                    t = $(this.H).find(".add-chart-element-item");
                t.click(function(t) { e.Yn(t) }), t.mouseenter(function(t) { e.Yn(t) })
            }, a.prototype.Vn = function() {}, a.prototype.Tn = function() {
                var e = $(this.H).find(".add-chart-element-subItem"),
                    i = this;
                e.mouseenter(function(t) { i.Wn(e, $(t.currentTarget), "add-chart-element-subItem-active") }), e.click(function(e) {
                    var r, a, s, l, c, d, p, u, h, f, g, m = $(e.currentTarget).data("parentKey"),
                        b = $(e.currentTarget).data("selfKey"),
                        v = $(e.currentTarget).data("type");
                    if ("openPanelMenuItem" !== v) {
                        switch (r = {}, m) {
                            case "axes":
                                switch (b) {
                                    case "axesPrimaryHorizontal":
                                        a = n.axesPrimaryHorizontal;
                                        break;
                                    case "axesPrimaryVertical":
                                        a = n.axesPrimaryVertical;
                                        break;
                                    case "axesSecondaryHorizontal":
                                        a = n.axesSecondaryHorizontal;
                                        break;
                                    case "axesSecondaryVertical":
                                        a = n.axesSecondaryVertical
                                }
                                r = o.getChartAxesItem(i.Fn, a), null !== r.visible && void 0 !== r.visible && (r.visible = !r.visible, s = o.setChartAxesItem(i.Fn, a, r), t.actions.doAction("changeChartElement", t.wrapper.spread, { axes: s }));
                                break;
                            case "axisTitles":
                                switch (l = i.Fn.axes(), c = "Axis Title", l.primaryCategory && l.primaryCategory.title && l.primaryCategory.title.text ? c = l.primaryCategory.title.text : l.primaryValue && l.primaryValue.title && l.primaryValue.title.text && (c = l.primaryValue.title.text), b) {
                                    case "axesTitlesPrimaryHorizontal":
                                        a = n.axesPrimaryHorizontal;
                                        break;
                                    case "axesTitlesPrimaryVertical":
                                        a = n.axesPrimaryVertical;
                                        break;
                                    case "axesTitlesSecondaryHorizontal":
                                        a = n.axesSecondaryHorizontal;
                                        break;
                                    case "axesTitlesSecondaryVertical":
                                        a = n.axesSecondaryVertical
                                }
                                r = o.getChartAxesItem(i.Fn, a), "" !== r.title.text ? r.title.text = "" : r.title.text = c, r.title.fontSize = 14, l = o.setChartAxesItem(i.Fn, a, r), t.actions.doAction("changeChartElement", t.wrapper.spread, { axes: l });
                                break;
                            case "chartTitle":
                                switch (d = i.Fn.title(), b) {
                                    case "chartTitleNone":
                                        d && d.text && (d.text = "");
                                        break;
                                    case "chartTitleAboveChart":
                                        d && d.text ? d.text = "" === d.text ? "Chart Title" : d.text : d = { text: "Chart Title" }
                                }
                                t.actions.doAction("changeChartElement", t.wrapper.spread, { title: d });
                                break;
                            case "dataLabels":
                                switch (p = i.Fn.dataLabels(), p.showValue = !0, p.showSeriesName = !1, p.showCategoryName = !1, u = GC.Spread.Sheets.Charts.DataLabelPosition, b) {
                                    case "dataLabelsNone":
                                        p.showValue = !1;
                                        break;
                                    case "dataLabelsCenter":
                                        "SunburstGroup" === o.getChartGroupString(i.Fn.chartType()) && (p.showValue = !1, p.showCategoryName = !0), p.position = u.center;
                                        break;
                                    case "dataLabelsInsideEnd":
                                        p.position = u.insideEnd;
                                        break;
                                    case "dataLabelsOutsideEnd":
                                        p.position = u.outsideEnd;
                                        break;
                                    case "dataLabelsBestFit":
                                        p.position = u.bestFit;
                                        break;
                                    case "dataLabelsLeft":
                                        p.position = u.left;
                                        break;
                                    case "dataLabelsRight":
                                        p.position = u.right;
                                        break;
                                    case "dataLabelsAbove":
                                        p.position = u.above;
                                        break;
                                    case "dataLabelsBelow":
                                        p.position = u.below;
                                        break;
                                    case "dataLabelsShow":
                                        "TreemapGroup" === o.getChartGroupString(i.Fn.chartType()) ? (p.showValue = !1, p.showCategoryName = !0) : p.showValue = !0
                                }
                                t.actions.doAction("changeChartElement", t.wrapper.spread, { dataLabels: p });
                                break;
                            case "gridLines":
                                switch (h = i.Fn.axes(), b) {
                                    case "gridLinesPrimaryMajorHorizontal":
                                        h.primaryValue.majorGridLine.visible = !h.primaryValue.majorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMajorVertical":
                                        h.primaryCategory.majorGridLine.visible = !h.primaryCategory.majorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMinorHorizontal":
                                        h.primaryValue.minorGridLine.visible = !h.primaryValue.minorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMinorVertical":
                                        h.primaryCategory.minorGridLine.visible = !h.primaryCategory.minorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMajorHorizontal":
                                        h.secondaryValue.majorGridLine.visible = !h.secondaryValue.majorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMajorVertical":
                                        h.secondaryCategory.majorGridLine.visible = !h.secondaryCategory.majorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMinorHorizontal":
                                        h.secondaryValue.minorGridLine.visible = !h.secondaryValue.minorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMinorVertical":
                                        h.secondaryCategory.minorGridLine.visible = !h.secondaryCategory.minorGridLine.visible
                                }
                                t.actions.doAction("changeChartElement", t.wrapper.spread, { axes: h });
                                break;
                            case "legend":
                                switch (f = i.Fn.legend(), f.visible = !0, g = GC.Spread.Sheets.Charts.LegendPosition, b) {
                                    case "legendNone":
                                        f.visible = !1;
                                        break;
                                    case "legendRight":
                                        f.position = g.right;
                                        break;
                                    case "legendTop":
                                        f.position = g.top;
                                        break;
                                    case "legendLeft":
                                        f.position = g.left;
                                        break;
                                    case "legendBottom":
                                        f.position = g.bottom
                                }
                                t.actions.doAction("changeChartElement", t.wrapper.spread, { legend: f })
                        }
                        i.Vn()
                    }
                })
            }, a.prototype.Mn = function(e) {
                var t, i, o;
                for (t = 0; t < this.Hn.length; t++)
                    if (i = this.Hn[t], o = this.Dn[i] || {}, !o[e] || o[e].needShow) return !0;
                return !1
            }, a.prototype.Pn = function(e, t) { var i, n, r, a, s; if (this.Hn.length > 0) { if (i = this.Hn[0], n = this.Dn[i] || {}, r = o.getChartTypeString(this.Fn.chartType()), a = n[e] || {}, s = a.subTitle || {}, "doughnut" === r && "dataLabels" === e) { if ("dataLabelsCenter" === t || "dataLabelsInsideEnd" === t || "dataLabelsOutsideEnd" === t || "dataLabelsBestFit" === t) return !1; if ("dataLabelsShow" === t) return !0 } if (s[t] && !s[t].needShow) return !1 } return !0 }, e.exports = a
        }()
    }, function(e, t) {
        ! function() {
            "use strict";

            function t(e, t) { this.Zn = t, this.$n = $(e), this._init() } t.prototype._init = function() {
                var e, t = this,
                    i = t.Zn,
                    o = t.$n,
                    n = $("<div>").addClass("chart-colorpicker-container");
                n.appendTo(o), t._n = n;
                for (e in i) i.hasOwnProperty(e) && t.ao(e)
            }, t.prototype.ao = function(e) {
                var t, i, o, n, r, a = this,
                    s = a._n,
                    l = a.Zn,
                    c = l[e],
                    d = c.name,
                    p = c.colors,
                    u = $("<div>").addClass("header-container").appendTo(s);
                for ($("<span>").text(d).appendTo(u), t = $("<div>").addClass("group-content").appendTo(s), i = 0; i < p.length; i++) o = p[i], n = $("<div>").addClass("color-items-container " + e).attr("title", o.tip).appendTo(t).data("index", i), n.click(function(t) { a.bo(e, $(t.currentTarget).data("index")) }), r = o.items, r.forEach(function(e) { $("<div>").addClass("color-item").css({ "background-color": e }).appendTo(n) })
            }, t.prototype.bo = function(e, t) {
                var i = this;
                i.co = e, i.do = t, i.onSelectedColorChanged({ group: e, index: t }), i.eo()
            }, t.prototype.onSelectedColorChanged = function(e) {}, t.prototype.setSelectedItem = function(e, t) {
                var i = this;
                i.co = e, i.do = t, i.eo()
            }, t.prototype.eo = function() {
                var e, t = this,
                    i = t.$n,
                    o = t.co,
                    n = t.do;
                i.find(".color-items-container").removeClass("selected"), e = i.find("." + o)[n], $(e).addClass("selected"), e.scrollIntoView()
            }, e.exports = t
        }()
    }, function(e, t) {
        ! function() {
            "use strict";
            var t = GC.Spread.Sheets.Charts.LegendPosition,
                i = GC.Spread.Sheets.Charts.DataLabelPosition;

            function o(e, o, n) {
                this._n = e, this.fo = n, this.ho = o, this.options = {
                    selectedChartType: "ColumnGroup",
                    chartLayoutsData: {
                        ColumnGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nHorizontal Axis\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout5", description: "Layout5\nChart Title\nVertical Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !1 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout6", description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } } } }, { name: "layout7", description: "Layout7\nChart Title\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !1 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout8", description: "Layout8\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout9", description: "Layout9\nChart Title\nLegend(Right)\nDataLabels(Inside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, dataLabels: { position: i.insideEnd, showValue: !0 }, legend: { position: t.right, visible: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout10", description: "Layout10\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "" }, dataLabels: { position: i.insideEnd, showValue: !1 }, legend: { position: t.right, visible: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }],
                        LineGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Center)\nHorizontal Axis\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.center, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout5", description: "Layout5\nChart Title\nVertical Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !1 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, {
                            name: "layout6",
                            description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                            value: {
                                title: { text: "" },
                                legend: {
                                    position: t.right,
                                    visible: !0
                                },
                                dataLabels: { showValue: !1 },
                                axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } }
                            }
                        }, { name: "layout7", description: "Layout7\nChart Title\nLegend(Bottom)\nDataLabels(Center)\nHorizontal Axis", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout8", description: "Layout8\nChart Title\nLegend(Right)\nDataLabels(Center)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.center, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout9", description: "Layout9\nOnly Series", value: { title: { text: "" }, dataLabels: { position: i.insideEnd, showValue: !1 }, legend: { visible: !1 }, axes: { primaryCategory: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout10", description: "Layout10\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }],
                        PieGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nDataLabels(Value and Percentage)\n", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.center, showValue: !0, showPercentage: !0, showCategoryName: !1, showSeriesName: !1 } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Value and Percentage)\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.center, showValue: !0, showPercentage: !0, showCategoryName: !1, showSeriesName: !1 } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Bottom)\n", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { showValue: !1, showPercentage: !1, showCategoryName: !1, showSeriesName: !1 } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nDataLabels(Category and Value)\n", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.center, showValue: !0, showPercentage: !1, showCategoryName: !0, showSeriesName: !1 } } }, { name: "layout5", description: "Layout5\nChart Title\nDataLabels(Category)\n", value: { title: { text: "" }, legend: { position: t.right, visible: !1 }, dataLabels: { position: i.center, showValue: !1, showPercentage: !1, showCategoryName: !0, showSeriesName: !1 } } }, { name: "layout6", description: "Layout6\nChart Title\nLegend(Right)\n", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1, showPercentage: !1, showCategoryName: !1, showSeriesName: !1 } } }, { name: "layout7", description: "Layout7\nChart Title\nLegend(Right)\n", value: { title: { text: "Chart Title" }, dataLabels: { position: i.insideEnd, showValue: !1, showPercentage: !1, showCategoryName: !1, showSeriesName: !1 }, legend: { position: t.right, visible: !0 } } }],
                        BarGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Outside End)\nVertical Axis\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout5", description: "Layout5\nChart Title\nHorizontal Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !1 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout6", description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } } } }, { name: "layout7", description: "Layout7\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout8", description: "Layout8\nChart Title\nLegend(Right)\nDataLabels(Inside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.insideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout9", description: "Layout9\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }],
                        AreaGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nHorizontal Axis\nVertical Axis\nMajor Gridlines\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout5", description: "Layout5\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } } } }, { name: "layout6", description: "Layout6\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "" } } } } }, { name: "layout7", description: "Layout7\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }],
                        ScatterGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Center)\nHorizontal Axis\n", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.center, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !1, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout3", description: "Layout3\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nHorizontal Axis Major Gridlines\nHorizontal Axis Minor Gridlines\nVertical Axis Major Gridlines\nVertical Axis Minor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } } } }, { name: "layout4", description: "Layout4\nLegend(Bottom)\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } } } } }, { name: "layout5", description: "Layout5\nChart Title\nLegend(Right)\nX and Y DataLabels(Above)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.above, showCategory: !0, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout6", description: "Layout6\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nDataLabels(Above)\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.above, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout7", description: "Layout7\nChart Title\nLegend(Right)\nX and Y DataLabels(Above)\nHorizontal Axis\nVertical AxisHorizontal Axis Major Gridlines\nVertical Axis Major Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.above, showCategory: !0, showValue: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout8", description: "Layout8\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nHorizontal Axis Major Gridlines\nVertical Axis Major Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !0 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "" } } } } }, { name: "layout9", description: "Layout9\nLegend(Right)\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines", value: { title: { text: "" }, dataLabels: { position: i.insideEnd, showValue: !1 }, legend: { position: t.right, visible: !0 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 } } } } }],
                        StockGroup: [{ name: "layout1", description: "Layout1\nChart Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !1 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 } } } } }, { name: "layout2", description: "Layout2\nHorizontal Axis\nVertical Axis", value: { title: { text: "" }, legend: { position: t.top, visible: !1 }, dataLabels: { position: i.center, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } }, primaryValue: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } } } } }, { name: "layout3", description: "Layout3\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines", value: { title: { text: "" }, legend: { position: t.bottom, visible: !1 }, dataLabels: { showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !0 }, title: { text: "Axis Title" } } } } }, { name: "layout4", description: "Layout4\nChart Title\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.bottom, visible: !1 }, dataLabels: { position: i.center, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 }, title: { text: "Axis Title" } } } } }, { name: "layout5", description: "Layout5\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !1 }, axes: { primaryCategory: { visible: !0, majorGridLine: { visible: !1 }, minorGridLine: { visible: !1 } }, primaryValue: { visible: !0, majorGridLine: { visible: !0 }, minorGridLine: { visible: !1 } } } } }],
                        RadarGroup: [{ name: "layout1", description: "Layout1\nChart Title\nLegend(Right)\nCategory Labels\nRadar Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.right, visible: !0 }, axes: { primaryCategory: { visible: !0 }, primaryValue: { visible: !0, lineStyle: { width: 0 }, minorGridLine: { visible: !1 } } } } }, { name: "layout2", description: "Layout2\nChart Title\nLegend(Top)\nData Labels\nCategory Labels\nRadar Axis\nMajor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { position: i.outsideEnd, showValue: !0 }, axes: { primaryCategory: { visible: !0 }, primaryValue: { visible: !0, minorGridLine: { visible: !1 }, lineStyle: { width: 0 } } } } }, { name: "layout3", description: "Layout3\nChart Title\nLegend(Top)\nData Labels\nCategory Labels\nRadar Axis\nMajor and Minor Gridlines", value: { title: { text: "Chart Title" }, legend: { position: t.top, visible: !0 }, dataLabels: { showValue: !0 }, axes: { primaryCategory: { visible: !0 }, primaryValue: { visible: !0, minorGridLine: { visible: !0 }, lineStyle: { width: 0 } } } } }, { name: "layout4", description: "Layout4\nLegend(Right)\nData Labels\nCategory Labels\nMajor and Minor Gridlines", value: { title: { text: "" }, legend: { position: t.right, visible: !0 }, axes: { primaryCategory: { visible: !0 }, primaryValue: { visible: !0, lineStyle: { width: 0 }, minorGridLine: { visible: !1 } } } } }],
                        SunburstGroup: [{ name: "layout1", description: "Layout1\nChart Title\nCategory Labels\n", value: { title: { text: "Chart Title" }, dataLabels: { showValue: !0 } } }, { name: "layout2", description: "Layout2\nData Labels\n", value: { title: { text: "" }, dataLabels: { showValue: !0 } } }],
                        TreemapGroup: [{ name: "layout1", description: "Layout1\nChart Title\nCategory Labels\n", value: { title: { text: "Chart Title" }, dataLabels: { showValue: !0 } } }, { name: "layout2", description: "Layout2\nData Labels\n", value: { title: { text: "" }, dataLabels: { showValue: !0 } } }]
                    }
                }, this.io()
            }
            o.prototype.io = function() {
                var e = this,
                    t = e.ho || e.options.selectedChartType;
                e.jo(t), e._n.bind("selectstart", function() { return !1 })
            }, o.prototype.jo = function(e) {
                var t, i, o, n, r = this,
                    a = r.options;
                if (e || a.chartLayoutsData[e]) {
                    for (r.ko(), r._n.empty(), t = $("<ul class='chart-layout-list'></ul>"), t.addClass("chart-layout-" + e), i = a.chartLayoutsData[e], o = 0; o < i.length; o++) n = r.lo(e, i[o]), n.appendTo(t);
                    t.appendTo(r._n), r.mo()
                }
            }, o.prototype._setOption = function(e) {
                var t = this;
                t.ho = e, t.jo(e)
            }, o.prototype.lo = function(e, t) {
                var i = $("<li class='chart-layout-list-item'></li>"),
                    o = $("<span></span>");
                return o.addClass("chart-layout-icon"), o.addClass(t.name), i.attr("title", t.description), i.attr("data-name", e), o.appendTo(i), i
            }, o.prototype.mo = function() {
                var e = this;
                this._n.find(".chart-layout-list-item").on("mouseover.chartlayoutpicker", function(t) { e._n.find(".chart-layout-list-item").removeClass("chart-layout-hover"), $(t.currentTarget).addClass("chart-layout-hover") }), this._n.find(".chart-layout-list-item").click(function(t) {
                    var i, o, n, r = e._n.find(".chart-layout-list-item");
                    r.removeClass("chart-layout-selected"), $(t.currentTarget).addClass("chart-layout-selected"), i = $(t.currentTarget).data("name"), o = r.index($(t.currentTarget)), n = e.options.chartLayoutsData[i][o].value, e.oo(t, n)
                })
            }, o.prototype.oo = function(e, t) {
                var i = this;
                i.fo && i.fo instanceof Function && i.fo.call(i, e, t)
            }, o.prototype.dispose = function() { this.ko(), this._n = null, this.fo = null, this.po = null }, o.prototype.ko = function() { this._n.find(".chart-layout-list-item").off("chartlayoutpicker") }, e.exports = o
        }()
    }, function(e, t) {
        ! function() {
            "use strict";
            var t = GC.Spread.Sheets.Designer;

            function i(e, i) { this._n = e, this.fo = i, this.options = { chartTypeData: { columnType: { icon: "select-series-type-column", text: t.res.selectChartDialog.column, items: [{ icon: "clustered-column-icon", tag: t.res.selectChartDialog.columnClustered, value: "columnClustered" }, { icon: "stacked-column-icon", tag: t.res.selectChartDialog.columnStacked, value: "columnStacked" }, { icon: "stacked100-column-icon", tag: t.res.selectChartDialog.columnClustered, value: "columnStacked100" }] }, barType: { icon: "select-series-type-bar", text: t.res.selectChartDialog.bar, items: [{ icon: "clustered-bar-icon", tag: t.res.selectChartDialog.barClustered, value: "barClustered" }, { icon: "stacked-bar-icon", tag: t.res.selectChartDialog.barStacked, value: "barStacked" }, { icon: "stacked100-bar-icon", tag: t.res.selectChartDialog.barStacked100, value: "barStacked100" }] }, lineType: { icon: "select-series-type-line", text: t.res.selectChartDialog.line, items: [{ icon: "line-icon", tag: t.res.selectChartDialog.line, value: "line" }, { icon: "stacked-line-icon", tag: t.res.selectChartDialog.lineStacked, value: "lineStacked" }, { icon: "stacked100-line-icon", tag: t.res.selectChartDialog.lineStacked100, value: "lineStacked100" }, { icon: "line-with-markers-icon", tag: t.res.selectChartDialog.lineMarkers, value: "lineMarkers" }, { icon: "stacked-line-with-markers-icon", tag: t.res.selectChartDialog.lineMarkersStacked, value: "lineMarkersStacked" }, { icon: "stacked100-line-with-markers-icon", tag: t.res.selectChartDialog.lineMarkersStacked100, value: "lineMarkersStacked100" }] }, areaType: { icon: "select-series-type-area", text: t.res.selectChartDialog.area, items: [{ icon: "area-icon", tag: t.res.selectChartDialog.area, value: "area" }, { icon: "stacked-area-icon", tag: t.res.selectChartDialog.areaStacked, value: "areaStacked" }, { icon: "stacked100-area-icon", tag: t.res.selectChartDialog.areaStacked100, value: "areaStacked100" }] }, scatterType: { icon: "select-series-type-scatter", text: t.res.selectChartDialog.xyScatter, items: [{ icon: "scatter-icon", tag: t.res.selectChartDialog.xyScatter, value: "xyScatter" }, { icon: "scatter-with-smooth-lines-and-markers-icon", tag: t.res.selectChartDialog.xyScatterSmooth, value: "xyScatterSmooth" }, { icon: "scatter-with-smooth-lines-icon", tag: t.res.selectChartDialog.xyScatterSmoothNoMarkers, value: "xyScatterSmoothNoMarkers" }, { icon: "scatter-with-straight-lines-and-markers-icon", tag: t.res.selectChartDialog.xyScatterLines, value: "xyScatterLines" }, { icon: "scatter-with-straight-lines-icon", tag: t.res.selectChartDialog.xyScatterLinesNoMarkers, value: "xyScatterLinesNoMarkers" }] } } }, this.qo() } i.prototype.qo = function() {
                var e = this,
                    t = e.ro();
                t.appendTo(e._n), e.updateSelectedStatus(GC.Spread.Sheets.Charts.ChartType.columnClustered), e._n.bind("selectstart", function() { return !1 }), e.mo()
            }, i.prototype.ro = function() {
                var e, t, i = this.options,
                    o = $("<ul class='series-chart-types-list'></ul>");
                for (e in i.chartTypeData) i.chartTypeData.hasOwnProperty(e) && (t = this.so(i.chartTypeData[e]), t.appendTo(o));
                return o
            }, i.prototype.so = function(e) {
                var t, i, o, n = $("<li class='series-chart-types-list-item column-type'></li>"),
                    r = $("<div class='series-chart-types-list-item-title'></div>"),
                    a = $("<span class='series-chart-types-list-item-title-icon'></span>");
                for (a.addClass(e.icon), a.appendTo(r), t = $("<span class='series-chart-types-list-item-title-text'></span>"), t.text(e.text), t.appendTo(r), r.appendTo(n), i = 0; i < e.items.length; i++) o = this.to(e.items[i]), o.appendTo(n);
                return n
            }, i.prototype.to = function(e) { var t, i = $("<div class='series-chart-type-item'></div>"); return i.attr("data-name", e.value), i.attr("data-bind", e.tag), t = $("<span class='chart-type-subtype-icon'></span>"), t.addClass(e.icon), t.appendTo(i), i }, i.prototype.mo = function() {
                var e = this;
                e._n.find(".series-chart-type-item").on("mouseover.chartTypePicker", function(t) { e._n.find(".series-chart-type-item").removeClass("chart-type-hover"), $(t.currentTarget).addClass("chart-type-hover") }), e._n.find(".series-chart-type-item").click(function(t) {
                    e._n.find(".series-chart-type-item").removeClass("chart-type-selected"), $(t.currentTarget).addClass("chart-type-selected");
                    var i = $(t.currentTarget).data("name");
                    e.oo(t, i)
                })
            }, i.prototype.oo = function(e, t) {
                var i = this;
                i.fo && i.fo instanceof Function && i.fo.call(i, e, t)
            }, i.prototype.updateSelectedStatus = function(e) { this._n.find(".series-chart-type-item").removeClass("chart-ui-selected"), this._n.find(".series-chart-type-item").removeClass("chart-type-hover"), this._n.find(".series-chart-type-item").removeClass("chart-type-selected"), this._n.find("[data-name=" + e + "]").addClass("chart-ui-selected") }, i.prototype.dispose = function() { this.ko(), this._n = null, this.fo = null, this.po = null }, i.prototype.ko = function() { this._n.find(".series-chart-type-item").off("chartTypePicker") }, e.exports = i
        }()
    }, function(e, t, i) {
        var o = i(2).app,
            n = GC.Spread.Sheets.Designer;
        ! function(e) {
            "use strict";
            var t, i;
            e.rootFolder = "../", t = [];

            function r(e) {
                i || (ko.applyBindings({ res: n.res }, document.body), ko.applyBindings({ res: n.res }, document.head));
                for (var r = 0; r < t.length; r++) t[r]();
                t = [], i ? (e.find(".loading-placeholder").addClass("hidden"), o.notifyReady()) : setTimeout(function() { e.find(".loading-placeholder").addClass("hidden"), o.notifyReady() }, 0), i = !0
            }

            function a(e) { t.push(e) } e.ready = a;

            function s() { if (!e.rootFolder) return "./"; var t = e.rootFolder.trim(); return "/" !== t.slice(-1) && (t += "/"), t }

            function l(e) {
                var t, i, o, a;
                return void 0 === e && (e = $(document)), t = s(), i = e.find("[data-include]"), o = [], a = [], i.each(function() {
                    var e = $(this),
                        i = e.data("include"),
                        r = n.util.resolveHtmlPath(t + i, i + ".html");
                    o.push(n.util.loadHtml(r, "." + i, e))
                }), $.when.apply($, o).then(function() {
                    if (n.ribbon.addLocalFonts(), 0 !== a.length) {
                        var t = a.map(function(e) { return n.util.loadScript(e + ".js") });
                        $.when.apply($, t).then(function() { r(e) })
                    } else r(e)
                })
            }
            e.loadContent = l, n.loader = e
        }(n.loader || {})
    }, function(e, t) {
        ! function() {
            "use strict";
            var e = GC.Spread.Sheets.Designer,
                t = function() {
                    function e() {}
                    return e.isThemeColor = function(e, t) { return e.getColor(t) !== t }, e.hexToRgb = function(e) {
                        var t, i, o = [],
                            n = [];
                        if (e = e.replace(/#/, ""), 3 === e.length) {
                            for (i = [], t = 0; t < 3; t++) i.push(e.charAt(t) + e.charAt(t));
                            e = i.join("")
                        }
                        for (t = 0; t < 3; t++) o[t] = "0x" + e.substr(2 * t, 2), n.push(parseInt(+o[t]));
                        return "rgb(" + n.join(",") + ")"
                    }, e.hexToRgba = function(e) {
                        var t, i, o = [],
                            n = [];
                        if (e = e.replace(/#/, ""), 3 === e.length) {
                            for (i = [], t = 0; t < 3; t++) i.push(e.charAt(t) + e.charAt(t));
                            e = i.join("")
                        }
                        for (t = 0; t < 3; t++) o[t] = "0x" + e.substr(2 * t, 2), n.push(parseInt(+o[t]));
                        return "rgba(" + n.join(",") + ",1)"
                    }, e.parse = function(t, i) {
                        var o, n, r, a, s, l;
                        if (!t) return null;
                        if (e.rrggbbPattern.test(t) || e.rgbPattern.test(t) || e.rgbFunctionPattern.test(t) || e.rgbaFunctionPattern.test(t) || e.standardColorNames.indexOf(t.toLowerCase()) > -1) return { baseColor: t, color: t };
                        if (n = -1, r = t.split(" ")) {
                            if (r.length > 1) {
                                if (void 0 === r[0] || null === r[0]) throw "invalid color name.";
                                if ("background" === (a = r[0].toLowerCase())) n = parseInt(r[1], 10) - 1;
                                else if ("text" === a) n = parseInt(r[1], 10) + 1;
                                else {
                                    if ("accent" !== a) throw "invalid color name.";
                                    n = parseInt(r[1], 10) + 3
                                }
                                o = r[0] + " " + r[1]
                            } else if (1 === r.length) {
                                if (void 0 === r[0] || null === r[0]) throw "invalid color name.";
                                if ("transparent" === (s = r[0].toLowerCase())) return { color: "rgba(0,0,0,0)" };
                                if ("hyperlink" !== s && "followedHyperlink" !== s) throw "invalid color name.";
                                o = r[0]
                            }
                            if (l = 0, r.length > 2 && (l = parseInt(r[2], 10)), n >= 0 && n <= 11) return { name: t, baseColor: i.getColor(o), tint: l, color: i.getColor(t) }
                        }
                        throw "invalid color name."
                    }, e.rrggbbPattern = /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i, e.rgbPattern = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i, e.rgbFunctionPattern = /^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i, e.rgbaFunctionPattern = /^rgba\(\d+, *\d+, *\d+, *\d+\.?\d*\)$/i, e.standardColorNames = ["aliceblue", "antiquewhite", "aqua", "aquamarine", "azure", "beige", "bisque", "black", "blanchedalmond", "blue", "blueviolet", "brown", "burlywood", "cadetblue", "chartreuse", "chocolate", "coral", "cornflowerblue", "cornsilk", "crimson", "cyan", "darkblue", "darkcyan", "darkgoldenrod", "darkgray", "darkgreen", "darkkhaki", "darkmagenta", "darkolivegreen", "darkorange", "darkorchid", "darkred", "darksalmon", "darkseagreen", "darkslateblue", "darkslategray", "darkturquoise", "darkviolet", "deeppink", "deepskyblue", "dimgray", "dodgerblue", "firebrick", "floralwhite", "forestgreen", "fuchsia", "gainsboro", "ghostwhite", "gold", "goldenrod", "gray", "green", "greenyellow", "honeydew", "hotpink", "indianred?", "indigo?", "ivory", "khaki", "lavender", "lavenderblush", "lawngreen", "lemonchiffon", "lightblue", "lightcoral", "lightcyan", "lightgoldenrodyellow", "lightgray", "lightgreen", "lightpink", "lightsalmon", "lightseagreen", "lightskyblue", "lightslategray", "lightsteelblue", "lightyellow", "lime", "limegreen", "linen", "magenta", "maroon", "mediumaquamarine", "mediumblue", "mediumorchid", "mediumpurple", "mediumseagreen", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "mintcream", "mistyrose", "moccasin", "navajowhite", "navy", "oldlace", "olive", "olivedrab", "orange", "orangered", "orchid", "palegoldenrod", "palegreen", "paleturquoise", "palevioletred", "papayawhip", "peachpuff", "peru", "pink", "plum", "powderblue", "purple", "red", "rosybrown", "royalblue", "saddlebrown", "salmon", "sandybrown", "seagreen", "seashell", "sienna", "silver", "skyblue", "slateblue", "slategray", "snow", "springgreen", "steelblue", "tan", "teal", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "whitesmoke", "yellow", "yellowgreen"], e
                }();
            e.ColorHelper = t
        }()
    }, function(e, t) {
        ! function() {
            "use strict";
            var e, t, i, o, n, r = GC.Spread.Sheets.Designer,
                a = GC.Spread.Sheets,
                s = void 0;
            r.PrimitiveTypes = { STRING: "string", NUMBER: "number", BOOLEAN: "boolean", OBJECT: "object", FUNCTION: "function", UNDEFINED: "undefined" }, e = function() {
                function e(e, t, i) { this.uo = e, this.vo = t, this.wo = i }
                return e.prototype.xo = function(e) {
                    var t, i = this.vo.properties[e],
                        o = i.getter;
                    if (void 0 !== o) {
                        if (typeof o === r.PrimitiveTypes.STRING) {
                            if (typeof(t = this.uo[o]) !== r.PrimitiveTypes.FUNCTION) throw 'metadata invalide. source object "' + this.uo + '" have no a function named "' + o + '".';
                            o = t
                        }
                        if (typeof o !== r.PrimitiveTypes.FUNCTION) throw 'metadata invalide. expect a "function" for getter of property "' + e + '" of type "' + this.vo + '", but actual is a "' + typeof o + '"'
                    } else typeof(o = this.uo[e]) !== r.PrimitiveTypes.FUNCTION && (o = function() { return this[e] });
                    return o.apply(this.uo)
                }, e.prototype.yo = function(t, i) {
                    var o, n = this.vo.properties[t],
                        a = n.setter;
                    if (void 0 !== a) {
                        if (typeof a === r.PrimitiveTypes.STRING) {
                            if (typeof(o = this.uo[a]) !== r.PrimitiveTypes.FUNCTION) throw 'metadata invalide. source object "' + this.uo + '" have no a function named "' + a + '".';
                            a = o
                        }
                        if (typeof a !== r.PrimitiveTypes.FUNCTION) throw 'metadata invalide. expect a "function" for setter of property "' + t + '" of type "' + this.vo + '", but actual is a "' + typeof a + '"'
                    } else typeof(a = this.uo[t]) !== r.PrimitiveTypes.FUNCTION && (a = function(e) { this[t] = e });
                    typeof i !== n.type && (i = e.zo(i, n.type)), a.call(this.uo, i)
                }, e.zo = function(e, t) {
                    if (void 0 === e || null === e) return e;
                    switch (t) {
                        case r.PrimitiveTypes.NUMBER:
                            return parseFloat(e);
                        case r.PrimitiveTypes.BOOLEAN:
                            return !!e;
                        case r.PrimitiveTypes.STRING:
                            return "" + e;
                        default:
                            return e
                    }
                }, e.prototype.Ao = function() {
                    var e = this;
                    Object.getOwnPropertyNames(this.vo.properties).forEach(function(t) { e[t] = e.Bo(t) })
                }, e.prototype.Bo = function() { throw "not implemented." }, e.undefinedValue = {}, e.indeterminateValue = {}, e
            }(), r.BaseMetaObject = e, t = function(t) {
                r.extends(i, t);

                function i(e, i, o) { t.call(this, e, i, o), this.Co = {}, this.Ao() }
                return i.prototype.hi = function(t, o) {
                    var n, r;
                    if (void 0 === o) { if (void 0 === (o = this.Co[t])) return o = this.xo(t), n = this.wo[this.vo.properties[t].type], void 0 !== n && (o = this.Co[t] = new i(o, n, this.wo)), o; if (o === e.undefinedValue) return; return o }
                    return r = this.vo.properties[t].type,
                        typeof o !== r && (o = e.zo(o, r)), this.Co[t] = o, $(this).trigger($.Event("change", { property: t })), this
                }, i.prototype.reset = function(e) { this.Co[e] = s }, i.prototype.commit = function() {
                    var t = this;
                    Object.getOwnPropertyNames(this.Co).forEach(function(o) {
                        var n = t.Co[o];
                        if (void 0 !== n) {
                            if (n instanceof i) return void n.commit();
                            n === e.undefinedValue && (n = s), t.yo(o, n)
                        }
                    })
                }, i.prototype.Bo = function(e) { return this.hi.bind(this, e) }, i
            }(e), i = function(t) {
                r.extends(i, t);

                function i(e, i, o) { t.call(this, e, i, o), this.Ao() }
                return i.prototype.Bo = function(t) {
                    var o = this,
                        n = this.wo[this.vo.properties[t].type];
                    return function(r) { var a, s; if (void 0 === r) return a = o.xo(t), void 0 !== n ? new i(a, n, o.wo) : a; if (void 0 !== n) throw "Complex property don't support set."; return s = o.vo.properties[t].type, typeof r !== s && (r = e.zo(r, s)), o.yo(t, r), $(o).trigger($.Event("change", { property: t })), this }
                }, i
            }(e), o = function(t) {
                r.extends(i, t);

                function i(e, i, o) { t.call(this, e, i, o), this.Co = {}, this.Ao() }
                return i.prototype.reset = function(e) { this.Co[e] = s }, i.prototype.commit = function() {
                    var t = this;
                    Object.getOwnPropertyNames(this.Co).forEach(function(o) {
                        var n = t.Co[o];
                        if (void 0 !== n) {
                            if (n instanceof i) return void n.commit();
                            n === e.undefinedValue && (n = s), t.yo(o, n)
                        }
                    })
                }, i.prototype.Bo = function(t) {
                    var i = this,
                        o = this.vo.properties[t];
                    return ko.computed({
                        read: function() { var o = i.Co[t]; return void 0 === o ? i.xo(t) : o === e.undefinedValue ? void 0 : o },
                        write: function(n) {
                            var r = n;
                            void 0 === r ? r = e.undefinedValue : typeof r !== o.type && (r = e.zo(r, o.type)), i.Co[t] = r
                        }
                    })
                }, i
            }(e), n = function() {
                function e(e) { this.wo = e }
                return e.prototype.genWrapper = function(t, o) { var n, r = t[e.internalWrapper]; return void 0 !== r ? r : void 0 === (n = this.wo[o]) ? t : (r = new i(t, n, this.wo), t[e.internalWrapper] = r, r) }, e.prototype.genShadow = function(e, i) { var o = this.wo[i]; return void 0 === o ? e : new t(e, o, this.wo) }, e.prototype.genKoShadow = function(e, t) { var i = this.wo[t]; return void 0 === i ? e : new o(e, i, this.wo) }, e.internalWrapper = "__gc_metadata_wrapper", e
            }(), r.MetaFactor = n
        }()
    }, function(e, t, i) {
        var o = GC.Spread.Sheets,
            n = o.Designer,
            r = o.Charts,
            a = i(1),
            s = o.CalcEngine.formulaToRange,
            l = r.Chart,
            c = n.ColorHelper;
        ! function(e) {
            "use strict";
            var t, i, o, r, l, d, p, u, h, f, g = null,
                m = void 0,
                b = 6,
                v = 2;
            e.clipboard = {};

            function y(e) { console.warn("SpreadDesigner: ", e) } e.warn = y;

            function w(e) { console.error("SpreadDesigner: ", e) } e.error = w;

            function x(e, t) { if (!e) throw "SpreadDeisgner Assertion: " + t } e.assert = x;

            function C(e) { var t, i, o = []; for (i = 0; i < arguments.length - 1; i++) o[i] = arguments[i + 1]; return 1 === o.length && "object" == typeof o[0] ? (t = /{([^{}]+)}/gm, e.replace(t, function(e, t) { return o[0][t] })) : (t = /{(\d+)}/gm, e.replace(t, function(e, t) { return o[~~t] })) } e.format = C;

            function S(e) { e.preventDefault ? (e.preventDefault(), e.stopPropagation()) : (e.cancelBubble = !1, e.returnValue = !1) } e.cancelDefault = S;

            function k(e) {
                var t = e.getHost(),
                    i = t.id;
                return i ? document.getElementById(i + "vp_vp") : $(t).find("canvas[id='vp_vp']")[0]
            }
            e.getCanvas = k;

            function T() { return document.getElementById(n.wrapper.spread.getHost().id + "_tabStrip") } e.getTabStripCanvas = T;

            function A(e, t, i) {
                var o, n, r, a;
                if (e && (o = e.getSelections()))
                    for (n = 0, r = o.length; n < r; n++)
                        if (a = o[n], a.contains(t, i)) return a;
                return g
            }
            e.findSelection = A, t = { UppercaseLetter: 0, LowercaseLetter: 1, DecimalDigitNumber: 8, OtherNumber: 10, SpaceSeparator: 11, Control: 14, ConnectorPunctuation: 18, DashPunctuation: 19, OpenPunctuation: 20, ClosePunctuation: 21, InitialQuotePunctuation: 22, FinalQuotePunctuation: 23, OtherPunctuation: 24, MathSymbol: 25, currencySymbol: 26, ModifierSymbol: 27, OtherSymbol: 28 }, i = [14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 11, 24, 24, 24, 26, 24, 24, 24, 20, 21, 24, 25, 24, 19, 24, 24, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 24, 24, 25, 25, 25, 24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 24, 21, 27, 18, 27, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 20, 25, 21, 25, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 11, 24, 26, 26, 26, 26, 28, 28, 27, 28, 1, 22, 25, 19, 28, 27, 28, 25, 10, 10, 27, 1, 28, 24, 27, 10, 1, 23, 10, 10, 10, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 25, 1, 1, 1, 1, 1, 1, 1, 1];

            function E(e) { n.util.triggerDesignerEvent("chartChanged", e) }

            function I(e) { return e <= 255 }

            function D(e) { return e <= 127 }

            function L(e) { var t = e.charCodeAt(0); return t >= 48 && t <= 57 }

            function F(e) { var o = e.charCodeAt(0); return !I(o) || (D(o) ? (o |= 32) >= 96 && o <= 122 : i[o] === t.UppercaseLetter || i[o] === t.LowercaseLetter) }

            function R(e) { var o = e.charCodeAt(0); return !I(o) || (D(o) ? o <= 57 ? o >= 48 : (o |= 32) >= 96 && o <= 122 : i[o] === t.UppercaseLetter || i[o] === t.LowercaseLetter) }

            function B(e) { var o = e.charCodeAt(0); return !!I(o) && (i[o] === t.MathSymbol || i[o] === t.currencySymbol || i[o] === t.ModifierSymbol || i[o] === t.OtherSymbol) }

            function O(e) { var o = e.charCodeAt(0); return D(o) ? o >= 48 && o <= 57 : i[o] === t.DecimalDigitNumber || i[o] === t.OtherNumber }

            function P(e) {
                var t, i, o;
                if (e === m || e === g || "" === e) return !1;
                if (1 === (t = e.length) && ("R" === e || "r" === e || "C" === e || "c" === e)) return !1;
                if ("_" !== (i = e.charAt(0)) && "\\" !== i && !F(i) && !B(i)) return !1;
                for (o = 1; o < t; o++)
                    if ("_" !== (i = e.charAt(o)) && "\\" !== i && "?" !== i && "." !== i && !R(i) && !B(i)) return !1;
                return !0
            }
            e.isValidateName = P, o = "\\+-*/^&=><: ,";

            function N(e, t, i) {
                var n, r, a;
                if (e === m || e === g || "" === e) return !0;
                if (!i && L(e.charAt(0))) return !1;
                if (n = z(e, t), !i && n.success && n.endIndex === e.length) return !1;
                for (a = 0; a < e.length; a++)
                    if (r = e.charAt(a), i) { if ("*" === r || ":" === r || "[" === r || "]" === r || "?" === r || "\\" === r || "/" === r) return !1 } else if ("'" === r || "[" === r || "]" === r || "?" === r || "\\" === r || "%" === r || '"' === r || -1 !== o.indexOf(r)) return !1;
                return !0
            }
            e.isValidateSheetName = N;

            function z(e, t) { return t ? V(e) : M(e) } r = -2147483648, l = 16384, d = 1048576, p = [1, 26, 676];

            function M(e) {
                var t, i, o, n, a, s, l, c, d = r,
                    p = { startRow: d, startColumn: d, endRow: d, endColumn: d, startRowRelative: !0, startColumnRelative: !0, endRowRelative: !0, endColumnRelative: !0, success: !1, endIndex: 0 };
                return e = e.replace(" ", ""), t = e.length, i = G(e, 0), p.endIndex = i.endIndex, !i.success || p.endIndex > t ? p : i.isRow ? (p.startRow = i.elementIndex, p.startRowRelative = i.isRelative, ":" === e.charAt(p.endIndex) ? (p.endIndex++, o = G(e, p.endIndex), p.endIndex = o.endIndex, o.success && o.isRow ? (p.endRow = o.elementIndex, p.endRowRelative = o.isRelative, p.success = !0, p) : p) : p) : (p.startColumn = i.elementIndex, p.startColumnRelative = i.isRelative, ":" === e.charAt(p.endIndex) ? (p.endIndex++, o = G(e, p.endIndex), p.endIndex = o.endIndex, !o.success || o.isRow ? p : (p.endColumn = o.elementIndex, p.endColumnRelative = o.isRelative, p.success = !0, p)) : O(e.charAt(p.endIndex)) || "$" === e.charAt(p.endIndex) ? (o = G(e, p.endIndex), p.endIndex = o.endIndex, o.success && o.isRow ? (p.startRow = o.elementIndex, p.startRowRelative = o.isRelative, n = p.endIndex, p.endIndex < t - 1 && ":" === e.charAt(p.endIndex) ? "'" === e.charAt(p.endIndex + 1) ? (p.success = !0, p) : (a = e.indexOf("!", p.endIndex + 1), s = e.indexOf(":", p.endIndex + 1), -1 !== a && (-1 === s || s > a) ? (p.success = !0, p) : (p.endIndex++, l = G(e, p.endIndex), !l.success || l.isRow ? (p.endIndex = n, p.success = !0, p) : (p.endIndex = l.endIndex, p.endColumn = l.elementIndex, p.endColumnRelative = l.isRelative, c = G(e, p.endIndex), c.success && c.isRow ? (p.endIndex = c.endIndex, p.endRow = c.elementIndex, p.endRowRelative = c.isRelative, p.success = !0, p) : (p.endIndex = n, p.endColumn = d, p.success = !0, p)))) : (p.success = !0, p)) : p) : p)
            }

            function V(e, t, i) {
                var o, n, a, s, l, c, d, p, u = r,
                    h = { startRow: u, startColumn: u, endRow: u, endColumn: u, startRowRelative: !0, startColumnRelative: !0, endRowRelative: !0, endColumnRelative: !0, success: !1, endIndex: 0 };
                return e = e.replace(" ", ""), o = e.length, n = j(e, t, i, 0), h.endIndex = n.endIndex, n.success ? n.isRow ? (h.startRow = n.elementIndex, h.startRowRelative = n.isRelative, h.endIndex >= o ? (h.success = !0, h) : ":" === e.charAt(h.endIndex) ? (h.endIndex++, a = j(e, t, i, h.endIndex), h.endIndex = a.endIndex, a.success && a.isRow ? (h.endRow = a.elementIndex, h.endRowRelative = a.isRelative, h.success = !0, h) : h) : "C" === e.charAt(h.endIndex) || "c" === e.charAt(h.endIndex) ? (a = j(e, t, i, h.endIndex), h.endIndex = a.endIndex, !a.success || a.isRow ? h : (h.startColumn = a.elementIndex, h.startColumnRelative = a.isRelative, s = h.endIndex, h.endIndex < o - 1 && ":" === e.charAt(h.endIndex) ? "'" === e.charAt(h.endIndex + 1) ? (h.success = !0, h) : (l = e.indexOf("!", h.endIndex + 1), c = e.indexOf(":", h.endIndex + 1), -1 !== l && (-1 === c || c > l) ? (h.success = !0, h) : (h.endIndex++, d = j(e, t, i, h.endIndex), d.success && d.isRow ? (h.endIndex = d.endIndex, h.endRow = d.elementIndex, h.endRowRelative = d.isRelative, p = j(e, t, i, h.endIndex), !p.success || p.isRow ? (h.endIndex = s, h.success = !0, h) : (h.endIndex = p.endIndex, h.endColumn = p.elementIndex, h.endColumnRelative = p.isRelative, h.success = !0, h)) : (h.endIndex = s, h.success = !0, h))) : (h.success = !0, h))) : h) : (h.startColumn = n.elementIndex, h.startColumnRelative = n.isRelative, h.endIndex >= o ? (h.success = !0, h) : ":" === e.charAt(h.endIndex) ? (h.endIndex++, a = j(e, t, i, h.endIndex), h.endIndex = a.endIndex, !a.success || a.isRow ? h : (h.endColumn = a.elementIndex, h.endColumnRelative = a.isRelative, h.success = !0, h)) : h) : h
            }

            function G(e, t) {
                var i, o, n, a, s, c = r,
                    u = { endIndex: t, elementIndex: c, isRow: !0, isRelative: !0, success: !1 },
                    h = e.length;
                if (t >= h) return u;
                if ("$" === e.charAt(t) && (u.isRelative = !1, t++), t >= h) return u;
                if (i = t, n = e.charAt(i), O(n) && "0" !== n) { for (u.isRow = !0; i < h && O(n);) ++i < h && (n = e.charAt(i)); if ((o = parseInt(e.substr(t, i - t), 10)) >= 1 && o <= d) return u.elementIndex = o - 1, u.endIndex = i, u.success = !0, u } else if (F(n)) { for (u.isRow = !1; i < h && F(n);) ++i < h && (n = e.charAt(i)); if (a = e.substr(t, i - t), a.length > 3) return u; for (a = a.toUpperCase(), o = 0, s = a.length - 1; s >= 0; s--) o += (a.charCodeAt(s) - 65 + 1) * p[a.length - s - 1]; if (o <= l) return u.elementIndex = o - 1, u.endIndex = i, u.success = !0, u }
                return u
            }

            function j(e, t, i, o) {
                var n, a, s, c, p, u = r,
                    h = { endIndex: o, elementIndex: u, isRow: !0, isRelative: !1, success: !1 },
                    f = e.length;
                if (o >= f) return h;
                if (n = o, "R" === (a = e.charAt(n)) || "r" === a) h.isRow = !0, s = t;
                else {
                    if ("C" !== a && "c" !== a) return h;
                    h.isRow = !1, s = i
                }
                if (o++, n++, o >= f) return h.endIndex = o, h.elementIndex = s, h.isRelative = !0, h.success = !0, h;
                if (a = e.charAt(n), "[" === a && (o++, n++, h.isRelative = !0), o >= f) return h;
                if (c = !1, a = e.charAt(n), h.isRelative && "-" === a && (o++, n++, c = !0), o >= f) return h;
                if (a = e.charAt(n), !O(a)) return h.isRelative ? h : (h.endIndex = o, h.elementIndex = s, h.isRelative = !0, h.success = !0, h);
                for (; n < f && O(a);) ++n < f && (a = e.charAt(n));
                if (p = parseInt(e.substr(o, n - o), 10), h.isRelative) {
                    if (n >= f || "]" !== e.charAt(n)) return h;
                    n++
                }
                return p < (h.isRow ? d : l) ? (h.isRelative ? (p = c ? -p : p, h.elementIndex = p + s) : h.elementIndex = p - 1, h.endIndex = n, h.success = !0, h) : void 0
            }

            function H(e, t) {
                var i, o, n, r, a = GC.Spread.CalcEngine.Functions.findGlobalFunction(e);
                if (a) {
                    for (i = [], o = t.length, n = 0; n < o; n++) {
                        if (!((r = t[n]) instanceof GC.Spread.Sheets.Range)) return g;
                        i[n] = U(r.row, r.col, r.row + r.rowCount - 1, r.col + r.colCount - 1)
                    }
                    return W(a, i)
                }
                return g
            }

            function W(e, t) { var i = new GC.Spread.CalcEngine.Expression(7); return i.function = e, i.arguments = t, i.functionName = e.name, i }

            function U(e, t, i, o, n, a, s, l) {
                var c = new GC.Spread.CalcEngine.Expression(1),
                    d;
                return c.isFullRow = t === r, c.isFullColumn = e === r, e > i && (d = e, e = i, i = d, d = n, n = s, s = d), t > o && (d = t, t = o, o = d, d = a, a = l, l = d), c.row = e, c.column = t, c.endRow = i, c.endColumn = o, c.rowRelative = n, c.columnRelative = a, c.endRowRelative = s, c.endColumnRelative = l, c
            }
            e.createStatisticalExpression = H;

            function q(e, t, i) { e && n.wrapper.spreadElement.trigger(t, i) } e.triggerSheetEvent = q;

            function _(e, t) { $(n).trigger(e, t) } e.triggerDesignerEvent = _;

            function K(e, t) { $(n).bind(e, t) } e.bindDesignerEvent = K;

            function X(e, t, i) { var o = $.Deferred(); return $.get(e).done(function(e) { i.empty(), i.append($("<div></div>").append($.parseHTML(e)).find(t)), o.resolve(i) }).fail(function(e, t) { i.empty(), i.append($("<div></div>").addClass("error").text("Loading failed with error: " + t)), o.reject([e, t]) }), o } e.loadHtml = X;

            function J(e) {
                var t, i, o = $.Deferred();
                if (0 !== $('script[src="' + e + '"]').length) return void o.resolve();
                t = document.createElement("script"), t.type = "text/javascript", t.charset = "utf-8", t.async = !0;

                function n() { o.resolve() }

                function r() { o.reject() }
                return !t.attachEvent || t.attachEvent.toString && ("" + t.attachEvent).indexOf("[native code") < 0 || "undefined" != typeof opera && "" + opera == "[object Opera]" ? (t.addEventListener("load", n, !1), t.addEventListener("error", r, !1)) : t.attachEvent("onreadystatechange", n), t.src = e, i = document.getElementsByTagName("head")[0], i.appendChild(t), o
            }
            e.loadScript = J;

            function Y(e) { var t, i = $.Deferred(); return 0 === $('link[href="' + e + '"]').length && (t = $("<link>"), t.attr("href", e), t.attr("type", "text/css"), t.attr("rel", "stylesheet"), $("head").append(t)), i.resolve(), i } e.loadCss = Y, e.resolveHtmlPath = function(e, t) { return location.pathname.indexOf("/content/") >= 0 ? t : e + "/" + t };

            function Q(e) {
                for (var t, i, o = null, n = null, r = "normal", a = "normal", s = "normal", l = "normal", c = e.split(/\s+/); t = c.shift();) switch (t) {
                    case "normal":
                        break;
                    case "italic":
                    case "oblique":
                        r = t;
                        break;
                    case "small-caps":
                        s = t;
                        break;
                    case "bold":
                    case "bolder":
                    case "lighter":
                    case "100":
                    case "200":
                    case "300":
                    case "400":
                    case "500":
                    case "600":
                    case "700":
                    case "800":
                    case "900":
                        a = t;
                        break;
                    default:
                        if (!n) { i = t.split("/"), n = i[0], -1 !== n.indexOf("px") && (n = ee(parseFloat(n)) + "pt"), i.length > 1 && (l = i[1], -1 !== l.indexOf("px") && (l = ee(parseFloat(l)) + "pt")); break }
                        return o = t, c.length && (o += " " + c.join(" ")), { fontStyle: r, fontVariant: s, fontWeight: a, fontSize: n, lineHeight: l, fontFamily: o }
                }
                return { fontStyle: r, fontVariant: s, fontWeight: a, fontSize: n, lineHeight: l, fontFamily: o }
            }
            e.parseFont = Q;

            function Z(e) { var t, i, o, n, r = [0, 0, 0, 0]; return e && "string" == typeof e ? (t = e.split(" ", 4), i = t.length, 1 === i ? (o = t[0], r = [o, o, o, o]) : 2 === i ? (o = t[0], n = t[1], r = [o, n, o, n]) : 3 === i ? (n = t[1], r = [t[0], n, t[2], n]) : 4 === i && (r = [t[0], t[1], t[2], t[3]]), r) : r } e.parsePadding = Z, u = $("<span></span>");

            function ee(e) { var t, i; return u.css({ "font-size": "96pt", display: "none" }), u.appendTo($(document.body)), t = u.css("font-size"), -1 !== t.indexOf("px") ? (i = parseFloat(t), Math.round(96 * e / i)) : Math.round(72 * e / 96) } e.px2pt = ee;

            function te(e) { var t = n.wrapper.spread.getActiveSheet().currentTheme(); if (t && e) { if ("Body" === e) return t.bodyFont(); if ("Headings" === e) return t.headerFont() } return null } e.getThemeFont = te;

            function ie(e) { var t = ""; if (0 !== e) return 1 & e && (t += "underline "), 2 & e && (t += "line-through "), 4 & e && (t += "overline "), t } e.toCSSTextDecoration = ie;

            function oe(e, t) {
                var i, o, r, a, s = n.wrapper.spread.getActiveSheet();
                if (!s) return null;
                if (!(i = s.getFormula(e, t))) return null;
                o = s.getCalcService();
                try { if (r = o.parse(null, i, e, t), r.type === GC.Spread.CalcEngine.ExpressionType.function && (a = r.functionName) && n.wrapper.spread.getSparklineEx(a)) return r } catch (e) {}
                return null
            }
            e.parseFormulaSparkline = oe;

            function ne(e, t, i) { var o, r = n.wrapper.spread.getActiveSheet(); return r ? (o = r.getCalcService(), o.unparse(null, e, t, i)) : null } e.unParseFormula = ne, e.DataFieldType = { checkbox: "checkbox", hyperlink: "hyperlink", combox: "combox", button: "button", text: "text", table: "table" }, e.BasicDataType = { Array: "array", Boolean: "boolean", Integer: "integer", Number: "number", Null: "null", Object: "object", String: "string" }, e.DefaultTypeDic = { array: e.DataFieldType.table, boolean: e.DataFieldType.checkbox, integer: e.DataFieldType.text, number: e.DataFieldType.text, null: e.DataFieldType.text, object: e.DataFieldType.text, string: e.DataFieldType.text }, e.DefaultDataFieldTypeDic = { checkbox: e.BasicDataType.Boolean, hyperlink: e.BasicDataType.String, combox: e.BasicDataType.String, button: e.BasicDataType.String, text: e.BasicDataType.String, table: e.BasicDataType.Array };

            function re(e) { var t, i, o; return e.$schema ? (t = [], i = $.extend({}, e), o = i.definitions, ae(o, e, !0), ae(i, e, !1), se(i, t), t) : null } e.parseJsonSchema = re, h = [];

            function ae(e, t, i) {
                var o, n, r, a, s, l, c, d;
                if (e) {
                    if ((o = e.$ref) && "string" == typeof o) {
                        if (0 === o.indexOf("#")) {
                            for (r = o.split("/"), a = r.length, s = $.extend({}, t), l = 1; l < a && s; l++) s = s[r[l]];
                            s && (n = s)
                        }
                        if (n) {
                            if (-1 !== h.join("/").indexOf(o)) return;
                            delete e.$ref, $.extend(e, n)
                        }
                    }
                    if (e.properties) h.push("properties"), ae(e.properties, t);
                    else
                        for (c in e)
                            if ("patternProperties" !== c && "allOf" !== c && "anyOf" !== c && "oneOf" !== c && "not" !== c && e.hasOwnProperty(c) && "object" == typeof e[c]) {
                                if (i && (h = ["#", "definitions"]), -1 !== h.indexOf(c) && (d = "#/definitions/" + c, -1 !== h.join("/").indexOf(d))) return;
                                h.push(c), ae(e[c], t)
                            }
                }
            }

            function se(e, t) {
                var i, o, n, r, a, s, l, c;
                if (e && (e.properties || e.items || e.definitions)) {
                    i = {}, e.items && (i.items = e.items), e.properties && (i.properties = e.properties), e.definitions && (i.definitions = e.definitions);
                    for (o in i)
                        if (i.hasOwnProperty(o)) {
                            n = i[o];
                            for (r in n)
                                if (n.hasOwnProperty(r)) {
                                    if (a = {}, a.name = r, "object" == typeof n[r]) {
                                        if (n[r].type && (a.type = n[r].type), n[r].dataFieldType && (a.dataFieldType = n[r].dataFieldType), n[r].enum)
                                            for (s = n[r].enum, a.enum = s, a.children = [], l = s.length, c = 0; c < l; c++) a.children.push({ name: s[c] });
                                        n[r].properties && (a.children = [], se(n[r], a.children)), n[r].items && (a.children = [], se(n[r].items, a.children))
                                    }
                                    t.push(a)
                                }
                        }
                }
            }

            function le(t) { if (t.constructor === Array.prototype.constructor) { var i = {}; return i.$schema = "http://json-schema.org/draft-04/schema#", i.properties = {}, i.type = e.BasicDataType.Object, ce(t, i.properties), i } } e.saveJSONSchema = le;

            function ce(t, i) {
                var o, n, r, a, s, l, c, d = t.length;
                if (d)
                    for (o = 0; o < d; o++) n = t[o], r = n.name, a = n.type, s = n.dataFieldType, l = n.children, c = n.enum, r && (i[r] || (i[r] = {}), s && (i[r].dataFieldType = s, a || (a = e.DefaultDataFieldTypeDic[s])), i[r].type = a || e.BasicDataType.String, c && (i[r].enum = c), l && !c && (a || (i[r].type = e.BasicDataType.Object), a === e.BasicDataType.Array ? (i[r].items || (i[r].items = {}), i[r].items.type = e.BasicDataType.Object, i[r].items.properties || (i[r].items.properties = {}), ce(l, i[r].items.properties)) : (i[r].properties || (i[r].properties = {}), ce(l, i[r].properties))))
            }

            function de(e, t, i, o, n) {
                var r, a, s, l, c, d;
                for (r = 0, a = t.length; r < a; r++)
                    if (s = t[r], i > s.row && i < s.row + s.rowCount && (l = e.getStyle(s.row, s.col, n)))
                        for (c = i; c < i + o; c++)
                            for (d = s.col; d < s.col + s.colCount; d++) e.setStyle(c, d, l, n)
            }

            function pe(e, t, i, o, n) {
                var r, a, s, l, c, d;
                for (r = 0, a = t.length; r < a; r++)
                    if (s = t[r], i > s.col && i < s.col + s.colCount && (l = e.getStyle(s.row, s.col, n)))
                        for (c = i; c < i + o; c++)
                            for (d = s.row; d < s.row + s.rowCount; d++) e.setStyle(d, c, l, n)
            }

            function ue(e, t, i, o) {
                if (e) {
                    var n = e.getSpans(void 0, 3);
                    t >= 0 ? (de(e, n, t, o, 3), de(e, e.getSpans(void 0, 2), t, o, 2)) : i >= 0 && (pe(e, n, i, o, 3), pe(e, e.getSpans(void 0, 1), i, o, 1))
                }
            }
            e.setSpanStyleWhenInsertRowsColumns = ue;

            function he(e) { if (!$.isNumeric(e)) return 0; var t = parseFloat(e); return Math.round(t) } e.formatNumber = he;

            function fe(e) {
                var t, i, o;
                if (!e) return null;
                if (!(t = e.slicers.all()) || $.isEmptyObject(t)) return null;
                i = [];
                for (o in t) t[o].isSelected() && i.push(t[o]);
                return i
            }
            e.getSelectedSlicers = fe;

            function ge(e, t) { e <= 0 && (e = 1); var i = Math.round((t - 2 * b - (e - 1) * v) / e); return i < 0 ? 0 : i } e.getSlicerItemWidth = ge;

            function me(e, t) { return e <= 0 && (e = 1), Math.round(t * e + (e - 1) * v + 2 * b) } e.getSlicerWidthFromItem = me;

            function be(t) { if (!t) return !1; var i = e.getSelectedSlicers(t); return !(!i || 0 === i.length) } e.isSlicerSelected = be;

            function ve(e) { return e.substr(4).split(",").map(function(e) { return parseInt(e) }) } e.parseColorString = ve;

            function ye(e, t) { var i, o = n.Gi; return o || (o = n.Gi = {}), i = o[e], i || (i = o[e] = t()), i } e.getFromCache = ye;

            function we(e) { return e.split(" ")[2] || 0 }

            function xe(e, t) { var i = e.split(" "); return i[2] = t, i.join(" ") } f = {
                chartTypeDict: { 0: { chartType: "combo", chartGroup: "ComboGroup" }, 1: { chartType: "xyScatter", chartGroup: "ScatterGroup" }, 2: { chartType: "radar", chartGroup: "RadarGroup" }, 3: { chartType: "doughnut", chartGroup: "PieGroup" }, 8: { chartType: "area", chartGroup: "AreaGroup" }, 9: { chartType: "line", chartGroup: "LineGroup" }, 10: { chartType: "pie", chartGroup: "PieGroup" }, 11: { chartType: "bubble", chartGroup: "ScatterGroup" }, 12: { chartType: "columnClustered", chartGroup: "ColumnGroup" }, 13: { chartType: "columnStacked", chartGroup: "ColumnGroup" }, 14: { chartType: "columnStacked100", chartGroup: "ColumnGroup" }, 18: { chartType: "barClustered", chartGroup: "BarGroup" }, 19: { chartType: "barStacked", chartGroup: "BarGroup" }, 20: { chartType: "barStacked100", chartGroup: "BarGroup" }, 24: { chartType: "lineStacked", chartGroup: "LineGroup" }, 25: { chartType: "lineStacked100", chartGroup: "LineGroup" }, 26: { chartType: "lineMarkers", chartGroup: "LineGroup" }, 27: { chartType: "lineMarkersStacked", chartGroup: "LineGroup" }, 28: { chartType: "lineMarkersStacked100", chartGroup: "LineGroup" }, 33: { chartType: "xyScatterSmooth", chartGroup: "ScatterGroup" }, 34: { chartType: "xyScatterSmoothNoMarkers", chartGroup: "ScatterGroup" }, 35: { chartType: "xyScatterLines", chartGroup: "ScatterGroup" }, 36: { chartType: "xyScatterLinesNoMarkers", chartGroup: "ScatterGroup" }, 37: { chartType: "areaStacked", chartGroup: "AreaGroup" }, 38: { chartType: "areaStacked100", chartGroup: "AreaGroup" }, 42: { chartType: "radarMarkers", chartGroup: "RadarGroup" }, 43: { chartType: "radarFilled", chartGroup: "RadarGroup" }, 49: { chartType: "stockHLC", chartGroup: "StockGroup" }, 50: { chartType: "stockOHLC", chartGroup: "StockGroup" }, 51: { chartType: "stockVHLC", chartGroup: "StockGroup" }, 52: { chartType: "stockVOHLC", chartGroup: "StockGroup" }, 57: { chartType: "sunburst", chartGroup: "SunburstGroup" }, 58: { chartType: "treemap", chartGroup: "TreemapGroup" } },
                getChartGroupString: function(e) { var t = this.chartTypeDict[e]; if (t && t.chartGroup) return t.chartGroup },
                getChartTypeString: function(e) { var t = this.chartTypeDict[e]; if (t && t.chartType) return t.chartType },
                getGradientThemeColor: function(e, t, i, o) { var n, r, a, s, l; if (0 === o) return e; if (o === i - 1) return t; if (n = parseFloat(we(e)), r = parseFloat(we(t)), a = (r - n) / (i - 1), s = 0, o !== m) return s = n + a * o, xe(e, s); for (l = [], l.push(e), o = 1; o < i - 1; o++) s = n + a * o, l.push(xe(e, s)); return l.push(t), l },
                getSelectedChart: function(e) {
                    var t, i, o = e.charts,
                        n = o.all();
                    for (t = 0; t < n.length; t++)
                        if (i = n[t], i.isSelected()) return i
                },
                resetChartsFocus: function(e) {
                    var t, i = e.charts.all();
                    if (i && i.length > 0)
                        for (t = 0; t < i.length; t++) i[t].isSelected(!1)
                },
                applyChartSeriesTheme: function(e, t) {
                    var i, o, n, r, s, l, c, d, p = this,
                        u = t.group || "colorful",
                        h = t.index || 0,
                        g = a.chartColors,
                        m = g[u].colors[h].items,
                        b = GC.Spread.Sheets.Charts.ChartType,
                        v = e.series(),
                        y = v.get(),
                        w = y.length;
                    if (e.chartType() === b.sunburst || e.chartType() === b.treemap)
                        for (n = v.dataPoints(), r = n.get().length, i = 0; i < r; i++) o = p.generateColor(m, r, i), s = n.get()[i], s.fillColor = o, n.transparency = 1, n.set(i, s);
                    else
                        for (i = 0; i < w; i++) l = y[i], e.chartType() === b.pie || e.chartType() === b.doughnut ? (c = f.getPieColorArray(l.backColor)) && c.length > 0 && (d = c.length, o = p.generateColor(m, d).join(",")) : o = p.generateColor(m, w, i), t.type ? "backColor" !== t.type || f.isNullOrUndefined(l.backColor) ? "borderColor" !== t.type || f.isNullOrUndefined(l.border) || (l.border.color = o) : l.backColor = o : (l.backColor && (l.backColor = o), l.border && (l.border.color = o)), v.set(i, l)
                },
                getPieColorArray: function(e) { return e.match(/transparent|rgb\(\d+, *\d+, *\d+\.?\d*\)|rgba\(\d+, *\d+, *\d+, *\d+\.?\d*\)|\w+ \d ?-?\d*/g) },
                generateColor: function(e, t, i) { var o, n, r, a = this; if (e instanceof Array) { if (o = e.length, i !== m) return e[i % o]; for (n = [], r = 0; r < t; r++) n.push(e[r % o]); return n } if (e instanceof Object) return a.getGradientThemeColor(e.startColor, e.stopColor, t, i) },
                getChartSeriesNames: function(e) {
                    var t, i, o, n, r, a, l = [],
                        c = e.series().get();
                    for (t = 0; t < c.length; t++) i = c[t], o = f.getDataSourceSheetBySeries(i), i.name && (n = "", '"' === i.name.substr(0, 1) && '"' === i.name.substr(i.name.length - 1, 1) ? n = i.name : (r = s(o, i.name), a = o.getCell(r.row, r.col), n = a.value()), l.push(n));
                    return l
                },
                getDataSourceSheetBySeries: function(e) { var t; return e.name && '"' !== e.name.substr(0, 1) || '"' !== e.name.substr(e.name.length - 1, 1) ? t = e.name : e.yValues ? t = e.yValues : e.xValues && (t = e.xValues), f.getSheetFromFormula(t) },
                getSheetFromFormula: function(e) {
                    var t, i, o = n.wrapper.spread.getActiveSheet(),
                        r = n.wrapper.spread,
                        a = {};
                    return e && "=" !== e && (a = GC.Spread.Sheets.CalcEngine.formulaToExpression(o, e)), a && a.source ? (i = a.source.getName(), t = r.getSheetFromName(i)) : t = o, t
                },
                mergeObject: function(e, t) { for (var i in t) t.hasOwnProperty(i) && ("object" == typeof t[i] ? (e[i] || (e[i] = {}), f.mergeObject(e[i], t[i])) : null !== t[i] && (e[i] = t[i])); return e },
                getSeriesWithoutStyle: function(e) { for (var t, i = 0, o = e.length, n = []; i < o; i++) t = { chartType: e[i].chartType, axisGroup: e[i].axisGroup, name: e[i].name, xValues: e[i].xValues, yValues: e[i].yValues, bubbleSizes: e[i].bubbleSizes }, n.push(t); return n },
                getImageFromChart: function(e) { var t, i, o = e.getHost(); return o[0] && (i = o[0].getElementsByTagName("canvas")[0], t = i.toDataURL("image/png")), t },
                getSeriesColor: function(e, t, i) {
                    var o = this,
                        r = e ? e.color.group : "colorful",
                        s = e ? e.color.index : 0,
                        l = a.chartColors,
                        d = l[r].colors[s].items,
                        p = o.generateColor(d, t, i),
                        u = n.wrapper.spread.getActiveSheet().currentTheme();
                    return c.isThemeColor(u, p) && (p = c.hexToRgba(c.parse(p, u).color)), p
                },
                axesItemEnum: { axesPrimaryHorizontal: 0, axesPrimaryVertical: 1, axesSecondaryHorizontal: 2, axesSecondaryVertical: 3 },
                isBarGroup: function(e) {
                    var t, i, o, n, r = e.chartType(),
                        a = !1,
                        s = f.getChartGroupString(r);
                    if ("BarGroup" === s && (a = !0), "ComboGroup" === s)
                        for (t = e.series().get(), i = 0; i < t.length; i++) { if (o = t[i], "BarGroup" !== (n = f.getChartGroupString(o.chartType))) { a = !1; break } a = !0 }
                    return a
                },
                isRadarGroup: function(e) {
                    var t = e.chartType(),
                        i = !1,
                        o = f.getChartGroupString(t);
                    return "RadarGroup" === o && (i = !0), i
                },
                getChartAxesItem: function(e, t) {
                    var i = f.isBarGroup(e),
                        o = e.axes();
                    if (i) switch (t) {
                        case 0:
                            return o.primaryValue;
                        case 1:
                            return o.primaryCategory;
                        case 2:
                            return o.secondaryValue;
                        case 3:
                            return o.secondaryCategory
                    } else switch (t) {
                        case 0:
                            return o.primaryCategory;
                        case 1:
                            return o.primaryValue;
                        case 2:
                            return o.secondaryCategory;
                        case 3:
                            return o.secondaryValue
                    }
                },
                setChartAxesItem: function(e, t, i) {
                    var o = f.isBarGroup(e),
                        n = e.axes();
                    if (o) switch (t) {
                        case 0:
                            n.primaryValue = i;
                            break;
                        case 1:
                            n.primaryCategory = i;
                            break;
                        case 2:
                            n.secondaryValue = i;
                            break;
                        case 3:
                            n.secondaryCategory = i
                    } else switch (t) {
                        case 0:
                            n.primaryCategory = i;
                            break;
                        case 1:
                            n.primaryValue = i;
                            break;
                        case 2:
                            n.secondaryCategory = i;
                            break;
                        case 3:
                            n.secondaryValue = i
                    }
                    return n
                },
                isNullOrUndefined: function(e) { return void 0 === e || null === e },
                SetChartStyle: function(e, t, i) {
                    var o, n, r, a;
                    try {
                        t.chartArea && e.chartArea(t.chartArea);
                        for (a in t)
                            if (t.hasOwnProperty(a))
                                if ("default" === i && "series" === a)
                                    for (n = 0; n < t[a].length; n++) r = t[a][n], e.series().set(n, r);
                                else if ("templetes" === i && "series" === a)
                            for (n = 0; n < e.series().get().length; n++) r = f.mergeObject(e.series().get(n), t[a]), e.series().set(n, r);
                        else { if ("chartArea" === a) continue; "colorAndStyle" === a ? o = t[a] : e[a](t[a]) } o && f.applyChartSeriesTheme(e, o.color), E(e)
                    } catch (e) {}
                },
                GetSeriesOrientation: function(e) { var t = e.Fn.getDataOrientation(); return !!t },
                GetCatCount: function(e, t) { return 0 === t || f.isNullOrUndefined(e) ? 0 : parseInt(e.length / t.length) },
                getCatValue: function(e, t, i, o) { return !f.isNullOrUndefined(e) && i < e.length ? e[t] : 0 === i ? "Branch" + (o + 1) : o + 1 },
                getDataSourceByCatArray: function(e, t, i) {
                    var o, n, r, a, s, l, c;
                    for (void 0 !== t && null !== t || (t = []), o = f.GetCatCount(t, i) || 2, n = i.length, a = [], s = 0; s < n; s++) {
                        for (l = [], c = 0; c < o; c++) r = f.GetSeriesOrientation(e) ? f.getCatValue(t, s * o + c, c, s) : f.getCatValue(t, s + c * n, c, s), l.push(r);
                        a.push(l)
                    }
                    return a
                },
                getCatString: function(e) {
                    var t, i, o, n, r = [],
                        a = [];
                    for (t = 0; t < e.length; t++) {
                        for (i = [], o = 0; o < e[t].length; o++) null !== e[t][o] && (a[o] = e[t][o], a.length = o + 1), null === e[t][o] && void 0 === a[o] || i.push(a[o]);
                        n = i.join(" "), r.push(n)
                    }
                    return r
                },
                chartElementType: ["series", "axis", m, "legend", "dataLabels", "chartTitle", m, "chartArea", "chartArea"]
            }, e.chartHelper = f, n.util = e
        }(n.util || {})
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer,
            o = i.util.chartHelper;
        ! function(e) {
            "use strict";
            var t = "separator",
                n = "designer.",
                r = "gc-spread-",
                a = "gc.spread.",
                s = "gc.spread.contextMenu.",
                l = "removeSlicer",
                c = "toggleComment",
                d = "deleteComment",
                p = "editComment",
                u = "unhideSheet",
                h = "hideSheet",
                f = "unhideRows",
                g = "unhideColumns",
                m = "sortAscend",
                b = "sortDescend",
                v = "sort",
                y = "filter",
                w = "insertComment",
                x = "deleteSheet",
                C = "insertSheet",
                S = "clearContents",
                k = "paste",
                T = "pasteOptions",
                A = "pasteFormatting",
                E = "pasteValues",
                I = "pasteFormula",
                D = "pasteAll",
                L = "cut",
                F = "copy",
                R = "groupHeader",
                B = "protectSheet",
                O = "customSort",
                P = "formatCells",
                N = "richText",
                z = "defineName",
                M = "cellTag",
                V = "rowHeight",
                G = "columnWidth",
                j = "sheetTag",
                H = "rowTag",
                W = "colTag",
                U = "hideRows",
                q = "hideColumns",
                _ = "tabColor",
                K = "showTabColor",
                X = "formatComment",
                J = "slicerCut",
                Y = "slicerCopy",
                Q = "slicerPasteOptions",
                Z = "slicerPaste",
                ee = "slicerSortAscend",
                te = "slicerSortDescend",
                ie = "slicerProperty",
                oe = "slicerSetting",
                ne = "insertColumns",
                re = "insertRows",
                ae = "deleteColumns",
                se = "deleteRows",
                le = "insert_dialog",
                ce = "delete_dialog",
                de = "columnHeaders",
                pe = "rowHeaders",
                ue = "changeChartTypeDialog",
                he = "selectChartDataDialog",
                fe = "formatChart",
                ge = "moveChartDialog",
                me = "floatingObjectCut",
                be = "floatingObjectCopy",
                ve = "resetChartColor",
                ye = "shape",
                we = "cutShapes",
                xe = "copyShapes",
                Ce = "pasteShapes",
                Se = "group",
                ke = "groupShapes",
                Te = "ungroupShapes",
                Ae = "formatShapes",
                Ee = "viewport",
                Ie = "colHeader",
                De = "rowHeader",
                $e = "corner",
                Le = "slicer",
                Fe = "sheetTab",
                Re = "chart";

            function Be(e) { return void 0 === e || null === e }

            function Oe(e, t, i) {
                for (var o = e.length, n = 0; n < o; n++)
                    if (!Be(e[n])) {
                        if (t === e[n].name) return void i(e, n);
                        e[n].subMenu && Oe(e[n].subMenu, t, i)
                    }
            }

            function Pe(e, t, i, o, n) {
                var r, a;
                for (t = t < 0 ? 0 : t, i = i < 0 ? 0 : i, r = t; r < t + o; r++)
                    for (a = i; a < i + n; a++)
                        if (e.getCell(r, a).locked()) return !0
            }

            function Ne(e) {
                var t, i = e.getSelections(),
                    o = !1;
                for (t = 0; t < i.length; t++) Pe(e, i[t].row, i[t].col, i[t].rowCount, i[t].colCount) && (o = !0);
                return o
            }

            function ze(e) {
                var t, i = e.getSelections();
                for (t = 0; t < i.length; t++)
                    if (-1 !== i[t].col) return !1;
                return !0
            }

            function Me(e) {
                var t, i = e.getSelections();
                for (t = 0; t < i.length; t++)
                    if (-1 !== i[t].row) return !1;
                return !0
            }

            function Ve() {
                var e, Be = i.wrapper.spread;

                function Pe() {}

                function Ve(e, t, i) { return RegExp(ye, "i").test(i.workArea) && e.worksheetHitInfo && e.worksheetHitInfo.shapeHitInfo } Pe.prototype = new GC.Spread.Sheets.ContextMenu.ContextMenu, Pe.prototype.onOpenMenu = function(e, t, r, a) {
                    var s, l, c, d, p, h, f, g, m, b, v, y, w = this,
                        x = a.getActiveSheet();
                    if (r.tabStripHitInfo) {
                        for (l = a.sheets, s = 0; s < l.length; s++)
                            if (!l[s].visible()) return void Oe(t, n + u, function(e, t) { e[t].disable = !1 });
                        Oe(t, n + u, function(e, t) { e[t].disable = !0 })
                    } else if (r.worksheetHitInfo && r.worksheetHitInfo.shapeHitInfo) {
                        for (t.length = 0, s = 0; s < e.length; s++) Ve(r, a, e[s]) && t.push(e[s]);
                        for (c = x.shapes.all(), d = !1, p = 0, s = 0; s < c.length; s++) c[s].isSelected() && (p++, c[s] instanceof GC.Spread.Sheets.Shapes.GroupShape && (d = !0));
                        p < 2 ? Oe(t, n + ke, function(e, t) { e[t].disable = !0 }) : Oe(t, n + ke, function(e, t) { e[t].disable = !1 }), d ? Oe(t, n + Te, function(e, t) { e[t].disable = !1 }) : Oe(t, n + Te, function(e, t) { e[t].disable = !0 })
                    } else h = x.getActiveRowIndex(), f = x.getActiveColumnIndex(), (g = x.comments.get(h, f)) || Oe(t, n + X, function(e, t) { e.splice(t, 1) });
                    m = r.worksheetHitInfo, m && (b = m.floatingObjectHitInfo && m.floatingObjectHitInfo.floatingObject) instanceof GC.Spread.Sheets.Charts.Chart && (v = b.hitTest(r.x, r.y)) && (y = o.chartElementType, Oe(t, n + fe, function(e, t) { e[t].text = i.res.contextMenu.formatChart[y[v.elementType]], e[t].options = v })), w.checkAvailableByCurrentSelections(t, a), w.checkAvailableByProtectionSettings(t, a), w.trimNullObject(t), w.trimSeparatorLine(t)
                }, Pe.prototype.checkAvailableByCurrentSelections = function(e, t) {
                    var i, o = this,
                        r = t.getActiveSheet();
                    for (i = 0; i < e.length; i++)
                        if (e[i]) {
                            switch (e[i].name) {
                                case n + re:
                                case n + se:
                                    ze(r) || (e[i].disable = !0);
                                    break;
                                case n + ne:
                                case n + ae:
                                    Me(r) || (e[i].disable = !0)
                            }
                            e[i] && e[i].subMenu && o.checkAvailableByCurrentSelections(e[i].subMenu, Be)
                        }
                }, Pe.prototype.checkAvailableByProtectionSettings = function(e, t) {
                    var i, o = this,
                        r = t.getActiveSheet(),
                        a = r.options.isProtected,
                        s = r.options.protectionOptions;
                    if (a && s)
                        for (i = 0; i < e.length; i++)
                            if (e[i]) {
                                switch (e[i].name) {
                                    case n + me:
                                    case n + be:
                                    case n + ve:
                                    case n + ue:
                                    case n + he:
                                    case n + ge:
                                    case n + fe:
                                    case n + J:
                                    case n + Y:
                                    case n + Z:
                                    case n + ee:
                                    case n + te:
                                    case n + l:
                                    case n + ie:
                                    case n + oe:
                                        s.allowEditObjects || e.splice(0, e.length);
                                        break;
                                    case n + X:
                                        s.allowEditObjects || (e[i] = null);
                                        break;
                                    case n + V:
                                        s.allowResizeRows || (e[i].disable = !0);
                                        break;
                                    case n + G:
                                        s.allowResizeColumns || (e[i].disable = !0);
                                        break;
                                    case n + le:
                                    case n + ce:
                                    case n + P:
                                    case n + N:
                                    case n + z:
                                    case n + M:
                                    case n + H:
                                    case n + W:
                                    case n + U:
                                    case n + f:
                                    case n + q:
                                    case n + g:
                                    case n + de:
                                    case n + pe:
                                        e[i].disable = !0;
                                        break;
                                    case n + re:
                                        s.allowInsertRows || (e[i].disable = !0);
                                        break;
                                    case n + ne:
                                        s.allowInsertColumns || (e[i].disable = !0);
                                        break;
                                    case n + ae:
                                        s.allowDeleteColumns || (e[i].disable = !0);
                                        break;
                                    case n + se:
                                        s.allowDeleteRows || (e[i].disable = !0);
                                        break;
                                    case n + y:
                                        s.allowFilter || (e[i].disable = !0);
                                        break;
                                    case n + m:
                                    case n + b:
                                    case n + O:
                                        s.allowSort && !Ne(r) || (e[i].disable = !0)
                                }
                                e[i] && e[i].subMenu && o.checkAvailableByProtectionSettings(e[i].subMenu, t)
                            }
                }, Pe.prototype.trimNullObject = function(e) {
                    var t, i = this,
                        o = e.length;
                    for (t = o - 1; t > 0; t--) e[t] ? e[t].subMenu && i.trimNullObject(e[t].subMenu) : e.splice(t, 1);
                    return e
                }, Pe.prototype.trimSeparatorLine = function(e) {
                    var i, o, n, r, a, s = [],
                        l = e.length;
                    for (i = 0; i < l; i++) e[i] && e[i].type === t && e[i + 1] && e[i + 1].type === t || s.push(e[i]);
                    for (l = s.length, o = 0, n = 0, r = !0, a = !0, i = 0; i < l && (r && s[i].type === t ? o++ : r = !1, a && s[l - 1 - i].type === t ? n++ : a = !1, r || a); i++);
                    for (s.splice(l - n, n), s.splice(0, o), e.splice(0, e.length), i = 0; i < s.length; i++) e.push(s[i]);
                    return e
                }, Be.contextMenu = new Pe, e = i.res.contextMenu, Be.contextMenu.menuData = [{ text: e.cut, name: n + L, command: n + L, iconClass: r + L, workArea: Ee + Ie + De + $e }, {
                    name: n + F,
                    text: e.copy,
                    command: n + F,
                    iconClass: r + F,
                    workArea: Ee + Ie + De + $e
                }, { text: e.paste, name: n + k, iconClass: r + T, type: R, workArea: Ee + Ie + De + $e }, { command: n + D, name: n + D, iconClass: r + D, group: n + k, text: e.pasteAll, workArea: Ee + Ie + De + $e }, { command: n + I, name: n + I, iconClass: r + I, group: n + k, text: e.pasteFormula, workArea: Ee + Ie + De + $e }, { command: n + E, name: n + E, iconClass: r + E, group: n + k, text: e.pasteValue, workArea: Ee + Ie + De + $e }, { command: n + A, name: n + A, iconClass: r + A, group: n + k, text: e.pasteFormatting, workArea: Ee + Ie + De + $e }, { text: e.cut, name: n + me, command: n + me, iconClass: r + L, workArea: Re }, { name: n + be, text: e.copy, command: n + be, iconClass: r + F, workArea: Re }, { text: e.cut, name: n + we, command: n + we, workArea: ye }, { text: e.copy, name: n + xe, command: n + xe, workArea: ye }, { text: e.pasteShape, name: n + Ce, command: n + Ce, workArea: ye }, { type: t }, { text: e.resetChartColor, name: n + ve, iconClass: r + ve, command: n + ve, workArea: Re }, { text: e.changeChartType, name: n + ue, iconClass: r + ue, command: n + ue, workArea: Re }, { text: e.selectData, name: n + he, iconClass: r + he, command: n + he, workArea: Re }, { text: e.moveChart, name: n + ge, iconClass: r + ge, command: n + ge, workArea: Re }, { text: e.formatChart.chartArea, name: n + fe, iconClass: r + fe, command: n + fe, workArea: Re }, { type: t }, { text: e.insertDialog, name: n + le, command: n + le, workArea: Ee + $e }, { text: e.deleteDialog, name: n + ce, command: n + ce, workArea: Ee + $e }, { text: e.insert, name: n + ne, command: s + ne, workArea: Ie }, { text: e.delete, name: n + ae, command: s + ae, workArea: Ie }, { text: e.insert, name: n + re, command: s + re, workArea: De }, { text: e.delete, name: n + se, command: s + se, workArea: De }, { text: e.clearcontents, command: s + S, name: n + S, workArea: Ee + Ie + De + $e }, { type: t }, { text: e.insert, name: n + C, command: s + C, workArea: Fe }, { text: e.delete, name: n + x, command: s + x, workArea: Fe }, { text: e.protectsheet, name: n + B, command: n + B, iconClass: r + B, workArea: Fe }, { type: t }, { text: e.filter, name: n + y, command: s + y, workArea: Ee + $e }, { text: e.sort, name: n + v, subMenu: [{ text: e.sortAToZ, name: n + m, command: s + m, iconClass: r + m }, { text: e.sortZToA, name: n + b, command: s + b, iconClass: r + b }, { text: e.customSort, name: n + O, command: n + O, iconClass: r + O }], workArea: Ee + $e }, { type: t }, { text: e.insertComment, name: a + w, command: s + w, iconClass: r + w, workArea: Ee + $e }, { text: e.editComment, name: a + p, command: s + p, iconClass: r + p, workArea: Ee + $e }, { text: e.deleteComment, name: a + d, command: s + d, iconClass: r + d, workArea: Ee + $e }, { text: e.unHideComment, name: a + c, command: s + c, workArea: Ee + $e }, { text: e.formatComment, name: n + X, command: n + X, iconClass: r + X, workArea: Ee + $e }, { type: t }, { text: e.formatCells, name: n + P, command: n + P, iconClass: r + P, workArea: Ee + Ie + De + $e }, { type: t }, { text: e.richText, name: n + N, command: n + N, iconClass: r + N, workArea: Ee }, { text: e.defineName, name: n + z, command: n + z, workArea: Ee + $e }, { text: e.tag, name: n + M, command: n + M, workArea: Ee + $e }, { text: e.tag, name: n + H, command: n + H, workArea: De }, { text: e.tag, name: n + W, command: n + W, workArea: Ie }, { text: e.rowHeight, name: n + V, command: n + V, workArea: De }, { text: e.columnWidth, name: n + G, command: n + G, workArea: Ie }, { text: e.hide, name: n + U, command: s + U, workArea: De }, { text: e.hide, name: n + q, command: s + q, workArea: Ie }, { text: e.unhide, name: n + g, command: s + g, workArea: Ie }, { text: e.unhide, name: n + f, command: s + f, workArea: De }, { text: e.headers, name: n + de, command: n + de, workArea: Ie }, { text: e.headers, name: n + pe, command: n + pe, workArea: De }, { type: t }, { text: e.sheetTabColor, name: n + K, subMenu: [{ name: n + _, command: n + _ }], workArea: Fe }, { text: e.hide, name: n + h, command: s + h, workArea: Fe }, { text: e.unhide, name: n + u, command: s + u, workArea: Fe }, { text: e.tag, name: n + j, command: n + j, workArea: Fe }, { type: t }, { text: e.cut, name: n + J, iconClass: r + L, command: s + L, workArea: Le }, { text: e.copy, name: n + Y, iconClass: r + F, command: s + F, workArea: Le }, { text: e.paste, name: n + Q, iconClass: r + T, type: R, workArea: Le }, { command: s + D, name: n + Z, iconClass: r + D, group: n + Q, text: e.pasteAll, workArea: Le }, { text: e.sortAToZ, name: n + ee, iconClass: r + m, command: s + ee, workArea: Le }, { text: e.sortZToA, name: n + te, iconClass: r + b, command: s + te, workArea: Le }, { text: e.remove, name: n + l, command: s + l, workArea: Le }, { text: e.slicerProperty, name: n + ie, command: n + ie, iconClass: r + ie, workArea: Le }, { text: e.slicerSetting, name: n + oe, command: n + oe, iconClass: r + oe, workArea: Le }, { type: t }, { text: e.groupShapes, iconClass: r + ke, name: n + Se, subMenu: [{ text: e.groupShapes, iconClass: r + ke, name: n + ke, command: n + ke }, { text: e.ungroupShapes, iconClass: r + Te, name: n + Te, command: n + Te }], workArea: ye }, { text: e.formatShapes, name: n + Ae, command: n + Ae, workArea: ye }];

                function Ge() {} Ge.prototype = new GC.Spread.Sheets.ContextMenu.MenuView, Ge.prototype.createMenuItemElement = function(t) { var o, r, a, s = this; return t.name === n + _ ? (r = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t), r.empty(), $(r[0]).colorpicker({ valueChanged: function(e, t) { t.isSetColorDirectly ? i.actions.doAction("setSheetTabColor", i.wrapper.spread, t.color) : $(r[0]).data("selectedColor", t) } }), $(r[0]).colorpicker("option", "themeColors", i.wrapper.getThemeColors()), r.css({ margin: "0", padding: "0" }), r.css("background", "white"), r) : t.name === n + B ? (a = i.wrapper.spread.getActiveSheet(), a.options.isProtected ? t.text = e.unprotectsheet : t.text = e.protectsheet, o = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t)) : o = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t) }, Ge.prototype.getCommandOptions = function(e, t, i) { return e.name === n + _ ? { value: $(t).children().data("selectedColor") } : e.name === n + fe ? e.options : void 0 }, Be.contextMenu.menuView = new Ge, i.spreadActions.initDesignerCommands(Be.commandManager())
            }
            e.initContextMenu = Ve, i.loader.ready(function() { i.wrapper.spread.notWorking || Ve() }), i.contextMenu = e
        }(i.contextMenu || {})
    }, function(e, t) {
        ! function() {
            "use strict";
            var e = GC.Spread.Sheets.Designer,
                t = function() {
                    function t() { this.res = e.res }
                    return t.Instance = new t, t
                }(),
                i = function() {
                    function i(e, t) {
                        if (this.po = this.Do(), this.po.autoOpen) throw "AutoOpen is not support.";
                        this.updateOptions(), this.Eo = $("<div></div>"), void 0 !== e ? this.Eo.load(e + " " + t, this.onLoad.bind(this)) : this.Fo = !0
                    }
                    return i.prototype.Do = function() { return null }, i.prototype.open = function() {
                        var e, t = [];
                        for (e = 0; e < arguments.length - 0; e++) t[e] = arguments[e + 0];
                        this.Go || (this.Ho = t, this.Go = !0, this.Fo && this.openReally())
                    }, i.prototype.close = function() { this.Go && (this.Go = !1, this.Fo && this.Eo.dialog("close")) }, i.prototype.destroy = function() { this.Fo && this.Eo.dialog("destroy") }, i.prototype.Io = function(e) {}, i.prototype.Jo = function() {}, i.prototype.Ko = function() { return t.Instance }, i.prototype._init = function() {}, i.prototype.openReally = function() { this.Lo || this.onInit(), this.Io.call(this, this.Ho), this.Eo.dialog("open") }, i.prototype.onLoad = function() { this.Fo = !0, this.Go && this.openReally() }, i.prototype.onInit = function() {
                        var e = this;
                        this.Lo = !0, this.Mo = this.Ko(), this.Eo.dialog(this.po), this.No = this.Eo.parent(), this._init(), void 0 !== this.Mo && ko.applyBindings(e.Mo, e.Eo[0]), this.po.preventDefaultOkButton || this.Eo.parent().on("keypress", function(t) {
                            var i, o, n;
                            13 === t.keyCode && (i = e.Eo.parent().find("button:focus").length > 0, o = e.Eo.parent().find("button[dialogToBeFocused='true']"), i || (n = e.Oo()) && n.click && !o.is(":focus") && n.click.call(e))
                        }), this.Eo.dialog({ open: function() { e.Eo.parent().trigger("mousedown"), e.Eo.parent().find("button[dialogToBeFocused='true']").focus() } })
                    }, i.prototype.Oo = function() {
                        var e, t, i = this,
                            o = i.po.buttons;
                        for (e = 0; e < o.length; e++)
                            if (t = o[e], t.isDefault) return t;
                        return o[0]
                    }, i.prototype.onClose = function(e, t) { this.Go = !1, void 0 !== this.Po && this.Po.call(this.Eo, e, t), this.Jo() }, i.prototype.updateOptions = function() { this.po.autoOpen = !1, this.po.closeText = e.res.close, this.po.resizable = !1, this.Po = this.po.close, this.po.close = this.onClose.bind(this), this.po.buttons && this.po.buttons[0] && (this.po.buttons[0].dialogToBeFocused = "true") }, i.prototype.getActiveSelection = function(e) { return e.getSelections()[0] }, i.prototype.Qo = function(t, i, o, n) { return this.Ro || (this.Ro = e.wrapper.spread.getActiveSheet().getCalcService()), this.Ro.unparse(t, i, o, n) }, i.prototype.So = function(t, i, o, n, r, a) { return this.Ro || (this.Ro = e.wrapper.spread.calcService), this.Ro.parse(t, i, o, n, r, a) }, i.prototype.To = function(e) { return !(!e || "string" != typeof e) && "=" == ("" + e)[0] }, i.prototype.Uo = function(t) { var i, o, n, r, a, s, l, c, d; if (this.To(t)) { if (i = e.wrapper.spread.getActiveSheet(), o = i.getActiveRowIndex(), n = i.getActiveColumnIndex(), !(r = i.getSelections()) || !r.length) return t; for (a = r[0].row, s = r[0].col, l = 1; l < r.length; l++) c = r[l], a = a <= c.row ? a : c.row, s = s <= c.col ? s : c.col; return a = a < 0 ? 0 : a, s = s < 0 ? 0 : s, d = GC.Spread.Sheets.CalcEngine.formulaToExpression(i, t, o, n), "=" + GC.Spread.Sheets.CalcEngine.expressionToFormula(i, d, a, s) } return t }, i.prototype.Vo = function(e, t) {
                        var i = this.Eo.find(".textBox-cell" + t).val(),
                            o = ("" + (i || "")).toUpperCase();
                        return i = "TRUE" === o || "FALSE" !== o && this.Uo(i)
                    }, i.prototype.hide = function() {
                        var e = $(".ui-widget-overlay");
                        this.No.hide(), e && e.hide()
                    }, i.prototype.show = function() {
                        var e = $(".ui-widget-overlay");
                        e && e.show(), this.No.show()
                    }, i
                }();
            e.BaseDialog = i
        }()
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = o.util.resolveHtmlPath("../dialogs", "chartDialogs.html"),
            r = i(1),
            a = i(16),
            s = GC.Spread.Sheets,
            l = s.Charts,
            c = l.Chart,
            d = GC.Spread.Sheets.CalcEngine.rangeToFormula,
            p = GC.Spread.Sheets.CalcEngine.formulaToRange,
            u = GC.Spread.Sheets.CalcEngine.formulaToRanges,
            h = o.util.chartHelper,
            f = h.isNullOrUndefined,
            g = o.ColorHelper;
        ! function() {
            "use strict";
            var e, t, i, r, g = function(e) {
                var t, i;
                o.extends(u, e), t = { 1: 1, 0: 0 }, i = function(e, t) { return (e !== l.ChartType.columnClustered && e !== l.ChartType.columnStacked && e !== l.ChartType.columnStacked100 || t !== l.ChartType.columnClustered && t !== l.ChartType.columnStacked && t !== l.ChartType.columnStacked100) && ((e !== l.ChartType.line && e !== l.ChartType.lineStacked && e !== l.ChartType.lineStacked100 || t !== l.ChartType.line && t !== l.ChartType.lineStacked && t !== l.ChartType.lineStacked100) && ((e !== l.ChartType.lineMarkers && e !== l.ChartType.lineMarkersStacked && e !== l.ChartType.lineMarkersStacked100 || t !== l.ChartType.lineMarkers && t !== l.ChartType.lineMarkersStacked && t !== l.ChartType.lineMarkersStacked100) && ((e !== l.ChartType.barClustered && e !== l.ChartType.barStacked && e !== l.ChartType.barStacked100 || t !== l.ChartType.barClustered && t !== l.ChartType.barStacked && t !== l.ChartType.barStacked100) && (e !== l.ChartType.area && e !== l.ChartType.areaStacked && e !== l.ChartType.areaStacked100 || t !== l.ChartType.area && t !== l.ChartType.areaStacked && t !== l.ChartType.areaStacked100)))) };

                function r(e, t, i) { var o = e.getValue(t, i); return !(!f(o) && ("" + o).length > 0) }

                function u() { e.call(this, n, ".select-chart-dialog"), this.q = { category: null, chartType: null, dataOrientation: null }, this.Wo = [], this.Xo = u.dialogType.insertChart, this.u = null, this.Yo = null, this.Zo = null, this.$o = !0 }
                return u.prototype.Do = function() { var e = this; return { width: "655px", resizable: !1, modal: !0, title: o.res.selectChartDialog.title, buttons: [{ text: o.res.ok, click: function() { e._o(), e.close() } }, { text: o.res.cancel, click: function() { e.close(), o.wrapper.setFocusToSpread() } }] } }, u.prototype._init = function() { this.Ln() }, u.prototype.Jo = function() { this.q = { category: null, chartType: null, dataOrientation: null }, this.Wo = [], this.Xo = u.dialogType.insertChart, this.u = null, this.Zo = null, this.$o = !0 }, u.prototype.Io = function(e) {
                    var t = this;
                    t.Xo = e[0], t.Wo = [], o.chartPreviewer.synchronizeData(o.wrapper.spread), t.Xo === u.dialogType.insertChart ? t.ap() : t.bp(e[1]), t.cp(), t.eo()
                }, u.prototype.ap = function() {
                    var e = this,
                        t = e.Eo;
                    t.dialog("option", "title", o.res.selectChartDialog.insertChart), e.q = { category: "ColumnGroup", chartType: "columnClustered", dataOrientation: l.RowCol.rows }, e.dp()
                }, u.prototype.ep = function(e) {
                    var t, i, n, a, l, c, d = e.row,
                        p = e.col,
                        u = e.rowCount,
                        h = e.colCount,
                        f = d < 0 ? 0 : d,
                        g = p < 0 ? 0 : p,
                        m = o.wrapper.spread,
                        b = m.getActiveSheet(),
                        v = b.getRowCount(),
                        y = b.getColumnCount();
                    if (-1 === d || 0 === d && u === v) {
                        c = -1 === p, c && (p = 0, h = y), d = 0, u = v, t = !0;
                        do {
                            for (n = p, a = p + h; n < a; n++)
                                if (!r(b, d, n)) { t = !1; break } if (t && (d++, 0 === --u)) return new s.Range(f, g, 1, 1)
                        } while (t);
                        i = d + u - 1, t = !0;
                        do {
                            for (n = p, a = p + h; n < a; n++)
                                if (!r(b, i, n)) { t = !1; break } if (t && (u--, i--, 0 === u)) return new s.Range(f, g, 1, 1)
                        } while (t);
                        c && (p = -1)
                    }
                    if (-1 === p || 0 === p && h === y) {
                        p = 0, h = y, t = !0;
                        do {
                            for (i = d, l = d + u; i < l; i++)
                                if (!r(b, i, p)) { t = !1; break } if (t && (p++, 0 === --h)) return new s.Range(f, g, 1, 1)
                        } while (t);
                        n = p + h - 1, t = !0;
                        do {
                            for (i = d, l = d + u; i < l; i++)
                                if (!r(b, i, n)) { t = !1; break } if (t && (h--, n--, 0 === h)) return new s.Range(f, g, 1, 1)
                        } while (t)
                    }
                    return new s.Range(d, p, u, h)
                }, u.prototype.dp = function() {
                    var e, t, i, n, r = this,
                        a = o.wrapper.spread,
                        s = a.getActiveSheet(),
                        c = s.getSelections()[0],
                        p = r.ep(c);
                    r.Zo = d(p), e = r.fp(r.Zo, l.RowCol.rows), t = r.fp(r.Zo, l.RowCol.columns), i = h.getSeriesWithoutStyle(e), n = h.getSeriesWithoutStyle(t), r.Wo.push(n), r.Wo.push(i)
                }, u.prototype.fp = function(e, t) {
                    var i = o.wrapper.spread.getActiveSheet(),
                        n = new c(i, "", l.ChartType.columnClustered, 20, 20, 480, 288, e, t);
                    return n.series().get()
                }, u.prototype.bp = function(e) {
                    var t, i, n, r, a, s, c, d = this,
                        p = d.Eo;
                    d.u = e, p.dialog("option", "title", o.res.selectChartDialog.changeChartType), t = e.chartType(), i = h.getChartGroupString(t), r = e.series().get(), d.Zo = e.dataRange(), n = e.getDataOrientation(), t = t === l.ChartType.combo ? "customCombination" : h.getChartTypeString(t), d.q = { category: i, chartType: t, dataOrientation: n }, a = h.getSeriesWithoutStyle(r), d.Wo.push(a), (s = d.gp(r)) && (c = h.getSeriesWithoutStyle(s), d.Wo.push(c))
                }, u.prototype.gp = function(e) {
                    var t, i = o.wrapper.spread.getActiveSheet(),
                        n = new l.Chart(i, "chartForGetSwitchedSeries", void 0, 20, 20, 480, 288, null);
                    return n.series().add(e), t = n.switchDataOrientation(), t ? n.series().get() : null
                }, u.prototype._o = function() {
                    var e, i, n = this;
                    n.$o && (n.Xo === u.dialogType.insertChart ? o.actions.doAction("insertChart", o.wrapper.spread, { chartType: n.q.chartType, dataOrientation: n.q.dataOrientation, dataFormula: n.Zo, category: n.q.category, series: n.Wo[t[n.q.dataOrientation]] }) : (e = n.q.dataOrientation !== l.RowCol.rows, o.actions.doAction("changeChartType", o.wrapper.spread, { chartType: n.q.chartType, isSwitchDataOrientation: e, dataFormula: n.Zo, category: n.q.category, series: n.Wo[t[n.q.dataOrientation]], chart: n.u })), i = o.wrapper.spread.getActiveSheet(), i.clearSelection())
                }, u.prototype.Ln = function() {
                    var e, t, i, o = this,
                        n = o.Eo,
                        r = n.find(".chart-type-category");
                    r.on("click", function(e) {
                        var t = $(e.currentTarget),
                            i = t.data("name"),
                            r = n.find("[data-group=" + i + "]"),
                            a = $(r[0]).data("name");
                        o.q.category = i, o.q.chartType = a, o.q.dataOrientation = l.RowCol.rows, o.hp(), o.eo(), o.cp()
                    }), e = n.find(".select-chart-type-subtype-item"), e.on("click", function(e) {
                        var t = $(e.currentTarget),
                            i = t.data("name");
                        o.q.chartType = i, o.q.dataOrientation = l.RowCol.rows, o.hp(), o.eo(), o.cp()
                    }), t = n.find(".select-chart-type-preview-item"), t.on("click", function(e) {
                        var t = $(e.currentTarget),
                            i = t.data("name");
                        o.q.dataOrientation = l.RowCol[i], o.ip()
                    }), i = n.find(".series-content-items"), i.on("click", function(e) {
                        var t, i, n, r, s, c = $(e.target),
                            d = $(".series-item");
                        for (d.removeClass("series-item-modifying"), d.removeClass("series-item-selected"), i = 0; i < d.length; i++) $(d[i]).find(c).length > 0 && (t = $(d[i]), o.jp = i);
                        t && ("series-chart-type-container" === c.attr("class") || "series-chart-type-container" === c.parent().attr("class") ? (n = $(".series-chart-type-list-container"), o.Yo || (o.Yo = new a(n, function(e, t) { o.Wo[0][o.jp].chartType !== l.ChartType[t] && (o.q.chartType = "customCombination", o.kp(o.jp, l.ChartType[t]), o.lp.gcuipopup("hide"), o.mp(), o.cp()) })), r = h.getChartTypeString(o.Wo[0][o.jp].chartType), o.Yo.updateSelectedStatus(r), o.lp = $(".series-chart-type-list-popup").gcuipopup({ autoHide: !0, position: { of: c, my: "left bottom", at: "left top" } }), o.lp.gcuipopup("show"), t.addClass("series-item-modifying")) : "series-secondary-axis-checkbox" === c.attr("class") ? (t.addClass("series-item-modifying"), s = c[0].checked, o.np(s), o.mp(), o.cp()) : t.addClass("series-item-selected"))
                    })
                }, u.prototype.np = function(e) {
                    var t, i, o, n, r = this,
                        a = r.Wo[0];
                    if (!e) return void(a[r.jp].axisGroup = l.AxisGroup.primary);
                    for (i = a.length, t = 0; t < i; t++)
                        if (a[t].axisGroup === l.AxisGroup.primary) {
                            if (t !== r.jp) return void(a[r.jp].axisGroup = l.AxisGroup.secondary);
                            for (o = t + 1; o < i; o++)
                                if (a[o].axisGroup === l.AxisGroup.primary) return void(a[r.jp].axisGroup = l.AxisGroup.secondary)
                        } for (n = $(".series-secondary-axis-checkbox"), t = 0; t < i; t++) a[t].axisGroup = l.AxisGroup.primary, n[t].checked = !1
                }, u.prototype.eo = function() {
                    var e, t, i, o, n = this,
                        r = n.Eo,
                        a = n.q.category,
                        s = n.q.chartType,
                        l = r.find(".chart-type-category"),
                        c = r.find("[data-name=" + a + "]");
                    n.pp(l, c), e = r.find(".select-chart-type-subtype-item"), t = r.find("[data-name=" + s + "]"), n.pp(e, t), i = r.find(".select-chart-type-preview-item"), o = r.find("[data-name= rows]"), n.pp(i, o), n.qp(s), n.rp(a)
                }, u.prototype.ip = function() {
                    var e = this,
                        t = e.Eo,
                        i = e.q.category,
                        o = e.q.chartType,
                        n = e.q.dataOrientation === l.RowCol.rows ? "rows" : "columns",
                        r = t.find(".select-chart-type-preview-item"),
                        a = t.find("[data-name=" + n + "]");
                    e.pp(r, a), e.qp(o), e.rp(i)
                }, u.prototype.mp = function() {
                    var e, t, i, n, r, a, s, c, d, p, u, f, g = this,
                        m = g.Eo,
                        b = g.q.chartType,
                        v = m.find(".select-chart-type-subtype-item"),
                        y = m.find("[data-name=" + b + "]");
                    for (g.pp(v, y), e = g.q.dataOrientation === l.RowCol.rows ? "rows" : "columns", t = m.find(".select-chart-type-preview-item"), i = m.find("[data-name=" + e + "]"), g.pp(t, i), g.qp(b), m.find(".select-chart-type-preview-item").addClass("hidden"), n = m.find("[data-group=" + b + "]"), n.removeClass("hidden"), r = $(".series-item"), a = g.Wo[0], s = 0, c = a.length; s < c; s++) d = r[s], p = a[s], u = $(d).find(".series-chart-type-selected"), u.text(o.res.selectChartDialog[h.getChartTypeString(p.chartType)]), f = $(d).find(".series-secondary-axis-checkbox"), f[0].checked = p.axisGroup === l.AxisGroup.primary ? "" : "checked"
                }, u.prototype.qp = function(e) { $(".select-chart-type-title").text(o.res.selectChartDialog[e]) }, u.prototype.pp = function(e, t) { e.removeClass("chart-ui-selected"), t.addClass("chart-ui-selected") }, u.prototype.rp = function(e) {
                    var t, i = this,
                        o = i.Eo;
                    o.find(".select-chart-type-subtype-item").addClass("hidden"), t = o.find("[data-group=" + e + "]"), t.removeClass("hidden")
                }, u.prototype.sp = function() { $(".series-container").show(), this.tp() }, u.prototype.up = function() { $(".series-container").hide() }, u.prototype.cp = function() {
                    var e, t, i, n, r, a, s, c, d, p, u = this,
                        f = u.Eo;
                    for (f.find(".select-chart-type-preview-item").addClass("hidden"), u.vp() ? u.sp() : u.up(), t = u.q.chartType, i = u.wp(), n = o.chartPreviewer.getChartPreviewCharts(i), r = f.find("[data-group=" + u.q.chartType + "]"), a = $(".select-chart-type-error-message"), e = 0; e < r.length; e++) {
                        if (s = n[e]) {
                            if (!(s instanceof l.Chart)) return p = o.res.selectChartDialog.errorPrompt[t + "ErrorMsg"], a.text(p), a.show(), r.addClass("hidden"), void(u.$o = !1);
                            a.hide(), $(r[e]).removeClass("hidden"), c = h.getImageFromChart(s), d = $($(r[e]).find(".chart-type-preview-icon")), u.vp() ? d.css("background-size", "330px") : d.css("background-size", "190px"), d.css("background-image", "url('" + c + "')")
                        }
                        u.$o = !0
                    }
                }, u.prototype.hp = function() {
                    var e, t, i, o = this;
                    if (o.vp()) o.xp();
                    else
                        for (e = o.q.chartType, t = 0; t < o.Wo.length; t++)
                            for (i = 0; i < o.Wo[t].length; i++) o.yp(t, i, l.ChartType[e])
                }, u.prototype.xp = function() {
                    var e, t, i, o, n, r, a, s = this,
                        c = s.q.chartType;
                    if ("columnClusteredAndLine" === c) e = l.ChartType.columnClustered, t = l.ChartType.line, i = o = l.AxisGroup.primary;
                    else if ("columnClusteredAndLineOnSecondaryAxis" === c) e = l.ChartType.columnClustered, t = l.ChartType.lineMarkers, i = l.AxisGroup.primary, o = l.AxisGroup.secondary;
                    else {
                        if ("stackedAreaAndColumnClustered" !== c) return;
                        e = l.ChartType.areaStacked, t = l.ChartType.columnClustered, i = o = l.AxisGroup.primary
                    }
                    for (r = s.Wo[0].length, a = r / 2, n = 0; n < r; n++) n < a ? (s.Wo[0][n].chartType = e, s.Wo[0][n].axisGroup = i) : (s.Wo[0][n].chartType = t, s.Wo[0][n].axisGroup = o)
                }, u.prototype.yp = function(e, t, i) { this.Wo[e][t].chartType = i }, u.prototype.kp = function(e, t) {
                    var o, n, r = this,
                        a = r.Wo[0];
                    for (a[e].chartType = t, o = a.length, n = 0; n < o; n++) i(t, a[n].chartType) || (a[n].chartType = t)
                }, u.prototype.wp = function() {
                    var e, t, i, o, n, r, a, s, c, d = this,
                        p = [];
                    for (d.Xo === u.dialogType.changeChartType && d.u.colorAndStyle && d.u.colorAndStyle.color && (e = d.u.colorAndStyle), t = d.vp() || d.zp() || d.Ap() || d.Bp() || d.Cp() ? 1 : d.Wo.length, d.u && (i = d.u.axes(), o = d.u.dataLabels(), n = d.u.chartArea(), r = d.u.legend(), a = d.u.getDataOrientation(), s = d.u.title()), c = 0; c < t; c++) a = void 0 !== a && null !== a ? 0 === c ? a : Math.abs(a - 1) : 0 === c ? l.RowCol.rows : l.RowCol.columns, d.Xo === u.dialogType.insertChart && d.Ap() && (a = null), p.push({ chartType: d.q.chartType, dataFormula: d.Zo, colorAndStyle: e, series: d.Wo[c], category: d.q.category, dataOrientation: a, axes: i, dataLabels: o, chartArea: n, legend: r, title: s });
                    return p
                }, u.prototype.vp = function() { if (this.q.category === h.chartTypeDict[0].chartGroup) return !0 }, u.prototype.Bp = function() { if (this.q.category === h.chartTypeDict[57].chartGroup) return !0 }, u.prototype.Cp = function() { if (this.q.category === h.chartTypeDict[58].chartGroup) return !0 }, u.prototype.zp = function() { if (this.q.category === h.chartTypeDict[50].chartGroup) return !0 }, u.prototype.Ap = function() { if (this.q.chartType === h.chartTypeDict[10].chartType) return !0 }, u.prototype.tp = function() {
                    var e, t, i, n, r, a, s, c, d, u, f, g, m, b, v, y, w = this,
                        x = w.Eo,
                        C = o.wrapper.spread.getActiveSheet(),
                        S = x.find(".series-content-items");
                    for (S.empty(), w.u && (e = w.u.colorAndStyle), t = w.Wo[0], i = t.length, n = 0; n < i; n++) r = t[n], a = r.name, '"' === a.substr(0, 1) && '"' === a.substr(a.length - 1, 1) ? s = a : (c = p(C, a.substring(a.indexOf("!") + 1)), s = C.getCell(c.row, c.col).text()), d = r.axisGroup === l.AxisGroup.primary ? "" : "checked", u = h.getChartTypeString(r.chartType), f = o.res.selectChartDialog[u], g = h.getSeriesColor(e, i, n), m = $("<div class='series-item'></div>"), b = $("<div class='series-name'><span class='series-item-color' style='background-color:" + g + "'></span><span class='series-item-name'>" + s + "</span></div>"), v = $("<div class='series-chart-type-container'><div class='series-chart-type-selected'>" + f + "</div></div>"), y = $("<div class='series-secondary-axis'><input type='checkbox' class='series-secondary-axis-checkbox'" + d + "/></div>"), b.appendTo(m), v.appendTo(m), y.appendTo(m), m.appendTo(S)
                }, u
            }(o.BaseDialog);
            g.dialogType = { insertChart: 0, changeChartType: 1 }, o.SelectChartDialog = g, e = function(e) {
                o.extends(t, e);

                function t() { e.call(this, n, ".move-chart-dialog"), this.Dp = t.sheetType.existingSheets }
                return t.prototype.Do = function() { var e = this; return { width: "655px", resizable: !1, modal: !0, title: o.res.moveChartDialog.title, buttons: [{ text: o.res.ok, click: function() { e._o(), e.close() } }, { text: o.res.cancel, click: function() { e.close(), o.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                    var e = this;
                    e.Ln()
                }, t.prototype.Io = function(e) {
                    var t = this,
                        i = o.wrapper.spread,
                        n = i.sheets,
                        r = h.getSelectedChart(i.getActiveSheet());
                    t.Ep(r, n), t.Fp(n), t.Gp()
                }, t.prototype.Fp = function(e) { var t, i, o, n = $("#existingSheetName"); for (n.empty(), t = 0; t < e.length; t++) i = e[t].name(), o = $("<option></option>"), o.attr("value", i), o.text(i), o.appendTo(n) }, t.prototype.Ep = function(e, t) {
                    for (var i = e.name(), o = 1; !this.Hp(i, t);) i = "Chart " + o, o++;
                    $("#chartSheetName").val(i)
                }, t.prototype.Hp = function(e, t) {
                    var i, o;
                    for (i = 0; i < t.length; i++)
                        if (o = t[i], e === o.name()) return !1;
                    return !0
                }, t.prototype.Gp = function() { this.Dp === t.sheetType.newSheet ? $("#moveToNewSheet").prop("checked", !0) : $("#moveToExistingSheet").prop("checked", !0) }, t.prototype._o = function() {
                    var e = {};
                    this.Dp === t.sheetType.newSheet ? (e.targetSheetName = $("#chartSheetName").val(), e.type = "newSheet") : (e.targetSheetName = $("#existingSheetName").val(), e.type = "existingSheet"), o.actions.doAction("moveChart", o.wrapper.spread, e)
                }, t.prototype.Ln = function() {
                    var e = this;
                    $("#chartSheetName").on("click", function() { e.Dp = t.sheetType.newSheet, e.Gp() }), $("#existingSheetName").on("click", function() { e.Dp = t.sheetType.existingSheets, e.Gp() }), $("input:radio[name=moveToSheetType]").change(function() { e.Dp = t.sheetType[this.value] })
                }, t
            }(o.BaseDialog), o.MoveChartDialog = e, e.sheetType = { newSheet: 0, existingSheets: 1 }, t = { RECHOOSE: 0, EDIT: 1, REMOVE: 2, REORDER: 3, ADD: 4 }, i = function(e) {
                o.extends(i, e);

                function i() { e.call(this, n, ".chart-select-data"), this.Ip = null, this.Jp = null, this.series = null }
                return i.prototype.Do = function() {
                    var e = this;
                    return {
                        width: "655px",
                        resizable: !1,
                        modal: !0,
                        title: o.res.selectData.selectDataSource,
                        buttons: [{
                            text: o.res.ok,
                            click: function() {
                                var t = e.Kp();
                                e.close(), o.wrapper.setFocusToSpread(), t && o.actions.doAction("updateChartAllSeries", o.wrapper.spread, { seriesArray: e.Jp, chart: e.Fn })
                            }
                        }, { text: o.res.cancel, click: function() { e.close(), o.wrapper.setFocusToSpread() } }]
                    }
                }, i.prototype._init = function() {
                    var e = this;
                    this.Ln(), e.Lp || (e.Lp = new o.RangeSelectDialog(e, { absoluteReference: !0 }))
                }, i.prototype.Io = function(e) { this.Fn = e[0], this.Wo = this.Fn.series(), this.Jp = this.Wo.get(), this.Mp = this.Fn.dataRange(), this.u = this.Np(this.Jp), this.Ip = null, this.Op = null, this.Pp = [], this.Qp(), this.Rp(), this.Sp(t.RECHOOSE), this.Tp(), this.Up() }, i.prototype.Vp = function(e, t, i) { var o, n, r = document.createElement("div"); return r.className = t, o = document.createElement("input"), o.type = "checkbox", n = document.createElement("span"), n.className = "chart-select-data-select-text", null !== e && void 0 !== e || (e = ""), e = "" + e, n.innerHTML = e.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"), r.appendChild(n), r }, i.prototype.Np = function(e) {
                    var t = o.wrapper.spread.getActiveSheet(),
                        i = new GC.Spread.Sheets.Charts.Chart(t, "middleChart", void 0, 0, 0, 100, 100, null);
                    return e.forEach(function(e, t) { i.series().add(e) }), i
                }, i.prototype.Wp = function(e, i) {
                    var n, r, a, s, l, c, d, p, u;
                    if (e < this.Jp.length) {
                        if (n = this.Jp[e], r = this.Xp(n.yValues), a = this.Xp(i.yValues), s = h.getChartGroupString(this.Fn.chartType()), l = h.getChartTypeString(this.Fn.chartType()), "ScatterGroup" === s) {
                            if (c = this.Xp(n.xValues), d = this.Xp(i.xValues), c.rowCount !== d.rowCount || c.colCount !== d.colCount) return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                            if (n.xValues = i.xValues, "bubble" === l) {
                                if (p = this.Xp(n.bubbleSizes), u = this.Xp(i.bubbleSizes), p.rowCount !== u.rowCount || p.colCount !== u.colCount) return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                                n.bubbleSizes = i.bubbleSizes
                            }
                        }
                        if (r.rowCount !== a.rowCount || r.colCount !== a.colCount) return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                        n.name = i.name, n.yValues = i.yValues, this.u.series().set(e, n), this.u.series().set(e, n)
                    }
                    this.Yp(t.EDIT)
                }, i.prototype.Zp = function(e) {
                    var i, n, r = {};
                    if (this.Jp.length > 0 ? r = this.Jp[0] : this.Wo.get().length > 0 && (r = this.Wo.get()[0]), r.yValues) {
                        if (i = this.Xp(r.yValues), n = this.Xp(e.yValues), i.rowCount !== n.rowCount || i.colCount !== n.colCount) return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                        e.xValues = r.xValues, this.u.series().add(e), this.Yp(t.ADD)
                    }
                }, i.prototype.$p = function(e) { this.u.series().remove(e), this.Yp(t.REMOVE) }, i.prototype._p = function(e, i) {
                    if (e < this.Jp.length && i < this.Jp.length) {
                        var o = this.Jp[e];
                        this.u.series().set(e, this.Jp[i]), this.u.series().set(i, o), this.Yp(t.REORDER)
                    }
                }, i.prototype.aq = function(e, t) {
                    var i = this.Jp[e];
                    i.xValues = t, this.u.series().set(e, i)
                }, i.prototype.bq = function(e) { this.u.dataRange(e), this.Yp(t.RECHOOSE) }, i.prototype.Yp = function(e) { this.cq(), this.dq(), this.Rp(), this.Sp(e), this.Tp(), this.Qp(), this.Up() }, i.prototype.cq = function() { this.Jp = this.u.series().get() }, i.prototype.dq = function() { this.Mp = this.u.dataRange() }, i.prototype.Qp = function() { var e = this.Mp || ""; "" === e ? this.Eo.find(".chart-select-data-range-noShow-desc").css({ visibility: "visible" }) : this.Eo.find(".chart-select-data-range-noShow-desc").css({ visibility: "hidden" }), this.Eo.find(".chart-select-data-range-input").val(e) }, i.prototype.Rp = function() {
                    var e, t, i, o, n, r, a, s = document.getElementById("itemBox0");
                    for (s.innerHTML = "", this.Pp = [], e = 0; e < this.Jp.length; e++) t = this.Jp[e], t.name && (i = "", '"' === t.name.substr(0, 1) && '"' === t.name.substr(t.name.length - 1, 1) ? i = t.name : (o = this.Xp(t.name), n = h.getSheetFromFormula(t.name), r = n.getCell(o.row, o.col), i = r.text()), a = this.Vp(i, "chart-select-data-select-series", !1), a.dataset.seriesIndex = e, s.appendChild(a), this.Pp.push($(a)));
                    this.fq()
                }, i.prototype.Sp = function(e) {
                    var i, o;
                    switch (e) {
                        case t.RECHOOSE:
                            this.Ip = this.Pp[0];
                            break;
                        case t.EDIT:
                            this.Ip = this.Pp[this.Ip.data("seriesIndex")];
                            break;
                        case t.REMOVE:
                            0 === this.Ip.data("seriesIndex") ? this.Ip = this.Pp[0] : this.Pp.length > this.Ip.data("seriesIndex") - 1 ? this.Ip = this.Pp[this.Ip.data("seriesIndex") - 1] : this.Ip = null;
                            break;
                        case t.ADD:
                            this.Ip = this.Pp[this.Pp.length - 1];
                            break;
                        case t.REORDER:
                            for (i = 0; i < this.Pp.length; i++)
                                if (o = this.Pp[i], o.context.innerText === this.Ip.context.innerText) { this.Ip = o; break }
                    }
                    this.gq(null, this.Ip, "chart-select-data-cell-selected")
                }, i.prototype.Tp = function() {
                    var e, t, i, o, n, r, a, s, l, c, d, p, u, f = document.getElementById("itemBox1");
                    if (f.innerHTML = "", e = [], t = [], this.Ip && this.Jp && (i = this.Ip.data("seriesIndex"), this.Jp.length > i))
                        if (o = this.Jp[i].xValues) l = this.Xp(o), c = h.getSheetFromFormula(o), l && (t = this.hq(l, c));
                        else if (n = this.Jp[i].yValues, r = this.Xp(n))
                        for (a = r.rowCount > r.colCount ? r.rowCount : r.colCount, s = 0; s < a; s++) t.push(s + 1);
                    if (t)
                        for (d = 0; d < t.length; d++) p = t[d], u = this.Vp(p, "chart-select-data-select-category", !1), u.dataset.categoryIndex = d, f.appendChild(u), e.push($(u));
                    this.iq()
                }, i.prototype.gq = function(e, t, i) { e && e.removeClass(i), t && t.addClass(i) }, i.prototype.Up = function() {
                    var e, t, i;
                    this.Ip && (e = this.Ip.data("seriesIndex"), t = document.getElementById("upBtnTrangle"), i = document.getElementById("downBtnTrangle"), t.className = "chart-select-data-option-upBtn-normal-trangle", i.className = "chart-select-data-option-downBtn-normal-trangle", 0 === e ? t.className = "chart-select-data-option-upBtn-UnClick-trangle" : e === this.Jp.length - 1 && (i.className = "chart-select-data-option-downBtn-unclick-trangle"))
                }, i.prototype.Xp = function(e) { if (e) { var t = h.getSheetFromFormula(e); return u(t, e, 0, 0)[0].ranges[0] } }, i.prototype.hq = function(e, t) {
                    var i, o, n, r, a, s, l, c, d, p = [],
                        u = h.getChartGroupString(this.Fn.chartType());
                    if (e)
                        if (u === h.chartTypeDict[57].chartGroup || u === h.chartTypeDict[58].chartGroup) i = this.Wo.get(0).xValues, o = this.Wo.get(0).yValues, f(i) || f(o) || (n = this.Xp(i), r = this.Xp(o), a = t.getArray(n.row, n.col, n.rowCount, n.colCount), s = t.getArray(r.row, r.col, r.rowCount, r.colCount), l = h.getDataSourceByCatArray(this, this.jq(a), this.jq(s)), p = h.getCatString(l));
                        else if (1 === e.rowCount)
                        for (c = 0; c < e.colCount; c++) p.push(t.getCell(e.row, e.col + c).text());
                    else if (1 === e.colCount)
                        for (d = 0; d < e.rowCount; d++) p.push(t.getCell(e.row + d, e.col).text());
                    return p
                }, i.prototype.jq = function(e) { var t, i = []; for (t = 0; t < e.length; t++) i = i.concat(e[t]); return i }, i.prototype.Ln = function() {
                    var e = this,
                        i = e.Eo,
                        n = $(".chart-select-data-range-input"),
                        r = i.find(".rangeSelectButton"),
                        a = i.find(".chart-select-data-switch-box-middle"),
                        s = i.find(".chart-select-data-option-one-btn-box"),
                        l = i.find(".chart-select-data-option-upDown-btn");
                    n.focusout(function() { e.kq(n[0].value) }), r.click(function() {
                        var t = e.Mp || "";
                        e.hide(), e.Lp.open(o.res.selectData.selectDataSource, e.kq, t)
                    }), a.click(function(i) {
                        var n, r;
                        h.getChartGroupString(e.Fn.chartType()) !== h.chartTypeDict[50].chartGroup ? (n = e.u.switchDataOrientation(), n ? (r = e.Fn.colorAndStyle && e.Fn.colorAndStyle.color, r && h.applyChartSeriesTheme(e.u, r), e.Yp(t.RECHOOSE)) : o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2)) : o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2)
                    }), l.click(function(t) {
                        var i, o;
                        e.Ip && (i = $(t.currentTarget), o = e.Ip.data("seriesIndex"), "Up" === i.data("name") ? o > 0 && e._p(o, o - 1) : "Down" === i.data("name") && o + 1 < e.Jp.length && e._p(o, o + 1))
                    }), s.click(function(t) {
                        var i, n, r, a = $(t.currentTarget),
                            s = e.Jp[e.Ip.data("seriesIndex")],
                            l = e.Fn.chartType();
                        "Remove" === a.data("name") ? e.Ip && e.Jp && (1 === e.Jp.length ? o.MessageBox.show(o.res.selectData.errorPrompt.cantRemoveLastSeries, "Error", 2) : null !== (i = e.Ip.data("seriesIndex")) && void 0 !== i && e.$p(i)) : "Add" === a.data("name") ? (n = new o.ChartEditSeries(e, e.lq, {}, !0, l), e.hide(), n.open()) : "Edit" === a.data("name") ? (r = new o.ChartEditSeries(e, e.mq, { name: s.name, yValue: s.yValues, xValue: s.xValues, size: s.bubbleSizes || null }, !1, l), e.hide(), r.open()) : "EditCategory" === a.data("name") && (e.hide(), e.Lp.open(o.res.selectData.selectDataSource, e.nq, s.xValues))
                    })
                }, i.prototype.fq = function() {
                    var e = this,
                        t = e.Eo,
                        i = t.find(".chart-select-data-select-series");
                    i.click(function(t) { e.Ip = $(t.currentTarget), e.gq(i, e.Ip, "chart-select-data-cell-selected"), e.Op = null, e.Tp(), e.Up() })
                }, i.prototype.iq = function() {
                    var e = this,
                        t = e.Eo,
                        i = t.find(".chart-select-data-select-category");
                    i.click(function(t) { e.Op = $(t.currentTarget), e.gq(i, e.Op, "chart-select-data-cell-selected") })
                }, i.prototype.kq = function(e) { var t = this.Mp || ""; "" !== (e = this.oq(e)) && "=" !== e && t !== e && "=" + t !== e && this.bq(e) }, i.prototype.lq = function(e) {
                    var t, i;
                    if (e) {
                        t = {};
                        for (i in e) t[i] = this.oq(e[i]);
                        this.Zp(t)
                    }
                }, i.prototype.nq = function(e) {
                    var i, n, r, a, s, l, c, d, u;
                    e && "=" !== e ? (i = this, e = this.oq(e), n = h.getSheetFromFormula(e), r = p(n, e), a = i.Jp[i.Ip.data("seriesIndex")], s = h.getSheetFromFormula(a.xValues), l = p(s, a.xValues), c = p(s, a.yValues), d = l && r.rowCount === l.rowCount && r.colCount === l.colCount, u = !l && c && r.rowCount === c.rowCount && r.colCount === c.colCount,
                        d || u ? (this.Jp.forEach(function(t, o) { i.aq(o, e) }), this.Yp(t.EDIT)) : o.MessageBox.show(o.res.selectData.errorPrompt.categoryValueIsIllegal, "Error", 2)) : o.MessageBox.show(o.res.selectData.errorPrompt.categoryValueIsIllegal, "Error", 2)
                }, i.prototype.mq = function(e) {
                    var t, i;
                    if (this.Ip) {
                        t = {};
                        for (i in e) t[i] = this.oq(e[i]);
                        this.Wp(this.Ip.data("seriesIndex"), t)
                    }
                }, i.prototype.Kp = function() {
                    var e, t, i, o = this.Jp,
                        n = this.Fn.series().get();
                    if (o.length === n.length) {
                        for (e = 0; e < o.length; e++)
                            if (t = o[e], i = n[e], t.name !== i.name || t.xValues !== i.xValues || t.yValues !== i.yValues || t.bubbleSizes !== i.bubbleSizes) return !0;
                        return !1
                    }
                    return !0
                }, i.prototype.oq = function(e) {
                    var t = o.wrapper.spread.getActiveSheet(),
                        i = {},
                        n = e;
                    return e && "=" !== e && (i = GC.Spread.Sheets.CalcEngine.formulaToExpression(t, e), n = GC.Spread.Sheets.CalcEngine.expressionToFormula(t, i, 0, 0, !1, !0)), n
                }, i
            }(o.BaseDialog), o.ChartSelectDataDialog = i, r = function(e) {
                o.extends(t, e);

                function t(t, i, o, r, a) { this.pq = t, this.qq = i, this.rq = o ? o.name || "" : "", this.sq = o ? o.yValue || "" : "", this.tq = o ? o.xValue || "" : "", this.uq = o ? o.size || "" : "", this.vq = r, this.wq = h.getChartGroupString(a), this.xq = h.getChartTypeString(a), e.call(this, n, ".chart-edit-series") }
                return t.prototype.Do = function() {
                    var e = this;
                    return {
                        width: "350px",
                        resizable: !1,
                        modal: !0,
                        title: e.vq ? o.res.selectData.addSeries : o.res.selectData.editSeries,
                        buttons: [{
                            text: o.res.ok,
                            click: function() {
                                if (e.qq) {
                                    var t = {};
                                    t = "" === e.uq || "=" === e.uq || void 0 === e.uq || null === e.uq ? { name: e.rq, yValues: e.sq, xValues: e.tq } : { name: e.rq, yValues: e.sq, xValues: e.tq, bubbleSizes: e.uq }, e.qq.apply(e.pq, [t])
                                }
                                e.close()
                            }
                        }, { text: o.res.cancel, click: function() { e.close() } }]
                    }
                }, t.prototype.Ln = function() {
                    var e = this,
                        t = e.Eo,
                        i = t.find("#nameRangeSelectBtn"),
                        n = t.find("#valueRangeSelectBtn"),
                        r = t.find("#xValueRangeSelectBtn"),
                        a = t.find("#sizeRangeSelectBtn");
                    e.yq.focusout(function() { e.zq(e.yq[0].value) }), e.Aq.focusout(function() { e.Bq(e.Aq[0].value) }), e.Cq.focusout(function() { e.Dq(e.Cq[0].value) }), e.Eq.focusout(function() { e.Fq(e.Eq[0].value) }), i.click(function() { e.hide(), e.Lp.open(o.res.selectData.editSeriesName, e.zq, e.rq) }), n.click(function() { e.hide(), e.Lp.open(o.res.selectData.editSeriesValue, e.Bq, e.sq) }), r.click(function() { e.hide(), e.Lp.open(o.res.selectData.editSeriesName, e.Dq, e.tq) }), a.click(function() { e.hide(), e.Lp.open(o.res.selectData.editSeriesValue, e.Fq, e.uq) })
                }, t.prototype._init = function() {
                    var e = this,
                        t = e.Eo;
                    "ScatterGroup" !== this.wq ? (t.find("#xValueContainer").hide(), t.find("#xValueDesc").hide(), t.find("#sizeContainer").hide(), t.find("#sizeDesc").hide()) : "bubble" !== this.xq && (t.find("#sizeContainer").hide(), t.find("#sizeDesc").hide()), this.yq = t.find("#name"), this.Aq = t.find("#value"), this.Cq = t.find("#xValue"), this.Eq = t.find("#seriesSize"), this.yq.val(this.rq), this.Aq.val(this.sq), this.Cq.val(this.tq), this.Eq.val(this.uq), this.Ln(), e.Lp || (e.Lp = new o.RangeSelectDialog(e, { absoluteReference: !0 }))
                }, t.prototype.zq = function(e) { this.rq = e, this.yq.val(this.rq) }, t.prototype.Bq = function(e) { this.sq = e, this.Aq.val(this.sq) }, t.prototype.Dq = function(e) { this.tq = e, this.Cq.val(this.tq) }, t.prototype.Fq = function(e) { this.uq = e, this.Eq.val(this.uq) }, t.prototype.Jo = function() { this.pq && this.pq.show() }, t
            }(o.BaseDialog), o.ChartEditSeries = r
        }()
    }, function(e, t) {
        var i = void 0,
            o = GC.Spread.Sheets,
            n = o.Designer;
        ! function() {
            "use strict";
            var e, t, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R, B, O, P, N, z, M, V, G, j, H, W, U, q, _, K, X, J, Y, Q, Z, ee;
            ! function(e) { e[e.none = 0] = "none", e[e.info = 1] = "info", e[e.warning = 2] = "warning", e[e.error = 3] = "error", e[e.question = 4] = "question", n.MessageBoxIcon = e }(n.MessageBoxIcon || {}),
            function(e) { e[e.ok = 0] = "ok", e[e.okCancel = 1] = "okCancel", e[e.yesNoCancel = 2] = "yesNoCancel", n.MessageBoxButtons = e }(n.MessageBoxButtons || {}),
            function(e) { e[e.none = 0] = "none", e[e.ok = 1] = "ok", e[e.yes = 2] = "yes", e[e.no = 3] = "no", e[e.cancel = 4] = "cancel", n.MessageBoxResult = e }(n.MessageBoxResult || {}), e = function() {
                    function e() {}
                    return e.Gq = function() { var e = $("<span></span>"); return e.css("background-color", "rgba(0,0,0,0)"), e.css("background-color") }, e.loadXML = function(e) { var t; return $.ajax({ url: e, async: !1, type: "GET", dataType: "xml", success: function(e) { t = e } }), t }, e
                }(), t = function() {
                    function e() {}
                    return e.Hq = function(t, i, o) { return { text: t, click: function(t) { e.Iq = !0, e.Eo.dialog("close", t), void 0 !== o && o(t, i) } } }, e.show = function(t, i, o, r, a) {
                        var s, l, c, d, p, u, h, f, g, m;
                        for (void 0 === o && (o = 0), void 0 === r && (r = 0), s = t.split("\n"), void 0 === e.Eo ? (e.Eo = $("<div></div>").addClass("message-box"), $("<span></span>").addClass("message-box-icon").appendTo(e.Eo), $("<div></div>").addClass("message-box-text-container").appendTo(e.Eo), $("<div></div>").addClass("clear-float").appendTo(e.Eo), e.Eo.dialog({ modal: !0, autoSize: !0, autoOpen: !1, resizable: !1, minWidth: 330, close: function(t) {!e.Iq && a && a(t, 0), e.Iq = !1 } })) : (e.Eo.dialog("destroy"), e.Eo.dialog({ modal: !0, autoSize: !0, autoOpen: !1, resizable: !1, minWidth: 330, close: function(t) {!e.Iq && a && a(t, 0), e.Iq = !1 } })), l = e.Eo, c = l.find(".message-box-icon"), c.attr("class", "message-box-icon"), c.addClass("message-box-icon-" + n.MessageBoxIcon[o]), d = l.find(".message-box-text-container"), d.empty(), p = 0; p < s.length; p++) u = $("<span></span>").addClass("message-box-text"), u.text(s[p]), u.appendTo(d);
                        switch (l.dialog("option", "title", i), h = e.Hq(n.res.ok, 1, a), f = e.Hq(n.res.cancel, 4, a), g = e.Hq(n.res.yes, 2, a), m = e.Hq(n.res.no, 3, a), r) {
                            case 0:
                                l.dialog("option", "buttons", [h]);
                                break;
                            case 1:
                                l.dialog("option", "buttons", [h, f]);
                                break;
                            case 2:
                                l.dialog("option", "buttons", [g, m, f])
                        }
                        l.dialog("open"), setTimeout(function() { return l.parent().find(".ui-dialog-titlebar").trigger("mousedown") }, 100)
                    }, e
                }(), n.MessageBox = t, r = n.util.resolveHtmlPath("../dialogs", "dialogs.html"), a = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".row-height-dialog") }
                    return i.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.rowHeightDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i, o, r = e.Eo.find("[name=row-height]").val();
                                    r.match(/^[0-9\.]*$/) ? (i = e.Jq(r)) && (o = parseInt(r), n.actions.doAction("setRowsHeight", n.wrapper.spread, o), e.close(), n.wrapper.setFocusToSpread()) : t.show(n.res.rowHeightDialog.exception, n.res.title, 2)
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype.Io = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.getRowHeight(e.getActiveRowIndex());
                        this.Eo.find("[name=row-height]").val(t)
                    }, i.prototype.Jq = function(e) { var i = !0; return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.rowHeightDialog.exception2, n.res.title, 2), i = !1), i }, i
                }(n.BaseDialog), n.RowHeightDialog = a, s = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".column-width-dialog") }
                    return i.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.columnWidthDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i, o, r = e.Eo.find("[name=column-width]").val();
                                    r.match(/^[0-9\.]*$/) ? (i = e.Jq(r)) && (o = parseInt(r), n.actions.doAction("setColumnsWidth", n.wrapper.spread, o), e.close(), n.wrapper.setFocusToSpread()) : t.show(n.res.columnWidthDialog.exception, n.res.title, 2)
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype.Io = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.getColumnWidth(e.getActiveColumnIndex());
                        this.Eo.find("[name=column-width]").val(t)
                    }, i.prototype.Jq = function(e) { var i = !0; return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.columnWidthDialog.exception2, n.res.title, 2), i = !1), i }, i
                }(n.BaseDialog), n.ColumnWidthDialog = s, l = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".font-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: 475, autoOpen: !1, resizable: !1, modal: !0, title: n.res.fontPickerDialog.title, buttons: [{ text: n.res.ok, click: function() { e.Kq(event, e.Lq()), e.close() } }, { text: n.res.cancel, click: function() { e.close() } }] } }, t.prototype._init = function() {
                        var e = this;
                        this.Eo.find(".font-picker").fontpicker({
                            changed: function(t, i) {
                                switch (i.name) {
                                    case "family":
                                        e.Mq = i.value;
                                        break;
                                    case "style":
                                        e.Nq = i.value;
                                        break;
                                    case "size":
                                        e.Oq = i.value;
                                        break;
                                    case "weight":
                                        e.Pq = i.value
                                }
                            },
                            isColorVisible: !1
                        })
                    }, t.prototype.Lq = function() { var e; return void 0 === this.Mq && void 0 === this.Nq && void 0 === this.Oq && void 0 === this.Pq ? e = "" : (e = this.Nq ? this.Nq : "normal", this.Pq ? e += " " + this.Pq : e += " normal", this.Oq ? e += " " + this.Oq + "pt" : e += " " + n.res.defaultFont.split(" ")[0], this.Mq ? e += " " + this.Mq : e += " " + n.res.defaultFont.split(" ")[1]), e }, t.prototype.Io = function(e) {
                        if (void 0 !== e[0] && null !== e[0] && "" !== e[0]) {
                            var t = n.util.parseFont(e[0]);
                            this.Eo.find(".font-picker").fontpicker("family", t.fontFamily), this.Eo.find(".font-picker").fontpicker("style", t.fontStyle), this.Eo.find(".font-picker").fontpicker("size", "" + parseFloat(t.fontSize)), this.Eo.find(".font-picker").fontpicker("weight", t.fontWeight)
                        } else this.Eo.find(".font-picker").fontpicker("family", ""), this.Eo.find(".font-picker").fontpicker("style", ""), this.Eo.find(".font-picker").fontpicker("size", ""), this.Eo.find(".font-picker").fontpicker("weight", ""), this.Mq = i, this.Nq = i, this.Oq = i, this.Pq = i
                    }, t.prototype.Kq = function(e, t) { $(this).trigger("dialogClose", t) }, t
                }(n.BaseDialog), n.FontPickerDialog = l, c = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".standard-width-dialog") }
                    return i.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.standardWidthDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i, o, r = e.Eo.find("[name=standard-column-width]").val();
                                    r.match(/^[0-9\.]*$/) ? (i = e.Jq(r)) && (o = parseInt(r), n.actions.doAction("defaultColumnWidth", n.wrapper.spread, o), e.close(), n.wrapper.setFocusToSpread()) : t.show(n.res.standardWidthDialog.exception, n.res.title, 2)
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype.Io = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.defaults.colWidth;
                        this.Eo.find("[name=standard-column-width]").val(t)
                    }, i.prototype.Jq = function(e) { var i = !0; return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.columnWidthDialog.exception2, n.res.title, 2), i = !1), i }, i
                }(n.BaseDialog), n.StandardColumnWidthDialog = c, d = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".standard-height-dialog") }
                    return i.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.standardHeightDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i, o, r = e.Eo.find("[name=standard-row-height]").val();
                                    r.match(/^[0-9\.]*$/) ? (i = e.Jq(r)) && (o = parseInt(r), n.actions.doAction("defaultRowHeight", n.wrapper.spread, o), e.close(), n.wrapper.setFocusToSpread()) : t.show(n.res.standardHeightDialog.exception, n.res.title, 2)
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype.Io = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.defaults.rowHeight;
                        this.Eo.find("[name=standard-row-height]").val(t)
                    }, i.prototype.Jq = function(e) { var i = !0; return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.rowHeightDialog.exception2, n.res.title, 2), i = !1), i }, i
                }(n.BaseDialog), n.StandardRowHeightDialog = d, p = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".insert-cells-dialog") }
                    return t.prototype.Do = function() { var e = this; return { resizable: !1, width: "auto", modal: !0, title: n.res.insertCellsDialog.title, buttons: [{ text: n.res.ok, click: function() { var t = e.Eo.find("input[name='insert-type']:checked").val(); "shiftcellsright" === t ? n.actions.doAction("insertRightCells", n.wrapper.spread) : "shiftcellsdown" === t ? n.actions.doAction("insertDownCells", n.wrapper.spread) : "entirerow" === t ? n.actions.doAction("insertRows", n.wrapper.spread) : "entirecolumn" === t && n.actions.doAction("insertColumns", n.wrapper.spread), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() { this.Eo.find("input[type='radio']").prop("checked", !1), this.Eo.find(".default-radio").prop("checked", !0).attr("autofocus", !0) }, t
                }(n.BaseDialog), n.InsertCellsDialog = p, u = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".delete-cells-dialog") }
                    return t.prototype.Do = function() { var e = this; return { resizable: !1, width: "auto", modal: !0, title: n.res.deleteCellsDialog.title, buttons: [{ text: n.res.ok, click: function() { var t = e.Eo.find("input[name='delete-type']:checked").val(); "shiftcellsleft" === t ? n.actions.doAction("deleteLeftCells", n.wrapper.spread) : "shiftcellsup" === t ? n.actions.doAction("deleteUpCells", n.wrapper.spread) : "entirerow" === t ? n.actions.doAction("deleteRows", n.wrapper.spread) : "entirecolumn" === t && n.actions.doAction("deleteColumns", n.wrapper.spread), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() { this.Eo.find("input[type='radio']").prop("checked", !1), this.Eo.find(".default-radio").prop("checked", !0).attr("autofocus", !0) }, t
                }(n.BaseDialog), n.DeleteCellsDialog = u, h = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".group-dialog") }
                    return t.prototype.Do = function() { var e = this; return { resizable: !1, width: "auto", modal: !0, title: n.res.groupDialog.title, buttons: [{ text: n.res.ok, click: function() { var t = e.Eo.find("input[name='group-type']:checked").val(); "rows" === t ? n.actions.doAction("groupRows", n.wrapper.spread) : "columns" === t && n.actions.doAction("groupColumns", n.wrapper.spread), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() { this.Eo.find("input[type='radio']").prop("checked", !1), this.Eo.find(".default-radio").prop("checked", !0).attr("autofocus", !0) }, t
                }(n.BaseDialog), n.GroupDialog = h, f = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".ungroup-dialog") }
                    return t.prototype.Do = function() { var e = this; return { resizable: !1, width: "auto", modal: !0, title: n.res.ungroupDialog.title, buttons: [{ text: n.res.ok, click: function() { var t = e.Eo.find("input[name='group-type']:checked").val(); "rows" === t ? n.actions.doAction("ungroupRows", n.wrapper.spread) : "columns" === t && n.actions.doAction("ungroupColumns", n.wrapper.spread), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() { this.Eo.find("input[type='radio']").prop("checked", !1), this.Eo.find(".default-radio").prop("checked", !0).attr("autofocus", !0) }, t
                }(n.BaseDialog), n.UnGroupDialog = f, g = function() {
                    function e() {}
                    return e.SearchInformation = function(e, t, i, o, n) { this.WithinWorksheet = e, this.SearchString = t, this.SearchFlags = i, this.SearchOrder = o, this.SearchFoundFlags = n }, e
                }(), n.SearchInformation = g, m = function() {
                    function e(e, t, i, o, n) { this.Qq = e, this.Rq = t, this.Sq = i, this.hi = o, this.Tq = n }
                    return e
                }(), n.FindResultInformation = m, b = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".find-dialog") }
                    return i.prototype.Do = function() { return { resizable: !1, width: "auto", modal: !0, title: n.res.findDialog.title } }, i.prototype.Uq = function() {
                        var e = this,
                            t = function(t, i) {
                                var o, r, a;
                                void 0 !== e.Vq && (o = i.addedCells.Ak[0].Si, r = e.Vq[o], a = n.wrapper.spread.getSheetFromName(r.sheet.name()), n.wrapper.spread.setActiveSheetIndex(n.wrapper.spread.sheets.indexOf(a)), n.wrapper.spread.getActiveSheet().setActiveCell(r.row, r.col), n.wrapper.spread.getActiveSheet().showCell(r.row, r.col, 3, 3))
                            };
                        this.Eo.find(".findall-grid").gcuigrid({ scrollMode: "auto", allowColMoving: !1, allowColSizing: !0, staticColumnIndex: -1, staticRowIndex: -1, columns: [{ headerText: "Book", dataType: "string" }, { headerText: "Sheet", dataType: "string" }, { headerText: "Cell", dataType: "string" }, { headerText: "Value", dataType: "string" }, { headerText: "Formula", dataType: "string" }], selectionChanged: t })
                    }, i.prototype.Wq = function(e) {
                        var t = this.Xq(e);
                        this.Eo.find(".findall-grid-container").addClass("show"), this.Eo.find(".findall-grid").addClass("show"), this.Eo.find(".findall-grid").gcuigrid({ data: t }), this.Eo.find(".findall-description-label").addClass("show").text(t.length + " cell(s) found")
                    }, i.prototype.Xq = function(e) { var t, i = []; for (t = 0; t < e.length; t++) i.push({ Book: e[t].Qq, Sheet: e[t].Rq, Cell: e[t].Sq, Value: e[t].hi, Formula: e[t].Tq }); return i }, i.prototype._init = function() {
                        var e = this;
                        this.Yq = this.Eo.find(".findwhat-input")[0], this.Zq = this.Eo.find("select[name='within']")[0], this.$q = this.Eo.find("select[name='search']")[0], this._q = this.Eo.find("select[name='lookin']")[0], this.ar = this.Eo.find(".matchcase-editor"), this.br = this.Eo.find(".matchexactly-editor"), this.dr = this.Eo.find(".usewildcards-editor"), this.er = this.Eo.find("button[name='option']"), this.Eo.find(".findall-button").button(), this.Eo.find(".findnext-button").button(), this.Eo.find(".close-button").button(), this.er.button(), this.Uq(), this.er.click(function() { e.Eo.find(".column1,.column2,.column3,.column4").toggleClass("column-hidden"), e.Eo.find(".row2,.row3").toggleClass("row-hidden"), e.gr(), e.er[0].children[0].textContent = n.res.findDialog.option + e.hr }), this.Eo.find(".findall-button").click(function() {
                            var i;
                            e.ir(), null != g && void 0 !== g.SearchString && (i = 0 === e.Zq.selectedIndex ? e.jr(n.wrapper.spread.getActiveSheet()) : e.jr(), i.length > 0 ? e.Wq(i) : (e.Eo.find(".findall-grid").gcuigrid("option", "data", []), t.show(n.res.findDialog.exception, n.res.title, 2), e.Eo.find(".findall-description-label").addClass("show").text("0cell(s) found")))
                        }), this.Eo.find(".findnext-button").click(function() { if (e.ir(), null != g && void 0 !== g.SearchString) { var i = e.kr();!0 !== i && t.show(n.res.findDialog.exception, n.res.title, 2) } }), this.Eo.find(".close-button").click(function() { e.close(), n.wrapper.setFocusToSpread() })
                    }, i.prototype.gr = function() { ">>" === this.hr ? this.hr = "<<" : this.hr = ">>" }, i.prototype.Io = function() { g.SearchInformation(void 0, void 0, void 0, void 0, void 0), this.lr = !1, this.mr = n.wrapper.spread.getActiveSheetIndex(), this.nr = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), this.or = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), "<<" === this.hr && (this.Eo.find(".column1,.column2,.column3,.column4").addClass("column-hidden"), this.Eo.find(".row2,.row3").addClass("row-hidden"), this.gr()), this.hr = ">>", this.er[0].children[0].textContent = n.res.findDialog.option + this.hr, this.Yq.value = "", this.Zq.selectedIndex = 0, this.$q.selectedIndex = 0, this._q.selectedIndex = 0, this.ar.removeAttr("checked"), this.br.removeAttr("checked"), this.dr.removeAttr("checked"), this.Eo.find(".findall-grid-container").removeClass("show"), this.Eo.find(".findall-description-label").removeClass("show") }, i.prototype.kr = function() {
                        if ("" === g.SearchString) return this.pr = -1, this.qr = -1, this.rr = -1, !0;
                        var e = !1;
                        if (this.lr) {
                            if (!this.sr()) return this.pr = -1, this.qr = -1, this.rr = -1, !1;
                            e = 1 === n.wrapper.spread.getActiveSheet().getSelections().length ? this.tr() : this.ur(), this.rr = n.wrapper.spread.getActiveSheetIndex()
                        } else if (g.WithinWorksheet) {
                            if (!this.vr(n.wrapper.spread.getActiveSheet())) return this.pr = -1, this.qr = -1, this.rr = -1, !1;
                            e = this.wr(n.wrapper.spread.getActiveSheet()), e && (this.or = this.qr, this.nr = this.pr, n.wrapper.spread.getActiveSheet().addSelection(this.pr, this.qr, 1, 1), n.wrapper.spread.getActiveSheet().setActiveCell(this.pr, this.qr), n.wrapper.spread.getActiveSheet().showCell(this.pr, this.qr, 3, 3)), this.rr = n.wrapper.spread.getActiveSheetIndex()
                        } else e = this.xr();
                        return e
                    }, i.prototype.vr = function(e) { var t, i, n, r = new o.Search.SearchCondition; return r.searchString = g.SearchString, r.searchFlags = 8 | g.SearchFlags, r.searchOrder = g.SearchOrder, r.searchTarget = g.SearchFoundFlags, r.sheetArea = 3, n = e.search(r), t = n.foundRowIndex, i = n.foundColumnIndex, -1 !== t && -1 !== i }, i.prototype.sr = function() {
                        var e, t, i, r, a, s, l, c, d, p, u = n.wrapper.spread.getActiveSheet().getSelections();
                        for (e = 0; e < u.length; e++)
                            if (t = u[e], i = t.row, r = t.col, a = t.row + t.rowCount - 1, s = t.col + t.colCount - 1, d = new o.Search.SearchCondition, d.searchString = g.SearchString, d.searchFlags = 8 | g.SearchFlags, d.searchOrder = g.SearchOrder, d.searchTarget = g.SearchFoundFlags, d.sheetArea = 3, d.rowStart = i, d.columnStart = r, d.rowEnd = a, d.columnEnd = s, p = n.wrapper.spread.getActiveSheet().search(d), l = p.foundRowIndex, c = p.foundColumnIndex, -1 !== l && -1 !== c) return !0;
                        return !1
                    }, i.prototype.ir = function() { var e, t, i, o, n = this.Yq.value; return "" === n ? null : (t = 0, "<<" === this.hr ? (e = 0 === this.Zq.selectedIndex, !0 !== this.ar.prop("checked") && (t |= 1), !0 === this.br.prop("checked") && (t |= 2), !0 === this.dr.prop("checked") && (t |= 4), i = 0 === this.$q.selectedIndex ? 0 : 1, 0 === this._q.selectedIndex ? o = 1 : 1 === this._q.selectedIndex && (o = 8, n = "=" === n.charAt(0) ? n.substr(1, n.length) : n)) : (e = !0, t = 1, i = 0, o = 1), g.SearchInformation(e, n, t, i, o)) }, i.prototype.yr = function(e, t) {
                        var i, o, n, r;
                        t && (i = t.row, o = t.col, n = t.row + t.rowCount - 1, r = t.col + t.colCount - 1, 0 === e ? -1 === this.or && -1 === this.nr ? (this.zr = 0, this.Ar = 0) : this.or < r ? (this.zr = this.nr, this.Ar = this.or + 1) : this.or === r ? (this.zr = this.nr + 1, this.Ar = 0) : (this.zr = i, this.Ar = o) : -1 === this.or && -1 === this.nr ? (this.zr = 0, this.Ar = 0) : this.nr < n ? (this.zr = this.nr + 1, this.Ar = this.or) : this.nr === n ? (this.zr = 0, this.Ar = this.or + 1) : (this.zr = i, this.Ar = o))
                    }, i.prototype.Br = function() {
                        var e, t, i = [],
                            o = this.mr;
                        for (e = o; e < n.wrapper.spread.getSheetCount(); e++) i.push(n.wrapper.spread.sheets[e]);
                        for (t = 0; t < o; t++) i.push(n.wrapper.spread.sheets[t]);
                        return i
                    }, i.prototype.Cr = function(e) { var t, i, r, a, s, l; return !!e && (this.yr(g.SearchOrder, e), r = e.row + e.rowCount - 1, a = e.col + e.colCount - 1, s = new o.Search.SearchCondition, s.searchString = g.SearchString, s.searchFlags = g.SearchFlags, s.searchOrder = g.SearchOrder, s.searchTarget = g.SearchFoundFlags, s.sheetArea = 3, s.rowStart = t, s.columnStart = i, s.rowEnd = r, s.columnEnd = a, l = n.wrapper.spread.getActiveSheet().search(s), this.pr = l.foundRowIndex, this.qr = l.foundColumnIndex, !(-1 === this.pr || -1 === this.qr)) }, i.prototype.Dr = function(e) { var t, i, n, r; return this.yr(g.SearchOrder, new o.Range(0, 0, e.getRowCount(), e.getColumnCount())), t = e.getRowCount() - 1, i = e.getColumnCount() - 1, n = new o.Search.SearchCondition, n.searchString = g.SearchString, n.searchFlags = g.SearchFlags, n.searchOrder = g.SearchOrder, n.searchTarget = g.SearchFoundFlags, n.sheetArea = 3, n.rowStart = this.zr, n.columnStart = this.Ar, n.rowEnd = t, n.columnEnd = i, r = e.search(n), this.pr = r.foundRowIndex, this.qr = r.foundColumnIndex, -1 !== this.pr && -1 !== this.qr }, i.prototype.tr = function() { var e, t; return this.pr = -1, this.qr = -1, !!(e = n.wrapper.spread.getActiveSheet().getSelections()[0]) && (t = this.Cr(e), t ? this.Er(e, this.pr, this.qr) ? (this.nr = this.pr, this.or = this.qr, n.wrapper.spread.getActiveSheet().setActiveCell(this.pr, this.qr), n.wrapper.spread.getActiveSheet().showCell(this.pr, this.qr, 3, 3), !0) : (0 === g.SearchOrder ? (this.nr++, this.or = e.col - 1) : (this.or++, this.nr = e.row - 1), this.tr()) : (0 === g.SearchOrder ? (this.nr = e.row, this.or = e.col - 1) : (this.nr = e.row - 1, this.or = e.col), this.tr())) }, i.prototype.ur = function() { var e, t, i; return this.pr = -1, this.qr = -1, !!(e = this.Fr) && (t = new o.Range(e.row, e.col, e.rowCount, e.colCount), i = this.Cr(t), i ? this.Gr(this.pr, this.qr) ? (this.nr = this.pr, this.or = this.qr, n.wrapper.spread.getActiveSheet().setActiveCell(this.pr, this.qr), n.wrapper.spread.getActiveSheet().showCell(this.pr, this.qr, 3, 3), !0) : (0 === g.SearchOrder ? (this.nr++, this.or = e.col) : (this.or++, this.nr = e.row), this.ur()) : (0 === g.SearchOrder ? (this.nr = e.row, this.or = e.col - 1) : (this.nr = e.row - 1, this.or = e.col), this.ur())) }, i.prototype.wr = function(e) { this.pr = -1, this.qr = -1; var t = this.Dr(e); return t ? (this.nr = this.pr, this.or = this.qr, n.wrapper.spread.getActiveSheet().addSelection(this.pr, this.qr, 1, 1), n.wrapper.spread.getActiveSheet().showCell(this.pr, this.qr, 3, 3), !0) : (this.nr = -1, this.or = -1, this.Dr(e)) }, i.prototype.xr = function() {
                        var e, t, i, o, r = this.Br();
                        for (this.pr = -1, this.qr = -1, this.rr = -1, e = 0; e < r.length; e++)
                            if (t = r[e], i = n.wrapper.spread.sheets.indexOf(t), i !== n.wrapper.spread.getActiveSheetIndex() && (this.nr = -1, this.or = -1), o = this.Dr(t)) { this.rr = i; break } return -1 !== this.rr && (this.mr = this.rr, this.nr = this.pr, this.or = this.qr, n.wrapper.spread.setActiveSheetIndex(this.rr), n.wrapper.spread.getActiveSheet().setActiveCell(this.pr, this.qr), n.wrapper.spread.getActiveSheet().showCell(this.pr, this.qr, 3, 3), !0)
                    }, i.prototype.Er = function(e, t, i) { return !!e && (t >= e.row && t <= e.row + e.rowCount && i >= e.col && i <= e.col + e.colCount) }, i.prototype.Gr = function(e, t) {
                        var i, o, r = n.wrapper.spread.getActiveSheet().getSelections();
                        for (i = 0; i < r.length; i++)
                            if (o = r[i], this.Er(o, e, t)) return !0;
                        return !1
                    }, i.prototype.jr = function(e) { this.Vq = []; var t; return t = void 0 === e ? this.Hr(n.wrapper.spread) : this.Ir(e) }, i.prototype.Ir = function(e) {
                        var t, i, r, a, s, l = [],
                            c = 0,
                            d = 0,
                            p = e.getRowCount() - 1,
                            u = e.getColumnCount() - 1,
                            h = -1,
                            f = -1,
                            b = new o.Search.SearchCondition;
                        for (b.searchString = g.SearchString, b.searchFlags = g.SearchFlags, b.searchOrder = g.SearchOrder, b.searchTarget = g.SearchFoundFlags, b.sheetArea = 3, b.rowStart = c, b.columnStart = d, b.rowEnd = p, b.columnEnd = u, t = e.search(b), h = t.foundRowIndex, f = t.foundColumnIndex; - 1 !== h && -1 !== f;) i = e.getCell(h, f), r = "" === n.wrapper.spread.name || null === n.wrapper.spread.name ? "Default" : n.wrapper.spread.name, a = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute), s = new m(r, e.name(), a, i.text(), i.formula()), l.push(s), this.Vq.push(i), 0 === g.SearchOrder ? (c = h, (d = f + 1) >= e.getColumnCount() && c < e.getRowCount() && (c = h + 1, d = 0)) : (c = h + 1, d = f, c >= e.getRowCount() && d < e.getColumnCount() && (c = 0, d = f + 1)), b = new o.Search.SearchCondition, b.searchString = g.SearchString, b.searchFlags = g.SearchFlags, b.searchOrder = g.SearchOrder, b.searchTarget = g.SearchFoundFlags, b.sheetArea = 3, b.rowStart = c, b.columnStart = d, b.rowEnd = p, b.columnEnd = u, t = e.search(b), h = t.foundRowIndex, f = t.foundColumnIndex;
                        return l
                    }, i.prototype.Hr = function(e) {
                        var t, i, r, a, s, l = [],
                            c = 0,
                            d = 0,
                            p = -1,
                            u = -1,
                            h = -1,
                            f = new o.Search.SearchCondition;
                        for (f.startSheetIndex = 0, f.endSheetIndex = e.getSheetCount() - 1, f.searchString = g.SearchString, f.searchFlags = g.SearchFlags, f.searchOrder = g.SearchOrder, f.searchTarget = g.SearchFoundFlags, f.sheetArea = 3, t = e.search(f), p = t.foundRowIndex, u = t.foundColumnIndex, h = t.foundSheetIndex; - 1 !== p && -1 !== u || h <= e.getSheetCount() - 1 && -1 !== h;) f = new o.Search.SearchCondition, -1 !== p && -1 !== u ? (i = e.sheets[h].getCell(p, u), r = "" === n.wrapper.spread.name || null === n.wrapper.spread.name ? "Default" : n.wrapper.spread.name, a = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute), s = new m(r, e.sheets[h].name(), a, i.text(), i.formula()), l.push(s), this.Vq.push(i), 0 === g.SearchOrder ? (c = p, (d = u + 1) >= e.sheets[h].getColumnCount() && c < e.sheets[h].getRowCount() && (c = p + 1, d = 0)) : (c = p + 1, d = u, c >= e.sheets[h].getRowCount() && d < e.sheets[h].getColumnCount() && (c = 0, d = u + 1)), f.rowStart = c, f.columnStart = d) : (f.rowStart = 0, f.columnStart = 0, f.rowEnd = e.sheets[h].getRowCount() - 1, f.columnEnd = e.sheets[h].getColumnCount() - 1), f.searchString = g.SearchString, f.searchFlags = g.SearchFlags, f.searchOrder = g.SearchOrder, f.searchTarget = g.SearchFoundFlags, f.sheetArea = 3, f.startSheetIndex = h, f.endSheetIndex = h, f.sheetArea = 3, t = e.search(f), p = t.foundRowIndex, u = t.foundColumnIndex, -1 !== t.foundSheetIndex ? h = t.foundSheetIndex : h++;
                        return l
                    }, i
                }(n.BaseDialog), n.FindDialog = b, v = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".goto-dialog") }
                    return i.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            width: "auto",
                            modal: !0,
                            title: n.res.gotoDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i = e.Eo.find(".goto-value-input").val(),
                                        o = e.Jr(i);
                                    !0 === o ? e.close() : t.show(n.res.gotoDialog.exception, n.res.title, 3), n.wrapper.setFocusToSpread()
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype._init = function() {
                        var e = this;
                        this.Eo.find(".goto-list").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            e.Eo.find(".goto-value-input").prop("value", o.value)
                        })
                    }, i.prototype.Io = function() {
                        var e, t, i, o, r = this.Eo.find(".goto-list")[0].options;
                        for (this.Eo.find(".goto-list").empty(), this.Eo.find(".goto-value-input").prop("value", ""), e = 0, t = 0; t < n.wrapper.spread.sheets.length; t++)
                            if (void 0 !== (o = n.wrapper.spread.sheets[t].getCustomNames()))
                                for (i = 0; i < o.length; i++) r[e++] = new Option(o[i].getName());
                        if (void 0 !== (o = n.wrapper.spread.getCustomNames()))
                            for (i = 0; i < o.length; i++) r[e++] = new Option(o[i].getName())
                    }, i.prototype.Jr = function(e) {
                        var t, i, o, r, a, s, l, c = -1;
                        if (void 0 === e || "" === e) return !1;
                        for (o = this.Eo.find(".goto-list")[0].options, r = !1, a = 0; a < o.length; a++)
                            if (e === o[a].textContent) { r = !0; break } if (r) {
                            for (s = n.wrapper.spread.getCustomName(e), a = 0; a < n.wrapper.spread.sheets.length; a++)
                                if (s || (s = n.wrapper.spread.sheets[a].getCustomName(e)), s) { c = a; break } t = s.getExpression()
                        } else l = n.wrapper.spread.getActiveSheet(), t = GC.Spread.Sheets.CalcEngine.formulaToExpression(l, e);
                        if (this.Kr = null, i = this.Lr(t), null == this.Kr) return !1;
                        for (a = 0; a < n.wrapper.spread.sheets.length; a++)
                            if (n.wrapper.spread.sheets[a].name() === this.Kr.name()) { c = a; break } return -1 !== c && n.wrapper.spread.setActiveSheetIndex(c), n.wrapper.spread.getActiveSheet().clearSelection(), n.wrapper.spread.getActiveSheet().setSelection(i.row, i.col, i.rowCount, i.colCount), n.wrapper.spread.getActiveSheet().showCell(i.row, i.col, 3, 3), !0
                    }, i.prototype.Lr = function(e) { var t = n.wrapper.spread.getActiveSheet(); return this.Kr = e.source ? e.source.getSheet() : t, e.getRange(0, 0) }, i
                }(n.BaseDialog), n.GoToDialog = v, y = {}, ["#NULL!", "#DIV/0!", "#VALUE!", "#REF!", "#NAME?", "#N/A", "#NUM!"].forEach(function(e) { y[e] = !0 }), w = function(e) {
                    var t, i, o, a, s, l, c, d, p, u, h, f, g, m, b, v, y;
                    n.extends(w, e);

                    function w(t) { e.call(this, r, ".richtext-dialog") }
                    return t = Object.assign || function(e) { var t, i, o; for (t = 1; t < arguments.length; t++) { i = arguments[t]; for (o in i) Object.prototype.hasOwnProperty.call(i, o) && (e[o] = i[o]) } return e }, i = function(e, t, i) { return e.addEventListener(t, i) }, o = function(e, t) { return e.appendChild(t) }, a = function(e) { return document.createElement(e) }, s = function(e) { return document.queryCommandState(e) }, l = function(e) { return document.queryCommandValue(e) }, c = { actionbar: "rich-editor-actionbar", button: "rich-editor-button", content: "rich-editor-content", selected: "rich-editor-button-selected" }, d = "defaultParagraphSeparator", p = "formatBlock", u = function(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null; return document.execCommand(e, !1, t) }, h = function(e) { return e <= 10 ? 1 : e <= 13 ? 2 : e <= 16 ? 3 : e <= 18 ? 4 : e <= 24 ? 5 : e <= 32 ? 6 : 7 }, f = [0, 10, 13, 16, 18, 24, 32, 48], g = function(e) { e && e.stopPropagation ? e.stopPropagation() : window.event.cancelBubble = !0 }, m = function(e) {
                        var t = e.split(","),
                            i = parseInt(t[0].split("(")[1]),
                            o = parseInt(t[1]),
                            n = parseInt(t[2].split(")")[0]);
                        return "#" + ((1 << 24) + (i << 16) + (o << 8) + n).toString(16).slice(1)
                    }, b = function(e, t) {
                        var i;
                        switch (e) {
                            case "subscript":
                                i = a("sub");
                                break;
                            case "superscript":
                                i = a("sup");
                                break;
                            case "underline":
                                i = a("u");
                                break;
                            case "strikeThrough":
                                i = a("strike");
                                break;
                            case "foreColor":
                                i = a("font"), i.color = m(t);
                                break;
                            case "fontName":
                                i = a("font"), i.face = t;
                                break;
                            case "fontSize":
                                i = a("font"), i.size = h(t);
                                break;
                            case "bold":
                                i = a("b");
                                break;
                            case "italic":
                                i = a("i");
                                break;
                            default:
                                i = a("span")
                        }
                        return i
                    }, v = function(e) {
                        for (var t = n.res.ribbon.fontFamilies, i = e, o = [], r = "ff", a = 1, s = r + a; t[s];) o.push('<li class="fontfamily-item">' + t[s].name + "</li>"), a++, s = r + a;
                        i.append($(o.join("")))
                    }, y = {
                        fontFamily: {
                            icon: '<span id="fontFamilyValue"  class="font-family-value">Calibri</span><span class="drop-down-arrow"></span>',
                            title: n.res.richTextDialog.fontFamilyTitle,
                            type: "drop-down",
                            specialStyle: { width: "164px" },
                            dropDownListId: "fontFamilyList",
                            queryValue: function() {
                                var e = l("fontName").replace(/"/g, "");
                                e.length > 15 && (e = e.substring(0, 15) + "..."), document.getElementById("fontFamilyValue").innerText = e
                            },
                            result: function(e) { e.currentTarget.style.display = "none", g(e); var t = "LI" === e.target.nodeName.toUpperCase() ? e.target.innerText : null; return !!t && (document.getElementById("fontFamilyValue").innerText = t, u("fontName", t), !0) }
                        },
                        fontSize: {
                            icon: '<span id="fontSizeValue">13</span><span class="drop-down-arrow"></span>',
                            title: n.res.richTextDialog.fontSizeTitle,
                            type: "drop-down",
                            specialStyle: { width: "40px" },
                            dropDownListId: "fontSizeList",
                            queryValue: function() {
                                var e = [0, 10, 13, 16, 18, 24, 32, 48],
                                    t = l("fontSize");
                                document.getElementById("fontSizeValue").innerText = e[t] ? e[t] : document.getElementById("fontSizeValue").innerText
                            },
                            result: function(e) { e.currentTarget.style.display = "none", g(e); var t = "LI" === e.target.nodeName.toUpperCase() ? parseInt(e.target.value) : null; return null !== t && (document.getElementById("fontSizeValue").innerText = f[t], u("fontSize", t), !0) }
                        },
                        bold: { icon: "<b>B</b>", title: n.res.richTextDialog.boldTitle, state: function() { return s("bold") }, result: function() { return u("bold") } },
                        italic: { icon: "<i>I</i>", title: n.res.richTextDialog.italicTitle, state: function() { return s("italic") }, result: function() { return u("italic") } },
                        underline: { icon: "<u>U</u>", title: n.res.richTextDialog.underlineTitle, state: function() { return s("underline") }, result: function() { return u("underline") } },
                        strikethrough: {
                            icon: "<strike>S</strike>",
                            title: n.res.richTextDialog.strikethroughTitle,
                            state: function() {
                                return s("strikeThrough")
                            },
                            result: function() { return u("strikeThrough") }
                        },
                        colorPicker: {
                            icon: '<span id="foreColorValue" class="color_picker_result">&nbsp;A&nbsp;</span><span class="drop-down-arrow fas fa-caret-down fa-lg fa-pull-right"></span>',
                            title: n.res.richTextDialog.colorPickerTitle,
                            type: "designer-gcui-widget",
                            specialStyle: { width: "40px" },
                            widgetId: ".rich-editor-color-picker",
                            initWidget: function() { var e = a("div"); return e.className = "rich-editor-color-picker", $(e).colorpicker({ valueChanged: function(e, t) { void 0 !== t.color && (u("foreColor", t.baseColor), $("#foreColorValue").css("borderBottom", "5px solid " + t.baseColor)), $(".rich-editor-color-picker").hide() } }), $(e).find(".colorpicker-div-nocolor").hide(), $(e).find(".colorpicker-div-morecolors").hide(), $(e).hide(), e },
                            queryValue: function() {
                                var e = l("foreColor");
                                document.getElementById("foreColorValue").style.borderBottomColor = e
                            }
                        },
                        superScript: { icon: "X<sup>2</sup>", title: n.res.richTextDialog.superScriptTitle, state: function() { return s("superscript") }, result: function() { return u("superscript") } },
                        subScript: { icon: "X<sub>2</sub>", title: n.res.richTextDialog.subScriptTitle, state: function() { return s("subscript") }, result: function() { return u("subscript") } }
                    }, w.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            autoOpen: !1,
                            width: "auto",
                            modal: !0,
                            preventDefaultOkButton: !0,
                            title: n.res.richTextDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = n.wrapper.spread.getActiveSheet(),
                                        i = e.Mr();
                                    i.length > 0 && t.setValue(t.getActiveRowIndex(), t.getActiveColumnIndex(), { richText: i }), e.close()
                                }
                            }, { text: n.res.cancel, click: function() { e.close() } }]
                        }
                    }, w.prototype.Io = function(e) {
                        var t, i = this;
                        $("#richEditor").children().remove(), t = { exec: u, init: i.Nr }, t.init({ element: document.getElementById("richEditor"), defaultParagraphSeparator: "p", styleWithCSS: !1 })
                    }, w.prototype.Mr = function() { for (var e, t = this, i = document.createNodeIterator(document.getElementsByClassName("rich-editor-content")[0], NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_TEXT, null, !1), o = i.nextNode(), n = [], r = {}, a = "", s = i.nextNode(), l = null, c = null, d = null; null !== s;) 3 === s.nodeType ? (a = s.nodeValue, r = document.defaultView.getComputedStyle(s.parentElement, null), l && !1 === l.contains(s) && (l = null), c && !1 === c.contains(s) && (c = null), d && t.Or(d) === s && t.Or(o) !== s && (a += "\r\n", d = null), e = t.Pr(r, l, c), t.Qr(o, s, e), n.push({ style: e, text: a })) : "p" === s.nodeName.toLowerCase() ? d = s : "u" === s.nodeName.toLowerCase() ? l = s : "strike" === s.nodeName.toLowerCase() && (c = s), s = i.nextNode(); return n }, w.prototype.Qr = function(e, t, i) {
                        if (e !== t)
                            for (; t.parentNode !== e;) { if ("sub" === t.nodeName.toLowerCase()) { i.vertAlign = 2; break } if ("sup" === t.nodeName.toLowerCase()) { i.vertAlign = 1; break } t = t.parentNode }
                    }, w.prototype.Pr = function(e, t, i) { return { font: ("700" === e.fontWeight ? "bold " : "") + ("italic" === e.fontStyle ? "italic " : "") + e.fontSize + " " + e.fontFamily, foreColor: e.color, textDecoration: (t ? 1 : 0) | (i ? 2 : 0) } }, w.prototype.Or = function(e) { var t, i = this; return e && 1 === e.nodeType ? (t = e.lastChild, i.Or(t)) : e }, w.prototype.Nr = function(e) {
                        var r, s, h, f, g, m, w, x, C, S, k = n.wrapper.spread.getActiveSheet(),
                            T = e.actions ? e.actions.map(function(e) { return "string" == typeof e ? y[e] : y[e.name] ? t({}, y[e.name], e) : e }) : Object.keys(y).map(function(e) { return y[e] }),
                            A = t({}, c, e.classes),
                            E = e[d] || "div",
                            I = a("div");
                        if (I.className = A.actionbar, o(e.element, I), r = e.element.content = a("div"), r.contentEditable = !0, r.className = A.content, r.oninput = function(e) {
                                var t = e.target.firstChild;
                                t && 3 === t.nodeType ? u(p, "<" + E + ">") : "<br>" === r.innerHTML && (r.innerHTML = "")
                            }, r.onkeydown = function(e) { "Tab" === e.key ? e.preventDefault() : "Enter" === e.key && "blockquote" === l(p) && setTimeout(function() { return u(p, "<" + E + ">") }, 0) }, o(e.element, r), s = k.getValue(k.getActiveRowIndex(), k.getActiveColumnIndex(), 3, 1), h = a(E), s && s.richText)
                            for (f = 0; f < s.richText.length; f++) {
                                if (g = [], s.richText[f].style && s.richText[f].text)
                                    for (m in s.richText[f].style)
                                        if (s.richText[f].style.hasOwnProperty(m)) switch (m) {
                                            case "vertAlign":
                                                2 === s.richText[f].style[m] ? g.push("subscript") : 1 === s.richText[f].style[m] && g.push("superscript");
                                                break;
                                            case "textDecoration":
                                                1 == (1 & s.richText[f].style[m]) && g.push("underline"), 2 == (2 & s.richText[f].style[m]) && g.push("strikeThrough");
                                                break;
                                            case "foreColor":
                                                g.push({ name: "foreColor", value: s.richText[f].style[m] });
                                                break;
                                            case "font":
                                                w = a("div"), w.style.font = s.richText[f].style[m], w.style.fontFamily && g.push({ name: "fontName", value: w.style.fontFamily }), w.style.fontSize && g.push({ name: "fontSize", value: parseInt(w.style.fontSize) }), "bold" === w.style.fontWeight && g.push("bold"), "italic" === w.style.fontStyle && g.push("italic")
                                        }
                                for (x = h, C = 0; C < g.length; C++) "string" == typeof g[C] ? S = b(g[C]) : "object" == typeof g[C] && g[C] && (S = b(g[C].name, g[C].value)), o(x, S), x = S, C === g.length - 1 && S && (S.innerHTML = s.richText[f].text)
                            } else h.innerHTML = s;
                        return o(r, h), self.Rr || (v($("#fontFamilyList")), self.Rr = !0), T.forEach(function(e) {
                            var t, n, s, l = a("button");
                            if (l.className = A.button, l.innerHTML = e.icon, e.specialStyle)
                                for (t in e.specialStyle) e.specialStyle.hasOwnProperty(t) && (l.style[t] = e.specialStyle[t]);
                            "designer-gcui-widget" === e.type && (n = e.initWidget(), o(l, n)), l.setAttribute("type", "button"), l.onclick = function() {
                                var t, o, n, a = document.getElementsByClassName("list"),
                                    s = document.getElementById(e.dropDownListId);
                                for (t = 0; t < a.length; t++) a[t] !== s && (a[t].style.display = "none");
                                if ("drop-down" === e.type) l.contains(s) ? "none" === s.style.display ? s.style.display = "block" : s.style.display = "none" : (o = s.cloneNode(!0), e.queryValue && i(o, "click", e.queryValue), l.appendChild(o), n = l.offsetHeight, o.style.top = n + "px", o.style.display = "block", o.onclick = function(t) { return e.result(t) && r.focus() });
                                else {
                                    if ("designer-gcui-widget" !== e.type) return e.result() && r.focus();
                                    $(e.widgetId).toggle()
                                }
                            }, e.state && (s = function() { return l.classList[e.state() ? "add" : "remove"](A.selected) }, i(r, "keyup", s), i(r, "mouseup", s), i(l, "click", s)), e.queryValue && (s = e.queryValue, i(r, "keyup", s), i(r, "mouseup", s), i(l, "click", s)), o(I, l)
                        }), e.styleWithCSS && u("styleWithCSS"), u(d, E), e.element
                    }, w
                }(n.BaseDialog), n.RichTextDialog = w, x = function(e) {
                    n.extends(i, e);

                    function i(t) { e.call(this, r, ".new-name-dialog"), void 0 !== t && (this.Sr = t) }
                    return i.prototype.Do = function() { var e = this; return { resizable: !1, autoOpen: !1, width: "auto", modal: !0, buttons: [{ text: n.res.ok, click: function() { e.Tr() && e.close() } }, { text: n.res.cancel, click: function() { e.close() } }] } }, i.prototype._init = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            e.Ur || (e.Ur = new n.RangeSelectDialog(e, { absoluteReference: !0 }));
                            var t = e.Eo.dialog("option", "title") + "-" + n.res.newNameDialog.referTo;
                            e.hide(), e.Ur.open(t, e.Vr, e.Eo.find(".referTo").val(), [".referTo"])
                        })
                    }, i.prototype.Jo = function() { void 0 !== this.Sr && this.Sr.open() }, i.prototype.Vr = function(e, t) { this.Eo.find(e).val(t) }, i.prototype.Wr = function(e) { var t = n.wrapper.spread.options.referenceStyle; return n.util.isValidateSheetName(e, t, !1) ? e : n.util.isValidateSheetName(e, t, !0) ? "'" + e + "'" : null }, i.prototype.Io = function(e) {
                        var t, i, r, a, s, l, c, d, p, u, h = this;
                        for (h.Xr = e, t = this.Eo.find(".name-input"), i = this.Eo.find(".scope-select"), r = this.Eo.find(".referTo"), a = this.Eo.find(".comment-input"), s = i[0].options, i.empty(), s.add(new Option(n.res.newNameDialog.scope.workbook)), l = 0; l < n.wrapper.spread.sheets.length; l++) s.add(new Option(n.wrapper.spread.sheets[l].name()));
                        if ("new" === e[0]) {
                            for ($(".scope-select").removeAttr("disabled"), this.Eo.dialog("option", "title", n.res.newNameDialog.titleNew), this.Eo.dialog("option", "modal", !0), t.prop("value", ""), i.prop("selectedIndex", 0), c = n.wrapper.spread.sheets[n.wrapper.spread.getActiveSheetIndex()].getSelections(), d = "=", l = 0; l < c.length; l++) p = c[l], u = o.CalcEngine.rangeToFormula(p, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute), u = this.Wr(n.wrapper.spread.getActiveSheet().name()) + "!" + u, d += u + ",";
                            d = d.slice(0, d.length - 1), r.prop("value", d), a.prop("value", "")
                        } else if ("edit" === e[0]) {
                            for ($(".scope-select").attr("disabled", "disabled"), this.selectedItem = e[1], this.Eo.dialog("option", "title", n.res.newNameDialog.titleEdit), this.Eo.dialog("option", "modal", !0), t.prop("value", this.selectedItem.name), r.prop("value", this.selectedItem.refersTo), l = 0; l < s.length; l++) s[l].innerText === this.selectedItem.scope && $(s[l]).prop("selected", !0);
                            a.prop("value", this.selectedItem.comment)
                        }
                    }, i.prototype.Tr = function() {
                        var e, i, o, r, a, s, l = this,
                            c = l.Xr,
                            d = l.Eo.find(".scope-select"),
                            p = l.Eo.find(".name-input"),
                            u = this.Eo.find(".comment-input"),
                            h = this.Eo.find(".referTo"),
                            f = 0 === d[0].selectedIndex,
                            g = d[0].selectedIndex - 1,
                            m = n.wrapper.spread,
                            b = n.res,
                            v = l.selectedItem,
                            y = function() { p.select(), p.focus() };
                        if ("" === p.val()) return void t.show(b.nameManagerDialog.exception1, b.title, 2, 0, y);
                        if (v || "new" === c[0]) {
                            if (v && (e = v.name), ("edit" !== c[0] || p.val() !== e) && null !== (i = f ? m.getCustomName(p.val()) : m.sheets[g].getCustomName(p.val())) && void 0 !== i) return void t.show(b.nameManagerDialog.exception2, b.title, 2, 0, y);
                            if (o = p.val(), !(r = (f ? m : m.sheets[g]).isValidCustomName(o))) return void t.show(b.newNameDialog.wrongName, b.title, 3, 0, y);
                            a = m.getActiveSheet(), s = { arg: c[0], scope: l.selectedItem ? l.selectedItem.scope : void 0, name: l.selectedItem ? l.selectedItem.name : void 0, commentValue: u.val(), nameValue: p.val(), referToValue: h.val(), sheetIndex: g, inWorkbook: f, activeRowIndex: a.getActiveRowIndex(), activeColumnIndex: a.getActiveColumnIndex() }, n.actions.doAction("baseDialogCommand", n.wrapper.spread, { value: s, execute: n.spreadActions.dialogAction.newNameDialoagApplySetting }), l.close()
                        }
                        return !0
                    }, i
                }(n.BaseDialog), n.NewNameDialog = x, C = function(e) {
                    n.extends(i, e);

                    function i() { e.call(this, r, ".name-manager-dialog") }
                    return i.prototype.Do = function() { var e = this; return { resizable: !1, height: 550, width: 640, minWidth: 640, maxWidth: 640, minHeight: 550, maxHeight: 550, modal: !0, title: n.res.nameManagerDialog.title, buttons: [{ text: n.res.close, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, i.prototype.Io = function() {
                        var e = this,
                            t = this.Eo.find(".edit-button"),
                            i = this.Eo.find(".delete-button"),
                            o = this.Eo.find(".names-grid");
                        this.Yr(), o.gcuigrid("option", "data", this.Xq()), this.Zr.length > 0 ? ($(t).button("enable"), $(i).button("enable")) : ($(t).button("disable"), $(i).button("disable")), setTimeout(function() { o.gcuigrid("doRefresh", e.Xq()) }, 0)
                    }, i.prototype._init = function() {
                        var e, i, o = this,
                            r = this.Eo.find(".names-grid"),
                            a = this.Eo.find(".edit-button"),
                            s = this.Eo.find(".delete-button"),
                            l = this.Eo.find(".filter-select"),
                            c = function(e, t) { o.$r = t.addedCells.Ak[0].Si },
                            d = function(e, t) {
                                var i = o.Eo.find(".gcui-gcuigrid-scroller"),
                                    n = o.Eo.find(".gcui-superpanel-statecontainer"),
                                    a = parseInt(n.css("width")) >= 605,
                                    s = parseInt(n.css("height"));
                                a ? (i.css("height", s + 18 + "px"), n.css("height", s + 18 + "px")) : r.gcuigrid("doRefresh")
                            };
                        r.gcuigrid({ scrollMode: "horizontal", allowColMoving: !1, allowColSizing: !0, height: "auto", columns: [{ headerText: n.res.nameManagerDialog.nameColumn, dataType: "string", width: 120, ensurePxWidth: !0 }, { headerText: n.res.nameManagerDialog.valueColumn, dataType: "string", width: 122, ensurePxWidth: !0 }, { headerText: n.res.nameManagerDialog.refersToColumn, dataType: "string", width: 120, ensurePxWidth: !0 }, { headerText: n.res.nameManagerDialog.scopeColumn, dataType: "string", width: 120, ensurePxWidth: !0 }, { headerText: n.res.nameManagerDialog.commentColumn, dataType: "string", width: 120, ensurePxWidth: !0 }], selectionChanged: c, columnResized: d }), e = this, i = this.Eo.find(".filter-select")[0].options, i.add(new Option(n.res.nameManagerDialog.filterWith.clearFilter)), i.add(new Option(n.res.nameManagerDialog.filterWith.nameScopedToWorkbook)), i.add(new Option(n.res.nameManagerDialog.filterWith.nameScopedToWorksheet)), i.add(new Option(n.res.nameManagerDialog.filterWith.nameWithErrors)), i.add(new Option(n.res.nameManagerDialog.filterWith.nameWithoutErrors)), this.Eo.find(".new-button").button(), a.button(), s.button(), this._r = new x(this), this.Eo.find(".new-button").click(function() { o.close(), o._r.open("new", void 0) }), a.click(function() { o.close(), o._r.open("edit", o.Zr[o.$r]) }), s.click(function() {
                            t.show(n.util.format(n.res.nameManagerDialog.deleteAlert, o.Zr[o.$r].name), APP_NAME, 2, 1, function(e, t) {
                                var i, l;
                                if (1 === t) {
                                    if ("Workbook" === o.Zr[o.$r].scope) n.wrapper.spread.removeCustomName(o.Zr[o.$r].name);
                                    else {
                                        for (l = 0; l < n.wrapper.spread.sheets.length; l++)
                                            if (n.wrapper.spread.sheets[l].name() === o.Zr[o.$r].scope) { i = l; break } n.wrapper.spread.sheets[i].removeCustomName(o.Zr[o.$r].name)
                                    }
                                    o.Yr(), r.gcuigrid("option", "data", o.Xq()), 0 === o.Zr.length && ($(a).button("disable"), $(s).button("disable"))
                                }
                            })
                        }), l.change(function() { r = e.Eo.find(".names-grid"), o.Yr(), r.gcuigrid("option", "data", o.Xq()), 0 === o.Zr.length ? ($(a).button("disable"), $(s).button("disable")) : ($(a).button("enable"), $(s).button("enable")) })
                    }, i.prototype.Xq = function() { var e, t, i, o = []; for (e = 0; e < this.Zr.length; e++) t = { Name: this.Zr[e].name, Value: this.Zr[e].value, "Refers To": this.Zr[e].refersTo, Scope: this.Zr[e].scope }, i = this.Zr[e].comment, i && (t.Comment = ("" + i).replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;")), o.push(t); return this.G = new n.gcui.data.ArrayDataView(o), this.G }, i.prototype.as = function(e) {
                        var t, i, o, r, a, s, l, c, d, p = "";
                        if (e.type === GC.Spread.CalcEngine.ExpressionType.operator) p = "{...}";
                        else { if (e.source instanceof GC.Spread.CalcEngine.ErrorSource) return "{...}"; if (t = e.source ? e.source.getSheet() : n.wrapper.spread.getActiveSheet(), i = e.column, o = e.row, r = e.endColumn ? e.endColumn - i + 1 : 1, a = e.endRow ? e.endRow - o + 1 : 1, i < 0 && (i = 0, r = t.getColumnCount()), o < 0 && (o = 0, a = t.getRowCount()), e.endRow) { for (s = t.getArray(o, i, a, r), l = !1, c = 0; c < s.length; c++) { for (d = 0; d < s[c].length; d++) null === s[c][d] ? p += '"",' : p += '"' + s[c][d] + '",'; if (p = p.substring(0, p.length - 1), p += ";", p.length > 50) { l = !0; break } } p = p.substring(0, p.length - 1), p = "{" + p + (l ? "..." : "}") } else null !== (p = t.getValue(o, i)) && (p = "" + p) }
                        return p
                    }, i.prototype.bs = function(e) {
                        var t, i, o, r, a, s, l, c;
                        if (!e.getRange) return !1;
                        for (t = n.wrapper.spread.getActiveSheet(), i = e.getRange(0, 0), o = i.row, r = i.col, a = i.row + i.rowCount, s = i.col + i.colCount, l = o; l < a; l++)
                            for (c = r; c < s; c++)
                                if (t.getValue(l, c) instanceof GC.Spread.CalcEngine.CalcError) return !0;
                        return !1
                    }, i.prototype.Yr = function() {
                        var e, t, i, o, r, a, s, l = this.Eo.find(".filter-select"),
                            c = n.wrapper.spread.getActiveSheet();
                        if (this.Zr = [], t = [], i = [], o = 0, l.val() !== n.res.nameManagerDialog.filterWith.nameScopedToWorksheet && void 0 !== (e = n.wrapper.spread.getCustomNames()))
                            for (o; o < e.length; o++) r = this.Qo(null, e[o].getExpression(), c.getActiveRowIndex(), c.getActiveColumnIndex()), a = this.as(e[o].getExpression()), this.Zr.push({ name: e[o].getName(), refersTo: r, scope: "Workbook", value: a, comment: e[o].getComment() }), this.bs(e[o].getExpression()) ? t.push(this.Zr[this.Zr.length - 1]) : i.push(this.Zr[this.Zr.length - 1]);
                        if (l.val() !== n.res.nameManagerDialog.filterWith.nameScopedToWorkbook)
                            for (s = 0; s < n.wrapper.spread.sheets.length; s++)
                                if (void 0 !== (e = n.wrapper.spread.sheets[s].getCustomNames()))
                                    for (o = 0; o < e.length; o++) r = this.Qo(null, e[o].getExpression(), c.getActiveRowIndex(), c.getActiveColumnIndex()), a = this.as(e[o].getExpression()), this.Zr.push({ name: e[o].getName(), refersTo: r, scope: n.wrapper.spread.sheets[s].name(), value: a, comment: e[o].getComment() }), this.bs(e[o].getExpression()) ? t.push(this.Zr[this.Zr.length - 1]) : i.push(this.Zr[this.Zr.length - 1]);
                        l.val() === n.res.nameManagerDialog.filterWith.nameWithoutErrors && (this.Zr = i), l.val() === n.res.nameManagerDialog.filterWith.nameWithErrors && (this.Zr = t)
                    }, i
                }(n.BaseDialog), n.NameManagerDialog = C, S = function(e) {
                    n.extends(t, e);

                    function t(t) { e.call(this, r, ".tag-dialog") }
                    return t.prototype.Do = function() { var e = this; return { resizable: !1, autoOpen: !1, width: "auto", modal: !0, preventDefaultOkButton: !0, buttons: [{ text: n.res.ok, click: function() { e._o(), e.close() } }, { text: n.res.cancel, click: function() { e.close() } }] } }, t.prototype.Io = function(e) {
                        var t = this,
                            i = n.wrapper.spread.getActiveSheet(),
                            o = "",
                            r = i.getSelections()[0];
                        switch (e[0]) {
                            case "sheet":
                                this.Eo.dialog("option", "title", n.res.tagDialog.sheetTagTitle), o = i.tag() || "";
                                break;
                            case "cell":
                                this.Eo.dialog("option", "title", n.res.tagDialog.cellTagTitle), r && (o = i.getRange(r.row, r.col, r.rowCount, r.colCount).tag() || "");
                                break;
                            case "row":
                                this.Eo.dialog("option", "title", n.res.tagDialog.rowTagTitle), r && (o = i.getTag(r.row, r.col) || "");
                                break;
                            case "column":
                                this.Eo.dialog("option", "title", n.res.tagDialog.columnTagTitle), r && (o = i.getTag(r.row, r.col) || "")
                        }
                        this.Eo.dialog("option", "open", function() { t.Eo.find(".tag-input").focus() }), this.Eo.find(".tag-input").val(o)
                    }, t.prototype._o = function() {
                        switch (this.Ho[0]) {
                            case "sheet":
                                n.actions.doAction("setTag", n.wrapper.spread, [this.Eo.find(".tag-input").val(), "sheet"]);
                                break;
                            case "cell":
                                n.actions.doAction("setTag", n.wrapper.spread, [this.Eo.find(".tag-input").val(), "cell"]);
                                break;
                            case "row":
                                n.actions.doAction("setTag", n.wrapper.spread, [this.Eo.find(".tag-input").val(), "row"]);
                                break;
                            case "column":
                                n.actions.doAction("setTag", n.wrapper.spread, [this.Eo.find(".tag-input").val(), "column"])
                        }
                    }, t
                }(n.BaseDialog), n.TagDialog = S, k = ["DAVERAGE", "DCOUNT", "DCOUNTA", "DGET", "DMAX", "DMIN", "DPRODUCT", "DSTDEV", "DSTDEVP", "DSUM", "DVAR", "DVARP"], T = ["DATE", "DATEDIF", "DATEVALUE", "DAY", "DAYS360", "EDATE", "EOMONTH", "HOUR", "MINUTE", "MONTH", "NETWORKDAYS", "NOW", "SECOND", "TIME", "TIMEVALUE", "TODAY", "WEEKDAY", "WEEKNUM", "WORKDAY", "YEAR", "YEARFRAC"], A = ["BESSELI", "BESSELJ", "BESSELK", "BESSELY", "BIN2DEC", "BIN2HEX", "BIN2OCT", "COMPLEX", "CONVERT", "DEC2BIN", "DEC2HEX", "DEC2OCT", "DELTA", "ERF", "ERFC", "GESTEP", "HEX2BIN", "HEX2DEC", "HEX2OCT", "IMABS", "IMAGINARY", "IMARGUMENT", "IMCONJUGATE", "IMCOS", "IMDIV", "IMEXP", "IMLN", "IMLOG10", "IMLOG2", "IMPOWER", "IMPRODUCT", "IMREAL", "IMSIN", "IMSQRT", "IMSUB", "IMSUM", "OCT2BIN", "OCT2DEC", "OCT2HEX"], E = ["ACCRINT", "ACCRINTM", "AMORDEGRC", "AMORLINC", "COUPDAYBS", "COUPDAYS", "COUPDAYSNC", "COUPNCD", "COUPNUM", "COUPPCD", "CUMIPMT", "CUMPRINC", "DB", "DDB", "DISC", "DOLLARDE", "DOLLARFR", "DURATION", "EFFECT", "FV", "FVSCHEDULE", "INTRATE", "IPMT", "IRR", "ISPMT", "MDURATION", "MIRR", "NOMINAL", "NPER", "NPV", "ODDFPRICE", "ODDFYIELD", "ODDLPRICE", "ODDLYIELD", "EURO", "EUROCONVERT", "PMT", "PPMT", "PRICE", "PRICEDISC", "PRICEMAT", "PV", "RATE", "RECEIVED", "SLN", "SYD", "TBILLEQ", "TBILLPRICE", "TBILLYIELD", "VDB", "XIRR", "XNPV", "YIELD", "YIELDDISC", "YIELDMAT"], I = ["ERROR.TYPE", "ISBLANK", "ISERR", "ISERROR", "ISEVEN", "ISLOGICAL", "ISNA", "ISNONTEXT", "ISNUMBER", "ISODD", "ISREF", "ISTEXT", "N", "NA", "TYPE"], D = ["AND", "FALSE", "IF", "IFERROR", "NOT", "OR", "TRUE"], L = ["ADDRESS", "CHOOSE", "COLUMN", "COLUMNS", "HLOOKUP", "INDEX", "LOOKUP", "MATCH", "OFFSET", "ROW", "ROWS", "TRANSPOSE", "VLOOKUP"], F = ["ABS", "ACOS", "ACOSH", "ASIN", "ASINH", "ATAN", "ATAN2", "ATANH", "CEILING", "COMBIN", "COS", "COSH", "DEGREES", "EVEN", "EXP", "FACT", "FACTDOUBLE", "FLOOR", "GCD", "INT", "LCM", "LN", "LOG", "LOG10", "MDETERM", "MINVERSE", "MMULT", "MOD", "MROUND", "MULTINOMIAL", "ODD", "PI", "POWER", "PRODUCT", "QUOTIENT", "RADIANS", "RAND", "RANDBETWEEN", "ROMAN", "ROUND", "ROUNDDOWN", "ROUNDUP", "SERIESSUM", "SIGN", "SIN", "SINH", "SQRT", "SQRTPI", "SUBTOTAL", "SUM", "SUMIF", "SUMIFS", "SUMPRODUCT", "SUMSQ", "SUMX2MY2", "SUMX2PY2", "SUMXMY2", "TAN", "TANH", "TRUNC"], R = ["AVEDEV", "AVERAGE", "AVERAGEA", "AVERAGEIF", "AVERAGEIFS", "BETADIST", "BETAINV", "BINOMDIST", "CHIDIST", "CHIINV", "CHITEST", "CONFIDENCE", "CORREL", "COUNT", "COUNTA", "COUNTBLANK", "COUNTIF", "COUNTIFS", "COVAR", "CRITBINOM", "DEVSQ", "EXPONDIST", "FDIST", "FINV", "FISHER", "FISHERINV", "FORECAST", "FREQUENCY", "FTEST", "GAMMADIST", "GAMMAINV", "GAMMALN", "GEOMEAN", "GROWTH", "HARMEAN", "HYPGEOMDIST", "INTERCEPT", "KURT", "LARGE", "LINEST", "LOGEST", "LOGINV", "LOGNORMDIST", "MAX", "MAXA", "MEDIAN", "MIN", "MINA", "MODE", "NEGBINOMDIST", "NORMDIST", "NORMINV", "NORMSDIST", "NORMSINV", "PEARSON", "PERCENTILE", "PERCENTRANK", "PERMUT", "POISSON", "PROB", "QUARTILE", "RANK", "RSQ", "SKEW", "SLOPE", "SMALL", "STANDARDIZE", "STDEV", "STDEVA", "STDEVP", "STDEVPA", "STEYX", "TDIST", "TINV", "TREND", "TRIMMEAN", "TTEST", "VAR", "VARA", "VARP", "VARPA", "WEIBULL", "ZTEST"], B = ["CHAR", "CLEAN", "CODE", "CONCATENATE", "DOLLAR", "EXACT", "FIND", "FIXED", "LEFT", "LEN", "LOWER", "MID", "PROPER", "REPLACE", "REPT", "RIGHT", "SEARCH", "SUBSTITUTE", "T", "TEXT", "TRIM", "UPPER", "VALUE"], O = [].concat(k, T, A, E, I, D, L, F, R, B), P = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".insert-function-dialog") }
                    return t.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            width: "470px",
                            modal: !0,
                            title: n.res.insertFunctionDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t, i, o = e.Eo.find(".formula").val(),
                                        r = $("#formulaBarText");
                                    "=" !== o.substring(0, 1) && (o = "=" + o), r.text(o), t = n.wrapper.spread.getActiveSheet(), i = { txt: o, activeRowIndex: t.getActiveRowIndex(), activeColumnIndex: t.getActiveColumnIndex() }, n.actions.doAction("baseDialogCommand", n.wrapper.spread, { value: i, execute: n.spreadActions.dialogAction.insertFunctionDiaplogApplySetting }), e.close(), n.wrapper.setFocusToSpread()
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, t.prototype._init = function() {
                        var e, t, i, o, r, a, s, l = this;
                        for (this.cs = n.res.insertFunctionDialog.functionCategorys.split(","), O.sort(), e = this.Eo.find(".function-list-select"), t = e[0].options, i = this.Eo.find(".formula"), o = this.Eo.find(".function-category-select"), r = o[0].options, o.empty(), a = 0; a < this.cs.length; a++) r.add(new Option(this.cs[a]));
                        e.change(function(e) {
                            var t, i, o, n = e.target || e.srcElement,
                                r = n,
                                a = GC.Spread.CalcEngine.Functions.findGlobalFunction(r.value);
                            a && (o = a.description(), i = o.description, t = o.parameters.map(function(e) { return e.name }).join(",")), l.Eo.find(".function-name").text(r.value + "(" + t + ")"), l.Eo.find(".function-description").text(i)
                        }), e.dblclick(function(e) {
                            var t, o, n = e.target || e.srcElement,
                                r = n;
                            "" === i.prop("value") ? (i.prop("value", r.value + "()"), i.attr("caretIndex", i.prop("value").length - 1), l.Eo.find(".formula").focus(), i[0].selectionStart = parseInt(i.attr("caretIndex")), i[0].selectionEnd = parseInt(i.attr("caretIndex"))) : (t = i.prop("value"), o = parseInt(i.attr("caretIndex")), t = t.substring(0, o) + r.value + "()" + t.substring(o, t.length), i.prop("value", t), i.attr("caretIndex", o + r.value.length + 1), l.Eo.find(".formula").focus(), i[0].selectionStart = parseInt(i.attr("caretIndex")), i[0].selectionEnd = parseInt(i.attr("caretIndex")))
                        }), s = function() {
                            var e = i[0].selectionStart;
                            i.attr("caretIndex", e)
                        }, i.select(s), i.click(s), i.keyup(s), o.change(function(i) {
                            var o = i.target || i.srcElement,
                                n = o;
                            if (e.empty(), n.value === l.cs[0])
                                for (a = 0; a < O.length; a++) t.add(new Option(O[a]));
                            else if (n.value === l.cs[1])
                                for (a = 0; a < k.length; a++) t.add(new Option(k[a]));
                            else if (n.value === l.cs[2])
                                for (a = 0; a < T.length; a++) t.add(new Option(T[a]));
                            else if (n.value === l.cs[3])
                                for (a = 0; a < A.length; a++) t.add(new Option(A[a]));
                            else if (n.value === l.cs[4])
                                for (a = 0; a < E.length; a++) t.add(new Option(E[a]));
                            else if (n.value === l.cs[5])
                                for (a = 0; a < I.length; a++) t.add(new Option(I[a]));
                            else if (n.value === l.cs[6])
                                for (a = 0; a < D.length; a++) t.add(new Option(D[a]));
                            else if (n.value === l.cs[7])
                                for (a = 0; a < L.length; a++) t.add(new Option(L[a]));
                            else if (n.value === l.cs[8])
                                for (a = 0; a < F.length; a++) t.add(new Option(F[a]));
                            else if (n.value === l.cs[9])
                                for (a = 0; a < R.length; a++) t.add(new Option(R[a]));
                            else if (n.value === l.cs[10])
                                for (a = 0; a < B.length; a++) t.add(new Option(B[a]));
                            $(t[0]).prop("selected", !0), e.trigger("change")
                        })
                    }, t.prototype.Io = function() {
                        var e, t, i, o, r, a, s, l, c, d = $("#formulaBarText"),
                            p = d.text(),
                            u = d[0].selectionStart;
                        for (void 0 !== p && ("=" === p.substring(0, 1) ? (e = p.substring(1, p.length), t = u - 1) : t = u), i = this.Eo.find(".function-list-select"), o = i[0].options, i.empty(), r = 0; r < O.length; r++) o.add(new Option(O[r]));
                        this.Eo.find(".function-category-select").prop("selectedIndex", 0), this.Eo.find(".function-list-select").prop("selectedIndex", 0), this.Eo.find(".function-list-select").trigger("change"), a = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), s = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), l = n.wrapper.spread.getActiveSheet().getCell(a, s).formula(), c = this.Eo.find(".formula"), void 0 !== e ? (c.prop("value", e), c.attr("caretIndex", t), c[0].selectionStart = t, c[0].selectionEnd = t) : void 0 !== l && null !== l ? (c.prop("value", l), c.attr("caretIndex", l.length), c[0].selectionStart = parseInt(c.attr("caretIndex")), c[0].selectionEnd = parseInt(c.attr("caretIndex"))) : (c.prop("value", ""), c.attr("caretIndex", 0))
                    }, t
                }(n.BaseDialog), n.InsertFunctionDialog = P, N = function(t) {
                    n.extends(i, t);

                    function i() { t.call(this, r, ".button-celltype-dialog") }
                    return i.prototype.Do = function() {
                        var t = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.buttonCellTypeDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i = t.Eo.find(".margin-left"),
                                        r = t.Eo.find(".margin-top"),
                                        a = t.Eo.find(".margin-right"),
                                        s = t.Eo.find(".margin-bottom"),
                                        l = t.Eo.find(".button-text"),
                                        c = t.Eo.find(".color-span"),
                                        d = new o.CellTypes.Button;
                                    "" !== i.val() && d.marginLeft(parseFloat(i.val())), "" !== r.val() && d.marginTop(parseFloat(r.val())), "" !== a.val() && d.marginRight(parseFloat(a.val())), "" !== s.val() && d.marginBottom(parseFloat(s.val())), "" !== l.val() && d.text(l.val()), c.css("background-color") !== e.Gq() && d.buttonBackColor(c.css("background-color")), n.actions.doAction("setCellType", n.wrapper.spread, d), t.close(), n.wrapper.setFocusToSpread()
                                }
                            }, { text: n.res.cancel, click: function() { t.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, i.prototype._init = function() {
                        var e = this;
                        $(".button-backcolor-color-picker").colorpicker({ valueChanged: function(t, i) { void 0 === i.color ? e.Eo.find(".color-span").css("background-color", "") : e.Eo.find(".color-span").css("background-color", i.color) }, choosedColor: function(t, i) { e.Eo.find(".color-frame").comboframe("close") }, openColorDialog: function(t, i) { e.Eo.find(".color-frame").comboframe("close") } }), this.Eo.find(".color-frame").comboframe()
                    }, i.prototype.Io = function() {
                        var e, t, i, r, a, s, l = this.Eo.find(".margin-left"),
                            c = this.Eo.find(".margin-top"),
                            d = this.Eo.find(".margin-right"),
                            p = this.Eo.find(".margin-bottom"),
                            u = this.Eo.find(".button-text"),
                            h = this.Eo.find(".color-span"),
                            f = $(".button-backcolor-color-picker");
                        $(".button-backcolor-color-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors()), e = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), t = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), i = n.wrapper.spread.getActiveSheet().getCell(e, t), r = i.cellType(), a = r instanceof o.CellTypes.Button ? r : new o.CellTypes.Button, l.val(a.ds), c.val(a.es), d.val(a.fs), p.val(a.gs), u.val(a.hs), a.js ? (s = n.ColorHelper.parse(a.js, n.wrapper.spread.getActiveSheet().currentTheme().colors()), f.colorpicker("option", "selectedItem", s), h.css("background-color", s.color)) : (f.colorpicker("option", "selectedItem", null), h.css("background-color", "transparent"))
                    }, i
                }(n.BaseDialog), n.ButtonCellTypeDialog = N, z = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".checkbox-celltype-dialog") }
                    return t.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.checkBoxCellTypeDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.Eo.find(".text-true"),
                                        i = e.Eo.find(".text-indeterminate"),
                                        r = e.Eo.find(".text-false"),
                                        a = e.Eo.find(".text-align"),
                                        s = e.Eo.find(".caption"),
                                        l = e.Eo.find(".isThreeState"),
                                        c = new o.CellTypes.CheckBox;
                                    "" !== t.val() && c.textTrue(t.val()), "" !== i.val() && c.textIndeterminate(i.val()), "" !== r.val() && c.textFalse(r.val()), "" !== s.val() && c.caption(s.val()), c.textAlign(parseInt(a.val())), c.isThreeState(l.prop("checked")), n.actions.doAction("setCellType", n.wrapper.spread, c), e.close(), n.wrapper.setFocusToSpread()
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, t.prototype._init = function() {
                        var e = this.Eo.find(".text-align"),
                            t = e[0].options;
                        t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.top, "0")), t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.bottom, "1")), t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.left, "2")), t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.right, "3"))
                    }, t.prototype.Io = function() {
                        var e, t = this.Eo.find(".text-true"),
                            i = this.Eo.find(".text-indeterminate"),
                            r = this.Eo.find(".text-false"),
                            a = this.Eo.find(".text-align"),
                            s = a[0].options,
                            l = this.Eo.find(".caption"),
                            c = this.Eo.find(".isThreeState"),
                            d = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                            p = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                            u = n.wrapper.spread.getActiveSheet().getCell(d, p),
                            h = u.cellType();
                        e = h instanceof o.CellTypes.CheckBox ? h : new o.CellTypes.CheckBox, t.val(e.textTrue()), i.val(e.textIndeterminate()), r.val(e.textFalse()), l.val(e.caption()), $(s[parseInt(e.textAlign())]).prop("selected", !0), a.prop("selected", e.textAlign()), c.prop("checked", e.isThreeState())
                    }, t
                }(n.BaseDialog), n.CheckBoxCellTypeDialog = z, M = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".combobox-celltype-dialog") }
                    return t.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            width: "auto",
                            modal: !0,
                            title: n.res.comboBoxCellTypeDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t, i, r, a, s, l = e.Eo.find(".text"),
                                        c = e.Eo.find(".value"); - 1 !== e.selectedIndex && e.selectedIndex < e.items.length && (e.items[e.selectedIndex] = { text: l.val(), value: c.val() }), t = e.Eo.find(".editor-valuetype"), i = new o.CellTypes.ComboBox, i.editorValueType(parseInt(t.val())), r = e.Eo.find("#combox-editable"), i.editable(r.prop("checked")), a = e.Eo.find(".combo-item-height"), s = parseFloat(a.val()), isNaN(s) || i.itemHeight(s), null !== e.items && void 0 !== e.items && i.items(e.items), n.actions.doAction("setCellType", n.wrapper.spread, i), e.close(), n.wrapper.setFocusToSpread()
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, t.prototype._init = function() {
                        var e, t, i, o, r, a, s, l, c = this;
                        this.selectedIndex = -1, e = this.Eo.find(".editor-valuetype"), t = e[0].options, t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.text, "0")), t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.index, "1")), t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.value, "2")), i = this.Eo.find(".items"), o = i[0].options, r = this.Eo.find(".text"), a = this.Eo.find(".value"), s = this.Eo.find(".add-button"), l = this.Eo.find(".remove-button"), s.button(), l.button(), s.click(function() { o[o.length] = new Option("ListItem" + o.length), null === c.items && (c.items = []), c.items.push({ text: "", value: "" }), r.removeAttr("disabled"), a.removeAttr("disabled"), i.trigger("change", { selectMoveTo: c.items.length - 1, action: "add" }) }), l.click(function() {
                            o.remove(c.selectedIndex), c.items.splice(c.selectedIndex, 1);
                            var e;
                            c.items.length > c.selectedIndex ? e = c.selectedIndex : c.items.length > 0 ? e = c.selectedIndex - 1 : (e = -1, r.val(""), a.val(""), r.attr("disabled", !0), a.attr("disabled", !0)), i.trigger("change", { selectMoveTo: e, action: "remove" })
                        }), i.change(function(e, t) {
                            var i, n = e.target || e.srcElement,
                                s = n;
                            (void 0 === t || "add" === t.action) && -1 !== c.selectedIndex && c.selectedIndex < c.items.length && (c.items[c.selectedIndex] = { text: r.val(), value: a.val() }), void 0 === t ? (i = s.value.substring(8), c.selectedIndex = parseInt(i)) : c.selectedIndex = t.selectMoveTo, -1 !== c.selectedIndex && ($(o[c.selectedIndex]).prop("selected", !0), r.val(c.items[c.selectedIndex].text), a.val(c.items[c.selectedIndex].value))
                        })
                    }, t.prototype.Io = function() {
                        var e, t, i = this.Eo.find(".editor-valuetype"),
                            r = i[0].options,
                            a = this.Eo.find(".items"),
                            s = a[0].options,
                            l = this.Eo.find(".text"),
                            c = this.Eo.find(".value"),
                            d = this.Eo.find(".combo-item-height"),
                            p = this.Eo.find("#combox-editable"),
                            u = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                            h = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                            f = n.wrapper.spread.getActiveSheet().getCell(u, h),
                            g = f.cellType();
                        if (e = g instanceof o.CellTypes.ComboBox ? g : new o.CellTypes.ComboBox, d.val(e.itemHeight()), p.prop("checked", e.editable()), $(r[parseInt(e.editorValueType())]).prop("selected", !0), this.items = e.items(), a.empty(), null !== this.items && void 0 !== this.items && 0 !== this.items.length) {
                            for (t = 0; t < this.items.length; t++) s[s.length] = new Option("ListItem" + s.length);
                            l.removeAttr("disabled"), c.removeAttr("disabled"), $(s[0]).prop("selected", !0), l.val(this.items[0].text), c.val(this.items[0].value), this.selectedIndex = 0
                        } else l.val(""), c.val(""), l.attr("disabled", !0), c.attr("disabled", !0)
                    }, t
                }(n.BaseDialog), n.ComboBoxCellTypeDialog = M, V = function(t) {
                    n.extends(i, t);

                    function i() { t.call(this, r, ".hyperLink-celltype-dialog") }
                    return i.prototype.Do = function() {
                        var t = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: n.res.hyperLinkCellTypeDialog.title,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var i = t.Eo.find(".text"),
                                        r = t.Eo.find(".linktooltip"),
                                        a = t.Eo.find(".link-color-span"),
                                        s = t.Eo.find(".visitedlink-color-span"),
                                        l = new o.CellTypes.HyperLink;
                                    "" !== i.val() && l.text(i.val()), "" !== r.val() && l.linkToolTip(r.val()), a.css("background-color") !== e.Gq() && l.linkColor(a.css("background-color")), s.css("background-color") !== e.Gq() && l.visitedLinkColor(s.css("background-color")), n.actions.doAction("setCellType", n.wrapper.spread, l), t.close(), n.wrapper.setFocusToSpread()
                                }
                            }, {
                                text: n.res.cancel,
                                click: function() { t.close(), n.wrapper.setFocusToSpread() }
                            }]
                        }
                    }, i.prototype._init = function() {
                        var e = this;
                        $(".link-color-picker").colorpicker({ valueChanged: function(t, i) { void 0 === i.color ? e.Eo.find(".link-color-span").css("background-color", "") : e.Eo.find(".link-color-span").css("background-color", i.color) }, choosedColor: function(t, i) { e.Eo.find(".link-color-frame").comboframe("close") }, openColorDialog: function(t, i) { e.Eo.find(".link-color-frame").comboframe("close") } }), this.Eo.find(".link-color-frame").comboframe(), $(".visitedlink-color-picker").colorpicker({ valueChanged: function(t, i) { void 0 === i.color ? e.Eo.find(".visitedlink-color-span").css("background-color", "") : e.Eo.find(".visitedlink-color-span").css("background-color", i.color) }, choosedColor: function(t, i) { e.Eo.find(".visitedlink-color-frame").comboframe("close") }, openColorDialog: function(t, i) { e.Eo.find(".visitedlink-color-frame").comboframe("close") } }), this.Eo.find(".visitedlink-color-frame").comboframe()
                    }, i.prototype.Io = function() {
                        var e, t, i, r, a, s, l = this.Eo.find(".text"),
                            c = this.Eo.find(".linktooltip"),
                            d = this.Eo.find(".link-color-span"),
                            p = $(".link-color-picker"),
                            u = this.Eo.find(".visitedlink-color-span"),
                            h = $(".visitedlink-color-picker");
                        p.colorpicker("option", "themeColors", n.wrapper.getThemeColors()), h.colorpicker("option", "themeColors", n.wrapper.getThemeColors()), e = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), t = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), i = n.wrapper.spread.getActiveSheet().getCell(e, t), r = i.cellType(), a = r instanceof o.CellTypes.HyperLink ? r : new o.CellTypes.HyperLink, c.val(a.ks), l.val(a.hs), a.ls ? (s = n.ColorHelper.parse(a.ls, n.wrapper.spread.getActiveSheet().currentTheme().colors()), p.colorpicker("option", "selectedItem", s), d.css("background-color", s.color)) : (p.colorpicker("option", "selectedItem", null), d.css("background-color", "transparent")), a.ms ? (s = n.ColorHelper.parse(a.ms, n.wrapper.spread.getActiveSheet().currentTheme().colors()), h.colorpicker("option", "selectedItem", s), u.css("background-color", s.color)) : (h.colorpicker("option", "selectedItem", null), u.css("background-color", "transparent"))
                    }, i
                }(n.BaseDialog), n.HyperLinkCellTypeDialog = V, G = function(e) {
                    n.extends(a, e);

                    function a() { e.call(this, r, ".header-cells-dialog") }
                    var s = { 0: "empty", 1: "thin", 2: "medium", 3: "dashed", 4: "dotted", 5: "thick", 6: "double", 7: "hair", 8: "mediumDashed", 9: "dashDot", 10: "mediumDashDot", 11: "dashDotDot", 12: "mediumDashDotDot", 13: "slantedDashDot" };
                    a.prototype.Do = function() { var e = this; return { width: 740, height: 720, resizable: !1, modal: !0, title: n.res.headerCellsDialog.title, buttons: [{ text: n.res.ok, click: function() { e.ns(e.os), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } };

                    function c(e) { e.sheets[0].selectionPolicy(1), e.options.tabStripVisible = !1, e.options.allowContextMenu = !1 }
                    return a.prototype._init = function() {
                        var e, t, i, r, a, s, l, d, p, u, h;
                        this.ps = !1, this.Eo.find(".font-popup").button(), this.qs = this.Eo.find(".header-tab").tabs(), this.rs = new o.Workbook(this.Eo.find("#rowHeaderTab")[0], { sheetCount: 1 }), this.ss = new o.Workbook(this.Eo.find("#columnHeaderTab")[0], { sheetCount: 1 }), e = this.rs, e.options.allowContextMenu = !1, t = this.ss, t.options.allowContextMenu = !1, c(e), c(t), i = this.Eo.find(".hAlign"), r = this.Eo.find(".vAlign");
                        for (a in o.HorizontalAlign) o.HorizontalAlign.hasOwnProperty(a) && i.append($("<option></option>").val(a).text(n.res.headerCellsDialog[a]));
                        for (a in o.VerticalAlign) o.VerticalAlign.hasOwnProperty(a) && r.append($("<option></option>").val(a).text(n.res.headerCellsDialog[a]));
                        this.ts(e, t), this.Eo.find(".backColor-colorframe").comboframe(), this.Eo.find(".foreColor-colorframe").comboframe(), this.Eo.find(".borderBottom-borderframe").comboframe(), this.Eo.find(".borderLeft-borderframe").comboframe(), this.Eo.find(".borderRight-borderframe").comboframe(), this.Eo.find(".borderTop-borderframe").comboframe(), this.Eo.find(".diagonalUp-borderframe").comboframe(), this.Eo.find(".diagonalDown-borderframe").comboframe(), s = $(".borderBottom-borderpicker"), l = $(".borderLeft-borderpicker"), d = $(".borderRight-borderpicker"), p = $(".borderTop-borderpicker"), u = $(".diagonalUp-borderpicker"), h = $(".diagonalDown-borderpicker"), s.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 }), l.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 }), d.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 }), p.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 }), u.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 }), h.borderpicker("option", "colorOptions", { showMoreColors: !1, showNoFill: !1 })
                    }, a.prototype.Io = function(e) {
                        var t, i, r, a, s, l = this;
                        switch (this.xd || (this.xd = !0, this.Eo.find(".button-set").gcuiribbon({
                            click: function(e, t) {
                                var i, o, r, a, s = l.us.getActiveSheet();
                                switch (t.commandName) {
                                    case "merge":
                                        n.actions.doAction("mergeCells", l.us);
                                        break;
                                    case "unmerge":
                                        n.actions.doAction("unmergeCells", l.us);
                                        break;
                                    case "insertrows":
                                        n.actions.doAction("insertRows", l.us);
                                        break;
                                    case "addrows":
                                        for (i = new n.spreadActions.InsertAndDeleteBase(l.us, { sheetName: s.sheetName, selections: s.getSelections() }), r = i.getSortedRowSelections(), o = 0; o < r.length; o++) l.us.sheets[0].addRows(l.us.sheets[0].getRowCount(), r[o].rowCount);
                                        break;
                                    case "deleterows":
                                        n.actions.doAction("deleteRows", l.us);
                                        break;
                                    case "insertcolumns":
                                        n.actions.doAction("insertColumns", l.us);
                                        break;
                                    case "addcolumns":
                                        for (i = new n.spreadActions.InsertAndDeleteBase(l.us, { sheetName: s.sheetName, selections: s.getSelections() }), a = i.getSortedColumnSelections(), o = 0; o < a.length; o++) l.us.sheets[0].addColumns(l.us.sheets[0].getColumnCount(), a[o].colCount);
                                        break;
                                    case "deletecolumns":
                                        n.actions.doAction("deleteColumns", l.us);
                                        break;
                                    case "clear":
                                        n.actions.doAction("clearAll", l.us)
                                }
                            }
                        })), this.Eo.find(".gcui-ribbon-list").removeClass("gcui-gcuitabs-hide"), i = this.rs, r = this.ss, e[0]) {
                            case "row":
                                t = 0, this.us = i, this.os = 2, this.vs("row"), n.util.triggerSheetEvent(i.sheets[0], o.Events.SelectionChanged), setTimeout(function() { i.refresh() }, 0);
                                break;
                            case "col":
                                t = 1, this.us = r, this.os = 1, this.vs("col"), n.util.triggerSheetEvent(r.sheets[0], o.Events.SelectionChanged), setTimeout(function() { r.refresh() }, 0)
                        }
                        this.ws(e[0]), this.qs.tabs("option", "active", t), this.xs(i, r), this.ys(1, r), this.ys(2, i), this.vs(e[0]), this.zs("cell"), a = $(".backColor-colorpicker"), s = $(".foreColor-colorpicker"), a.colorpicker("option", "themeColors", n.wrapper.getThemeColors()), s.colorpicker("option", "themeColors", n.wrapper.getThemeColors())
                    }, a.prototype.xs = function(e, t, i) {
                        var o, r, a, s, l, c, d, p;
                        i ? (o = e.sheets[0].getColumnCount(3), r = t.sheets[0].getColumnCount(3), a = e.sheets[0].getRowCount(3), s = t.sheets[0].getRowCount(3), n.wrapper.spread.getActiveSheet().setColumnCount(o, 2), n.wrapper.spread.getActiveSheet().setRowCount(a, 2), n.wrapper.spread.getActiveSheet().setColumnCount(r, 1), n.wrapper.spread.getActiveSheet().setRowCount(s, 1)) : (l = n.wrapper.spread.getActiveSheet().getColumnCount(2), c = n.wrapper.spread.getActiveSheet().getColumnCount(1), d = n.wrapper.spread.getActiveSheet().getRowCount(2), p = n.wrapper.spread.getActiveSheet().getRowCount(1), e.sheets[0].setColumnCount(l), e.sheets[0].setRowCount(d), t.sheets[0].setColumnCount(c), t.sheets[0].setRowCount(p))
                    }, a.prototype.vs = function(e) {
                        var t = 0,
                            i = 0;
                        switch (e) {
                            case "row":
                                t = n.wrapper.spread.getActiveSheet().getActiveRowIndex();
                                break;
                            case "col":
                                i = n.wrapper.spread.getActiveSheet().getActiveColumnIndex()
                        }
                        this.us.sheets[0].setActiveCell(t, i)
                    }, a.prototype.zs = function(e) {
                        var t, i, o, r, a, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I = this.us.sheets[0],
                            D = I.getActiveColumnIndex(),
                            L = I.getActiveRowIndex(),
                            F = I.getValue(L, D, 3),
                            R = I.getColumnWidth(D, 3),
                            B = I.getRowHeight(L, 3),
                            O = I.getColumnVisible(D, 3),
                            P = I.getRowVisible(L, 3),
                            N = I.getColumnResizable(D, 3),
                            z = I.getRowResizable(L, 3),
                            M = this.Eo.find(".height"),
                            V = this.Eo.find(".value"),
                            G = this.Eo.find(".visible"),
                            j = this.Eo.find(".width"),
                            H = this.Eo.find(".resizable");
                        switch (M.val(B), null !== F ? V.val("" + F) : V.val(""), j.val(R), e) {
                            case "row":
                                H.prop("checked", z), G.prop("checked", P), t = I.getStyle(L, -1, 3);
                                break;
                            case "col":
                                H.prop("checked", N), G.prop("checked", O), t = I.getStyle(-1, D, 3);
                                break;
                            case "cell":
                                t = I.getStyle(L, D, 3);
                                break;
                            case "sheet":
                                t = I.getStyle(-1, -1, 3)
                        }
                        i = this.Eo.find(".backColor-colorspan"), o = $(".backColor-colorpicker"), r = this.Eo.find(".foreColor-colorspan"), a = $(".foreColor-colorpicker"), l = this.Eo.find(".borderBottom-borderspan"), c = this.Eo.find(".borderLeft-borderspan"), d = this.Eo.find(".borderRight-borderspan"), p = this.Eo.find(".borderTop-borderspan"), u = this.Eo.find(".diagonalUp-borderspan"), h = this.Eo.find(".diagonalDown-borderspan"), f = this.Eo.find(".font"), g = this.Eo.find(".formatter"), m = this.Eo.find(".hAlign"), b = this.Eo.find(".locked"), v = this.Eo.find(".verticalText"), y = this.Eo.find(".shrinkToFit"), w = this.Eo.find(".textIndent"), x = this.Eo.find(".vAlign"), C = this.Eo.find(".wordWrap"), S = m[0].options, k = x[0].options, null !== t && void 0 !== t ? (void 0 !== t.backColor ? (T = n.ColorHelper.parse(t.backColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()), o.colorpicker("option", "selectedItem", T), i.css("background-color", T.color)) : (o.colorpicker("option", "selectedItem", null), i.css("background-color", "transparent")), void 0 !== t.foreColor ? (T = n.ColorHelper.parse(t.foreColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()), a.colorpicker("option", "selectedItem", T), r.css("background-color", T.color)) : (a.colorpicker("option", "selectedItem", null), r.css("background-color", "transparent")), void 0 !== t.borderBottom ? (A = t.borderBottom, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), l.val(E)) : l.val(""), void 0 !== t.borderLeft ? (A = t.borderLeft, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), c.val(E)) : c.val(""), void 0 !== t.borderRight ? (A = t.borderRight, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), d.val(E)) : d.val(""), void 0 !== t.borderTop ? (A = t.borderTop, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), p.val(E)) : p.val(""), void 0 !== t.diagonalUp ? (A = t.diagonalUp, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), u.val(E)) : u.val(""), void 0 !== t.diagonalDown ? (A = t.diagonalDown, E = "", void 0 !== A.color && null !== A.color && (E = A.color), void 0 !== A.style && null !== A.style && (E += ";" + s[A.style]), h.val(E)) : h.val(""), void 0 !== t.font ? f.val(t.font) : f.val(""), void 0 !== t.formatter ? g.val(t.formatter) : g.val(""), void 0 !== t.textIndent ? w.val(t.textIndent) : w.val(""), void 0 !== t.locked ? b.prop("checked", t.locked) : b.prop("checked", !0), void 0 !== t.wordWrap ? C.prop("checked", t.wordWrap) : C.prop("checked", !1), void 0 !== t.isVerticalText ? v.prop("checked", t.isVerticalText) : v.prop("checked", !1), void 0 !== t.shrinkToFit ? y.prop("checked", t.shrinkToFit) : y.prop("checked", !1), void 0 !== t.isVerticalText ? v.prop("checked", t.isVerticalText) : v.prop("checked", !1), void 0 !== t.hAlign ? $(S[parseInt(t.hAlign)]).prop("selected", !0) : $(S[3]).prop("selected", !0), void 0 !== t.vAlign ? $(k[parseInt(t.vAlign)]).prop("selected", !0) : $(k[1]).prop("selected", !0)) : (o.colorpicker("option", "selectedItem", null), i.css("background-color", "transparent"), a.colorpicker("option", "selectedItem", null), r.css("background-color", "transparent"), l.val(""), c.val(""), d.val(""), p.val(""), u.val(""), h.val(""), f.val(""), g.val(""), w.val(""), b.prop("checked", !0), C.prop("checked", !1), y.prop("checked", !1), v.prop("checked", !1), $(S[3]).prop("selected", !0), $(k[1]).prop("selected", !0))
                    }, a.prototype.ys = function(e, t) {
                        var i, o, r, a, s;
                        i = t || this.us, i.suspendPaint();
                        try {
                            for (o = n.wrapper.spread.getActiveSheet(), r = i.sheets[0], a = 0; a < r.getRowCount(); a++)
                                for (s = 0; s < r.getColumnCount(); s++) this.As(o, r, a, s, e, 3);
                            for (a = 0; a < r.getColumnCount(); a++) this.As(o, r, -1, a, e, 3);
                            for (a = 0; a < r.getRowCount(); a++) this.As(o, r, a, -1, e, 3);
                            this.As(o, r, -1, -1, e, 3), this.Bs(o, r, e, 3)
                        } catch (e) { i.resumePaint() } i.resumePaint()
                    }, a.prototype.ns = function(e) {
                        var i, o, r, a, s;
                        if (this.ps) return void t.show(n.res.headerCellsDialog.exception, n.res.title, 3, 0);
                        n.wrapper.spread.suspendPaint();
                        try { i = this.rs.sheets[0], o = this.ss.sheets[0], r = new GC.Spread.Sheets.Worksheet("rowSheetTemp"), r.fromJSON(i.toJSON()), a = new GC.Spread.Sheets.Worksheet("colSheetTemp"), a.fromJSON(o.toJSON()), s = { rowSheet: r, colSheet: a }, n.actions.doAction("baseDialogCommand", n.wrapper.spread, { value: s, execute: n.spreadActions.dialogAction.headerCellsApplySetting }) } catch (e) { n.wrapper.spread.resumePaint() } n.wrapper.spread.resumePaint(), this.close()
                    }, a.prototype.As = function(e, t, i, o, n, r) {
                        var a, s, l, c, d, p, u, h, f = e.getStyle(i, o, n);
                        t.setStyle(i, o, f, r), a = e.getValue(i, o, n), s = t.getValue(i, o, r), a !== s && t.setValue(i, o, a, r), l = e.getColumnWidth(o, n), void 0 !== l && l >= 0 && t.setColumnWidth(o, l, r), c = e.getRowHeight(i, n), void 0 !== c && c >= 0 && t.setRowHeight(i, c, r), d = e.getColumnVisible(o, n), t.setColumnVisible(o, d, r), p = e.getRowVisible(i, n), t.setRowVisible(i, p, r), u = e.getColumnResizable(o, n), t.setColumnResizable(o, u, r), h = e.getRowResizable(i, n), t.setRowResizable(i, h, r)
                    }, a.prototype.Bs = function(e, t, i, o) {
                        var n, r = t.getSpans(void 0, o);
                        for (n = 0; n < r.length; n++) t.removeSpan(r[n].row, r[n].col, o);
                        if (r = e.getSpans(void 0, i), 0 !== r.length)
                            for (n = 0; n < r.length; n++) t.addSpan(r[n].row, r[n].col, r[n].rowCount, r[n].colCount, o)
                    }, a.prototype.ws = function(e) {
                        var t = this.Eo.find(".property-grid-container"),
                            i = this.Eo.find(".property-grid"),
                            o = this.Eo.find(".header-tab");
                        switch (e) {
                            case "row":
                                o.addClass("rowheader-sheet"), o.removeClass("columnheader-sheet"), i.addClass("rowheader-porpertygird"), i.removeClass("columnheader-porpertygird"), t.removeClass("columnheader-property-grid-container");
                                break;
                            case "col":
                                o.addClass("columnheader-sheet"), o.removeClass("rowheader-sheet"), i.addClass("columnheader-porpertygird"), i.removeClass("rowheader-porpertygird"), t.addClass("columnheader-property-grid-container")
                        }
                    }, a.prototype.Cs = function(e) {
                        var t, i, r, a = new o.Style;
                        switch (e) {
                            case "bottom":
                                t = $(".borderBottom-borderspan").val();
                                break;
                            case "top":
                                t = $(".borderTop-borderspan").val();
                                break;
                            case "left":
                                t = $(".borderLeft-borderspan").val();
                                break;
                            case "right":
                                t = $(".borderRight-borderspan").val();
                                break;
                            case "diagonalUp":
                                t = $(".diagonalUp-borderspan").val();
                                break;
                            case "diagonalDown":
                                t = $(".diagonalDown-borderspan").val()
                        }
                        switch (t && (i = t.split(";")[0], r = t.split(";")[1]), e) {
                            case "bottom":
                                a.borderBottom = new o.LineBorder(i, o.LineStyle[r]);
                                break;
                            case "top":
                                a.borderTop = new o.LineBorder(i, o.LineStyle[r]);
                                break;
                            case "left":
                                a.borderLeft = new o.LineBorder(i, o.LineStyle[r]);
                                break;
                            case "right":
                                a.borderRight = new o.LineBorder(i, o.LineStyle[r]);
                                break;
                            case "diagonalUp":
                                a.diagonalUp = new o.LineBorder(i, o.LineStyle[r]);
                                break;
                            case "diagonalDown":
                                a.diagonalDown = new o.LineBorder(i, o.LineStyle[r])
                        }
                        n.actions.doAction("setStyle", this.us, a)
                    }, a.prototype.ts = function(e, t) {
                        var r, a, d, p, u = this,
                            h = $(".backColor-colorpicker"),
                            f = $(".foreColor-colorpicker"),
                            g = this.Eo.find(".borderBottom-borderspan"),
                            m = $(".borderBottom-borderpicker"),
                            b = this.Eo.find(".borderLeft-borderspan"),
                            v = $(".borderLeft-borderpicker"),
                            y = this.Eo.find(".borderRight-borderspan"),
                            w = $(".borderRight-borderpicker"),
                            x = this.Eo.find(".borderTop-borderspan"),
                            C = $(".borderTop-borderpicker"),
                            S = this.Eo.find(".diagonalUp-borderspan"),
                            k = $(".diagonalUp-borderpicker"),
                            T = this.Eo.find(".diagonalDown-borderspan"),
                            A = $(".diagonalDown-borderpicker"),
                            E = this.Eo.find(".font"),
                            I = this.Eo.find(".formatter"),
                            D = this.Eo.find(".hAlign"),
                            L = this.Eo.find(".locked"),
                            F = this.Eo.find(".verticalText"),
                            R = this.Eo.find(".shrinkToFit"),
                            B = this.Eo.find(".textIndent"),
                            O = this.Eo.find(".vAlign"),
                            P = this.Eo.find(".wordWrap"),
                            N = this.Eo.find(".height"),
                            z = this.Eo.find(".value"),
                            M = this.Eo.find(".visible"),
                            V = this.Eo.find(".width"),
                            G = this.Eo.find(".resizable"),
                            j = this;
                        h.colorpicker({
                            valueChanged: function(e, t) {
                                if (void 0 === t.color) j.Eo.find(".backColor-colorspan").css("background-color", ""), n.actions.doAction("setBackColor", j.us, void 0);
                                else {
                                    j.Eo.find(".backColor-colorspan").css("background-color", t.color);
                                    var i = new o.Style;
                                    i.backColor = t.color, n.actions.doAction("setStyle", j.us, i)
                                }
                            },
                            choosedColor: function(e, t) { j.Eo.find(".backColor-colorframe").comboframe("close") },
                            openColorDialog: function(e, t) { j.Eo.find(".backColor-colorframe").comboframe("close") }
                        }), f.colorpicker({
                            valueChanged: function(e, t) {
                                if (void 0 === t.color) j.Eo.find(".foreColor-colorspan").css("background-color", ""), n.actions.doAction("setForeColor", j.us, void 0);
                                else {
                                    j.Eo.find(".foreColor-colorspan").css("background-color", t.color);
                                    var i = new o.Style;
                                    i.foreColor = t.color, n.actions.doAction("setStyle", j.us, i)
                                }
                            },
                            choosedColor: function(e, t) { j.Eo.find(".foreColor-colorframe").comboframe("close") },
                            openColorDialog: function(e, t) { j.Eo.find(".foreColor-colorframe").comboframe("close") }
                        }), m.borderpicker({ colorChanged: function(e, t) { g.val(t.color + ";" + s[m.borderpicker("option", "lineStyle")]), j.Cs("bottom") }, lineStyleChanged: function(e, t) { g.val(m.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("bottom") } }), v.borderpicker({ colorChanged: function(e, t) { b.val(t.color + ";" + s[v.borderpicker("option", "lineStyle")]), j.Cs("left") }, lineStyleChanged: function(e, t) { b.val(v.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("left") } }), w.borderpicker({ colorChanged: function(e, t) { y.val(t.color + ";" + s[w.borderpicker("option", "lineStyle")]), j.Cs("right") }, lineStyleChanged: function(e, t) { y.val(w.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("right") } }), C.borderpicker({ colorChanged: function(e, t) { x.val(t.color + ";" + s[C.borderpicker("option", "lineStyle")]), j.Cs("top") }, lineStyleChanged: function(e, t) { x.val(C.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("top") } }), k.borderpicker({ colorChanged: function(e, t) { S.val(t.color + ";" + s[k.borderpicker("option", "lineStyle")]), j.Cs("diagonalUp") }, lineStyleChanged: function(e, t) { S.val(k.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("diagonalUp") } }), A.borderpicker({ colorChanged: function(e, t) { T.val(t.color + ";" + s[A.borderpicker("option", "lineStyle")]), j.Cs("diagonalDown") }, lineStyleChanged: function(e, t) { T.val(A.borderpicker("option", "borderColor").color + ";" + s[t]), j.Cs("diagonalDown") } }), I.change(function() { n.actions.doAction("setFormatter", u.us, I.val()) }), N.change(function() { N.removeClass("ui-state-error"), u.ps = !1, $.isNumeric(N.val()) && parseInt(N.val()) >= 0 && parseInt(N.val()) === parseFloat(N.val()) ? n.actions.doAction("setRowsHeight", u.us, parseInt(N.val())) : (N.addClass("ui-state-error"), u.ps = !0) }), G.change(function() {
                            var e = n.spreadActions.getSelectionType(u.us);
                            switch (e) {
                                case 2:
                                    n.spreadActions.DesignerActionBase.prototype.execInSelectionsForCol(j.us.sheets[0], function(e, t) { j.us.sheets[0].setColumnResizable(t, G.prop("checked"), 1) });
                                    break;
                                case 1:
                                    n.spreadActions.DesignerActionBase.prototype.execInSelectionsForRow(j.us.sheets[0], function(e, t) { j.us.sheets[0].setRowResizable(t, G.prop("checked"), 2) })
                            }
                        }), z.change(function(e) {
                            var t = z.val(),
                                i = j.us.sheets[0];
                            j.us.suspendPaint();
                            try { n.spreadActions.DesignerActionBase.prototype.execInSelections(i, "", function(e, i, o) { e.getCell(i, o).text(t) }) } catch (e) { j.us.resumePaint() } j.us.resumePaint()
                        }), M.change(function() {
                            var e, t = n.spreadActions.getSelectionType(u.us);
                            switch (t) {
                                case 2:
                                    e = !0 === M.prop("checked") ? "unHideColumns" : "hideColumns";
                                    break;
                                case 1:
                                    e = !0 === M.prop("checked") ? "unHideRows" : "hideRows"
                            }
                            n.actions.doAction(e, u.us, M.val())
                        }), V.change(function() { V.removeClass("ui-state-error"), u.ps = !1, $.isNumeric(V.val()) && parseInt(V.val()) >= 0 && parseInt(V.val()) === parseFloat(V.val()) ? n.actions.doAction("setColumnsWidth", u.us, parseInt(V.val())) : (V.addClass("ui-state-error"), u.ps = !0) }), r = function(e) {
                            var t = e.target || e.srcElement,
                                r = new o.Style;
                            switch (t.id) {
                                case "hAlign":
                                    r.hAlign = parseInt(o.HorizontalAlign[D.val()]);
                                    break;
                                case "locked":
                                    r.locked = L.prop("checked");
                                    break;
                                case "shrinkToFit":
                                    r.shrinkToFit = R.prop("checked");
                                    break;
                                case "verticalText":
                                    r.isVerticalText = F.prop("checked");
                                    break;
                                case "textIndent":
                                    B.removeClass("ui-state-error"), u.ps = !1, $.isNumeric(B.val()) && parseInt(B.val()) >= 0 && parseInt(B.val()) === parseFloat(B.val()) ? r.textIndent = parseInt(B.val()) : "" === B.val() ? r.textIndent = i : (B.addClass("ui-state-error"), u.ps = !0);
                                    break;
                                case "vAlign":
                                    r.vAlign = parseInt(o.VerticalAlign[O.val()]);
                                    break;
                                case "wordWrap":
                                    r.wordWrap = P.prop("checked");
                                    break;
                                case "font":
                                    r.font = E.val()
                            }
                            n.actions.doAction("setStyle", u.us, r)
                        }, D.change(r), L.change(r), R.change(r), F.change(r), B.change(r), O.change(r), P.change(r), E.change(r), a = function(e, t) {
                            var i = n.spreadActions.getSelectionType(u.us);
                            switch (i) {
                                case 2:
                                    u.Eo.find(".resizable-row").removeClass("hidden"), u.Eo.find(".visible-row").removeClass("hidden"), u.Eo.find(".width-row").removeClass("hidden"), u.Eo.find(".resizable-row").addClass("visible"), u.Eo.find(".visible-row").addClass("visible"), u.Eo.find(".width-row").addClass("visible"), u.Eo.find(".height-row").removeClass("visible"), u.Eo.find(".value-row").removeClass("visible"), u.Eo.find(".height-row").addClass("hidden"), u.Eo.find(".value-row").addClass("hidden"), u.zs("col");
                                    break;
                                case 1:
                                    u.Eo.find(".resizable-row").removeClass("hidden"), u.Eo.find(".visible-row").removeClass("hidden"), u.Eo.find(".width-row").removeClass("visible"), u.Eo.find(".resizable-row").addClass("visible"), u.Eo.find(".visible-row").addClass("visible"), u.Eo.find(".width-row").addClass("hidden"), u.Eo.find(".height-row").removeClass("hidden"), u.Eo.find(".value-row").removeClass("visible"), u.Eo.find(".height-row").addClass("visible"), u.Eo.find(".value-row").addClass("hidden"), u.zs("row");
                                    break;
                                case 3:
                                    u.Eo.find(".resizable-row").removeClass("visible"), u.Eo.find(".visible-row").removeClass("visible"), u.Eo.find(".width-row").removeClass("visible"), u.Eo.find(".resizable-row").addClass("hidden"), u.Eo.find(".visible-row").addClass("hidden"), u.Eo.find(".width-row").addClass("hidden"), u.Eo.find(".height-row").removeClass("visible"), u.Eo.find(".value-row").removeClass("hidden"), u.Eo.find(".height-row").addClass("hidden"), u.Eo.find(".value-row").addClass("visible"), u.zs("cell");
                                    break;
                                default:
                                    u.Eo.find(".resizable-row").removeClass("visible"), u.Eo.find(".visible-row").removeClass("visible"), u.Eo.find(".width-row").removeClass("visible"), u.Eo.find(".resizable-row").addClass("hidden"), u.Eo.find(".visible-row").addClass("hidden"), u.Eo.find(".width-row").addClass("hidden"), u.Eo.find(".height-row").removeClass("visible"), u.Eo.find(".value-row").removeClass("visible"), u.Eo.find(".height-row").addClass("hidden"), u.Eo.find(".value-row").addClass("hidden"), u.zs("sheet")
                            }
                            N.removeClass("ui-state-error"), V.removeClass("ui-state-error"), B.removeClass("ui-state-error"), u.ps = !1
                        }, e.sheets[0].bind(o.Events.SelectionChanged, a), t.sheets[0].bind(o.Events.SelectionChanged, a), d = function(i, o) { return "columnHeaderTab" === o.newPanel[0].id ? (u.us = t, u.os = 1, u.ws("col"), a(), void setTimeout(function() { t.refresh() }, 0)) : "rowHeaderTab" === o.newPanel[0].id ? (u.us = e, u.os = 2, u.ws("row"), a(), void setTimeout(function() { e.refresh() }, 0)) : void 0 }, this.qs.on("tabsactivate", d), this.Eo.find(".property-grid").click(function(e) {
                            $(u.Eo.find(".property-grid").children()[0].children).removeClass("ui-state-focus");
                            var t = e.target || e.srcElement;
                            $(t).parents("tr").addClass("ui-state-focus")
                        }), void 0 === this.Ds && (p = new l, this.Eo.find(".font-popup").click(function() { p.open(E.val()) }), $(p).on("dialogClose", function(e, t) { E.val(t), E.trigger("change") })), $(document).mousedown(function(e) {
                            var t, i = e.target || e.srcElement,
                                o = $(".gcui-borderpicker-color-picker"),
                                n = !1;
                            for (t = 0; t < o.length; t++)
                                if (o[t].contains(i)) { n = !0; break } n || ($(".borderBottom-borderpicker")[0].contains(i) || u.Eo.find(".borderBottom-borderframe").comboframe("close"), $(".borderLeft-borderpicker")[0].contains(i) || u.Eo.find(".borderLeft-borderframe").comboframe("close"), $(".borderRight-borderpicker")[0].contains(i) || u.Eo.find(".borderRight-borderframe").comboframe("close"), $(".borderTop-borderpicker")[0].contains(i) || u.Eo.find(".borderTop-borderframe").comboframe("close"), $(".diagonalUp-borderpicker")[0].contains(i) || u.Eo.find(".diagonalUp-borderframe").comboframe("close"), $(".diagonalDown-borderpicker")[0].contains(i) || u.Eo.find(".diagonalDown-borderframe").comboframe("close"), $(".gcui-borderpicker-color").comboframe("close"))
                        }), n.wrapper.spread.bind(o.Events.ActiveSheetChanged, function() {
                            var i = u.Eo.find("#rowHeaderTab"),
                                n = u.Eo.find("#columnHeaderTab");
                            e.destroy(), i.empty(), t.destroy(), n.empty(), u.rs = e = new o.Workbook(i[0], { sheetCount: 1 }), u.ss = t = new o.Workbook(n[0], { sheetCount: 1 }), c(e), c(t), e.sheets[0].bind(o.Events.SelectionChanged, a), t.sheets[0].bind(o.Events.SelectionChanged, a)
                        })
                    }, a
                }(n.BaseDialog), n.HeaderCellsDialog = G, j = function() {
                    function e() {}
                    return e.Es = function(e, t) {
                        var i, r, a, s, l, c, d = new o.Style;
                        switch (e) {
                            case 0:
                                d.backColor = "#FFB6C1", d.foreColor = "#8B0000";
                                break;
                            case 1:
                                d.backColor = "#F0E68C", d.foreColor = "#BDB76B";
                                break;
                            case 2:
                                d.backColor = "#90EE90", d.foreColor = "#006400";
                                break;
                            case 3:
                                d.backColor = "#FFB6C1";
                                break;
                            case 4:
                                d.foreColor = "#8B0000";
                                break;
                            case 5:
                                d.borderBottom = new o.LineBorder("#8B0000", 1), d.borderLeft = new o.LineBorder("#8B0000", 1), d.borderTop = new o.LineBorder("#8B0000", 1), d.borderRight = new o.LineBorder("#8B0000", 1);
                                break;
                            case 6:
                                d = t, "" !== t.font && void 0 !== t.font && (i = n.wrapper.spread.getActiveSheet(), r = i.getActiveColumnIndex(), a = i.getActiveRowIndex(), s = i.getActualStyle(a, r, 3), l = $("<span></span>"), void 0 !== s.font ? ("" !== t.font && (l.css("font", t.font), c = l.css("font-style")), l.css("font", s.font), c && l.css("font-style", c)) : "" !== t.font && l.css("font", t.font + n.res.defaultFont), d.font = l.css("font"))
                        }
                        return d
                    }, e.Fs = function(e, t, i, o) { void 0 === o ? (e.css("background-image", "linear-gradient(to right, " + t + ", " + i + ")"), e.css("background-image", "-o-linear-gradient(to right, " + t + ", " + i + ")"), e.css("background-image", "-moz-linear-gradient(to right, " + t + ", " + i + ")"), e.css("background-image", "-webkit-linear-gradient(to right, " + t + ", " + i + ")"), e.css("background-image", "-ms-linear-gradient(to right, " + t + ", " + i + ")"), e.css("background-image", "-webkit-gradient(linear, left top, right top, color-stop(0, " + t + "),  color-stop(1, " + i + "))")) : (e.css("background-image", "linear-gradient(to right, " + t + ", " + i + ", " + o + ")"), e.css("background-image", "-o-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"), e.css("background-image", "-moz-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"), e.css("background-image", "-webkit-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"), e.css("background-image", "-ms-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"), e.css("background-image", "-webkit-gradient(linear, left top, right top, from(" + t + "), to(" + o + "),  color-stop(50%, " + i + "))")) }, e.Gs = function(t, i) {
                        var o, r, a, s;
                        void 0 === i || null === i ? (t.text(n.res.conditionalFormatting.newFormattingRule.preview.noFormat), t.css("background-color", ""), t.css("color", "black"), t.css("font-style", "normal"), t.css("text-decoration", "none")) : (t.text(n.res.conditionalFormatting.newFormattingRule.preview.hasFormat), o = e.Hs(i.backColor), void 0 === o && (o = i.backColor), null === o && (o = ""), t.css("background-color", o), r = e.Hs(i.foreColor), void 0 === r && (r = i.foreColor), t.css("color", r), void 0 !== i.font && "" !== i.font && (a = n.util.parseFont(i.font), t.css("font-style", a.fontStyle)), i.textDecoration && (s = n.util.toCSSTextDecoration(i.textDecoration), t.css("text-decoration", s)))
                    }, e.Hs = function(e) { var t = n.wrapper.spread.getActiveSheet().currentTheme().colors(); return t.getColor(e) }, e.Is = function(e) {
                        var t, i, o, r, a, s, l = e,
                            c = n.wrapper.spread.getActiveSheet(),
                            d = l.style(),
                            p = GC.Spread.Sheets.CalcEngine.formulaToExpression(c, l.formula());
                        return p.type === GC.Spread.CalcEngine.ExpressionType.function && (o = p, r = o.functionName, "ISBLANK" === r ? (t = 1, i = 3) : "ISERROR" === r ? (t = 1, i = 5) : "NOT" === r && 1 === o.args.length && (a = o.args[0], s = a.getFunctionName(), "ISBLANK" === s ? (t = 1, i = 4) : "ISERROR" === s && (t = 1, i = 6))), void 0 === t && (t = 5), { ruleType: t, selectorIndex: i, style: d, formula: l.formula() }
                    }, e.parseValue = function(e) { return !isNaN(e) && isFinite(e) ? parseFloat(e) : e }, e.Js = function(t, i, o, n) {
                        switch (i) {
                            case 15:
                                e.Ks(t, ["up-arrow-green", "right-up-arrow-yellow", "right-arrow-yellow", "right-down-arrow-yellow", "down-arrow-red"], o, n);
                                break;
                            case 16:
                                e.Ks(t, ["up-arrow-gray", "right-up-arrow-gray", "right-arrow-gray", "right-down-arrow-gray", "down-arrow-gray"], o, n);
                                break;
                            case 19:
                                e.Ks(t, ["box-4", "box-3", "box-2", "box-1", "box-0"], o, n);
                                break;
                            case 18:
                                e.Ks(t, ["quarters-4", "quarters-3", "quarters-2", "quarters-1", "quarters-0"], o, n);
                                break;
                            case 17:
                                e.Ks(t, ["rating-4", "rating-3", "rating-2", "rating-1", "rating-0"], o, n);
                                break;
                            case 10:
                                e.Ks(t, ["up-arrow-green", "right-up-arrow-yellow", "right-down-arrow-yellow", "down-arrow-red"], o, n);
                                break;
                            case 11:
                                e.Ks(t, ["up-arrow-gray", "right-up-arrow-gray", "right-down-arrow-gray", "down-arrow-gray"], o, n);
                                break;
                            case 13:
                                e.Ks(t, ["rating-3", "rating-2", "rating-1", "rating-0"], o, n);
                                break;
                            case 12:
                                e.Ks(t, ["ball-red", "ball-pink", "ball-gray", "ball-black"], o, n);
                                break;
                            case 14:
                                e.Ks(t, ["traffic-light-green", "traffic-light-yellow", "traffic-light-red", "traffic-light-black"], o, n);
                                break;
                            case 0:
                                e.Ks(t, ["up-arrow-green", "right-arrow-yellow", "down-arrow-red"], o, n);
                                break;
                            case 1:
                                e.Ks(t, ["up-arrow-gray", "right-arrow-gray", "down-arrow-gray"], o, n);
                                break;
                            case 4:
                                e.Ks(t, ["flag-green", "flag-yellow", "flag-red"], o, n);
                                break;
                            case 7:
                                e.Ks(t, ["traffic-light-green", "up-triangle-yellow", "down-rhombus-red"], o, n);
                                break;
                            case 3:
                                e.Ks(t, ["star-solid", "star-half", "star-hollow"], o, n);
                                break;
                            case 8:
                                e.Ks(t, ["check-circled-green", "notice-circled-yellow", "close-circled-red"], o, n);
                                break;
                            case 9:
                                e.Ks(t, ["check-uncircled-green", "notice-uncircled-yellow", "close-uncircled-red"], o, n);
                                break;
                            case 6:
                                e.Ks(t, ["traffic-light-rimmed-green", "traffic-light-rimmed-yellow", "traffic-light-rimmed-red"], o, n);
                                break;
                            case 5:
                                e.Ks(t, ["traffic-light-green", "traffic-light-yellow", "traffic-light-red"], o, n);
                                break;
                            case 2:
                                e.Ks(t, ["up-triangle-green", "minus-yellow", "down-triangle-red"], o, n)
                        }
                    }, e.Ls = function(t, i, o) {
                        var n, r = [];
                        for (n = i.length - 1; n >= 0; n--) r.push(e.Ms(i[n]));
                        e.Ks(t, r, o)
                    }, e.Ks = function(e, t, i, o) { var n, r; for (o && t.reverse(), n = 0; n < t.length; n++) r = $("<span>").addClass("iconSetsIcons").addClass("" + t[n]), i && r.css(i), e.append(r) }, e.Ms = function(e) {
                        var t = [
                            ["down-arrow-red", "right-arrow-yellow", "up-arrow-green"],
                            ["down-arrow-gray", "right-arrow-gray", "up-arrow-gray"],
                            ["down-triangle-red", "minus-yellow", "up-triangle-green"],
                            ["star-hollow", "star-half", "star-solid"],
                            ["flag-red", "flag-yellow", "flag-green"],
                            ["traffic-light-red", "traffic-light-yellow", "traffic-light-green"],
                            ["traffic-light-rimmed-red", "traffic-light-rimmed-yellow", "traffic-light-rimmed-green"],
                            ["down-rhombus-red", "up-triangle-yellow", "traffic-light-green"],
                            ["close-circled-red", "notice-circled-yellow", "check-circled-green"],
                            ["close-uncircled-red", "notice-uncircled-yellow", "check-uncircled-green"],
                            ["down-arrow-red", "right-down-arrow-yellow", "right-up-arrow-yellow", "up-arrow-green"],
                            ["down-arrow-gray", "right-down-arrow-gray", "right-up-arrow-gray", "up-arrow-gray"],
                            ["ball-black", "ball-gray", "ball-pink", "ball-red"],
                            ["rating-0", "rating-1", "rating-2", "rating-3"],
                            ["traffic-light-black", "traffic-light-red", "traffic-light-yellow", "traffic-light-green"],
                            ["down-arrow-red", "right-down-arrow-yellow", "right-arrow-yellow", "right-up-arrow-yellow", "up-arrow-green"],
                            ["down-arrow-gray", "right-down-arrow-gray", "right-arrow-gray", "right-up-arrow-gray", "up-arrow-gray"],
                            ["rating-0", "rating-1", "rating-2", "rating-3", "rating-4"],
                            ["quarters-0", "quarters-1", "quarters-2", "quarters-3", "quarters-4"],
                            ["box-0", "box-1", "box-2", "box-3", "box-4"],
                            ["no-cell-icon"]
                        ];
                        return t[e.iconSetType][e.iconIndex]
                    }, e
                }(), n.RuleFormatHelper = j,
                function(e) { e[e.greaterThan = 0] = "greaterThan", e[e.lessThan = 1] = "lessThan", e[e.between = 2] = "between", e[e.equalTo = 3] = "equalTo", e[e.top = 4] = "top", e[e.bottom = 5] = "bottom", e[e.above = 6] = "above", e[e.below = 7] = "below", n.OpenType = e }(n.OpenType || {}), H = function(e) {
                    n.extends(o, e);

                    function o() { e.call(this, r, ".cellValueRuleFormat-dialog") }
                    return o.prototype.Do = function() {
                        var e = this;
                        return {
                            width: "auto",
                            resizable: !1,
                            modal: !0,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.Jq();
                                    t && (e.Ns(), e.close(), n.wrapper.setFocusToSpread())
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, o.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i }), e.Ps()
                    }, o.prototype.Ps = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Qs || (e.Qs = new n.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                switch (e.hide(), $(this).data("name")) {
                                    case "textBox-cell1":
                                        o = e.Eo.find(".textBox-cell1").val(), e.Qs.open(t, i, o, [".textBox-cell1"]);
                                        break;
                                    case "textBox-cell2":
                                        o = e.Eo.find(".textBox-cell2").val(), e.Qs.open(t, i, o, [".textBox-cell2"]);
                                        break;
                                    default:
                                        e.show()
                                }
                            }
                        })
                    }, o.prototype.Rs = function(e, t) { this.Eo.find(e).val(t), this.Eo.find(e).change() }, o.prototype.Io = function(e) {
                        var t, o, r = e[0];
                        switch (this.Os = i, this.Ss = r, r) {
                            case 2:
                                t = n.res.conditionalFormatting.between.title, o = n.res.conditionalFormatting.between.description, this.Ts(!0);
                                break;
                            case 3:
                                t = n.res.conditionalFormatting.equalTo.title, o = n.res.conditionalFormatting.equalTo.description, this.Ts(!1);
                                break;
                            case 0:
                                t = n.res.conditionalFormatting.greaterThan.title, o = n.res.conditionalFormatting.greaterThan.description, this.Ts(!1);
                                break;
                            case 1:
                                t = n.res.conditionalFormatting.lessThan.title, o = n.res.conditionalFormatting.lessThan.description, this.Ts(!1)
                        }
                        this.Eo.dialog("option", "title", t), this.Eo.find(".description").text(o), this.Us(), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0)
                    }, o.prototype.Ts = function(e) {
                        var t = this.Eo.find(".label-and"),
                            i = this.Eo.find(".textBox-cell2-container");
                        e ? (t.removeClass("hidden"), i.show()) : (t.addClass("hidden"), i.hide())
                    }, o.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, o.prototype.Ns = function() {
                        var e, t, i = n.wrapper.spread.getActiveSheet(),
                            o = i.getSelections(),
                            r = this.Vo(this.Eo, 1),
                            a = this.Vo(this.Eo, 2),
                            s = this.Es();
                        switch (this.Ss) {
                            case 2:
                                t = 6;
                                break;
                            case 3:
                                t = 0;
                                break;
                            case 0:
                                t = 2;
                                break;
                            case 1:
                                t = 4
                        }
                        e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(1, o, s, t, r, a), n.actions.doAction("addRule", n.wrapper.spread, e)
                    }, o.prototype.Us = function() {
                        var e, t, i, o, r = n.wrapper.spread.getActiveSheet(),
                            a = r.getSelections(),
                            s = this.Eo.find(".textBox-cell1"),
                            l = this.Eo.find(".textBox-cell2"),
                            c = n.util.createStatisticalExpression("AVERAGE", a),
                            d = GC.Spread.Sheets.CalcEngine.evaluateExpression(r, c, 0, 0);
                        d instanceof GC.Spread.CalcEngine.CalcError && (d = 0), 2 === this.Ss ? (e = n.util.createStatisticalExpression("MIN", a), t = GC.Spread.Sheets.CalcEngine.evaluateExpression(r, e, 0, 0), i = d - t, o = d + t, s.val(i), l.val(o)) : s.val(d)
                    }, o.prototype.Jq = function() {
                        var e = this.Eo.find(".textBox-cell1").val(),
                            i = this.Eo.find(".textBox-cell2").val(),
                            o = !0;
                        switch (this.Ss) {
                            case 2:
                                "" !== e && "" !== i || (t.show(n.res.conditionalFormatting.exceptions.e1, n.res.title, 2), o = !1);
                                break;
                            case 3:
                            case 0:
                            case 1:
                                "" === e && (t.show(n.res.conditionalFormatting.exceptions.e1, n.res.title, 2), o = !1)
                        }
                        return o
                    }, o
                }(n.BaseDialog), n.CellValueRuleFormatDialog = H, W = function(e) {
                    n.extends(o, e);

                    function o() { e.call(this, r, ".textRuleFormat-dialog") }
                    return o.prototype.Do = function() {
                        var e = this;
                        return {
                            title: n.res.conditionalFormatting.textThatCotains.title,
                            width: "auto",
                            resizable: !1,
                            modal: !0,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.Jq();
                                    t && (e.Ns(), e.close(), n.wrapper.setFocusToSpread())
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, o.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i }), e.Ps()
                    }, o.prototype.Ps = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Qs || (e.Qs = new n.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                e.hide(), o = e.Eo.find(".textBox-cell1").val(), e.Qs.open(t, i, o, [".textBox-cell1"])
                            }
                        })
                    }, o.prototype.Rs = function(e, t) { this.Eo.find(e).val(t), this.Eo.find(e).change() }, o.prototype.Io = function() { this.Os = i, this.Us(), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0) }, o.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, o.prototype.Ns = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.getSelections(),
                            i = this.Vo(this.Eo, 1),
                            o = this.Es(),
                            r = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(2, t, o, 0, null, null, i);
                        n.actions.doAction("addRule", n.wrapper.spread, r)
                    }, o.prototype.Us = function() {
                        var e = n.wrapper.spread.getActiveSheet(),
                            t = e.getActiveColumnIndex(),
                            i = e.getActiveRowIndex(),
                            o = e.getCell(i, t),
                            r = this.Eo.find(".textBox-cell1");
                        r.val(o.text())
                    }, o.prototype.Jq = function() {
                        var e = this.Eo.find(".textBox-cell1").val(),
                            i = !0;
                        return "" === e && (t.show(n.res.conditionalFormatting.exceptions.e2, n.res.title, 2), i = !1), i
                    }, o
                }(n.BaseDialog), n.TextRuleFormatDialog = W, U = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".dateOccurringFormat-dialog") }
                    return t.prototype.Do = function() { var e = this; return { title: n.res.conditionalFormatting.dateOccurringFormat.title, width: "auto", resizable: !1, modal: !0, buttons: [{ text: n.res.ok, click: function() { e.Ns(), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i })
                    }, t.prototype.Io = function() { this.Os = i, $(this.Eo.find(".date").children()[0]).prop("selected", !0), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0) }, t.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, t.prototype.Ns = function() {
                        var e, t, i = n.wrapper.spread.getActiveSheet(),
                            o = i.getSelections(),
                            r = this.Es(),
                            a = parseInt(this.Eo.find(".date").prop("selectedIndex"));
                        switch (a) {
                            case 0:
                                e = 1;
                                break;
                            case 1:
                                e = 0;
                                break;
                            case 2:
                                e = 2;
                                break;
                            case 3:
                                e = 3;
                                break;
                            case 4:
                                e = 8;
                                break;
                            case 5:
                                e = 7;
                                break;
                            case 6:
                                e = 9;
                                break;
                            case 7:
                                e = 5;
                                break;
                            case 8:
                                e = 4;
                                break;
                            case 9:
                                e = 6
                        }
                        t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(4, o, r, null, null, null, null, null, e), n.actions.doAction("addRule", n.wrapper.spread, t)
                    }, t
                }(n.BaseDialog), n.DateOccurringFormatDialog = U, q = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".duplicateValuesFormat-dialog") }
                    return t.prototype.Do = function() { var e = this; return { title: n.res.conditionalFormatting.duplicateValuesFormat.title, width: "auto", resizable: !1, modal: !0, buttons: [{ text: n.res.ok, click: function() { e.Ns(), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i })
                    }, t.prototype.Io = function() { this.Os = i, $(this.Eo.find(".type").children()[0]).prop("selected", !0), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0) }, t.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, t.prototype.Ns = function() {
                        var e, t = n.wrapper.spread.getActiveSheet(),
                            i = t.getSelections(),
                            o = this.Es(),
                            r = parseInt(this.Eo.find(".type").prop("selectedIndex"));
                        switch (r) {
                            case 0:
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(7, i, o);
                                break;
                            case 1:
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(6, i, o)
                        }
                        n.actions.doAction("addRule", n.wrapper.spread, e)
                    }, t
                }(n.BaseDialog), n.DuplicateValuesFormatDialog = q, _ = function(e) {
                    n.extends(o, e);

                    function o() { e.call(this, r, ".top10RuleFormat-dialog") }
                    return o.prototype.Do = function() {
                        var e = this;
                        return {
                            width: "auto",
                            resizable: !1,
                            modal: !0,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.Jq();
                                    t && (e.Ns(), e.close(), n.wrapper.setFocusToSpread())
                                }
                            }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }]
                        }
                    }, o.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i })
                    }, o.prototype.Io = function(e) {
                        var t, o, r, a = e[0];
                        switch (this.Os = i, this.Ss = a, a) {
                            case 4:
                                t = n.res.conditionalFormatting.top10items.title, o = n.res.conditionalFormatting.top10items.description;
                                break;
                            case 5:
                                t = n.res.conditionalFormatting.bottom10items.title, o = n.res.conditionalFormatting.bottom10items.description
                        }
                        this.Eo.dialog("option", "title", t), this.Eo.find(".description").text(o), r = this.Eo.find(".itemCounts"), r.spinner({ min: 1, max: 1e3 }), r.val(10), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0)
                    }, o.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, o.prototype.Ns = function() {
                        var e, t, i = n.wrapper.spread.getActiveSheet(),
                            o = i.getSelections(),
                            r = this.Es(),
                            a = this.Eo.find(".itemCounts").val();
                        switch (this.Ss) {
                            case 4:
                                e = 0;
                                break;
                            case 5:
                                e = 1
                        }
                        t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(5, o, r, null, null, null, null, null, e, a), n.actions.doAction("addRule", n.wrapper.spread, t)
                    }, o.prototype.Jq = function() {
                        var e = parseInt(this.Eo.find(".itemCounts").val()),
                            i = !0;
                        return (isNaN(e) || e > 1e3 || e < 1) && (t.show(n.res.conditionalFormatting.exceptions.e3, n.res.title, 2), i = !1), i
                    }, o
                }(n.BaseDialog), n.Top10RuleFormatDialog = _, K = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".averageRuleFormat-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", resizable: !1, modal: !0, buttons: [{ text: n.res.ok, click: function() { e.Ns(), e.close(), n.wrapper.setFocusToSpread() } }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog), this.Eo.find(".withStyle").change(function(t) {
                            var i = t.target || t.srcElement,
                                o = i;
                            o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, e.formatCellDialog.setFormatDirectly(!1), e.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, e.Os, !0))
                        }), $(this.formatCellDialog).on("okClicked", function(t, i) { e.Os = i })
                    }, t.prototype.Io = function(e) {
                        var t, o, r = e[0];
                        switch (this.Os = i, this.Ss = r, r) {
                            case 6:
                                t = n.res.conditionalFormatting.aboveAverage.title, o = n.res.conditionalFormatting.aboveAverage.description;
                                break;
                            case 7:
                                t = n.res.conditionalFormatting.belowAverage.title, o = n.res.conditionalFormatting.belowAverage.description
                        }
                        this.Eo.dialog("option", "title", t), this.Eo.find(".description").text(o), $(this.Eo.find(".withStyle").children()[0]).prop("selected", !0)
                    }, t.prototype.Es = function() { var e = parseInt(this.Eo.find(".withStyle").prop("selectedIndex")); return j.Es(e, this.Os) }, t.prototype.Ns = function() {
                        var e, t, i = n.wrapper.spread.getActiveSheet(),
                            o = i.getSelections(),
                            r = this.Es();
                        switch (this.Ss) {
                            case 6:
                                e = 0;
                                break;
                            case 7:
                                e = 1
                        }
                        t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(8, o, r, null, null, null, null, null, e), n.actions.doAction("addRule", n.wrapper.spread, t)
                    }, t
                }(n.BaseDialog), n.AverageRuleFormatDialog = K,
                function(e) { e[e.formatOnValue = 0] = "formatOnValue", e[e.formatContain = 1] = "formatContain", e[e.formatRankedValue = 2] = "formatRankedValue", e[e.formatAbove = 3] = "formatAbove", e[e.formatUnique = 4] = "formatUnique", e[e.useFormula = 5] = "useFormula", n.RuleType = e }(n.RuleType || {}),
                function(e) { e[e.color2 = 0] = "color2", e[e.color3 = 1] = "color3", e[e.dataBar = 2] = "dataBar", e[e.iconSets = 3] = "iconSets", n.FormatStyle = e }(n.FormatStyle || {}), X = function(e) {
                    n.extends(t, e);

                    function t() { e.call(this, r, ".negativeValueAndAxisSettings-dialog") }
                    return t.prototype.Do = function() { var e = this; return { title: n.res.conditionalFormatting.newFormattingRule.formatOnValue.dataBar.negativeDialog.title, width: "auto", resizable: !1, modal: !0, buttons: [{ text: n.res.ok, click: function() { e.close(), e.Kq(event, e.Vs()), e.destroy() } }, { text: n.res.cancel, click: function() { e.close(), e.Kq(event, null), e.destroy() } }], beforeClose: function(t, i) { t.currentTarget && (e.Kq(t, null), e.destroy()) } } }, t.prototype.destroy = function() {
                        var t = $(".fillcolor-picker"),
                            i = $(".bordercolor-picker"),
                            o = $(".axiscolor-picker");
                        t.length > 0 && t.children().length > 0 && t.colorpicker("destroy"), i.length > 0 && i.children().length > 0 && i.colorpicker("destroy"), o.length > 0 && o.children().length > 0 && o.colorpicker("destroy"), t.remove(), i.remove(), o.remove(), e.prototype.destroy.call(this)
                    }, t.prototype.Kq = function(e, t) { $(this).trigger("dialogClose", t) }, t.prototype._init = function() {
                        var e = this,
                            t = this;
                        $(".fillcolor-picker").colorpicker({
                            valueChanged: function(e, i) {
                                var o;
                                o = void 0 === i.color ? "red" : i.color, t.Eo.find(".fillcolor-span").css("background-color", o)
                            },
                            choosedColor: function(e, i) { t.Eo.find(".fillcolor-frame").comboframe("close") },
                            openColorDialog: function(e, i) { t.Eo.find(".fillcolor-frame").comboframe("close") }
                        }), this.Eo.find(".fillcolor-frame").comboframe(), $(".fillcolor-picker").colorpicker("option", "value", "red"), this.Eo.find(".fillcolor-span").css("background-color", "red"), $(".bordercolor-picker").colorpicker({
                            valueChanged: function(e, i) {
                                var o;
                                o = void 0 === i.color ? "black" : i.color, t.Eo.find(".bordercolor-span").css("background-color", o)
                            },
                            choosedColor: function(e, i) { t.Eo.find(".bordercolor-frame").comboframe("close") },
                            openColorDialog: function(e, i) { t.Eo.find(".bordercolor-frame").comboframe("close") }
                        }), this.Eo.find(".bordercolor-frame").comboframe(), $(".bordercolor-picker").colorpicker("option", "value", "black"), this.Eo.find(".bordercolor-span").css("background-color", "black"), $(".axiscolor-picker").colorpicker({
                            valueChanged: function(e, i) {
                                var o;
                                o = void 0 === i.color ? "black" : i.color, t.Eo.find(".axiscolor-span").css("background-color", o)
                            },
                            choosedColor: function(e, i) { t.Eo.find(".axiscolor-frame").comboframe("close") },
                            openColorDialog: function(e, i) { t.Eo.find(".axiscolor-frame").comboframe("close") }
                        }), this.Eo.find(".axiscolor-frame").comboframe(), $(".axiscolor-picker").colorpicker("option", "value", "black"), this.Eo.find(".axiscolor-span").css("background-color", "black"), this.Eo.find(".default-radio").prop("checked", !0).attr("autofocus", !0), this.Eo.find("input[name = 'axis-positon']").change(function() { "none" === e.Eo.find("input[name = 'axis-positon']:checked").val() ? e.Eo.find(".axiscolor-frame button").attr("disabled", "disabled") : e.Eo.find(".axiscolor-frame button").removeAttr("disabled") })
                    }, t.prototype.Io = function(e) {
                        var t = e[0],
                            i = e[1],
                            o = this.Eo.find(".borderColor");
                        0 === t ? o.attr("disabled", "disabled") : o.removeAttr("disabled"), i && this.Ws(i)
                    }, t.prototype.Ws = function(e) { this.Eo.find(".fillcolor-span").css("background-color", e.negativeFillColor), this.Eo.find(".bordercolor-span").css("background-color", e.negativeBorderColor), this.Eo.find(".axiscolor-span").css("background-color", e.axisColor), e.useNegativeFillColor ? (this.Eo.find(".default-radio").prop("checked", !0), this.Eo.find("#fill-color-editor1").prop("checked", !0)) : this.Eo.find("#fill-color-editor2").prop("checked", !0), e.useNegativeBorderColor ? this.Eo.find("#border-color-editor1").prop("checked", !0) : this.Eo.find("#border-color-editor2").prop("checked", !0), 0 === e.axisPosition ? this.Eo.find("#axis-positon-editor1").prop("checked", !0) : 1 === e.axisPosition ? this.Eo.find("#axis-positon-editor2").prop("checked", !0) : this.Eo.find("#axis-positon-editor3").prop("checked", !0) }, t.prototype.Vs = function() {
                        var e, t, i, o, n, r = this.Eo.find(".fillcolor-span").css("background-color"),
                            a = this.Eo.find(".bordercolor-span").css("background-color"),
                            s = this.Eo.find(".axiscolor-span").css("background-color"),
                            l = this.Eo.find("input[name = 'fill-color']:checked").val();
                        return t = "fillColor" === l, o = this.Eo.find("input[name = 'border-color']:checked").val(), e = "borderColor" === o, n = this.Eo.find("input[name = 'axis-positon']:checked").val(), i = "auto" === n ? 0 : "cell" === n ? 1 : 2, { negativeBorderColor: a, negativeFillColor: r, useNegativeBorderColor: e, useNegativeFillColor: t, axisColor: s, axisPosition: i }
                    }, t
                }(n.BaseDialog), n.NegativeValueandAxisDialog = X;

            function te(e) {
                var t;
                switch (e) {
                    case "3-arrows-icon-set":
                        t = 0;
                        break;
                    case "3-arrows-gray-icon-set":
                        t = 1;
                        break;
                    case "3-triangles-icon-set":
                        t = 2;
                        break;
                    case "3-traffic-lights-unrimmed-icon-set":
                        t = 5;
                        break;
                    case "3-traffic-lights-rimmed-icon-set":
                        t = 6;
                        break;
                    case "3-signs-icon-set":
                        t = 7;
                        break;
                    case "3-symbols-circled-icon-set":
                        t = 8;
                        break;
                    case "3-symbols-uncircled-icon-set":
                        t = 9;
                        break;
                    case "3-flags-icon-set":
                        t = 4;
                        break;
                    case "3-stars-icon-set":
                        t = 3;
                        break;
                    case "4-arrows-gray-icon-set":
                        t = 11;
                        break;
                    case "4-arrows-icon-set":
                        t = 10;
                        break;
                    case "4-traffic-lights-icon-set":
                        t = 14;
                        break;
                    case "red-to-black-icon-set":
                        t = 12;
                        break;
                    case "4-ratings-icon-set":
                        t = 13;
                        break;
                    case "5-arrows-gray-icon-set":
                        t = 16;
                        break;
                    case "5-arrows-icon-set":
                        t = 15;
                        break;
                    case "5-quarters-icon-set":
                        t = 18;
                        break;
                    case "5-ratings-icon-set":
                        t = 17;
                        break;
                    case "5-boxes-icon-set":
                        t = 19;
                        break;
                    case "noIcons":
                        t = 20
                }
                return t
            }

            function ie(e, t) {
                var i, o = !0,
                    n = !0,
                    r = !0;
                for (i = 0; i < t.length; i++)
                    if (t[i].iconSetType !== e) { o = !1; break } for (i = 0; i < t.length; i++)
                    if (parseInt(t[i].iconIndex) !== i) { n = !1; break } for (i = 0; i < t.length; i++)
                    if (parseInt(t[i].iconIndex) !== t.length - 1 - i) { r = !1; break } return !o || !n && !r
            }

            function oe(e) { return e && "string" == typeof e && "=" === ("" + e)[0] && !isNaN(parseInt(e.substring(1))) ? e.substring(1) : e && "=" !== ("" + e)[0] && !isNaN(e) ? "=" + e : e } J = function(e) {
                n.extends(a, e);

                function a() { e.call(this, r, ".newFormattingRule-dialog") }
                return a.prototype.Do = function() {
                    var e = this;
                    return {
                        width: "auto",
                        height: "auto",
                        resizable: !1,
                        modal: !0,
                        buttons: [{
                            text: n.res.ok,
                            click: function() {
                                var t = e.Jq();
                                t && (e.Ns(), n.actions.isFileModified = !0, e.close(), e.Xs || n.wrapper.setFocusToSpread(), e.Ys && e.Zs.ranges(e.Ys), e.Kq(event, { rule: e.Zs, isCloseByOK: !0 }), e.destroy())
                            }
                        }, { text: n.res.cancel, click: function() { e.close(), e.Xs || n.wrapper.setFocusToSpread(), e.Ys && e.Zs.ranges(e.Ys), e.Kq(event, { rule: e.Zs, isCloseByOK: !1 }), e.destroy() } }],
                        beforeClose: function(t, i) { t.currentTarget && (e.Ys && e.Zs.ranges(e.Ys), e.Kq(t, { rule: e.Zs, isCloseByOK: !1 }), e.destroy()) }
                    }
                }, a.prototype.destroy = function() {
                    var t = $(".min-color-picker"),
                        i = $(".max-color-picker"),
                        o = $(".mid-color-picker"),
                        n = $(".barcolor1-picker"),
                        r = $(".barcolor2-picker");
                    t.length > 0 && t.children().length > 0 && t.colorpicker("destroy"), i.length > 0 && i.children().length > 0 && i.colorpicker("destroy"), o.length > 0 && o.children().length > 0 && o.colorpicker("destroy"), n.length > 0 && n.children().length > 0 && n.colorpicker("destroy"), r.length > 0 && r.children().length > 0 && r.colorpicker("destroy"), t.remove(), i.remove(), o.remove(), n.remove(), r.remove(), $("#icon-sets-popup-dialog").remove(), $(".icons-popup-dialog").remove(), this.$s(!1), e.prototype.destroy.call(this)
                }, a.prototype._init = function() {
                    var e = this,
                        t = this.Eo.find(".ruleType");
                    t.change(function() {
                        var i = parseInt(t.prop("selectedIndex"));
                        e._s(i), e.bt(i), e.eg && e.ct(e.Zs)
                    }), this.Xs = !1, this.ts()
                }, a.prototype.Io = function(e) {
                    var t = e[0],
                        o = e[1],
                        r = e[2],
                        a = e[3],
                        s = e[4],
                        l = e[5];
                    this.Os = i, this.dt = i, this._s(t, r, l), this.bt(t), o ? this.Eo.dialog("option", "title", n.res.conditionalFormatting.newFormattingRule.title) : (this.Eo.dialog("option", "title", n.res.conditionalFormatting.newFormattingRule.title2), this.ct(s), this.eg = !0), this.Xs = a
                }, a.prototype.Rs = function(e, t) { this.Eo.find(e).val(t), this.Eo.find(e).change() }, a.prototype.Ps = function() {
                    var e = this;
                    e.Eo.find(".rangeSelectButton").click(function() {
                        if (e.Qs || (e.Qs = new n.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                            var t = e.Eo.dialog("option", "title"),
                                i = e.Rs,
                                o;
                            switch (e.hide(), $(this).data("name")) {
                                case "minValue":
                                    o = e.Eo.find(".minValue").val(), e.Qs.open(t, i, o, [".minValue"]);
                                    break;
                                case "midValue":
                                    o = e.Eo.find(".midValue").val(), e.Qs.open(t, i, o, [".midValue"]);
                                    break;
                                case "maxValue":
                                    o = e.Eo.find(".maxValue").val(), e.Qs.open(t, i, o, [".maxValue"]);
                                    break;
                                case "minValue2":
                                    o = e.Eo.find(".minValue2").val(), e.Qs.open(t, i, o, [".minValue2"]);
                                    break;
                                case "maxValue2":
                                    o = e.Eo.find(".maxValue2").val(), e.Qs.open(t, i, o, [".maxValue2"]);
                                    break;
                                case "value1":
                                    o = e.Eo.find(".value1").val(), e.Qs.open(t, i, o, [".value1"]);
                                    break;
                                case "value2":
                                    o = e.Eo.find(".value2").val(), e.Qs.open(t, i, o, [".value2"]);
                                    break;
                                case "value3":
                                    o = e.Eo.find(".value3").val(), e.Qs.open(t, i, o, [".value3"]);
                                    break;
                                case "value4":
                                    o = e.Eo.find(".value4").val(), e.Qs.open(t, i, o, [".value4"]);
                                    break;
                                case "textBox-cell1":
                                    o = e.Eo.find(".textBox-cell1").val(), e.Qs.open(t, i, o, [".textBox-cell1"]);
                                    break;
                                case "textBox-cell2":
                                    o = e.Eo.find(".textBox-cell2").val(), e.Qs.open(t, i, o, [".textBox-cell2"]);
                                    break;
                                case "formula-input":
                                    o = e.Eo.find(".formula-input").val(), e.Qs.open(t, i, o, [".formula-input"]);
                                    break;
                                default:
                                    e.show()
                            }
                        }
                    })
                }, a.prototype.ts = function() {
                    var e, t, i, o, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A = this,
                        E = this;
                    E.Ps(), e = this.Eo.find(".formatStyle"), e.change(function() {
                        var t = parseInt(e.prop("selectedIndex"));
                        A.et(t), 0 !== t && 1 !== t || A.ft()
                    }), t = this.Eo.find(".minSelector"), t.change(function() {
                        var e = parseInt(t.prop("selectedIndex")),
                            i = A.Eo.find(".minValue"),
                            o = A.Eo.find(".minValueButton");
                        switch (e) {
                            case 0:
                                i.val("(" + t.val() + ")"), i.attr("disabled", "disabled"), o.attr("disabled", "disabled");
                                break;
                            case 1:
                            case 2:
                                i.val(0), i.removeAttr("disabled"), o.removeAttr("disabled");
                                break;
                            case 3:
                                i.val(""), i.removeAttr("disabled"), o.removeAttr("disabled");
                                break;
                            case 4:
                                i.val(10), i.removeAttr("disabled"), o.removeAttr("disabled")
                        }
                    }), i = this.Eo.find(".maxSelector"), i.change(function() {
                        var e = parseInt(i.prop("selectedIndex")),
                            t = A.Eo.find(".maxValue"),
                            o = A.Eo.find(".maxValueButton");
                        switch (e) {
                            case 0:
                                t.val("(" + i.val() + ")"), t.attr("disabled", "disabled"), o.attr("disabled", "disabled");
                                break;
                            case 1:
                                t.val(0), t.removeAttr("disabled"), o.removeAttr("disabled");
                                break;
                            case 2:
                                t.val(100), t.removeAttr("disabled"), o.removeAttr("disabled");
                                break;
                            case 3:
                                t.val(""), t.removeAttr("disabled"), o.removeAttr("disabled");
                                break;
                            case 4:
                                t.val(90), t.removeAttr("disabled"), o.removeAttr("disabled")
                        }
                    }), o = this.Eo.find(".midSelector"), o.change(function() {
                        var e = parseInt(o.prop("selectedIndex")),
                            t = A.Eo.find(".midValue");
                        switch (e) {
                            case 0:
                                t.val(0);
                                break;
                            case 1:
                                t.val(50);
                                break;
                            case 2:
                                t.val("");
                                break;
                            case 3:
                                t.val(50)
                        }
                    }), r = this.Eo.find(".minSelector2"), r.change(function() {
                        var e = parseInt(r.prop("selectedIndex")),
                            t = A.Eo.find(".minValue2"),
                            i = A.Eo.find(".minValue2Button");
                        switch (e) {
                            case 0:
                            case 5:
                                t.val("(" + r.val() + ")"), t.attr("disabled", "disabled"), i.attr("disabled", "disabled");
                                break;
                            case 1:
                            case 2:
                                t.val(0), t.removeAttr("disabled"), i.removeAttr("disabled");
                                break;
                            case 3:
                                t.val(""), t.removeAttr("disabled"), i.removeAttr("disabled");
                                break;
                            case 4:
                                t.val(10), t.removeAttr("disabled"), i.removeAttr("disabled")
                        }
                    }), a = this.Eo.find(".maxSelector2"), a.change(function() {
                        var e = parseInt(a.prop("selectedIndex")),
                            t = A.Eo.find(".maxValue2"),
                            i = A.Eo.find(".maxValue2Button");
                        switch (e) {
                            case 0:
                            case 5:
                                t.val("(" + a.val() + ")"), t.attr("disabled", "disabled"), i.attr("disabled", "disabled");
                                break;
                            case 1:
                                t.val(0), t.removeAttr("disabled"), i.removeAttr("disabled");
                                break;
                            case 2:
                                t.val(100), t.removeAttr("disabled"), i.removeAttr("disabled");
                                break;
                            case 3:
                                t.val(""), t.removeAttr("disabled"), i.removeAttr("disabled");
                                break;
                            case 4:
                                t.val(90), t.removeAttr("disabled"), i.removeAttr("disabled")
                        }
                    }), s = this.Eo.find(".fillSelector"), s.change(function() { E.gt() }), l = this.Eo.find(".borderSelector"), l.change(function() { E.gt(), 0 === l.prop("selectedIndex") ? A.Eo.find(".barcolor2-frame button").attr("disabled", "disabled") : A.Eo.find(".barcolor2-frame button").removeAttr("disabled") }), c = this.Eo.find(".barDirectionSelector"), c.change(function() { E.gt() }), d = this.Eo.find(".value1"), d.change(function() { E.ht(d.val()) }), p = this.Eo.find(".value2"), p.change(function() { E.ht(void 0, p.val()) }), u = this.Eo.find(".value3"), u.change(function() { E.ht(void 0, void 0, u.val()) }), h = this.Eo.find(".value4"), h.change(function() { E.ht(void 0, void 0, void 0, h.val()) }), f = this.Eo.find(".reverseIconOrder"), f.change(function(e) {
                        var t, i, o = [];
                        for (t = 0; t < A.it.length; t++) o.push("" + A.it[t]);
                        i = o.reverse(), A.jt.reverse(), A.kt(void 0, i)
                    }), $("#icon-sets-popup-dialog button").on("mouseenter", function(e) {
                        var t = e.currentTarget,
                            i = $(t).children("span.icon-button-container");
                        $(i).addClass("ui-state-hover")
                    }), $("#icon-sets-popup-dialog button").on("mouseleave", function(e) {
                        var t = e.currentTarget,
                            i = $(t).children("span.icon-button-container");
                        $(i).removeClass("ui-state-hover")
                    }), $("#icon-sets-popup-dialog button").on("click", function(e) {
                        var t, i, o, n, r, a, s, l, c;
                        for (E.Eo.find(".iconStyle-frame").comboframe("close"), t = [], o = e.currentTarget, E.lt = o.name, n = o.childNodes[1].children, r = 0; r < n.length; r++) a = n[r].className, i = "iconSetsIcons horizontal-icon-set-item ", s = a.substring(i.length, a.length), t.push(s);
                        if (E.jt = [], E.nt = !1, E.$s(!1), f.prop("checked")) {
                            for (l = [], r = 0; r < t.length; r++) l.push("" + t[r]);
                            for (c = l.reverse(), r = 0; r < t.length; r++) E.jt.push({ iconSetType: te(o.name), iconIndex: r });
                            E.kt(t, c)
                        } else {
                            for (r = t.length - 1; r >= 0; r--) E.jt.push({ iconSetType: te(o.name), iconIndex: r });
                            E.kt(t, t)
                        }
                        E.ot(t.length), E.pt(o.name)
                    }), $(".icons-popup-dialog .icon-wrapper").on("mouseenter", function(e) {
                        var t = e.currentTarget;
                        $(t).addClass("ui-state-hover")
                    }), $(".icons-popup-dialog .icon-wrapper").on("mouseleave", function(e) {
                        var t = e.currentTarget;
                        $(t).removeClass("ui-state-hover")
                    }), $(".icons-popup-dialog span").on("click", function(e) {
                        var t, i, o, r, a, s, l, c, d, p, u, h, f, g = E.Eo.find(".icon-frame.ui-state-active");
                        1 === g.length && (t = E.Eo.find(".icon-frame").index(g), g.comboframe("close"), i = $(g).children()[0], o = $(i).children()[0], r = $(e.currentTarget).hasClass("iconSetsIcons") ? e.currentTarget : $(e.currentTarget).children()[0], a = r.className, s = "iconSetsIcons ", l = a.substring(s.length, a.length), c = $(o).next("span"), "no-cell-icon" === l ? c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.noCellIcon) : c.text(""), d = "iconX iconSetsIcons ", p = o.className, (u = p.substring(d.length, p.length)) !== l && (h = o.className.match(/icon\d+/g), $(o).removeClass(), $(o).addClass(h[0]), $(o).addClass(s), $(o).addClass(l), f = r.getAttribute("name"), E.it[t] = l, f = f.split(","), E.jt[t] = { iconSetType: te(f[0]), iconIndex: parseInt(f[1]) }, E.nt = !0, E.$s(!0)))
                    }), g = this.Eo.find(".value1Selector"), g.change(function() { E.pt(E.lt, 1) }), m = this.Eo.find(".value2Selector"), m.change(function() { E.pt(E.lt, 2) }), b = this.Eo.find(".value3Selector"), b.change(function() { E.pt(E.lt, 3) }), v = this.Eo.find(".value4Selector"), v.change(function() { E.pt(E.lt, 4) }), y = this.Eo.find(".operator1"), y.change(function() { E.ht(d.val()) }), w = this.Eo.find(".operator2"), w.change(function() { E.ht(void 0, p.val()) }), x = this.Eo.find(".operator3"), x.change(function() { E.ht(void 0, void 0, u.val()) }), C = this.Eo.find(".operator4"), C.change(function() { E.ht(void 0, void 0, void 0, h.val()) }), S = this.Eo.find(".formatContain-type"), k = this.Eo.find(".operator"), S.change(function() {
                        var e = parseInt(S.prop("selectedIndex"));
                        A.qt(e), A.rt(e), k.trigger("change")
                    }), k.change(function(e) {
                        var t = parseInt(S.prop("selectedIndex"));
                        0 === t && A.st(k.prop("selectedIndex"))
                    }), T = this.Eo.find(".format-button"), T.click(function() { A.formatCellDialog.selectTabOptions = { numbers: !0, font: !0, border: !0, fill: !0 }, A.formatCellDialog.setFormatDirectly(!1), A.formatCellDialog.open("font", { family: "disabled", size: "disabled", weight: "disabled" }, A.Os, !0) })
                }, a.prototype.bt = function(e) {
                    var t = ".format-rule-sperator-line";
                    0 === e ? this.Eo.find(t).css("display", "none") : this.Eo.find(t).css("display", "block")
                }, a.prototype.Kq = function(e, t) { $(this).trigger("dialogClose", t) }, a.prototype.ct = function(e) {
                    var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R, B, O, P, N, z, M, V, G, H, W, U, q, _, K, X, J, Y, Q, Z, ee, te, oe, ne, re, ae, se, le, ce, de, pe, ue, he, fe, ge, me, be, ve, ye, we;
                    if (this.Ys = e.ranges(), this.Zs = e, v = n.wrapper.spread.getActiveSheet(), y = v.getActiveRowIndex(), w = v.getActiveColumnIndex(), e.ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule) x = e, u = x.minType(), h = x.minValue(), f = x.minColor(), g = x.maxType(), m = x.maxValue(), b = x.maxColor(), a = this.Eo.find(".minSelector"), t = this.tt(u), a.prop("selectedIndex", t), a.trigger("change"), s = this.Eo.find(".maxSelector"), i = this.tt(g), s.prop("selectedIndex", i), s.trigger("change"), $(".min-color-picker").colorpicker("option", "value", f), this.Eo.find(".min-color-span").css("background-color", f), $(".max-color-picker").colorpicker("option", "value", b), this.Eo.find(".max-color-span").css("background-color", b), 0 !== t && this.Eo.find(".minValue").val(h), 0 !== i && this.Eo.find(".maxValue").val(m), this.ft();
                    else if (e.ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule) C = e, u = C.minType(), h = C.minValue(), f = C.minColor(), g = C.maxType(), m = C.maxValue(), b = C.maxColor(), S = C.midType(), k = C.midValue(), T = C.midColor(), a = this.Eo.find(".minSelector"), t = this.tt(u), a.prop("selectedIndex", t), a.trigger("change"), s = this.Eo.find(".maxSelector"), i = this.tt(g), s.prop("selectedIndex", i), s.trigger("change"), A = this.Eo.find(".midSelector"), E = this.tt(S) - 1, A.prop("selectedIndex", E), A.trigger("change"), $(".min-color-picker").colorpicker("option", "value", f), this.Eo.find(".min-color-span").css("background-color", f), $(".max-color-picker").colorpicker("option", "value", b), this.Eo.find(".max-color-span").css("background-color", b), $(".mid-color-picker").colorpicker("option", "value", T), this.Eo.find(".mid-color-span").css("background-color", T), 0 !== t && this.Eo.find(".minValue").val(h), 0 !== i && this.Eo.find(".maxValue").val(m), this.Eo.find(".midValue").val(k), this.ft();
                    else if (e.ruleType() === o.ConditionalFormatting.RuleType.dataBarRule) I = e, D = I.minType(), h = I.minValue(), L = I.maxType(), m = I.maxValue(), F = I.color(), O = I.borderColor(), R = I.showBarOnly(), B = I.gradient(), P = I.showBorder(), N = I.dataBarDirection(), z = I.negativeBorderColor(), M = I.negativeFillColor(), V = I.useNegativeBorderColor(), G = I.useNegativeFillColor(), H = I.axisColor(), W = I.axisPosition(), U = this.Eo.find(".minSelector2"), t = this.tt(D), U.prop("selectedIndex", t), U.trigger("change"), q = this.Eo.find(".maxSelector2"), i = this.tt(L), q.prop("selectedIndex", i), q.trigger("change"), this.Eo.find(".minValue2").val(h), this.Eo.find(".maxValue2").val(m), $(".barcolor1-picker").colorpicker("option", "value", F), $(".barcolor2-picker").colorpicker("option", "value", O), this.Eo.find(".barcolor1-span").css("background-color", F), this.Eo.find(".barcolor2-span").css("background-color", O), this.Eo.find(".showBarOnly").prop("checked", R), _ = this.Eo.find(".fillSelector"), _.prop("selectedIndex", !0 === B ? 1 : 0), _.trigger("change"), K = this.Eo.find(".borderSelector"), K.prop("selectedIndex", !0 === P ? 1 : 0), K.trigger("change"), this.Eo.find(".barDirectionSelector").prop("selectedIndex", 0 === N ? 0 : 1), this.dt = { negativeBorderColor: z, negativeFillColor: M, useNegativeBorderColor: V, useNegativeFillColor: G, axisColor: H, axisPosition: W }, this.gt();
                    else if (e.ruleType() === o.ConditionalFormatting.RuleType.iconSetRule) {
                        switch (X = e, J = X.iconSetType(), Y = X.showIconOnly(), Q = X.reverseIconOrder(), Z = X.iconCriteria(), J) {
                            case 0:
                                ee = "3-arrows-icon-set";
                                break;
                            case 1:
                                ee = "3-arrows-gray-icon-set";
                                break;
                            case 2:
                                ee = "3-triangles-icon-set";
                                break;
                            case 5:
                                ee = "3-traffic-lights-unrimmed-icon-set";
                                break;
                            case 6:
                                ee = "3-traffic-lights-rimmed-icon-set";
                                break;
                            case 7:
                                ee = "3-signs-icon-set";
                                break;
                            case 8:
                                ee = "3-symbols-circled-icon-set";
                                break;
                            case 9:
                                ee = "3-symbols-uncircled-icon-set";
                                break;
                            case 4:
                                ee = "3-flags-icon-set";
                                break;
                            case 3:
                                ee = "3-stars-icon-set";
                                break;
                            case 11:
                                ee = "4-arrows-gray-icon-set";
                                break;
                            case 10:
                                ee = "4-arrows-icon-set";
                                break;
                            case 14:
                                ee = "4-traffic-lights-icon-set";
                                break;
                            case 12:
                                ee = "red-to-black-icon-set";
                                break;
                            case 13:
                                ee = "4-ratings-icon-set";
                                break;
                            case 16:
                                ee = "5-arrows-gray-icon-set";
                                break;
                            case 15:
                                ee = "5-arrows-icon-set";
                                break;
                            case 18:
                                ee = "5-quarters-icon-set";
                                break;
                            case 17:
                                ee = "5-ratings-icon-set";
                                break;
                            case 19:
                                ee = "5-boxes-icon-set"
                        }
                        for (this.pt(ee), this.Eo.find(".showIconOnly").prop("checked", Y), this.Eo.find(".reverseIconOrder").prop("checked", Q), this.Eo.find(".operator1").prop("selectedIndex", !0 === this.ut(Z[Z.length - 1]) ? 0 : 1), this.Eo.find(".operator2").prop("selectedIndex", !0 === this.ut(Z[Z.length - 2]) ? 0 : 1), this.Eo.find(".value1Selector").prop("selectedIndex", this.vt(Z[Z.length - 1])), this.Eo.find(".value2Selector").prop("selectedIndex", this.vt(Z[Z.length - 2])), te = this.Eo.find(".value1"), te.val(this.wt(Z[Z.length - 1])), oe = this.Eo.find(".value2"), oe.val(this.wt(Z[Z.length - 2])), Z.length >= 3 && (this.Eo.find(".operator3").prop("selectedIndex", !0 === this.ut(Z[Z.length - 3]) ? 0 : 1), this.Eo.find(".value3Selector").prop("selectedIndex", this.vt(Z[Z.length - 3])), ne = this.Eo.find(".value3"), ne.val(this.wt(Z[Z.length - 3]))), Z.length >= 4 && (this.Eo.find(".operator4").prop("selectedIndex", !0 === this.ut(Z[Z.length - 4]) ? 0 : 1), this.Eo.find(".value4Selector").prop("selectedIndex", this.vt(Z[Z.length - 4])), re = this.Eo.find(".value4"), re.val(this.wt(Z[Z.length - 4]))), ae = $("<div></div>"), j.Js(ae, J), ae.children().removeClass("iconSetsIcons"), se = [], le = [], ce = 0; ce < ae.children().length; ce++) se.push(ae.children()[ce].className);
                        if (this.jt = X.icons(), this.jt)
                            for (this.jt = X.icons().concat(), this.jt.reverse(), ce = 0; ce < ae.children().length; ce++) le.push(j.Ms(this.jt[ce]));
                        else this.jt = [], le = se;
                        this.nt = X.nt || ie(J, this.jt), this.$s(this.nt), Q && (this.jt.reverse(), le.reverse()), this.kt(se, le), this.ot(Z.length + 1), this.ht(te.val(), oe.val(), void 0 === ne ? void 0 : ne.val(), void 0 === re ? void 0 : re.val())
                    } else if (e.ruleType() === o.ConditionalFormatting.RuleType.cellValueRule) {
                        switch (de = e, c = de.operator(), d = de.value1(y, w), p = de.value2(y, w), this.Os = de.style(), l = this.Eo.find(".formatContain-type"), l.prop("selectedIndex", 0), l.trigger("change"), c) {
                            case 6:
                                t = 0;
                                break;
                            case 7:
                                t = 1;
                                break;
                            case 0:
                                t = 2;
                                break;
                            case 1:
                                t = 3;
                                break;
                            case 2:
                                t = 4;
                                break;
                            case 4:
                                t = 5;
                                break;
                            case 3:
                                t = 6;
                                break;
                            case 5:
                                t = 7
                        }
                        this.Eo.find(".operator").prop("selectedIndex", t), this.Eo.find(".operator").trigger("change"), this.Eo.find(".textBox-cell1").val(d), this.Eo.find(".textBox-cell2").val(p), this.Gs()
                    } else if (e.ruleType() === o.ConditionalFormatting.RuleType.specificTextRule) {
                        switch (pe = e, c = pe.operator(), d = pe.text(), this.Os = pe.style(), l = this.Eo.find(".formatContain-type"), l.prop("selectedIndex", 1), l.trigger("change"), c) {
                            case 0:
                                t = 0;
                                break;
                            case 1:
                                t = 1;
                                break;
                            case 2:
                                t = 2;
                                break;
                            case 3:
                                t = 3
                        }
                        this.Eo.find(".operator").prop("selectedIndex", t), this.Eo.find(".operator").trigger("change"), this.Eo.find(".textBox-cell1").val(d), this.Gs()
                    } else if (e.ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule) {
                        switch (ue = e, he = ue.type(), this.Os = ue.style(), l = this.Eo.find(".formatContain-type"), l.prop("selectedIndex", 2), l.trigger("change"), he) {
                            case 1:
                                t = 0;
                                break;
                            case 0:
                                t = 1;
                                break;
                            case 2:
                                t = 2;
                                break;
                            case 3:
                                t = 3;
                                break;
                            case 8:
                                t = 4;
                                break;
                            case 7:
                                t = 5;
                                break;
                            case 9:
                                t = 6;
                                break;
                            case 5:
                                t = 7;
                                break;
                            case 4:
                                t = 8;
                                break;
                            case 6:
                                t = 9
                        }
                        this.Eo.find(".operator").prop("selectedIndex", t), this.Eo.find(".operator").trigger("change"), this.Gs()
                    } else if (e.ruleType() === o.ConditionalFormatting.RuleType.top10Rule) fe = e, r = fe.type(), ge = fe.rank(), this.Os = fe.style(), this.Eo.find(".formatRankedValue-type").prop("selectedIndex", 0 === r ? 0 : 1), this.Eo.find(".formatRankedValue-type").trigger("change"), this.Eo.find(".itemCounts").val(ge), this.Gs();
                    else if (e.ruleType() === o.ConditionalFormatting.RuleType.averageRule) {
                        switch (me = e, r = me.type(), this.Os = me.style(), r) {
                            case 0:
                                t = 0;
                                break;
                            case 1:
                                t = 1;
                                break;
                            case 2:
                                t = 2;
                                break;
                            case 3:
                                t = 3;
                                break;
                            case 4:
                                t = 4;
                                break;
                            case 5:
                                t = 5;
                                break;
                            case 6:
                                t = 6;
                                break;
                            case 7:
                                t = 7;
                                break;
                            case 8:
                                t = 8;
                                break;
                            case 9:
                                t = 9
                        }
                        this.Eo.find(".formatAbove-type").prop("selectedIndex", t), this.Eo.find(".formatAbove-type").trigger("change"), this.Gs()
                    } else e.ruleType() === o.ConditionalFormatting.RuleType.duplicateRule ? (be = e, this.Os = be.style(), this.Eo.find(".formatUnique-type").prop("selectedIndex", 0), this.Gs()) : e.ruleType() === o.ConditionalFormatting.RuleType.uniqueRule ? (ve = e, this.Os = ve.style(), this.Eo.find(".formatUnique-type").prop("selectedIndex", 1), this.Gs()) : e.ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (ye = e, t = ye.selectorIndex, this.Os = ye.style(), 1 === ye.ruleType() ? (this.Eo.find(".formatContain-type").prop("selectedIndex", t), this.Eo.find(".formatContain-type").trigger("change")) : 3 === ye.ruleType() && (we = ye.formula(), this.Eo.find(".formula-input").val(we)), this.Gs())
                }, a.prototype.tt = function(e) {
                    var t;
                    switch (e) {
                        case 2:
                        case 1:
                            t = 0;
                            break;
                        case 0:
                            t = 1;
                            break;
                        case 3:
                            t = 2;
                            break;
                        case 6:
                            t = 3;
                            break;
                        case 4:
                            t = 4;
                            break;
                        case 5:
                        case 7:
                            t = 5
                    }
                    return t
                }, a.prototype.xt = function(e, t) { return e[t] }, a.prototype.ut = function(e) { return this.xt(e, "isGreaterThanOrEqualTo") }, a.prototype.wt = function(e) { var t = this.xt(e, "iconValue"); return oe(t) }, a.prototype.vt = function(e) {
                    var t, i = this.xt(e, "iconValueType");
                    switch (i) {
                        case 1:
                            t = 0;
                            break;
                        case 4:
                            t = 1;
                            break;
                        case 7:
                            t = 2;
                            break;
                        case 5:
                            t = 3
                    }
                    return t
                }, a.prototype.yt = function(e) {
                    var t;
                    switch (e) {
                        case 0:
                            t = 1;
                            break;
                        case 1:
                            t = 4;
                            break;
                        case 2:
                            t = 7;
                            break;
                        case 3:
                            t = 5
                    }
                    return t
                }, a.prototype.Jq = function() {
                    var e, i, o, r, a, s, l, c, d, p = parseInt(this.Eo.find(".ruleType").prop("selectedIndex"));
                    switch (p) {
                        case 0:
                            break;
                        case 1:
                            switch (e = parseInt(this.Eo.find(".formatContain-type").prop("selectedIndex")), i = this.Eo.find(".operator").prop("selectedIndex"), o = this.Eo.find(".textBox-cell1"), r = this.Eo.find(".textBox-cell2"), e) {
                                case 0:
                                    if (0 === i || 1 === i) { if ("" === o.val() || "" === r.val()) return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2), !1 } else if ("" === o.val()) return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2), !1;
                                    break;
                                case 1:
                                    if ("" === o.val()) return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2), !1
                            }
                            break;
                        case 2:
                            return a = parseInt(this.Eo.find(".itemCounts").val()), s = !0, (isNaN(a) || a > 1e3 || a < 1) && (t.show(n.res.conditionalFormatting.exceptions.e3, n.res.title, 2), s = !1), s;
                        case 5:
                            if (l = this.Eo.find(".formula-input").val(), c = n.wrapper.spread.getActiveSheet(), d = GC.Spread.Sheets.CalcEngine.formulaToExpression(c, l), d.type !== GC.Spread.CalcEngine.ExpressionType.function && d.type !== GC.Spread.CalcEngine.ExpressionType.reference && d.type !== GC.Spread.CalcEngine.ExpressionType.operator) return t.show(n.res.conditionalFormatting.exceptions.e5, n.res.title, 2), !1
                    }
                    return !0
                }, a.prototype.Ns = function() {
                    var e, t, i, o = parseInt(this.Eo.find(".ruleType").prop("selectedIndex"));
                    switch (o) {
                        case 0:
                            switch (e = parseInt(this.Eo.find(".formatStyle").prop("selectedIndex"))) {
                                case 0:
                                    this.zt(!1);
                                    break;
                                case 1:
                                    this.zt(!0);
                                    break;
                                case 2:
                                    this.At();
                                    break;
                                case 3:
                                    this.Bt()
                            }
                            break;
                        case 1:
                            switch (t = parseInt(this.Eo.find(".formatContain-type").prop("selectedIndex"))) {
                                case 0:
                                    this.Ct();
                                    break;
                                case 1:
                                    this.Dt();
                                    break;
                                case 2:
                                    this.Et();
                                    break;
                                default:
                                    this.Ft(t)
                            }
                            break;
                        case 2:
                            this.Gt();
                            break;
                        case 3:
                            this.Ht();
                            break;
                        case 4:
                            this.It();
                            break;
                        case 5:
                            this.Jt()
                    }(i = this.Zs) && i.style() && void 0 !== i.style().locked && delete i.style().locked
                }, a.prototype._s = function(e, t, i) {
                    var o = this.Eo.find(".formatOnValue"),
                        n = this.Eo.find(".formatContain"),
                        r = this.Eo.find(".formatRankedValue"),
                        a = this.Eo.find(".formatAbove"),
                        s = this.Eo.find(".formatUnique"),
                        l = this.Eo.find(".useFormula"),
                        c = this.Eo.find(".ruleType"),
                        d = this.Eo.find(".preview");
                    switch (e) {
                        case 0:
                            o.removeClass("hidden"), n.addClass("hidden"), r.addClass("hidden"), a.addClass("hidden"), s.addClass("hidden"), l.addClass("hidden"), d.addClass("hidden"), this.Kt(t), c.prop("selectedIndex", 0);
                            break;
                        case 1:
                            o.addClass("hidden"), n.removeClass("hidden"), r.addClass("hidden"), a.addClass("hidden"), s.addClass("hidden"), l.addClass("hidden"), d.removeClass("hidden"), this.Lt(i), this.Mt(), c.prop("selectedIndex", 1);
                            break;
                        case 2:
                            o.addClass("hidden"), n.addClass("hidden"), r.removeClass("hidden"), a.addClass("hidden"), s.addClass("hidden"), l.addClass("hidden"), d.removeClass("hidden"), this.Nt(), this.Mt(), c.prop("selectedIndex", 2);
                            break;
                        case 3:
                            o.addClass("hidden"), n.addClass("hidden"), r.addClass("hidden"), a.removeClass("hidden"), s.addClass("hidden"), l.addClass("hidden"), d.removeClass("hidden"), this.Ot(), this.Mt(), c.prop("selectedIndex", 3);
                            break;
                        case 4:
                            o.addClass("hidden"), n.addClass("hidden"), r.addClass("hidden"), a.addClass("hidden"), s.removeClass("hidden"), l.addClass("hidden"), d.removeClass("hidden"), this.Pt(), this.Mt(), c.prop("selectedIndex", 4);
                            break;
                        case 5:
                            o.addClass("hidden"), n.addClass("hidden"), r.addClass("hidden"), a.addClass("hidden"), s.addClass("hidden"), l.removeClass("hidden"), d.removeClass("hidden"), this.Qt(), this.Mt(), c.prop("selectedIndex", 5)
                    }
                }, a.prototype.ft = function() {
                    var e = this.Eo.find(".min-color-span").css("background-color"),
                        t = this.Eo.find(".mid-color-span").css("background-color"),
                        i = this.Eo.find(".max-color-span").css("background-color");
                    0 === this.Rt ? this.St(e, i) : this.St(e, t, i)
                }, a.prototype.gt = function() {
                    var e, t, i, o = this.Eo.find(".barcolor1-span").css("background-color"),
                        n = this.Eo.find(".barcolor2-span").css("background-color"),
                        r = this.Eo.find(".fillSelector").prop("selectedIndex"),
                        a = this.Eo.find(".borderSelector").prop("selectedIndex"),
                        s = this.Eo.find(".barDirectionSelector").prop("selectedIndex"),
                        l = this.Eo.find(".previewContainer-dataBar"),
                        c = o;
                    1 === r && (e = "white"), 1 === a && (t = n), 1 === s ? (i = c, c = e, e = i, l.attr("align", "right")) : l.attr("align", "left"), this.Tt(c, e, t)
                }, a.prototype.Kt = function(e) {
                    var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R = this,
                        B = this;
                    if ($(".min-color-picker").colorpicker({
                            valueChanged: function(e, t) {
                                var i;
                                i = void 0 === t.color ? "red" : t.color, B.Eo.find(".min-color-span").css("background-color", i), B.ft()
                            },
                            choosedColor: function(e, t) { B.Eo.find(".min-color-frame").comboframe("close") },
                            openColorDialog: function(e, t) { B.Eo.find(".min-color-frame").comboframe("close") }
                        }), this.Eo.find(".min-color-frame").comboframe(), $(".min-color-picker").colorpicker("option", "value", "red"), this.Eo.find(".min-color-span").css("background-color", "red"), $(".mid-color-picker").colorpicker({ valueChanged: function(e, t) { void 0 === t.color ? B.Eo.find(".mid-color-span").css("background-color", "yellow") : B.Eo.find(".mid-color-span").css("background-color", t.color), B.ft() }, choosedColor: function(e, t) { B.Eo.find(".mid-color-frame").comboframe("close") }, openColorDialog: function(e, t) { B.Eo.find(".mid-color-frame").comboframe("close") } }), this.Eo.find(".mid-color-frame").comboframe(), $(".mid-color-picker").colorpicker("option", "value", "yellow"), this.Eo.find(".mid-color-span").css("background-color", "yellow"), $(".max-color-picker").colorpicker({ valueChanged: function(e, t) { void 0 === t.color ? B.Eo.find(".max-color-span").css("background-color", "green") : B.Eo.find(".max-color-span").css("background-color", t.color), B.ft() }, choosedColor: function(e, t) { B.Eo.find(".max-color-frame").comboframe("close") }, openColorDialog: function(e, t) { B.Eo.find(".max-color-frame").comboframe("close") } }), this.Eo.find(".max-color-frame").comboframe(), $(".max-color-picker").colorpicker("option", "value", "green"), this.Eo.find(".max-color-span").css("background-color", "green"), t = this.Eo.find(".formatStyle"), e) switch (e) {
                        case 0:
                            t.prop("selectedIndex", 0);
                            break;
                        case 1:
                            t.prop("selectedIndex", 1);
                            break;
                        case 2:
                            t.prop("selectedIndex", 2);
                            break;
                        case 3:
                            t.prop("selectedIndex", 3)
                    } else t.prop("selectedIndex", 0);
                    for (t.trigger("change"), i = this.Eo.find(".minSelector"), i.prop("selectedIndex", 0), i.trigger("change"), o = this.Eo.find(".maxSelector"), o.prop("selectedIndex", 0), o.trigger("change"), n = this.Eo.find(".midSelector"), n.prop("selectedIndex", 3), n.trigger("change"), r = this.Eo.find(".showBarOnly"), r.prop("checked", !1), a = this.Eo.find(".minSelector2"), s = a.prop("selectedIndex"), a.prop("selectedIndex", 5), s !== a.prop("selectedIndex") && a.trigger("change"), l = this.Eo.find(".maxSelector2"), c = l.prop("selectedIndex"), l.prop("selectedIndex", 5), c !== l.prop("selectedIndex") && l.trigger("change"), $(".barcolor1-picker").colorpicker({
                            valueChanged: function(e, t) {
                                var i;
                                i = void 0 === t.color ? "rgb(99,142,198)" : t.color, B.Eo.find(".barcolor1-span").css("background-color", i), B.gt()
                            },
                            choosedColor: function(e, t) { B.Eo.find(".barcolor1-frame").comboframe("close") },
                            openColorDialog: function(e, t) { B.Eo.find(".barcolor1-frame").comboframe("close") }
                        }), this.Eo.find(".barcolor1-frame").comboframe(), $(".barcolor1-picker").colorpicker("option", "value", "rgb(99,142,198)"), this.Eo.find(".barcolor1-span").css("background-color", "rgb(99,142,198)"), $(".barcolor2-picker").colorpicker({
                            valueChanged: function(e, t) {
                                var i;
                                i = void 0 === t.color ? "black" : t.color, B.Eo.find(".barcolor2-span").css("background-color", i), B.gt()
                            },
                            choosedColor: function(e, t) { B.Eo.find(".barcolor2-frame").comboframe("close") },
                            openColorDialog: function(e, t) { B.Eo.find(".barcolor2-frame").comboframe("close") }
                        }), this.Eo.find(".barcolor2-frame").comboframe(), $(".barcolor2-picker").colorpicker("option", "value", "black"), this.Eo.find(".barcolor2-span").css("background-color", "black"), d = this.Eo.find(".fillSelector"), p = d.prop("selectedIndex"), d.prop("selectedIndex", 0), p !== d.prop("selectedIndex") && d.trigger("change"), u = this.Eo.find(".borderSelector"), h = u.prop("selectedIndex"), u.prop("selectedIndex", 0), h !== u.prop("selectedIndex") && u.trigger("change"), f = this.Eo.find(".barDirectionSelector"), g = f.prop("selectedIndex"), f.prop("selectedIndex", 0), g !== f.prop("selectedIndex") && f.trigger("change"), m = this.Eo.find(".negativeBtn"), m.button(), m.click(function() {
                            var e = u.prop("selectedIndex");
                            R.negativeDialog || (R.negativeDialog = new X), $(R.negativeDialog).on("dialogClose", function(e, t) { t && (B.dt = t), B.negativeDialog = null }), R.negativeDialog.open(e, R.dt)
                        }), this.gt(), void 0 === this.Ut && (this.Ut = []), void 0 === this.it && (this.it = []), void 0 === this.jt && (this.jt = [], this.nt = !1), b = this.Eo.find(".reverseIconOrder"), !1 !== b.prop("checked") && (b.prop("checked", !1), b.trigger("change")), v = this.Eo.find(".showIconOnly"), !1 !== v.prop("checked") && v.prop("checked", !1), y = this.Eo.find(".iconStyleIcon1-span"), w = $("#icon-sets-popup-dialog"), x = w.find("ul"), w.gcuipopup({ autoHide: !0, position: { of: y, my: "left top", at: "right top" }, collision: "fit fit", showing: function(e, t) { x.removeClass("hidden") }, hidden: function(e, t) { B.Eo.find(".iconStyle-frame").comboframe("close") } }), this.Eo.find(".iconStyle-frame").comboframe(), this.Eo.find(".icon-frame").comboframe(), C = ["up-arrow-green", "right-arrow-yellow", "down-arrow-red"], this.lt = "3-arrows-icon-set", this.jt = [], S = 0; S < 3; S++) this.jt.push({ iconSetType: te("3-arrows-icon-set"), iconIndex: 2 - S });
                    this.kt(C, C), this.ot(3), k = this.Eo.find(".value1Selector"), 1 !== k.prop("selectedIndex") && (k.prop("selectedIndex", 1), k.trigger("change")), T = this.Eo.find(".value2Selector"), 1 !== T.prop("selectedIndex") && (T.prop("selectedIndex", 1), T.trigger("change")), A = this.Eo.find(".value3Selector"), 1 !== A.prop("selectedIndex") && (A.prop("selectedIndex", 1), A.trigger("change")), E = this.Eo.find(".value4Selector"), 1 !== E.prop("selectedIndex") && (E.prop("selectedIndex", 1), E.trigger("change")), B.pt("3-arrows-icon-set"), I = this.Eo.find(".operator1"), 0 !== I.prop("selectedIndex") && (I.prop("selectedIndex", 0), I.trigger("change")), D = this.Eo.find(".operator2"), 0 !== D.prop("selectedIndex") && (D.prop("selectedIndex", 0), D.trigger("change")), L = this.Eo.find(".operator3"), 0 !== L.prop("selectedIndex") && (L.prop("selectedIndex", 0), L.trigger("change")), F = this.Eo.find(".operator4"), 0 !== F.prop("selectedIndex") && (F.prop("selectedIndex", 0), F.trigger("change"))
                }, a.prototype.gt = function() {
                    var e, t, i, o = this.Eo.find(".barcolor1-span").css("background-color"),
                        n = this.Eo.find(".barcolor2-span").css("background-color"),
                        r = this.Eo.find(".fillSelector").prop("selectedIndex"),
                        a = this.Eo.find(".borderSelector").prop("selectedIndex"),
                        s = this.Eo.find(".barDirectionSelector").prop("selectedIndex"),
                        l = this.Eo.find(".previewContainer-dataBar"),
                        c = o;
                    1 === r && (e = "white"), 1 === a && (t = n), 1 === s ? (i = c, c = e, e = i, l.attr("align", "right")) : l.attr("align", "left"), this.Tt(c, e, t)
                }, a.prototype.$s = function(e) { e ? ($(".iconStyleIcon").hide(), $(".iconStyle-frame .custom-iconset").remove(), $(".iconStyle-frame .icon-button-container").append($("<span></span>").addClass("custom-iconset").text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.customIconSet))) : ($(".iconStyleIcon").show(), $(".iconStyle-frame .custom-iconset").remove()) }, a.prototype.pt = function(e, t) {
                    var i, o, n, r, a, s, l, c, d, p, u, h;
                    switch (this.lt = e, i = this.Eo.find(".value1Selector").prop("selectedIndex"), o = this.Eo.find(".value2Selector").prop("selectedIndex"), n = this.Eo.find(".value3Selector").prop("selectedIndex"), r = this.Eo.find(".value4Selector").prop("selectedIndex"), e) {
                        case "3-arrows-icon-set":
                        case "3-arrows-gray-icon-set":
                        case "3-triangles-icon-set":
                        case "3-traffic-lights-unrimmed-icon-set":
                        case "3-traffic-lights-rimmed-icon-set":
                        case "3-signs-icon-set":
                        case "3-symbols-circled-icon-set":
                        case "3-symbols-uncircled-icon-set":
                        case "3-flags-icon-set":
                        case "3-stars-icon-set":
                            switch (i) {
                                case 0:
                                    a = 0;
                                    break;
                                case 1:
                                case 3:
                                    a = 67;
                                    break;
                                case 2:
                                    a = ""
                            }
                            switch (o) {
                                case 0:
                                    s = 0;
                                    break;
                                case 1:
                                case 3:
                                    s = 33;
                                    break;
                                case 2:
                                    s = ""
                            }
                            break;
                        case "4-arrows-gray-icon-set":
                        case "4-arrows-icon-set":
                        case "4-traffic-lights-icon-set":
                        case "red-to-black-icon-set":
                        case "4-ratings-icon-set":
                            switch (i) {
                                case 0:
                                    a = 0;
                                    break;
                                case 1:
                                case 3:
                                    a = 75;
                                    break;
                                case 2:
                                    a = ""
                            }
                            switch (o) {
                                case 0:
                                    s = 0;
                                    break;
                                case 1:
                                case 3:
                                    s = 50;
                                    break;
                                case 2:
                                    s = ""
                            }
                            switch (n) {
                                case 0:
                                    l = 0;
                                    break;
                                case 1:
                                case 3:
                                    l = 25;
                                    break;
                                case 2:
                                    l = ""
                            }
                            break;
                        case "5-arrows-gray-icon-set":
                        case "5-arrows-icon-set":
                        case "5-quarters-icon-set":
                        case "5-ratings-icon-set":
                        case "5-boxes-icon-set":
                            switch (i) {
                                case 0:
                                    a = 0;
                                    break;
                                case 1:
                                case 3:
                                    a = 80;
                                    break;
                                case 2:
                                    a = ""
                            }
                            switch (o) {
                                case 0:
                                    s = 0;
                                    break;
                                case 1:
                                case 3:
                                    s = 60;
                                    break;
                                case 2:
                                    s = ""
                            }
                            switch (n) {
                                case 0:
                                    l = 0;
                                    break;
                                case 1:
                                case 3:
                                    l = 40;
                                    break;
                                case 2:
                                    l = ""
                            }
                            switch (r) {
                                case 0:
                                    c = 0;
                                    break;
                                case 1:
                                case 3:
                                    c = 20;
                                    break;
                                case 2:
                                    c = ""
                            }
                    }
                    if (d = this.Eo.find(".value1"), p = this.Eo.find(".value2"), u = this.Eo.find(".value3"), h = this.Eo.find(".value4"), void 0 !== t) switch (t) {
                        case 1:
                            d.val(a);
                            break;
                        case 2:
                            p.val(s);
                            break;
                        case 3:
                            u.val(l);
                            break;
                        case 4:
                            h.val(c)
                    } else d.val(a), p.val(s), u.val(l), h.val(c);
                    this.ht(d.val(), p.val(), u.val(), h.val())
                }, a.prototype.ht = function(e, t, i, o) {
                    var r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E = this.Eo.find(".iconSet-dataRow4"),
                        I = this.Eo.find(".iconSet-dataRow5");
                    r = !E.hasClass("hidden"), a = !I.hasClass("hidden"), s = this.Eo.find(".des2_iconSet"), l = this.Eo.find(".des3_iconSet"), c = this.Eo.find(".des4_iconSet"), d = this.Eo.find(".des5_iconSet"), p = "", u = this.Eo.find(".operator1").prop("selectedIndex"), 1 === u && (p = " = "), h = "", f = this.Eo.find(".operator2").prop("selectedIndex"), 1 === f && (h = " = "), g = "", m = this.Eo.find(".operator3").prop("selectedIndex"), 1 === m && (g = " = "), b = "", v = this.Eo.find(".operator4").prop("selectedIndex"), 1 === v && (b = " = "), y = this.Eo.find(".value1Selector").prop("selectedIndex"), w = this.Eo.find(".value2Selector").prop("selectedIndex"), x = this.Eo.find(".value3Selector").prop("selectedIndex"), C = this.Eo.find(".value4Selector").prop("selectedIndex"), S = 2 === y || e && 0 === e.indexOf("=") ? "Formula" : e, k = 2 === w || t && 0 === t.indexOf("=") ? "Formula" : t, T = 2 === x || i && 0 === i.indexOf("=") ? "Formula" : i, A = 2 === C || o && 0 === o.indexOf("=") ? "Formula" : o, S && s.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + p + S + " " + n.res.conditionalFormatting.common.and), k && (r ? l.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + h + k + " " + n.res.conditionalFormatting.common.and) : l.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + h + k)), a ? (T && c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + g + T + " " + n.res.conditionalFormatting.common.and), A && d.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + b + A)) : T && c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + g + T)
                }, a.prototype.kt = function(e, t) {
                    var i, o = this.Eo.find(".icon1"),
                        r = this.Eo.find(".icon2"),
                        a = this.Eo.find(".icon3"),
                        s = this.Eo.find(".icon4"),
                        l = this.Eo.find(".icon5"),
                        c = this.Eo.find(".iconStyleIcon"),
                        d = [o, r, a, s, l];
                    if (e) {
                        for (c.removeClass(), c.addClass("iconStyleIcon").addClass("horizontal-icon-set-item"), i = 0; i < e.length; i++) $(c[i]).addClass(e[i]).addClass("iconSetsIcons");
                        this.Ut = e
                    }
                    if (t) {
                        for (i = 0; i < this.it.length; i++) d[i].removeClass(this.it[i]);
                        for (i = 0; i < t.length; i++) d[i].addClass(t[i]), i >= 3 && d[i].addClass("iconSetsIcons"), "no-cell-icon" === t[i] ? $(d[i]).next("span").text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.noCellIcon) : $(d[i]).next("span").text("");
                        for (this.it = t, i = t.length; i < 5; i++) switch (i) {
                            case 3:
                                s.removeClass("iconSetsIcons");
                                break;
                            case 4:
                                l.removeClass("iconSetsIcons")
                        }
                    }
                }, a.prototype.St = function(e, t, i) {
                    var o = this.Eo.find(".previewOfColor23");
                    j.Fs(o, e, t, i)
                }, a.prototype.et = function(e) {
                    var t, i, o, n;
                    switch (this.Rt = e, t = this.Eo.find(".color23"), i = this.Eo.find(".color3"), o = this.Eo.find(".dataBar"), n = this.Eo.find(".iconSets"), e) {
                        case 0:
                            t.removeClass("hidden"), o.addClass("hidden"), n.addClass("hidden"), i.addClass("hidden"), this.St("red", "green");
                            break;
                        case 1:
                            t.removeClass("hidden"), o.addClass("hidden"), n.addClass("hidden"), i.removeClass("hidden"), this.St("red", "yellow", "green");
                            break;
                        case 2:
                            t.addClass("hidden"), o.removeClass("hidden"), n.addClass("hidden");
                            break;
                        case 3:
                            t.addClass("hidden"), o.addClass("hidden"), n.removeClass("hidden")
                    }
                }, a.prototype.ot = function(e) {
                    var t = this.Eo.find(".iconSet-dataRow4"),
                        i = this.Eo.find(".iconSet-dataRow5"),
                        o = this.Eo.find(".row3-mayHiddenParts"),
                        n = this.Eo.find(".row4-mayHiddenParts");
                    e <= 3 ? (t.addClass("hidden"), i.addClass("hidden"), o.addClass("hidden"), n.addClass("hidden")) : e <= 4 ? (t.removeClass("hidden"), i.addClass("hidden"), o.removeClass("hidden"), n.addClass("hidden")) : (t.removeClass("hidden"), i.removeClass("hidden"), o.removeClass("hidden"), n.removeClass("hidden"))
                }, a.prototype.Lt = function(e) {
                    var t, i, o, n = this.Eo.find(".formatContain-type");
                    n.prop("selectedIndex", 0), n.trigger("change"), t = this.Eo.find(".operator"), e ? t.prop("selectedIndex", e) : t.prop("selectedIndex", 0), t.trigger("change"), i = this.Eo.find(".textBox-cell1"), i.val(""), o = this.Eo.find(".textBox-cell2"), o.val("")
                }, a.prototype.qt = function(e) {
                    var t = this.Eo.find(".operator"),
                        i = t[0].options;
                    switch (t.empty(), e) {
                        case 0:
                            i[0] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.between), i[1] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.notBetween), i[2] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.equalTo), i[3] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.notEqualTo), i[4] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.greaterThan), i[5] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.lessThan), i[6] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.greaterThanOrEqu), i[7] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.lessThanOrEqu);
                            break;
                        case 1:
                            i[0] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.containing), i[1] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.notContaining), i[2] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.beginningWith), i[3] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.endingWith);
                            break;
                        case 2:
                            i[0] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.yesterday), i[1] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.today), i[2] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.tomorrow), i[3] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.last7days), i[4] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.lastweek), i[5] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.thisweek), i[6] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.nextweek), i[7] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.lastmonth), i[8] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.thismonth), i[9] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.nextmonth)
                    }
                }, a.prototype.rt = function(e) {
                    var t = this.Eo.find(".operator"),
                        i = this.Eo.find(".textBox-cell1-container"),
                        o = this.Eo.find(".label-and"),
                        n = this.Eo.find(".textBox-cell2-container");
                    switch (e) {
                        case 0:
                        case 1:
                            t.removeClass("hidden"), i.show(), o.addClass("hidden"), n.hide();
                            break;
                        case 2:
                            t.removeClass("hidden"), i.hide(), o.addClass("hidden"), n.hide();
                            break;
                        case 3:
                        case 4:
                        case 5:
                        case 6:
                            t.addClass("hidden"), i.hide(), o.addClass("hidden"), n.hide()
                    }
                }, a.prototype.st = function(e) {
                    var t = this.Eo.find(".textBox-cell1-container"),
                        i = this.Eo.find(".label-and"),
                        o = this.Eo.find(".textBox-cell2-container");
                    switch (e) {
                        case 0:
                        case 1:
                            t.show(), i.removeClass("hidden"), o.show();
                            break;
                        default:
                            t.show(), i.addClass("hidden"), o.hide()
                    }
                }, a.prototype.Nt = function() {
                    var e, t = this.Eo.find(".formatRankedValue-type");
                    t.prop("selectedIndex", 0), e = this.Eo.find(".itemCounts"), e.spinner({ min: 1, max: 1e3 }), e.val(10)
                }, a.prototype.Tt = function(e, t, i) {
                    var o = this.Eo.find(".previewOfDatabar");
                    t ? j.Fs(o, e, t) : o.css("background", e), i ? o.css("border", "1px solid " + i) : o.css("border-width", "0px")
                }, a.prototype.Ot = function() {
                    var e = this.Eo.find(".formatAbove-type");
                    e.prop("selectedIndex", 0)
                }, a.prototype.Pt = function() {
                    var e = this.Eo.find(".formatUnique-type");
                    e.prop("selectedIndex", 0)
                }, a.prototype.Qt = function() {
                    var e = this.Eo.find(".formula-input");
                    e.val("")
                }, a.prototype.Mt = function() {
                    var e = this,
                        t = this.Eo.find(".format-button");
                    t.button(), void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog, $(this.formatCellDialog).on("okClicked", function(t, i) {
                        var o, r, a, s, l, c;
                        e.Os = i, "" !== i.font && void 0 !== i.font && (o = n.wrapper.spread.getActiveSheet(), r = o.getActiveColumnIndex(), a = o.getActiveRowIndex(), s = o.getActualStyle(a, r, 3), l = $("<span></span>"), void 0 !== s.font ? ("" !== e.Os.font && (l.css("font", e.Os.font), c = l.css("font-style")), l.css("font", s.font), c && l.css("font-style", c)) : "" !== i.font && l.css("font", i.font + n.res.defaultFont), e.Os.font = l.css("font")), e.Gs()
                    })), this.Os = i, this.Gs()
                }, a.prototype.Gs = function() {
                    var e = this.Eo.find(".preview-common");
                    j.Gs(e, this.Os)
                }, a.prototype.zt = function(e) {
                    var t, i, r, a, s, l, c, d, p, u, h, f, g, m = n.wrapper.spread.getActiveSheet(),
                        b = m.getSelections(),
                        v = this.Eo.find(".minSelector"),
                        y = parseInt(v.prop("selectedIndex"));
                    switch (y) {
                        case 0:
                            t = 1;
                            break;
                        case 1:
                            t = 0;
                            break;
                        case 2:
                            t = 3;
                            break;
                        case 3:
                            t = 6;
                            break;
                        case 4:
                            t = 4
                    }
                    switch (r = this.Eo.find(".maxSelector"), y = parseInt(r.prop("selectedIndex"))) {
                        case 0:
                            i = 2;
                            break;
                        case 1:
                            i = 0;
                            break;
                        case 2:
                            i = 3;
                            break;
                        case 3:
                            i = 6;
                            break;
                        case 4:
                            i = 4
                    }
                    if (a = 1 === t ? null : this.Eo.find(".minValue").val(), s = 2 === i ? null : this.Eo.find(".maxValue").val(), l = this.Eo.find(".min-color-span").css("background-color"), c = this.Eo.find(".max-color-span").css("background-color"), e) {
                        switch (p = this.Eo.find(".midSelector"), y = parseInt(p.prop("selectedIndex"))) {
                            case 0:
                                d = 0;
                                break;
                            case 1:
                                d = 3;
                                break;
                            case 2:
                                d = 6;
                                break;
                            case 3:
                                d = 4
                        }
                        u = this.Eo.find(".midValue").val(), h = this.Eo.find(".mid-color-span").css("background-color"), f = new o.ConditionalFormatting.ScaleRule(11, t, a, l, d, u, h, i, s, c, b), this.Xs ? this.Zs = f : n.actions.doAction("addRule", n.wrapper.spread, f)
                    } else g = new o.ConditionalFormatting.ScaleRule(10, t, a, l, null, null, null, i, s, c, b), this.Xs ? this.Zs = g : n.actions.doAction("addRule", n.wrapper.spread, g)
                }, a.prototype.At = function() {
                    var e, t, i, o, r, a, s, l, c, d, p, u, h, f, g, m;
                    switch (n.wrapper.spread.suspendPaint(), e = n.wrapper.spread.getActiveSheet(), t = e.getSelections(), o = this.Eo.find(".minSelector2"), r = parseInt(o.prop("selectedIndex"))) {
                        case 0:
                            i = 1;
                            break;
                        case 1:
                            i = 0;
                            break;
                        case 2:
                            i = 3;
                            break;
                        case 3:
                            i = 6;
                            break;
                        case 4:
                            i = 4;
                            break;
                        case 5:
                            i = 5
                    }
                    switch (s = this.Eo.find(".maxSelector2"), r = parseInt(s.prop("selectedIndex"))) {
                        case 0:
                            a = 2;
                            break;
                        case 1:
                            a = 0;
                            break;
                        case 2:
                            a = 3;
                            break;
                        case 3:
                            a = 6;
                            break;
                        case 4:
                            a = 4;
                            break;
                        case 5:
                            a = 7
                    }
                    l = this.Eo.find(".minValue2").val(), c = this.Eo.find(".maxValue2").val(), d = this.Eo.find(".barcolor1-span").css("background-color"), p = this.Eo.find(".barcolor2-span").css("background-color"), u = this.Eo.find(".showBarOnly").prop("checked"), h = 0 !== this.Eo.find(".fillSelector").prop("selectedIndex"), f = 0 !== this.Eo.find(".borderSelector").prop("selectedIndex"), g = 0 === this.Eo.find(".barDirectionSelector").prop("selectedIndex") ? 0 : 1, m = new GC.Spread.Sheets.ConditionalFormatting.DataBarRule(i, j.parseValue(l), a, j.parseValue(c), d, t), m.showBarOnly(u), m.gradient(h), m.borderColor(p), m.showBorder(f), m.dataBarDirection(g), this.dt && (m.negativeBorderColor(this.dt.negativeBorderColor), m.negativeFillColor(this.dt.negativeFillColor), m.useNegativeBorderColor(this.dt.useNegativeBorderColor), m.useNegativeFillColor(this.dt.useNegativeFillColor), m.axisColor(this.dt.axisColor), m.axisPosition(this.dt.axisPosition)), this.Xs ? this.Zs = m : n.actions.doAction("addRule", n.wrapper.spread, m), n.wrapper.spread.resumePaint()
                }, a.prototype.Bt = function() {
                    var e, t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I;
                    if (n.wrapper.spread.suspendPaint(), e = n.wrapper.spread.getActiveSheet(), t = e.getSelections(), r = te(this.lt), a = this.Eo.find(".showIconOnly").prop("checked"), s = this.Eo.find(".reverseIconOrder").prop("checked"), l = 0 === this.Eo.find(".operator1").prop("selectedIndex"), c = 0 === this.Eo.find(".operator2").prop("selectedIndex"), d = 0 === this.Eo.find(".operator3").prop("selectedIndex"), p = 0 === this.Eo.find(".operator4").prop("selectedIndex"), u = parseInt(this.Eo.find(".value1Selector").prop("selectedIndex")), h = this.yt(u), f = parseInt(this.Eo.find(".value2Selector").prop("selectedIndex")), g = this.yt(f), m = parseInt(this.Eo.find(".value3Selector").prop("selectedIndex")), b = this.yt(m), v = parseInt(this.Eo.find(".value4Selector").prop("selectedIndex")), y = this.yt(v), w = oe(this.Eo.find(".value1").val()), x = oe(this.Eo.find(".value2").val()), C = oe(this.Eo.find(".value3").val()), S = oe(this.Eo.find(".value4").val()), k = this.Eo.find(".iconSet-dataRow4"), T = this.Eo.find(".iconSet-dataRow5"), i = new o.ConditionalFormatting.IconSetRule(r, t), i.showIconOnly(a), i.reverseIconOrder(s), A = i.iconCriteria(), T.hasClass("hidden") || k.hasClass("hidden") ? k.hasClass("hidden") ? (A[0] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c, g, j.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(c, g, x), A[1] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l, h, j.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(l, h, w)) : (A[0] = 7 !== b ? new o.ConditionalFormatting.IconCriterion(d, b, j.parseValue(C)) : new o.ConditionalFormatting.IconCriterion(d, b, C), A[1] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c, g, j.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(c, g, x), A[2] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l, h, j.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(l, h, w)) : (A[0] = 7 !== y ? new o.ConditionalFormatting.IconCriterion(p, y, j.parseValue(S)) : new o.ConditionalFormatting.IconCriterion(p, y, S), A[1] = 7 !== b ? new o.ConditionalFormatting.IconCriterion(d, b, j.parseValue(C)) : new o.ConditionalFormatting.IconCriterion(d, b, C), A[2] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c, g, j.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(c, g, x), A[3] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l, h, j.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(l, h, w)), this.nt && this.jt && this.jt.length > 0)
                        for (i.nt = !0, E = i.icons(), s || this.jt.reverse(), I = 0; I < this.jt.length; I++) E[I] = { iconSetType: this.jt[I].iconSetType, iconIndex: this.jt[I].iconIndex };
                    this.Xs ? this.Zs = i : n.actions.doAction("addRule", n.wrapper.spread, i), n.wrapper.spread.resumePaint()
                }, a.prototype.Ct = function() {
                    var e, t, i, o, r = n.wrapper.spread.getActiveSheet(),
                        a = r.getSelections(),
                        s = this.Eo.find(".operator"),
                        l = parseInt(s.prop("selectedIndex"));
                    switch (l) {
                        case 0:
                            t = 6;
                            break;
                        case 1:
                            t = 7;
                            break;
                        case 2:
                            t = 0;
                            break;
                        case 3:
                            t = 1;
                            break;
                        case 4:
                            t = 2;
                            break;
                        case 5:
                            t = 4;
                            break;
                        case 6:
                            t = 3;
                            break;
                        case 7:
                            t = 5
                    }
                    i = this.Vo(this.Eo, 1), o = this.Vo(this.Eo, 2), e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(1, a, this.Os, t, i, o), this.Xs ? this.Zs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                }, a.prototype.Dt = function() {
                    var e, t, i, o = n.wrapper.spread.getActiveSheet(),
                        r = o.getSelections(),
                        a = this.Eo.find(".operator"),
                        s = parseInt(a.prop("selectedIndex"));
                    switch (s) {
                        case 0:
                            t = 0;
                            break;
                        case 1:
                            t = 1;
                            break;
                        case 2:
                            t = 2;
                            break;
                        case 3:
                            t = 3
                    }
                    i = this.Vo(this.Eo, 1), e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(2, r, this.Os, t, null, null, i), this.Xs ? this.Zs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                }, a.prototype.Et = function() {
                    var e, t, i = n.wrapper.spread.getActiveSheet(),
                        o = i.getSelections(),
                        r = parseInt(this.Eo.find(".operator").prop("selectedIndex"));
                    switch (r) {
                        case 0:
                            e = 1;
                            break;
                        case 1:
                            e = 0;
                            break;
                        case 2:
                            e = 2;
                            break;
                        case 3:
                            e = 3;
                            break;
                        case 4:
                            e = 8;
                            break;
                        case 5:
                            e = 7;
                            break;
                        case 6:
                            e = 9;
                            break;
                        case 7:
                            e = 5;
                            break;
                        case 8:
                            e = 4;
                            break;
                        case 9:
                            e = 6
                    }
                    t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(4, o, this.Os, null, null, null, null, null, e), this.Xs ? this.Zs = t : n.actions.doAction("addRule", n.wrapper.spread, t)
                }, a.prototype.Ft = function(e) {
                    var i, r, a, s, l = n.wrapper.spread.getActiveSheet(),
                        c = l.getSelections();
                    switch (c.length > 1 && t.show(n.res.conditionalFormatting.exceptions.e6, n.res.title, 2), i = c[0], r = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute), e) {
                        case 3:
                            a = "ISBLANK(" + r + ")";
                            break;
                        case 4:
                            a = "NOT(ISBLANK(" + r + "))";
                            break;
                        case 5:
                            a = "ISERROR(" + r + ")";
                            break;
                        case 6:
                            a = "NOT(ISERROR(" + r + "))"
                    }
                    s = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(3, c, this.Os, null, null, null, null, "=" + a), this.Xs ? this.Zs = s : n.actions.doAction("addRule", n.wrapper.spread, s)
                }, a.prototype.Gt = function() {
                    var e = n.wrapper.spread.getActiveSheet(),
                        t = e.getSelections(),
                        i = 0 === this.Eo.find(".formatRankedValue-type").prop("selectedIndex") ? 0 : 1,
                        o = this.Eo.find(".itemCounts").val(),
                        r = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(5, t, this.Os, null, null, null, null, null, i, o);
                    this.Xs ? this.Zs = r : n.actions.doAction("addRule", n.wrapper.spread, r)
                }, a.prototype.Ht = function() {
                    var e, t, i = n.wrapper.spread.getActiveSheet(),
                        o = i.getSelections(),
                        r = parseInt(this.Eo.find(".formatAbove-type").prop("selectedIndex"));
                    switch (r) {
                        case 0:
                            t = 0;
                            break;
                        case 1:
                            t = 1;
                            break;
                        case 2:
                            t = 2;
                            break;
                        case 3:
                            t = 3;
                            break;
                        case 4:
                            t = 4;
                            break;
                        case 5:
                            t = 5;
                            break;
                        case 6:
                            t = 6;
                            break;
                        case 7:
                            t = 7;
                            break;
                        case 8:
                            t = 8;
                            break;
                        case 9:
                            t = 9
                    }
                    e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(8, o, this.Os, null, null, null, null, null, t), this.Xs ? this.Zs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                }, a.prototype.It = function() {
                    var e, t = n.wrapper.spread.getActiveSheet(),
                        i = t.getSelections(),
                        o = parseInt(this.Eo.find(".formatUnique-type").prop("selectedIndex"));
                    switch (o) {
                        case 0:
                            e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(7, i, this.Os);
                            break;
                        case 1:
                            e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(6, i, this.Os)
                    }
                    this.Xs ? this.Zs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                }, a.prototype.Jt = function() {
                    var e, t = n.wrapper.spread.getActiveSheet(),
                        i = t.getSelections(),
                        o = this.Eo.find(".formula-input").val();
                    o = this.Uo(o), e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(3, i, this.Os, null, null, null, null, o), this.Xs ? this.Zs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                }, a.prototype.Vt = function(e) { var t = n.wrapper.spread.getActiveSheet(); return GC.Spread.Sheets.CalcEngine.evaluateFormula(t, e, t.getActiveRowIndex(), t.getActiveColumnIndex(), !1) }, a
            }(n.BaseDialog), n.NewFormattingRuleDialog = J, Y = function(e) {
                n.extends(t, e);

                function t() { e.call(this, r, ".format-rules-manager-dialog") }
                return t.prototype.Do = function() { var e = this; return { title: n.res.formattingRulesManagerDialog.title, width: "auto", resizable: !1, modal: !0, buttons: [{ text: n.res.ok, click: function() { n.actions.isFileModified = !0, e.Wt(), n.wrapper.spread.suspendPaint(), e.close() } }, { text: n.res.close, click: function() { e.close() } }, { text: n.res.apply, click: function() { e.Wt(), n.wrapper.spread.suspendPaint() } }] } }, t.prototype.Wt = function() { var e, t, i; if (void 0 !== this.Xt) { e = n.wrapper.spread.getActiveSheet(), t = e.conditionalFormats; try { i = { formats: t, tempFormats: $.extend(!0, {}, this.Xt) }, n.actions.doAction("baseDialogCommand", n.wrapper.spread, { value: i, execute: n.spreadActions.dialogAction.managerRulesApplySetting }) } catch (e) { throw n.wrapper.spread.resumePaint(), e } n.wrapper.spread.resumePaint() } }, t.prototype.Jo = function() {
                    var e, t = n.wrapper.spread.getActiveSheet().conditionalFormats,
                        i = t.getRules().concat();
                    for (t.clearRule(), e = 0; e < i.length; e++) t.addRule(i[e]);
                    n.wrapper.spread.resumePaint()
                }, t.prototype.Yt = function() {
                    var e = this;
                    $("#new-rule").on("click", function() { e.Zt(), e.close() }), $("#edit-rule").on("click", function() { 0 !== $(".format-rules-grid-body .ui-state-default").length && (e.$t(), e.close()) }), $("#delete-rule").on("click", function() { return e._t() }), $("#format-rule-move-up").on("click", function() { return e.au(!0) }), $("#format-rule-move-down").on("click", function() { return e.au(!1) })
                }, t.prototype.Zt = function() {
                    var e = this;
                    e.bu || (e.bu = new J, $(e.bu).on("dialogClose", function(t, i) { i.isCloseByOK && e.Xt.addRule(i.rule), e.bu = null, e.open(!0) })), e.bu.open(0, !0, 0, !0)
                }, t.prototype.$t = function() {
                    var e, t, i, n, r, a;
                    void 0 !== this.Xt && 0 !== this.Xt.count() && (e = $(".format-rules-grid-body .ui-state-default").index(), t = this.Xt.count() - 1 - e, i = this.Xt.getRule(t), i.ruleType() === o.ConditionalFormatting.RuleType.cellValueRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.specificTextRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.duplicateRule ? n = 4 : i.ruleType() === o.ConditionalFormatting.RuleType.uniqueRule ? n = 4 : i.ruleType() === o.ConditionalFormatting.RuleType.top10Rule ? n = 2 : i.ruleType() === o.ConditionalFormatting.RuleType.averageRule ? n = 3 : i.ruleType() === o.ConditionalFormatting.RuleType.dataBarRule ? (n = 0, r = 2) : i.ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule ? (n = 0, r = 0) : i.ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule ? (n = 0, r = 1) : i.ruleType() === o.ConditionalFormatting.RuleType.iconSetRule ? (n = 0, r = 3) : i.ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (n = j.Is(i).ruleType), a = this, a.cu || (a.cu = new J, $(a.cu).on("dialogClose", function(e, t) {
                        if (t.isCloseByOK) {
                            var o = a.Xt.getRules().indexOf(i);
                            a.Xt.getRules()[o] = t.rule
                        }
                        a.cu = null, a.open(!0)
                    })), a.cu.open(n, !1, r, !0, i))
                }, t.prototype._t = function() {
                    var e, t;
                    void 0 !== this.Xt && 0 !== this.Xt.count() && -1 !== (e = $(".format-rules-grid-body .ui-state-default").index()) && (t = this.Xt.count() - 1 - e, this.Xt.removeRule(this.Xt.getRule(t)), this.du())
                }, t.prototype.au = function(e) {
                    var t, i, o, n = $(".format-rules-grid-body .ui-state-default").index();
                    if (!(0 === n && e || n === this.Xt.count() - 1 && !e)) {
                        if (t = $.extend(!0, {}, this.Xt), this.Xt.clearRule(), i = t.count() - 1 - n, e)
                            for (o = 0; o < t.count(); o++) o === i ? this.Xt.addRule(t.getRule(i + 1)) : o === i + 1 ? this.Xt.addRule(t.getRule(i)) : this.Xt.addRule(t.getRule(o));
                        else
                            for (o = 0; o < t.count(); o++) o === i ? this.Xt.addRule(t.getRule(i - 1)) : o === i - 1 ? this.Xt.addRule(t.getRule(i)) : this.Xt.addRule(t.getRule(o));
                        this.du(), e ? $(".format-rules-grid-body tr:eq(" + (n - 1) + ")").addClass("ui-state-default") : $(".format-rules-grid-body tr:eq(" + (n + 1) + ")").addClass("ui-state-default")
                    }
                }, t.prototype._init = function() { this.Yt() }, t.prototype.Io = function(e) {
                    var t, i, o, r, a, s = e[0];
                    if (n.wrapper.spread.suspendPaint(), t = n.wrapper.spread.getActiveSheet(), i = t.conditionalFormats, !s)
                        for (this.Xt = new GC.Spread.Sheets.ConditionalFormatting.ConditionalFormats(t), this.Xt.fromJSON(i.toJSON()), o = i.getRules(), r = this.Xt.getRules(), a = 0; a < o.length; a++) r[a].nt = o[a].nt;
                    this.du()
                }, t.prototype.eu = function(e) {
                    var t = n.wrapper.spread.getActiveSheet(),
                        i = GC.Spread.Sheets.CalcEngine.formulaToExpression(t, e, 0, 0);
                    return i.type === GC.Spread.CalcEngine.ExpressionType.reference ? i.getRange(0, 0) : null
                }, t.prototype.fu = function(e, t) {
                    var i, n, r = this;
                    e.on("click", function(t) { $(".format-rules-grid-body tr").removeClass("ui-state-default"), e.addClass("ui-state-default") }), e.on("dblclick", function(e) { r.$t(), r.close() }), i = function(e) {
                        var i, n, a = e.currentTarget,
                            s = a.value,
                            l = s.slice(1).split(",");
                        for (i = 0; i < t.ranges().length; i++) t.ranges().pop();
                        for (i = 0; i < l.length; i++) n = r.eu(l[i]), t.ranges().unshift(new o.Range(n.row, n.col, n.rowCount, n.colCount))
                    }, n = function(e) {
                        var i = e.currentTarget;
                        t.stopIfTrue(i.checked)
                    }, e.find("input[type!=checkbox]").on("change", function(e) { return i(e) }), e.find("input[type=checkbox]").on("change", function(e) { return n(e) })
                }, t.prototype.du = function() {
                    var e, t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k;
                    for ($(".format-rules-grid-body").empty(), e = n.wrapper.spread.getActiveSheet(), t = e.getActiveRowIndex(), i = e.getActiveColumnIndex(), r = this.Xt.getRules(), s = r.length - 1; s >= 0; s--) {
                        if (l = $("<tr>"), c = $("<td>"), d = $("<td>"), p = $("<div>"), u = $("<td>"), h = $("<input>"), f = $("<td>"), g = $("<input>"), g.prop("type", "checkbox"), m = n.res.formattingRulesManagerDialog.ruleDescriptions, r[s].ruleType() === o.ConditionalFormatting.RuleType.cellValueRule) {
                            switch (b = r[s].value1(t, i), v = r[s].value2(t, i), r[s].operator()) {
                                case 6:
                                    a = n.util.format(m.valueBetween, b, v);
                                    break;
                                case 0:
                                    a = n.util.format(m.valueEquals, b);
                                    break;
                                case 2:
                                    a = n.util.format(m.valueGreateThan, b);
                                    break;
                                case 3:
                                    a = n.util.format(m.valueGreateThanOrEquals, b);
                                    break;
                                case 4:
                                    a = n.util.format(m.valueLessThan, b);
                                    break;
                                case 5:
                                    a = n.util.format(m.valueLessThanOrEquals, b);
                                    break;
                                case 7:
                                    a = n.util.format(m.valueNotBetween, b, v);
                                    break;
                                case 1:
                                    a = n.util.format(m.valueNotEquals, b)
                            }
                            c.text(a), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style())
                        } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.specificTextRule) {
                            switch (r[s].operator()) {
                                case 2:
                                    a = n.util.format(m.valueBeginsWith, r[s].text());
                                    break;
                                case 0:
                                    a = n.util.format(m.valueContains, r[s].text());
                                    break;
                                case 1:
                                    a = n.util.format(m.valueNotContains, r[s].text());
                                    break;
                                case 3:
                                    a = n.util.format(m.valueEndsWith, r[s].text())
                            }
                            c.text(a), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style())
                        } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule) {
                            switch (r[s].type()) {
                                case 3:
                                    a = m.last7Days;
                                    break;
                                case 5:
                                    a = m.lastMonth;
                                    break;
                                case 8:
                                    a = m.lastWeek;
                                    break;
                                case 6:
                                    a = m.nextMonth;
                                    break;
                                case 9:
                                    a = m.nextWeek;
                                    break;
                                case 4:
                                    a = m.thisMonth;
                                    break;
                                case 7:
                                    a = m.thisWeek;
                                    break;
                                case 0:
                                    a = m.today;
                                    break;
                                case 2:
                                    a = m.tomorrow;
                                    break;
                                case 1:
                                    a = m.yesterday
                            }
                            c.text(a), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style())
                        } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.duplicateRule) c.text(m.duplicateValues), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style());
                        else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.uniqueRule) c.text(m.uniqueValues), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style());
                        else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.top10Rule) {
                            switch (r[s].type()) {
                                case 0:
                                    a = n.util.format(m.top, r[s].rank());
                                    break;
                                case 1:
                                    a = n.util.format(m.bottom, r[s].rank())
                            }
                            c.text(a), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style())
                        } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.averageRule) {
                            switch (r[s].type()) {
                                case 0:
                                    a = m.above;
                                    break;
                                case 4:
                                    a = m.above1StdDev;
                                    break;
                                case 6:
                                    a = m.above2StdDev;
                                    break;
                                case 8:
                                    a = m.above3StdDev;
                                    break;
                                case 1:
                                    a = m.below;
                                    break;
                                case 5:
                                    a = m.below1StdDev;
                                    break;
                                case 7:
                                    a = m.below2StdDev;
                                    break;
                                case 9:
                                    a = m.below3StdDev;
                                    break;
                                case 2:
                                    a = m.equalOrAbove;
                                    break;
                                case 3:
                                    a = m.equalOrBelow
                            }
                            c.text(a), p.text(n.res.formattingRulesManagerDialog.previewText), j.Gs(p, r[s].style())
                        } else r[s].ruleType() === o.ConditionalFormatting.RuleType.dataBarRule ? (c.text(m.dataBar), r[s].showBorder() && p.css("border", "1px solid " + r[s].borderColor()), r[s].gradient() ? j.Fs(p, r[s].color(), "white") : p.css("background-color", r[s].color()), g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule ? (c.text(m.twoScale), j.Fs(p, r[s].minColor(), r[s].maxColor()), g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule ? (c.text(m.threeScale), j.Fs(p, r[s].minColor(), r[s].midColor(), r[s].maxColor()), g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.iconSetRule ? (c.text(m.iconSet), r[s].icons() ? (y = r[s].icons().concat(), r[s].reverseIconOrder() && y.reverse(), j.Ls(p, y, { margin: "2px 0 0 2px" })) : j.Js(p, r[s].iconSetType(), { margin: "2px 0 0 2px" }, r[s].reverseIconOrder()), g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (c.text(n.util.format(m.formula, r[s].formula())), j.Gs(p, r[s].style()));
                        for (w = "", x = r[s].ranges(), C = 0; C < x.length; C++) S = x[C], k = o.CalcEngine.rangeToFormula(S, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute), w += k + ",";
                        h.val("=" + k), u.append(h), g.prop("checked", r[s].stopIfTrue()), f.append(g), p.css({ width: "100%", height: "20px" }).appendTo(d), c.addClass("rule-column"), d.addClass("format-column"), u.addClass("applies-to-column"), f.addClass("stop-if-true-column"), l.append([c, d, u, f]), l.appendTo($(".format-rules-grid-body")), this.fu(l, r[s])
                    }
                }, t
            }(n.BaseDialog), n.FormatRulesManagerDialog = Y, Q = function(e) {
                n.extends(t, e);

                function t() { e.call(this, r, ".password-dialog") }
                return t.prototype.Do = function() {
                    var e = this;
                    return {
                        resizable: !1,
                        modal: !0,
                        title: n.res.passwordDialog.title,
                        buttons: [{
                            text: n.res.ok,
                            click: function() {
                                var t = e.Eo.find("[name=password]").val();
                                void 0 === e.Ho[2] && (e.Ho[2] = {}), e.Ho[2].password = t, n.actions.openOtherFormat.apply(e, e.Ho), e.close()
                            }
                        }, { text: n.res.cancel, click: function() { e.close(), n.wrapper.setFocusToSpread() } }],
                        width: 350
                    }
                }, t.prototype.Io = function() { this.Eo.find("[name=password]").val(""), this.Eo.find("#passwordMessage").text(this.Ho[4]) }, t
            }(n.BaseDialog), n.PasswordDialog = Q, n.Helper = e, Z = function(e) {
                n.extends(t, e);

                function t(t, i) { e.call(this, r, ".range-select-dialog"), this.pq = t, this.gu = i }
                return t.prototype.Do = function() { return { resizable: !1, modal: !1, width: 460, height: 80 } }, t.prototype._init = function() {
                    var e = this.gu || {};
                    e.rangeSelectMode = !0, this.Lp = new GC.Spread.Sheets.FormulaTextBox.FormulaTextBox(this.Eo.find("#rangeSelect")[0], e)
                }, t.prototype.Io = function(e) {
                    var t = n.wrapper.spread;
                    this.mr = t.getActiveSheetIndex(), this.Eo.dialog("option", "title", e[0]), this.Lp.workbook(n.wrapper.spread), this.qq = e[1], this.Lp.startSelectMode(e[2]), t.bind("RangeSelectEnding", this, this.hu), $(document).bind("keydown", this, this.iu)
                }, t.prototype.hu = function(e) {
                    var t = e.data;
                    t.close()
                }, t.prototype.iu = function(e) { var t = e.data; "Enter" === e.key && t.close() }, t.prototype.Jo = function() {
                    var e, t, i = n.wrapper.spread;
                    i.unbind("RangeSelectEnding", this.hu), $(document).unbind("keydown", this.iu), i.setActiveSheetIndex(this.mr), this.pq && this.pq.show(), this.qq && (e = this.Ho[3] || [], t = this.ju(this.Lp.text()), e.push(t), this.qq.apply(this.pq, e)), this.Lp.endSelectMode(), this.Lp.workbook(null)
                }, t.prototype.ju = function(e) { var t, i; return e.length > 1 && "=" === (t = e.slice(0, 1)) && (i = e.slice(1, e.length), isFinite(i)) ? i : e }, t
            }(n.BaseDialog), n.RangeSelectDialog = Z, ee = function(e) {
                n.extends(t, e);

                function t() { e.call(this, r, ".save-as-dialog") }
                return t.prototype.Do = function() {
                    var e = this,
                        t = {
                            title: n.res.saveAsDialog.title,
                            resizable: !1,
                            width: 280,
                            modal: !0,
                            close: function() {
                                var t = e.fi;
                                t && t({ fileName: e.$saveFileName.val().trim(), cancelled: e.ku })
                            },
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.$saveFileName.val().trim();
                                    t ? (e.ku = !1, e.close()) : e.$saveFileName.focus()
                                }
                            }, { text: n.res.cancel, click: function() { e.ku = !0, e.close() } }]
                        };
                    return t
                }, t.prototype.Io = function(e) {
                    if (this.$saveFileName || (this.$saveFileName = $("#saveAsFileName")), this.$saveFileName.val(""), e && e[0]) {
                        var t = e[0];
                        $("#saveAsFileExtension").text(t.fileExtension), this.fi = t.done
                    }
                }, t
            }(n.BaseDialog), n.SaveAsDialog = ee
        }()
    }, function(e, t) {
        var i = void 0,
            o = GC.Spread,
            n = o.Sheets,
            r = n.Designer;
        ! function() {
            "use strict";
            var e, t, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R, B, O, P, N, z, M, V, G, j, H, W = r.util.resolveHtmlPath("../dialogs", "dialogs2.html"),
                U = o.Sheets.CalcEngine.formulaToRanges,
                q = function() {
                    function e() {}
                    return e.parseColorExpression = function(e, t, i) {
                        var a, s;
                        if (!e) return null;
                        if (a = r.wrapper.spread.getActiveSheet(), e.type === o.CalcEngine.ExpressionType.string) return e.value;
                        if (e.type === o.CalcEngine.ExpressionType.missingArgument) return null;
                        s = null;
                        try { s = r.util.unParseFormula(e, t, i) } catch (e) {}
                        return n.CalcEngine.evaluateFormula(a, s, t, i)
                    }, e
                }(),
                _ = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".fill-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", title: r.res.seriesDialog.series, modal: !0, buttons: [{ text: r.res.ok, click: function() { e.fill(), e.close(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        this.lu = this.Eo.find("#series-columns"), this.mu = this.Eo.find("#series-rows"), this.nu = this.Eo.find("#type-linear"), this.ou = this.Eo.find("#type-growth"), this.pu = this.Eo.find("#type-date"), this.qu = this.Eo.find("#type-autofill"), this.ru = this.Eo.find("#date-day"), this.su = this.Eo.find("#date-weekday"), this.tu = this.Eo.find("#date-month"), this.uu = this.Eo.find("#date-year"), this.vu = this.Eo.find("#series-trend"), this.wu = this.Eo.find("#step-value"), this.xu = this.Eo.find("#stop-value"), this.yu = 0, this.zu = 1, this.Au = 0, this.lu.prop("checked", !0), this.nu.prop("checked", !0), this.ru.prop("checked", !0), this.wu.val(1), this.Bu();
                        var e = this;
                        this.lu.on("click", function() { e.yu = 0 }), this.mu.on("click", function() { e.yu = 1 }), this.nu.on("click", function() { e.vu.prop("checked") || (e.Bu(), e.Cu()), e.zu = 1 }), this.ou.on("click", function() { e.vu.prop("checked") || (e.Bu(), e.Cu()), e.zu = 2 }), this.qu.on("click", function() { e.Bu(), e.Du(), e.zu = 4 }), this.pu.on("click", function() { e.Eu(), e.Eu(), e.zu = 3 }), this.vu.on("change", function() { $(this).prop("checked") ? e.Fu() : e.Gu() }), this.ru.on("click", function() { e.Au = 0 }), this.su.on("click", function() { e.Au = 1 }), this.tu.on("click", function() { e.Au = 2 }), this.uu.on("click", function() { e.Au = 3 })
                    }, t.prototype.Bu = function() { this.ru.attr("disabled", "disabled"), this.su.attr("disabled", "disabled"), this.tu.attr("disabled", "disabled"), this.uu.attr("disabled", "disabled") }, t.prototype.Eu = function() { this.ru.removeAttr("disabled"), this.su.removeAttr("disabled"), this.tu.removeAttr("disabled"), this.uu.removeAttr("disabled") }, t.prototype.Du = function() { this.wu.attr("disabled", "disabled"), this.xu.attr("disabled", "disabled") }, t.prototype.Cu = function() { this.wu.removeAttr("disabled"), this.xu.removeAttr("disabled") }, t.prototype.Gu = function() { this.pu.removeAttr("disabled"), this.qu.removeAttr("disabled"), this.Cu() }, t.prototype.Fu = function() { this.nu.prop("checked", !0), this.nu.removeAttr("disabled"), this.ou.removeAttr("disabled"), this.pu.attr("disabled", "disabled"), this.qu.attr("disabled", "disabled"), this.Bu(), this.Du() }, t.prototype.fill = function() {
                        var e, t, i, o, a, s, l, c, d, p = r.wrapper.spread,
                            u = p.getActiveSheet();
                        for (u.suspendPaint(), u.suspendCalcService(), e = u.getSelections(), t = [], i = 0; i < e.length; i++) {
                            if (a = e[i], o = 0 === this.yu ? new n.Range(a.row, a.col, 1, a.colCount) : new n.Range(a.row, a.col, a.rowCount, 1), this.vu.prop("checked")) switch (this.zu) {
                                case 1:
                                    s = { fillType: 1, series: this.yu };
                                    break;
                                case 2:
                                    s = { fillType: 2, series: this.yu }
                            } else switch (l = +this.wu.val(), c = this.xu.val(), this.zu) {
                                case 1:
                                    c ? (c = +this.xu.val(), s = { fillType: 1, series: this.yu, step: l, stop: c }) : s = { fillType: 1, series: this.yu, step: l };
                                    break;
                                case 2:
                                    c ? (c = +this.xu.val(), s = { fillType: 2, series: this.yu, step: l, stop: c }) : s = { fillType: 2, series: this.yu, step: l };
                                    break;
                                case 4:
                                    s = { fillType: 4, series: this.yu };
                                    break;
                                case 3:
                                    c ? (c = +this.xu.val(), s = { fillType: 3, series: this.yu, step: l, stop: c, unit: this.Au }) : s = { fillType: 3, series: this.yu, step: l, unit: this.Au }
                            }
                            d = { startRange: o, wholeRange: a, fillAutoOptions: s }, t.push(d)
                        }
                        r.actions.doAction("autoFillByDirection", p, t), u.resumePaint(), u.resumeCalcService()
                    }, t
                }(r.BaseDialog);
            r.FillDialog = _, e = function(e) {
                    r.extends(t, e);

                    function t(t) { e.call(this, W, ".sort-option-dialog"), this.Hu = t }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.customSortDialog.sortOptions, buttons: [{ text: r.res.ok, click: function() { e.Hu.Iu(e.Ju), e.close() } }, { text: r.res.cancel, click: function() { e.close() } }] } }, t.prototype._init = function() {
                        var e = this;
                        this.Ju = !0, this.Eo.find("#sort-byrows").prop("checked", !0).click(function() { e.Ju = !0 }), this.Eo.find("#sort-bycols").click(function() { e.Ju = !1 })
                    }, t
                }(r.BaseDialog), r.SortOptionDialog = e, t = function(t) {
                    r.extends(i, t);

                    function i() { t.call(this, W, ".sort-dialog") }
                    return i.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.customSortDialog.sort, buttons: [{ text: r.res.ok, click: function() { e.sort(), e.close(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, i.prototype.Io = function() { this.Ku = this.Lu(), this.Eo.find(".sort-infolist").empty(), this.Mu() }, i.prototype.Lu = function() {
                        var e, t, i, o, n, a, s = r.wrapper.spread.getActiveSheet(),
                            l = this.getActiveSelection(s);
                        if (!l) return null;
                        if (e = r.res.customSortDialog, t = $("<select><select>"), t.addClass("sort-row-sortby"), this.Ju)
                            for (n = l.col, n = -1 === n ? 0 : n, i = 0; i < l.colCount; i++) o = $("<option></option>"), o.text(e.column + s.getCell(s.getRowCount(1) - 1, n + i, 1).text()), o.val(n + i), t.append(o);
                        else
                            for (a = l.row, a = -1 === a ? 0 : a, i = 0; i < l.rowCount; i++) o = $("<option></option>"), o.text(e.row + "" + (a + i + 1)), o.val(a + i), t.append(o);
                        return t
                    }, i.prototype._init = function() {
                        var e = this;
                        this.Ju = !0, this.Nu = !0, this.Eo.find("#add-level").on("click", function() { e.Mu() }), this.Eo.find("#delete-level").on("click", function() { e.Ou() }), this.Eo.find("#copy-level").on("click", function() { e.Pu() }), this.Eo.find("#move-up").on("click", function() { e.Qu() }), this.Eo.find("#move-down").on("click", function() { e.Ru() }), this.Eo.find("#sort-options").on("click", function() { e.Su() })
                    }, i.prototype.Mu = function() {
                        var e, t = $("<Div></Div>").addClass("sort-info").appendTo(this.Eo.find(".sort-infolist")),
                            i = r.res.customSortDialog;
                        1 === t.parent().children().length ? (this.Tu = t, this.Tu.addClass("ui-state-default-special ui-state-default"), t.append($("<label></label>").addClass("sort-row-header").text(i.sortBy2))) : t.append($("<label></label>").addClass("sort-row-header").text(i.thenBy)), this.Ku && t.append(this.Ku.clone(!0)), t.append($("<select></select>").addClass("sort-column").append($("<option>Values</option>"))), t.append($("<select></select>").addClass("sort-column sort-order").append($("<option>A to Z</option><option>Z to A</option>"))), t.append($("<div></div>").addClass("clear-float")), e = this, t.click(function() { e.Tu.removeClass("ui-state-default"), e.Tu = $(this), e.Tu.addClass("ui-state-default") })
                    }, i.prototype.Ou = function() {
                        var e = this.Tu;
                        this.Tu = e.prev(), 0 === this.Tu.length && (this.Tu = e.next(), this.Tu.find(".sort-row-header").text(r.res.customSortDialog.sortBy2)), this.Tu.addClass("ui-state-default"), e.remove()
                    }, i.prototype.Pu = function() {
                        var e = this.Tu.clone(!0);
                        0 === this.Tu.prev().length && e.find(".sort-row-header").text(r.res.customSortDialog.thenBy), e.find(".sort-row-sortby").val(this.Tu.find(".sort-row-sortby").val()), e.find(".sort-order").val(this.Tu.find(".sort-order").val()), this.Tu.after(e), this.Tu.removeClass("ui-state-default"), this.Tu = this.Tu.next()
                    }, i.prototype.Qu = function() { this.Tu.prev().before(this.Tu), this.Uu() }, i.prototype.Ru = function() { this.Tu.next().after(this.Tu), this.Uu() }, i.prototype.Su = function() {
                        var t = this;
                        this.Vu || (this.Vu = new e(t)), this.Vu.open()
                    }, i.prototype.Iu = function(e) { this.Ju !== e && (this.Ju = e, this.Ku = this.Lu(), this.Eo.find(".sort-infolist").empty(), this.Mu()) }, i.prototype.Uu = function() { this.Eo.find(".sort-infolist").children().each(function(e, t) { 0 === e ? $(t).find(".sort-row-header").text(r.res.customSortDialog.sortBy2) : $(t).find(".sort-row-header").text(r.res.customSortDialog.thenBy) }) }, i.prototype.sort = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = this.getActiveSelection(e),
                            i = this.Eo.find(".sort-infolist"),
                            o = [];
                        0 !== i.length && (i.children().each(function(e, t) { var i, n, r = !0; "Z to A" === $(t).find(".sort-order").val() && (r = !1), i = $(t).find(".sort-row-sortby").val(), n = { index: i, ascending: r }, o.push(n) }), t && r.actions.doAction("sortCustomRange", r.wrapper.spread, { byRows: this.Ju, sortInfos: o }))
                    }, i
                }(r.BaseDialog), r.SortDialog = t, a = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".spread-setting-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, resizable: !1, title: r.res.spreadSettingDialog.spreadSetting, buttons: [{ text: r.res.ok, click: function() { e._o(), r.actions.isFileModified = !0, e.close(), r.wrapper.setFocusToSpread(), r.ribbon.updateShowHide() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.settingTab = this.Eo.find(".spread-setting-tab").tabs() }, t.prototype.Io = function(e) {
                        var t, i, o, n = ["noHeaders", "rowHeaders", "columnHeaders", "allHeaders"];
                        switch (e[0]) {
                            case "general":
                                t = 0;
                                break;
                            case "scrollbar":
                                t = 1;
                                break;
                            case "tabstrip":
                                t = 2
                        }
                        this.settingTab.tabs("option", "active", t), this.Eo.find("#setting-dragmerge").prop("checked", r.wrapper.spread.options.allowUserDragMerge), this.Eo.find("#setting-dropdrop").prop("checked", r.wrapper.spread.options.allowUserDragDrop), this.Eo.find("#setting-dragfill").prop("checked", r.wrapper.spread.options.allowUserDragFill), this.Eo.find("#setting-undo").prop("checked", r.wrapper.spread.options.allowUndo), this.Eo.find("#setting-formula").prop("checked", r.wrapper.spread.options.allowUserEditFormula), this.Eo.find("#setting-zoom").prop("checked", r.wrapper.spread.options.allowUserZoom), this.Eo.find("#setting-overflow").prop("checked", r.wrapper.spread.getActiveSheet().options.allowCellOverflow), this.Eo.find("#setting-vertical-scrollbar").prop("checked", r.wrapper.spread.options.showVerticalScrollbar), this.Eo.find("#setting-horizontal-scrollbar").prop("checked", r.wrapper.spread.options.showHorizontalScrollbar), this.Eo.find("#setting-scrollbar-showmax").prop("checked", r.wrapper.spread.options.scrollbarShowMax), this.Eo.find("#setting-scrollbar-maxalign").prop("checked", r.wrapper.spread.options.scrollbarMaxAlign), this.Eo.find("#setting-tab-visible").prop("checked", r.wrapper.spread.options.tabStripVisible), this.Eo.find("#setting-new-tab").prop("checked", r.wrapper.spread.options.newTabVisible), this.Eo.find("#setting-tab-edit").prop("checked", r.wrapper.spread.options.tabEditable), i = this.Eo.find("#setting-tab-ratio"), i.spinner(), i.val(Math.round(100 * r.wrapper.spread.options.tabStripRatio)), this.Eo.find("#setting-copyExcelStyle").prop("checked", r.wrapper.spread.options.allowCopyPasteExcelStyle), this.Eo.find("#setting-copyExtendRange").prop("checked", r.wrapper.spread.options.allowExtendPasteRange), o = n[r.wrapper.spread.options.copyPasteHeaderOptions], this.Eo.find('input[type="radio"][name="headerOptions"]').each(function(e, t) { $(t).val() === o && $(t).attr("checked", "checked") })
                    }, t.prototype._o = function() {
                        var e, t;
                        for (r.wrapper.spread.options.allowUserDragMerge = this.Eo.find("#setting-dragmerge").prop("checked"), r.wrapper.spread.options.allowUserDragDrop = this.Eo.find("#setting-dropdrop").prop("checked"), r.wrapper.spread.options.allowUserDragFill = this.Eo.find("#setting-dragfill").prop("checked"), r.wrapper.spread.options.allowUndo = this.Eo.find("#setting-undo").prop("checked"), r.wrapper.spread.options.allowUserEditFormula = this.Eo.find("#setting-formula").prop("checked"), r.wrapper.spread.options.allowUserZoom = this.Eo.find("#setting-zoom").prop("checked"), e = 0; e < r.wrapper.spread.sheets.length; e++) r.wrapper.spread.sheets[e].options.allowCellOverflow = this.Eo.find("#setting-overflow").prop("checked");
                        r.wrapper.spread.options.showVerticalScrollbar = this.Eo.find("#setting-vertical-scrollbar").prop("checked"), r.wrapper.spread.options.showHorizontalScrollbar = this.Eo.find("#setting-horizontal-scrollbar").prop("checked"), r.wrapper.spread.options.scrollbarShowMax = this.Eo.find("#setting-scrollbar-showmax").prop("checked"), r.wrapper.spread.options.scrollbarMaxAlign = this.Eo.find("#setting-scrollbar-maxalign").prop("checked"), r.wrapper.spread.options.tabStripVisible = this.Eo.find("#setting-tab-visible").prop("checked"), r.wrapper.spread.options.newTabVisible = this.Eo.find("#setting-new-tab").prop("checked"), r.wrapper.spread.options.tabEditable = this.Eo.find("#setting-tab-edit").prop("checked"), t = this.Eo.find("#setting-tab-ratio").val(), $.isNumeric(t) && (r.wrapper.spread.options.tabStripRatio = t / 100), r.wrapper.spread.options.allowCopyPasteExcelStyle = this.Eo.find("#setting-copyExcelStyle").prop("checked"), r.wrapper.spread.options.allowExtendPasteRange = this.Eo.find("#setting-copyExtendRange").prop("checked"), r.wrapper.spread.options.copyPasteHeaderOptions = GC.Spread.Sheets.CopyPasteHeaderOptions[this.Eo.find('input[type="radio"][name="headerOptions"]:checked').val()]
                    }, t
                }(r.BaseDialog), r.SpreadSettingDialog = a, s = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".sheet-setting-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, resizable: !1, title: r.res.sheetSettingDialog.sheetSetting, buttons: [{ text: r.res.ok, click: function() { e.close(), e._o(), r.actions.isFileModified = !0, r.wrapper.setFocusToSpread(), r.ribbon.updateShowHide() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        this.Eo.find(".sheet-setting-tab").tabs(), this.Eo.find(".header-setting-tab").tabs(), this.Eo.find("#sheet-column-count").spinner(), this.Eo.find("#sheet-row-count").spinner(), this.Eo.find("#frozen-column-count").spinner(), this.Eo.find("#frozen-row-count").spinner(), this.Eo.find("#trailing-column-count").spinner(), this.Eo.find("#trailing-row-count").spinner(), this.Eo.find("#header-row-count").spinner(), this.Eo.find("#header-row-autoindex").spinner(), this.Eo.find("#header-row-default-width").spinner(), this.Eo.find("#header-column-count").spinner(), this.Eo.find("#header-column-autoindex").spinner(), this.Eo.find("#header-column-default-height").spinner(), this.Eo.find("#gridline-color-picker").colorpicker({ valueChanged: function(t, i) { void 0 === i.color ? e.Eo.find("#gridline-color-span").css("background-color", "") : e.Eo.find("#gridline-color-span").css("background-color", i.color) }, choosedColor: function(t, i) { e.Eo.find("#gridline-color-frame").comboframe("close") }, openColorDialog: function(t, i) { e.Eo.find("#gridline-color-frame").comboframe("close") }, showNoFill: !1 }), this.Eo.find("#gridline-color-frame").comboframe(), this.Eo.find("#sheettab-color-picker").colorpicker({ valueChanged: function(t, i) { void 0 === i.color ? e.Eo.find("#sheettab-color-span").css("background-color", "") : e.Eo.find("#sheettab-color-span").css("background-color", i.color) }, choosedColor: function(t, i) { e.Eo.find("#sheettab-color-frame").comboframe("close") }, openColorDialog: function(t, i) { e.Eo.find("#sheettab-color-frame").comboframe("close") }, showNoFill: !1 }), this.Eo.find("#sheettab-color-frame").comboframe(), this.Eo.find("#reference-A1").on("click", function() { e.Eo.find("#header-column-autotext-letters").prop("checked", !0) }), this.Eo.find("#reference-R1C1").on("click", function() { e.Eo.find("#header-column-autotext-numbers").prop("checked", !0) })
                    }, t.prototype.Io = function(e) {
                        var t, i, o = r.wrapper.spread,
                            n = r.wrapper.spread.getActiveSheet();
                        switch ($("#gridline-color-picker").colorpicker({ themeColors: r.wrapper.getThemeColors() }), $("#sheettab-color-picker").colorpicker({ themeColors: r.wrapper.getThemeColors() }), e[0]) {
                            case "general":
                                i = 0;
                                break;
                            case "gridline":
                                i = 1;
                                break;
                            case "calculation":
                                i = 2;
                                break;
                            case "headers":
                                i = 3;
                                break;
                            case "sheettab":
                                i = 4
                        }
                        this.Eo.find(".sheet-setting-tab").tabs("option", "active", i), this.Eo.find("#sheet-column-count").val(n.getColumnCount()), this.Eo.find("#sheet-row-count").val(n.getRowCount()), this.Eo.find("#frozen-column-count").val(n.frozenColumnCount()), this.Eo.find("#frozen-row-count").val(n.frozenRowCount()), this.Eo.find("#trailing-column-count").val(n.frozenTrailingColumnCount()), this.Eo.find("#trailing-row-count").val(n.frozenTrailingRowCount()), this.Eo.find("input[name='selection-policy']").each(function(e, t) { $(t).val() === "" + n.selectionPolicy() && $(t).prop("checked", !0) }), this.Eo.find("#sheet-protect").prop("checked", n.options.isProtected), this.Eo.find("#gridline-horizontal").prop("checked", n.options.gridline.showHorizontalGridline), this.Eo.find("#gridline-vertical").prop("checked", n.options.gridline.showVerticalGridline), n.options.gridline.color ? (t = r.ColorHelper.parse(n.options.gridline.color, n.currentTheme().colors()),
                            $("#gridline-color-picker").colorpicker("option", "selectedItem", t), this.Eo.find("#gridline-color-span").css("background-color", t.color)) : (this.Eo.find("#gridline-color-span").css("background-color", "transparent"), $("#gridline-color-picker").colorpicker("option", "selectedItem", null)), this.Eo.find("input[name='reference-style']").each(function(e, t) { $(t).val() === "" + o.options.referenceStyle && $(t).prop("checked", !0) }), this.Eo.find("#header-column-count").val(n.getRowCount(1)), this.Eo.find("input[name='column-autotext']").each(function(e, t) { $(t).val() === "" + n.options.colHeaderAutoText && $(t).prop("checked", !0) }), this.Eo.find("#header-column-autoindex").val(n.options.colHeaderAutoTextIndex), this.Eo.find("#header-column-default-height").val(n.defaults.colHeaderRowHeight), this.Eo.find("#header-column-visible").prop("checked", n.options.colHeaderVisible), this.Eo.find("#header-row-count").val(n.getColumnCount(2)), this.Eo.find("input[name='row-autotext']").each(function(e, t) { $(t).val() === "" + n.options.rowHeaderAutoText && $(t).prop("checked", !0) }), this.Eo.find("#header-row-autoindex").val(n.options.rowHeaderAutoTextIndex), this.Eo.find("#header-row-default-width").val(n.defaults.rowHeaderColWidth), this.Eo.find("#header-row-visible").prop("checked", n.options.rowHeaderVisible), n.options.sheetTabColor ? (t = r.ColorHelper.parse(n.options.sheetTabColor, n.currentTheme().colors()), $("#sheettab-color-picker").colorpicker("option", "selectedItem", t), this.Eo.find("#sheettab-color-span").css("background-color", t.color)) : (this.Eo.find("#sheettab-color-span").css("background-color", "transparent"), $("#sheettab-color-picker").colorpicker("option", "selectedItem", null))
                    }, t.prototype._o = function() {
                        var e, t, i = r.wrapper.spread.getActiveSheet(),
                            o = r.wrapper.spread;
                        i.suspendPaint(), i.suspendCalcService(), i.setColumnCount(+this.Eo.find("#sheet-column-count").val()), i.setRowCount(+this.Eo.find("#sheet-row-count").val()), i.frozenRowCount(+this.Eo.find("#frozen-row-count").val()), i.frozenColumnCount(+this.Eo.find("#frozen-column-count").val()), i.frozenTrailingRowCount(+this.Eo.find("#trailing-row-count").val()), i.frozenTrailingColumnCount(+this.Eo.find("#trailing-column-count").val()), i.selectionPolicy(+this.Eo.find("input[name='selection-policy']:checked").val()), i.options.isProtected = this.Eo.find("#sheet-protect").prop("checked"), e = $("#gridline-color-picker").colorpicker("option", "selectedItem"), e && (i.options.gridline = { showHorizontalGridline: this.Eo.find("#gridline-horizontal").prop("checked"), showVerticalGridline: this.Eo.find("#gridline-vertical").prop("checked"), color: e.color }), o.options.referenceStyle = +this.Eo.find("input[name='reference-style']:checked").val(), i.setRowCount(+this.Eo.find("#header-column-count").val(), 1), i.options.colHeaderAutoText = +this.Eo.find("input[name='column-autotext']:checked").val(), i.options.colHeaderAutoTextIndex = +this.Eo.find("#header-column-autoindex").val(), i.defaults.colHeaderRowHeight = +this.Eo.find("#header-column-default-height").val(), i.options.colHeaderVisible = this.Eo.find("#header-column-visible").prop("checked"), i.setColumnCount(+this.Eo.find("#header-row-count").val(), 2), i.options.rowHeaderAutoText = +this.Eo.find("input[name='row-autotext']:checked").val(), i.options.rowHeaderAutoTextIndex = +this.Eo.find("#header-row-autoindex").val(), i.defaults.rowHeaderColWidth = +this.Eo.find("#header-row-default-width").val(), i.options.rowHeaderVisible = this.Eo.find("#header-row-visible").prop("checked"), t = $("#sheettab-color-picker").colorpicker("option", "selectedItem"), t && (t.name ? i.options.sheetTabColor = t.name : i.options.sheetTabColor = t.color), i.resumeCalcService(), i.resumePaint()
                    }, t
                }(r.BaseDialog), r.SheetSettingDialog = s, l = function(e) {
                    var t, o, a;
                    r.extends(s, e);

                    function s() { e.call(this, W, ".data-validation-dialog") } s.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.dataValidationDialog.dataValidation, buttons: [{ text: r.res.dataValidationDialog.clearAll, click: function() { e.Wu() } }, { text: r.res.ok, click: function() { e.Xu() && (e._o(), e.close(), r.wrapper.setFocusToSpread()) }, isDefault: !0 }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, s.prototype._init = function() {
                        var e = this;
                        this.Eo.find(".data-validation-tab").tabs(), this.Yu = this.Eo.find(".validation-criteria-type"), this.Zu = this.Eo.find(".validation-ignore-blank").prop("disabled", !0).prop("checked", !0), this.$u = this.Eo.find(".validation-comparison-operator").prop("disabled", !0), this.av = this.Eo.find(".validation-incell-dropdown").prop("checked", !0), this.bv = this.Eo.find(".validation-value1"), this.cv = this.Eo.find(".validation-value2"), this.dv = this.Eo.find(".validation-value1-container"), this.ev = this.Eo.find(".validation-value2-container"), this.fv = this.Eo.find(".validation-value1-label"), this.gv = this.Eo.find(".validation-value2-label"), this.hv = this.Eo.find(".show-input-message").prop("checked", !0), this.iv = this.Eo.find(".input-title"), this.jv = this.Eo.find(".input-message"), this.kv = this.Eo.find(".show-error-message").prop("checked", !0), this.lv = this.Eo.find(".error-title"), this.mv = this.Eo.find(".error-message"), this.nv = this.Eo.find(".error-style"), this.Yu.on("change", function() { e.ov() }), this.$u.on("change", function() { e.pv() }), this.hv.on("change", function() { e.qv() }), this.kv.on("change", function() { e.rv() }), this.nv.on("change", function() { e.sv() }), e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Qs || (e.Qs = new r.RangeSelectDialog(e, { needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                e.hide();
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                switch ($(this).data("name")) {
                                    case "validation-value1":
                                        o = e.bv.val(), e.Qs.open(t, i, o, [".validation-value1"]);
                                        break;
                                    case "validation-value2":
                                        o = e.cv.val(), e.Qs.open(t, i, o, [".validation-value2"]);
                                        break;
                                    default:
                                        e.show()
                                }
                            }
                        })
                    }, s.prototype.Rs = function(e, t) { this.Eo.find(e).val(t) }, s.prototype.Io = function() {
                        var e, t, i;
                        this.Eo.find(".data-validation-tab").tabs("option", "active", 0), e = r.wrapper.spread.getActiveSheet(), (t = this.getActiveSelection(e)) && (i = e.getDataValidator(t.row, t.col), i ? (this.tv(i), this.uv(i.type(), i.comparisonOperator()), this.vv()) : this.Wu())
                    }, t = { 0: "anyValue", 1: "wholeNumber", 2: "decimalValues", 3: "list", 4: "date", 5: "time", 6: "textLength", 7: "custom" }, o = { 0: "equalsTo", 1: "notEqualsTo", 2: "greaterThan", 3: "greaterThanOrEqualsTo", 4: "lessThan", 5: "lessThanOrEqualsTo", 6: "between", 7: "notBetween" }, a = { 0: "stop", 1: "warning", 2: "information" };

                    function l(e) { return null === e || e === i ? "" : e && e.getDate ? [e.getMonth() + 1, e.getDate(), e.getFullYear()].join("/") : e + "" }
                    return s.prototype.tv = function(e) {
                        var i = r.wrapper.spread.getActiveSheet(),
                            n = i.getActiveRowIndex(),
                            s = i.getActiveColumnIndex();
                        this.Yu.val(t[e.type()]), this.$u.val(o[e.comparisonOperator()]), this.bv.val(l(e.value1(n, s))), this.cv.val(l(e.value2(n, s))), this.Zu.prop("checked", e.ignoreBlank()), this.av.prop("checked", e.inCellDropdown()), this.hv.prop("checked", e.showInputMessage()), this.iv.val(e.inputTitle()), this.jv.val(e.inputMessage()), this.kv.prop("checked", e.showErrorMessage()), this.nv.val(a[e.errorStyle()]), this.lv.val(e.errorTitle()), this.mv.val(e.errorMessage())
                    }, s.prototype.Wu = function() { this.wv(), this.Yu.find("option:first-child").prop("selected", !0), this.$u.find("option:first-child").prop("selected", !0), this.bv.val(null), this.cv.val(null), this.hv.prop("checked", !0), this.iv.val(null).prop("disabled", !1), this.jv.val(null).prop("disabled", !1), this.kv.prop("checked", !0), this.nv.prop("disabled", !1).find("option:first-child").prop("selected", !0), this.lv.val(null).prop("disabled", !1), this.mv.val(null).prop("disabled", !1), this.vv() }, s.prototype.wv = function() { this.$u.prop("disabled", !0), this.Zu.prop("disabled", !0), this.av.parent().css("visibility", "hidden"), this.dv.css("visibility", "hidden"), this.fv.css("visibility", "hidden"), this.ev.css("visibility", "hidden"), this.gv.css("visibility", "hidden") }, s.prototype.xv = function(e) { this.Zu.prop("disabled", e) }, s.prototype.yv = function(e) { this.$u.prop("disabled", e) }, s.prototype.zv = function(e) { this.av.parent().css("visibility", e ? "visible" : "hidden") }, s.prototype.Av = function(e, t) { this.dv.css("visibility", e ? "visible" : "hidden"), this.fv.css("visibility", e ? "visible" : "hidden"), this.fv.text(t) }, s.prototype.Bv = function(e, t) { this.ev.css("visibility", e ? "visible" : "hidden"), this.gv.css("visibility", e ? "visible" : "hidden"), this.gv.text(t) }, s.prototype.uv = function(e, t) {
                        var i, o, n;
                        if (this.wv(), 0 !== e)
                            if (1 === e || 2 === e || 4 === e || 6 === e) {
                                switch (e) {
                                    case 1:
                                    case 2:
                                        i = r.res.dataValidationDialog.minimum, o = r.res.dataValidationDialog.maximum, n = r.res.dataValidationDialog.value;
                                        break;
                                    case 4:
                                        i = r.res.dataValidationDialog.startDate, o = r.res.dataValidationDialog.endDate, n = r.res.dataValidationDialog.dateLabel;
                                        break;
                                    case 6:
                                        i = r.res.dataValidationDialog.minimum, o = r.res.dataValidationDialog.maximum, n = r.res.dataValidationDialog.length
                                }
                                switch (t) {
                                    case 6:
                                    case 7:
                                        this.xv(!1), this.yv(!1), this.zv(!1), this.Av(!0, i), this.Bv(!0, o);
                                        break;
                                    case 0:
                                    case 1:
                                        this.xv(!1), this.yv(!1), this.zv(!1), this.Av(!0, n), this.Bv(!1, "");
                                        break;
                                    case 2:
                                    case 3:
                                        this.xv(!1), this.yv(!1), this.zv(!1), this.Av(!0, i), this.Bv(!1, "");
                                        break;
                                    case 4:
                                    case 5:
                                        this.xv(!1), this.yv(!1), this.zv(!1), this.Av(!0, o), this.Bv(!1, "")
                                }
                            } else 3 === e ? (this.xv(!1), this.yv(!0), this.zv(!0), this.Av(!0, r.res.dataValidationDialog.source), this.Bv(!1, "")) : 7 === e && (this.xv(!1), this.yv(!0), this.zv(!1), this.Av(!0, r.res.dataValidationDialog.formula), this.Bv(!1, ""))
                    }, s.prototype.ov = function() { this.uv(n.DataValidation.CriteriaType[this.Yu.val()], n.ConditionalFormatting.ComparisonOperators[this.$u.val()]) }, s.prototype.pv = function() { this.uv(n.DataValidation.CriteriaType[this.Yu.val()], n.ConditionalFormatting.ComparisonOperators[this.$u.val()]) }, s.prototype.qv = function() { this.iv.prop("disabled", !this.hv.prop("checked")), this.jv.prop("disabled", !this.hv.prop("checked")) }, s.prototype.rv = function() { this.lv.prop("disabled", !this.kv.prop("checked")), this.mv.prop("disabled", !this.kv.prop("checked")), this.nv.prop("disabled", !this.kv.prop("checked")) }, s.prototype.vv = function() {
                        var e = this.Eo.find(".error-icon");
                        switch (this.nv.val()) {
                            case "stop":
                                e.removeClass("error-icon-warning").removeClass("error-icon-info").addClass("error-icon-stop");
                                break;
                            case "warning":
                                e.removeClass("error-icon-stop").removeClass("error-icon-info").addClass("error-icon-warning");
                                break;
                            case "information":
                                e.removeClass("error-icon-warning").removeClass("error-icon-stop").addClass("error-icon-info")
                        }
                    }, s.prototype.sv = function() { this.vv() }, s.prototype._o = function() {
                        var e, t = n.ConditionalFormatting.ComparisonOperators[this.$u.val()],
                            i = this.bv.val(),
                            o = this.cv.val();
                        switch (i = this.Uo(i), o = this.Uo(o), this.Yu.val()) {
                            case "anyValue":
                                e = new n.DataValidation.DefaultDataValidator, e.type(0);
                                break;
                            case "wholeNumber":
                                $.isNumeric(i) && (i = +i), $.isNumeric(o) && (o = +o), e = n.DataValidation.createNumberValidator(t, i, o, !0);
                                break;
                            case "decimalValues":
                                $.isNumeric(i) && (i = +i), $.isNumeric(o) && (o = +o), e = n.DataValidation.createNumberValidator(t, i, o, !1);
                                break;
                            case "list":
                                e = this.To(i) ? n.DataValidation.createFormulaListValidator(i) : n.DataValidation.createListValidator(i);
                                break;
                            case "date":
                                i && !this.To(i) && (i = new Date(i)), o && !this.To(o) && (o = new Date(o)), e = n.DataValidation.createDateValidator(t, i, o);
                                break;
                            case "textLength":
                                e = n.DataValidation.createTextLengthValidator(t, i, o);
                                break;
                            case "custom":
                                e = n.DataValidation.createFormulaValidator(i)
                        }
                        e && (e.showInputMessage(this.hv.prop("checked")), e.inputTitle(this.iv.val()), e.inputMessage(this.jv.val()), e.showErrorMessage(this.kv.prop("checked")), e.errorTitle(this.lv.val()), e.errorMessage(this.mv.val()), e.errorStyle(n.DataValidation.ErrorStyle[this.nv.val()]), e.ignoreBlank(this.Zu.prop("checked")), e.inCellDropdown(this.av.prop("checked")), e.comparisonOperator(n.ConditionalFormatting.ComparisonOperators[this.$u.val()])), r.actions.doAction("setDataValidation", r.wrapper.spread, e)
                    }, s.prototype.Xu = function() {
                        var e = this.bv.val(),
                            t = this.cv.val();
                        if ("visible" === this.bv.css("visibility") && "hidden" === this.cv.css("visibility") && !e) return r.MessageBox.show(r.res.dataValidationDialog.valueEmptyMessage, r.res.title, 1, 0), !1;
                        if ("visible" === this.bv.css("visibility") && "visible" === this.cv.css("visibility")) { if (!e || !t) return r.MessageBox.show(r.res.dataValidationDialog.valueEmptyMessage, r.res.title, 1, 0), !1; if ($.isNumeric(e) && $.isNumeric(t) && +e > +t) return r.MessageBox.show(r.res.dataValidationDialog.minimumMaximumMessage, r.res.title, 1, 0), !1 }
                        return !0
                    }, s
                }(r.BaseDialog), r.DataValidationDialog = l, c = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".group-direction-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.groupDirectionDialog.settings, buttons: [{ text: r.res.ok, click: function() { e._o(), e.close(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet();
                        this.Eo.find("#row-group-direction").prop("checked", 1 === e.rowOutlines.direction()), this.Eo.find("#column-group-direction").prop("checked", 1 === e.columnOutlines.direction())
                    }, t.prototype._o = function() {
                        var e = r.wrapper.spread.getActiveSheet();
                        e.suspendPaint(), e.rowOutlines.direction(this.Eo.find("#row-group-direction").prop("checked") ? 1 : 0), e.columnOutlines.direction(this.Eo.find("#column-group-direction").prop("checked") ? 1 : 0), e.resumePaint()
                    }, t
                }(r.BaseDialog), r.GroupDirectionDialog = c, d = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".zoom-dialog") }
                    return t.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: r.res.zoomDialog.title,
                            width: 230,
                            buttons: [{
                                text: r.res.ok,
                                click: function() {
                                    var t, i, o = e.Eo.find("input[name='zoom-ratio']:checked").val();
                                    o === r.res.zoomDialog.fitSelection ? r.actions.doAction("zoomSelection", r.wrapper.spread) : (t = e.Eo.find("input[name='zoom-custom-ratio']").val(), i = parseFloat(t), i /= 100, i ? r.actions.doAction("zoom", r.wrapper.spread, i) : r.MessageBox.show(r.res.zoomDialog.exception, r.res.title, 2)), e.close(), r.wrapper.setFocusToSpread(), r.ribbon.updateZoomToStatusBar()
                                }
                            }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }]
                        }
                    }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = e.zoom(),
                            i = this.Cv("" + t);
                        this.Eo.find("input[type='text']").val(i), this.Dv(t)
                    }, t.prototype._init = function() {
                        var e = this,
                            t = r.wrapper.spread.getActiveSheet(),
                            i = t.zoom(),
                            o = 4,
                            n = this.Cv("" + i);
                        this.Eo.find("input[type='text']").val(n), this.Dv(i), this.Eo.find("input[name='zoom-ratio']").bind("change", function() {
                            var t, i = e.Eo.find("input[name='zoom-ratio']:checked").val();
                            i === r.res.zoomDialog.custom || (i === r.res.zoomDialog.fitSelection ? (t = r.actions.Ev()) && (t.zoom > o && (t.zoom = o), e.Eo.find("input[type='text']").val(e.Cv("" + t.zoom))) : e.Eo.find("input[type='text']").val(i))
                        }), this.Eo.find("input[name='zoom-custom-ratio']").bind("focus", function() { e.Eo.find("input[class='custom-ratio']").prop("checked", !0) })
                    }, t.prototype.Fv = function() {
                        var e = this.Eo.find("input[name='zoom-ratio']:checked").val();
                        this.Eo.find("input[type='text']").val(e)
                    }, t.prototype.Cv = function(e) { return e.match(/^[0-9\.]*$/) ? 100 * parseFloat(e) : !!e.match(/^[0-9\.]*%$/) && (e.substring(0, e.indexOf("%") - 1), e) }, t.prototype.Dv = function(e) {
                        switch (e) {
                            case 2:
                                this.Eo.find("input[id='zoom-ratio1']").prop("checked", !0);
                                break;
                            case 1:
                                this.Eo.find("input[id='zoom-ratio2']").prop("checked", !0);
                                break;
                            case .75:
                                this.Eo.find("input[id='zoom-ratio3']").prop("checked", !0);
                                break;
                            case .5:
                                this.Eo.find("input[id='zoom-ratio4']").prop("checked", !0);
                                break;
                            case .25:
                                this.Eo.find("input[id='zoom-ratio5']").prop("checked", !0);
                                break;
                            default:
                                this.Eo.find("input[class='custom-ratio']").prop("checked", !0)
                        }
                    }, t
                }(r.BaseDialog), r.ZoomDialog = d,
                function(e) { e[e.pie = 0] = "pie", e[e.area = 1] = "area", e[e.scatter = 2] = "scatter", e[e.compatible = 3] = "compatible", e[e.bullet = 4] = "bullet", e[e.spread = 5] = "spread", e[e.stacked = 6] = "stacked", e[e.hbar = 7] = "hbar", e[e.vbar = 8] = "vbar", e[e.variance = 9] = "variance", e[e.boxplot = 10] = "boxplot", e[e.cascade = 11] = "cascade", e[e.pareto = 12] = "pareto", r.FormulaSparklineType = e }(r.FormulaSparklineType || {}),
                function(e) { e[e.cascade = 0] = "cascade", e[e.pareto = 1] = "pareto", r.MultiRangeFormulaType = e }(r.MultiRangeFormulaType || {}), p = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".insert-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.insertSparklineDialog.createSparklines, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Gv || (e.Gv = new r.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), e.Qs || (e.Qs = new r.RangeSelectDialog(e, { absoluteReference: !1, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                e.hide();
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                switch ($(this).data("name")) {
                                    case "sparkline-data-range":
                                        o = e.Eo.find(".sparkline-data-range").val(), e.Qs.open(t, i, o, [".sparkline-data-range"]);
                                        break;
                                    case "sparkline-location-range":
                                        o = e.Eo.find(".sparkline-location-range").val(), e.Gv.open(t, i, o, [".sparkline-location-range"]);
                                        break;
                                    default:
                                        e.show()
                                }
                            }
                        })
                    }, t.prototype.Rs = function(e, t) {
                        var i = t;
                        0 === t.indexOf("=") && (i = t.substr(1)), this.Eo.find(e).val(i)
                    }, t.prototype.Io = function(e) {
                        var t, o, n, a, s;
                        this.Hv = r.wrapper.spread.getActiveSheet(), this.Iv = i, this.Jv = i, t = this.Eo.find("#is-formula-sparkline"), o = t.parent(), n = e[0], void 0 !== e[1] ? (this.Iv = n, t.prop("checked", !0).attr("disabled", "disabled"), o.addClass("element-disabled")) : (this.Jv = n, t.prop("checked", !0).removeAttr("disabled"), o.removeClass("element-disabled")), a = this.Hv, s = r.wrapper.spread.options.referenceStyle, this.Eo.find(".sparkline-data-range").val(r.CEUtility.parseRangeToExpString(a.getSelections()[0], null, a.getActiveRowIndex(), a.getActiveColumnIndex(), s)), this.Eo.find(".sparkline-location-range").val("")
                    }, t.prototype._o = function() {
                        var e, t, i = this,
                            o = i.Hv,
                            n = i.Eo,
                            a = n.find(".sparkline-data-range").val(),
                            s = r.CEUtility.parseExpStringToRanges(n.find(".sparkline-location-range").val(), o);
                        if (!a || !s || s.length < 1) return void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0);
                        if (e = n.find("#is-formula-sparkline").prop("checked")) {
                            if (t = "", void 0 !== this.Jv) switch (i.Jv) {
                                case 0:
                                    i.Iv = 3, t = "line";
                                    break;
                                case 1:
                                    i.Iv = 3, t = "column";
                                    break;
                                case 2:
                                    i.Iv = 3, t = "winloss"
                            }
                            r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { type: i.Iv, compatibleType: t, dataRange: a, locationRange: s[0] })
                        } else r.actions.doAction("setDefaultSparkline", r.wrapper.spread, { dataRange: a, locationRange: s[0], sparklineType: i.Jv, setting: 2 === i.Jv ? { showNegative: !0 } : {} });
                        r.ribbon.updateSparkline(), i.close(), i.Kv(), r.wrapper.setFocusToSpread()
                    }, t.prototype.Kv = function() {
                        var e, t = $("#formulaBarText"),
                            i = this.Hv;
                        t.length > 0 && (e = i.getFormula(i.getActiveRowIndex(), i.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                    }, t
                }(r.BaseDialog), r.InsertSparkLineDialog = p, u = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".sparkline-weight-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "200", modal: !0, title: r.res.sparklineWeightDialog.sparklineWeight, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex());
                        t && this.Eo.find(".sparkline-weight").val(t.setting().options.lineWeight)
                    }, t.prototype._o = function() {
                        var e = this.Eo.find(".sparkline-weight").val(),
                            t = this;
                        $.isNumeric(e) ? (r.actions.doAction("setSparklineSetting", r.wrapper.spread, [e, "lineWeight"]), t.close(), r.wrapper.setFocusToSpread()) : r.MessageBox.show(r.res.sparklineWeightDialog.errorMessage, r.res.title, 2, 0)
                    }, t
                }(r.BaseDialog), r.SparklineWeightDialog = u, h = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".sparkline-marker-color-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.sparklineMarkerColorDialog.sparklineMarkerColor, buttons: [{ text: r.res.ok, click: function() { e._o(), e.close(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.Lv("sparkline-negative-point-color-frame", "sparkline-negative-point-color-span", "sparkline-negative-point-color-picker"), this.Lv("sparkline-marker-point-color-frame", "sparkline-marker-point-color-span", "sparkline-marker-point-color-picker"), this.Lv("sparkline-high-point-color-frame", "sparkline-high-point-color-span", "sparkline-high-point-color-picker"), this.Lv("sparkline-low-point-color-frame", "sparkline-low-point-color-span", "sparkline-low-point-color-picker"), this.Lv("sparkline-first-point-color-frame", "sparkline-first-point-color-span", "sparkline-first-point-color-picker"), this.Lv("sparkline-last-point-color-frame", "sparkline-last-point-color-span", "sparkline-last-point-color-picker") }, t.prototype.Lv = function(e, t, i) {
                        var o = this;
                        this.Eo.find("." + i).colorpicker({ valueChanged: function(e, i) { void 0 === i.color ? o.Eo.find("." + t).css("background-color", "") : o.Eo.find("." + t).css("background-color", i.color) }, choosedColor: function(t, i) { o.Eo.find("." + e).comboframe("close") }, openColorDialog: function(t, i) { o.Eo.find("." + e).comboframe("close") } }), this.Eo.find("." + e).comboframe()
                    }, t.prototype.Mv = function(e, t, i) {
                        var o, n;
                        $("." + i).colorpicker({ themeColors: r.wrapper.getThemeColors() }), o = r.wrapper.spread.getActiveSheet(), e ? (n = r.ColorHelper.parse(e, o.currentTheme().colors()), $("." + i).colorpicker("option", "selectedItem", n), this.Eo.find("." + t).css("background-color", n.color)) : (this.Eo.find("." + t).css("background-color", "transparent"), $("." + i).colorpicker("option", "selectedItem", null))
                    }, t.prototype.Nv = function(e, t, i) { e && (e.name ? r.actions.doAction(t, r.wrapper.spread, [e.name, i]) : r.actions.doAction(t, r.wrapper.spread, [e.color, i])) }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex()).setting();
                        this.Mv(t.options.negativeColor, "sparkline-negative-point-color-span", "sparkline-negative-point-color-picker"), this.Mv(t.options.markersColor, "sparkline-marker-point-color-span", "sparkline-marker-point-color-picker"), this.Mv(t.options.highMarkerColor, "sparkline-high-point-color-span", "sparkline-high-point-color-picker"), this.Mv(t.options.lowMarkerColor, "sparkline-low-point-color-span", "sparkline-low-point-color-picker"), this.Mv(t.options.firstMarkerColor, "sparkline-first-point-color-span", "sparkline-first-point-color-picker"), this.Mv(t.options.lastMarkerColor, "sparkline-last-point-color-span", "sparkline-last-point-color-picker")
                    }, t.prototype._o = function() { this.Nv($(".sparkline-negative-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "negativeColor"), this.Nv($(".sparkline-marker-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "markersColor"), this.Nv($(".sparkline-high-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "highMarkerColor"), this.Nv($(".sparkline-low-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "lowMarkerColor"), this.Nv($(".sparkline-first-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "firstMarkerColor"), this.Nv($(".sparkline-last-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "lastMarkerColor") }, t
                }(r.BaseDialog), r.SparklineMarkerColorDialog = h, f = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".create-table-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.createTableDialog.createTable, buttons: [{ text: r.res.ok, click: function() { e._o(), e.close(), r.wrapper.setFocusToSpread(), r.ribbon.updateTable() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            var t, i, o;
                            e.Qs || (e.Qs = new r.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), e.hide(), t = e.Eo.dialog("option", "title"), i = e.Rs, o = e.Eo.find(".table-source-range").val(), e.Qs.open(t, i, o, [".table-source-range"])
                        })
                    }, t.prototype.Rs = function(e, t) { this.Eo.find(e).val(t) }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet();
                        this.Ov = e, this.Eo.find(".table-source-range").val(r.CEUtility.parseRangeToExpString(e.getSelections()[0], !0))
                    }, t.prototype._o = function() {
                        var e = r.CEUtility.parseExpStringToRanges(this.Eo.find(".table-source-range").val(), this.Ov);
                        e && e.length >= 1 && r.actions.doAction("createDefaultTable", r.wrapper.spread, e[0])
                    }, t
                }(r.BaseDialog), r.CreateTableDialog = f, g = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".format-table-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: 600, modal: !0, title: r.res.formatTableStyle.tableStyle, buttons: [{ text: r.res.ok, click: function() { e.Pv() ? r.MessageBox.show(r.res.formatTableStyle.exception, r.res.title, 2) : (t.currentId++, e.Qv(), r.actions.isFileModified = !0, e.close(), r.wrapper.setFocusToSpread()) } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.Rv = null, this.Sv = null, this.Tv = null, this.Uv = null, this.Vv = null, this.Wv(), this.Xv(), this.Yv(), this.Zv(), this.$v() }, t.prototype.Xv = function() {
                        var e, t = r.res.tableElement;
                        for (e in t) $("<option></option>").attr("strip-size", 1).val(e).text(t[e]).appendTo(this.Eo.find(".table-element-select"));
                        this.Eo.find(".table-element-select").attr("size", 8), this.Eo.find(".table-element-select").get(0).selectedIndex = 0, this._v = this.Eo.find(".table-element-select").find("option:selected").val()
                    }, t.prototype.Wv = function() {
                        var e = r.res.formatTableStyle.tableStyle + " " + t.currentId;
                        this.Eo.find(".table-style-input").val(e)
                    }, t.prototype.Yv = function() {
                        var e, t, i, o, a, s, l, c = this;
                        for (this.aw = new n.Workbook(this.Eo.find(".pre-spread")[0]), e = this.aw.getActiveSheet(), this.aw.options.showHorizontalScrollbar = !1, this.aw.options.showVerticalScrollbar = !1, this.aw.options.tabStripVisible = !1, this.aw.options.allowUserResize = !1, this.aw.options.allowUserDragDrop = !1, this.aw.options.allowUserDragFill = !1, this.aw.options.allowContextMenu = !1, e.suspendPaint(), $(r.util.getCanvas(this.aw)).unbind("gcmousewheel.gcSheet"), e.currentTheme(r.wrapper.spread.getActiveSheet().currentTheme()), e.options.gridline = { showVerticalGridline: !1, showHorizontalGridline: !1 }, e.options.colHeaderVisible = !1, e.options.rowHeaderVisible = !1, e.options.selectionBackColor = "transparent", e.options.selectionBorderColor = "transparent", e.options.isProtected = !0, e.setColumnCount(8), e.setRowCount(9), t = new n.Style, t.vAlign = 1, t.hAlign = 1, i = 1; i < 8; i++)
                            for (o = 1; o < 7; o++) e.setValue(i, o, "-"), e.setStyle(i, o, t);
                        for (e.setRowHeight(0, 1), e.setRowHeight(8, 10), e.setColumnWidth(0, 3), e.setColumnWidth(7, 10), i = 1; i < 8; i++) e.setRowHeight(i, 14);
                        for (o = 1; o < 7; o++) e.setColumnWidth(o, 17);
                        if (0 === e.tables.all().length)
                            for (s = new n.Tables.TableTheme, a = e.tables.add("table1", 1, 1, 6, 6, s), a.filterButtonVisible(!0), l = 0; l < 7; l++) a.setColumnName(l, "c" + l);
                        e.resumePaint(), setTimeout(function() { c.aw.refresh() }, 0)
                    }, t.prototype.Zv = function() {
                        var e, t = 8;
                        for (e = 1; e <= t; e++) $("<option></option>").val(e).text(e).appendTo(this.Eo.find(".stripe-size-select"));
                        this.Eo.find(".stripe-size-select").attr("size", 1), this.Eo.find(".stripe-size-select").get(0).selectedIndex = 0, this.Eo.find(".stripe-size-block").css("display", "none")
                    }, t.prototype.$v = function() {
                        var e = this;
                        this.Eo.find(".table-element-select").change(function() {
                            var t = e.Eo.find(".stripe-size-block");
                            e._v = e.Eo.find(".table-element-select").find("option:selected").val(), -1 === e._v.indexOf("Strip") ? t.css("display", "none") : t.css("display", "block"), e.bw()
                        }), this.Eo.find(".stripe-size-select").change(function() {
                            var t = e.Eo.find(".stripe-size-select").find("option:selected").val();
                            e.Eo.find(".table-element-select").find("option:selected").attr("strip-size", t), e.cw()
                        }), this.Eo.find(".format-table-element").click(function() {
                            var t, i, o, a, s = e.aw.getActiveSheet(),
                                l = new n.Style;
                            0 !== s.tables.all().length && (t = s.tables.find(2, 2), i = e.Eo.find(".table-element-select").find("option:selected").val(), o = t.style(), (a = o[i]()) && (l.backColor = a.backColor, l.foreColor = a.foreColor, l.font = a.font, l.borderLeft = a.borderLeft, l.borderTop = a.borderTop, l.borderRight = a.borderRight, l.borderBottom = a.borderBottom, l.borderVertical = a.borderVertical, l.borderHorizontal = a.borderHorizontal, l.textDecoration = a.textDecoration)), void 0 === this.dw && (this.dw = new r.FormatDialog), this.dw.open("font", void 0, l, !0, !0), this.dw.selectTabOptions = { font: !0, border: !0, fill: !0 }, this.dw.setFormatDirectly(!1), $(this.dw).on("okClicked", function(t, i) {
                                var o = e.Eo.find(".table-element-select").find("option:selected").val();
                                switch (o) {
                                    case "firstRowStripStyle":
                                        e.Uv = i;
                                        break;
                                    case "secondRowStripStyle":
                                        e.Vv = i;
                                        break;
                                    case "firstColumnStripStyle":
                                        e.Sv = i;
                                        break;
                                    case "secondColumnStripStyle":
                                        e.Tv = i;
                                        break;
                                    default:
                                        e.Rv = i
                                }
                                e.cw()
                            })
                        }), this.Eo.find(".clear-table-element").click(function() {
                            var t, i, o, n = e.aw.getActiveSheet();
                            if (0 !== n.tables.all().length) {
                                switch (n.suspendPaint(), t = n.tables.find(2, 2), i = e.Eo.find(".table-element-select").find("option:selected").val(), o = t.style(), i) {
                                    case "firstRowStripStyle":
                                        e.Uv = null;
                                        break;
                                    case "secondRowStripStyle":
                                        e.Vv = null;
                                        break;
                                    case "firstColumnStripStyle":
                                        e.Sv = null;
                                        break;
                                    case "secondColumnStripStyle":
                                        e.Tv = null;
                                        break;
                                    default:
                                        e.Rv = null
                                }
                                o[i](null), t.style(o), n.resumePaint()
                            }
                        })
                    }, t.prototype.ew = function() { this.Eo.find(".format-table-element").unbind("click"), this.Eo.find(".clear-table-element").unbind("click"), this.Eo.find(".table-element-select").unbind("change"), this.Eo.find(".stripe-size-select").unbind("change") }, t.prototype.bw = function() {
                        var e, t, i = this.aw.getActiveSheet(),
                            o = i.tables.find(2, 2),
                            n = parseInt(this.Eo.find(".stripe-size-select").find("option:selected").val()),
                            r = this.Eo.find(".table-element-select").find("option:selected").val();
                        if (null !== o && "block" === this.Eo.find(".stripe-size-block").css("display")) {
                            switch (t = o.style(), r) {
                                case "firstRowStripStyle":
                                    e = t.firstRowStripSize();
                                    break;
                                case "secondRowStripStyle":
                                    e = t.secondRowStripSize();
                                    break;
                                case "firstColumnStripStyle":
                                    e = t.firstColumnStripSize();
                                    break;
                                case "secondColumnStripStyle":
                                    e = t.secondColumnStripSize()
                            }
                            e !== n && this.Eo.find(".stripe-size-select").val(e)
                        }
                    }, t.prototype.cw = function() {
                        var e, t, i, o, r, a = new n.Tables.TableTheme,
                            s = this.Eo.find(".stripe-size-block"),
                            l = this.aw.getActiveSheet();
                        if (l.suspendPaint(), 0 !== l.tables.all().length) e = l.tables.find(2, 2);
                        else
                            for (e = l.tables.add("table1", 1, 1, 6, 6, a), e.filterButtonVisible(!1), i = 0; i < 7; i++) e.setColumnName(i, "-");
                        if (e.bandColumns(!0), e.bandRows(!0), e.showHeader(!0), e.showFooter(!0), e.highlightFirstColumn(!0), e.highlightLastColumn(!0), o = this.Eo.find(".table-element-select").find("option:selected").val(), "block" === s.css("display")) switch (r = parseInt(this.Eo.find(".stripe-size-select").find("option:selected").val()), o) {
                            case "firstRowStripStyle":
                                this.Uv && (t = this.Es(e, o, this.Uv), t.firstRowStripSize(r));
                                break;
                            case "secondRowStripStyle":
                                this.Vv && (t = this.Es(e, o, this.Vv), t.secondRowStripSize(r));
                                break;
                            case "firstColumnStripStyle":
                                this.Sv && (t = this.Es(e, o, this.Sv), t.firstColumnStripSize(r));
                                break;
                            case "secondColumnStripStyle":
                                this.Tv && (t = this.Es(e, o, this.Tv), t.secondColumnStripSize(r))
                        } else this.Rv && (t = this.Es(e, o, this.Rv));
                        t && e.style(t), l.resumePaint()
                    }, t.prototype.Es = function(e, t, i) { var o, r; return i ? (o = e.style(), r = new n.Tables.TableStyle, r.backColor = i.backColor, r.foreColor = i.foreColor, r.font = i.font, r.borderLeft = i.borderLeft, r.borderTop = i.borderTop, r.borderRight = i.borderRight, r.borderBottom = i.borderBottom, r.borderVertical = i.borderVertical, r.borderHorizontal = i.borderHorizontal, r.textDecoration = i.textDecoration, o[t](r), o) : null }, t.prototype.Qv = function() {
                        var e, i, o, n = this.aw.getActiveSheet(),
                            r = "custom",
                            a = 1,
                            s = n.tables.find(1, 1);
                        if (s) {
                            e = this.Eo.find(".table-style-input").val(), i = s.style(), i.name(e);
                            for (o in t.customTableStyle) a++;
                            e = r + "" + a + "-" + e, t.customTableStyle[e] = i
                        }
                    }, t.prototype.Pv = function() {
                        var e, i = this.Eo.find(".table-style-input").val();
                        for (e in t.customTableStyle)
                            if ((e = e.substring(e.indexOf("-") + 1)) === i) return !0;
                        return !1
                    }, t.prototype.refresh = function() {
                        this.ew(), 0 !== this.Eo.find(".table-element-select").children().length && this.Eo.find(".table-element-select").empty(), 0 !== this.Eo.find(".pre-spread").children().length && this.Eo.find(".pre-spread").empty(),
                            0 !== this.Eo.find(".stripe-size-select").children().length && this.Eo.find(".stripe-size-select").empty(), this._init()
                    }, t.currentId = 1, t.customTableStyle = {}, t
                }(r.BaseDialog), r.FormatTableDialog = g, m = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".resize-table-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: 300, modal: !0, title: r.res.resizeTableDialog.title, buttons: [{ text: r.res.ok, click: function() { e._o(), e.close(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            var t, i, o;
                            e.Qs || (e.Qs = new r.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), e.hide(), t = e.Eo.dialog("option", "title"), i = e.Rs, o = e.Eo.find(".table-source-range").val(), e.Qs.open(t, i, o, [".table-source-range"])
                        })
                    }, t.prototype.Rs = function(e, t) { this.Eo.find(e).val(t) }, t.prototype.Io = function() {
                        var e, t = r.wrapper.spread.getActiveSheet();
                        this.Ov = t, (e = t.tables.find(t.getActiveRowIndex(), t.getActiveColumnIndex())) instanceof n.Tables.Table && this.Eo.find(".table-source-range").val(r.CEUtility.parseRangeToExpString(e.range(), !0))
                    }, t.prototype._o = function() {
                        var e = r.CEUtility.parseExpStringToRanges(this.Eo.find(".table-source-range").val(), this.Ov);
                        e && e.length >= 1 && r.actions.doAction("resizeTable", r.wrapper.spread, e[0])
                    }, t
                }(r.BaseDialog), r.ResizeTableDialog = m, b = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".cell-style-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: "Style", resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.ok() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.Eo.find(".cell-style-format-setting").button(), this.fw() }, t.prototype.Io = function() { this.gw(), this.Os = new n.Style }, t.prototype.gw = function() {
                        var e = "Style " + t.hw;
                        this.Eo.find(".cell-style-name").val(e)
                    }, t.prototype.ok = function() {
                        var e = this.Eo.find(".cell-style-name").val();
                        this.iw(e) ? r.MessageBox.show(r.res.newCellStyleDialog.message, r.res.title, 2) : (this.Os.name = e, t.existedCustomCellStyle[e.toLowerCase()] = this.Os, t.hw++, r.actions.isFileModified = !0, this.close(), r.wrapper.setFocusToSpread())
                    }, t.prototype.iw = function(e) { return !!(e && (e = e.toLowerCase(), t.existedCustomCellStyle.hasOwnProperty(e) || t.buildInCellStyle.hasOwnProperty(e))) }, t.prototype.fw = function() {
                        var e = this;
                        this.Eo.find(".cell-style-format-setting").click(function() { void 0 === e.dw && (e.dw = new r.FormatDialog), e.dw.open("numbers", void 0, e.Os, !0), e.dw.setFormatDirectly(!1), $(e.dw).on("okClicked", function(t, i) { e.Os = i }) })
                    }, t.buildInCellStyle = {}, t.existedCustomCellStyle = {}, t.hw = 1, t
                }(r.BaseDialog), r.CellStyleDialog = b, v = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".pdf-printer-setting-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "450px", modal: !0, title: r.res.fileMenu.printerSettingDialogTitle, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.ok(), e.close() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.jw = [], this.Eo.find(".printer-range-setting-button").button(), this.kw(), this.mw(), this.$v() }, t.prototype.kw = function() {
                        var e, t = r.res.fileMenu.scalingType,
                            i = this.Eo.find(".scaling-type");
                        for (e in t) $("<option></option>").val(e).text(t[e]).appendTo(i)
                    }, t.prototype.mw = function() {
                        var e, t = r.res.fileMenu.duplexMode,
                            i = this.Eo.find(".duplex-mode");
                        for (e in t) $("<option></option>").val(e).text(t[e]).appendTo(i)
                    }, t.prototype.ow = function(e) { this.pw && $(this.pw).css("background-color", ""), this.pw = e, $(this.pw).css("background-color", "#98DDFB") }, t.prototype.$v = function() {
                        var e = this,
                            t = this.Eo.find(".printer-range-table");
                        $(".add-print-range").on("click", function() {
                            var i, o = parseInt(e.Eo.find(".page-range-index").val(), 10),
                                n = parseInt(e.Eo.find(".page-range-count").val(), 10);
                            if (isNaN(o) || isNaN(n) || o < 0 || n <= 0) return void r.MessageBox.show(r.res.fileMenu.addRangeException, r.res.title, 3, 0);
                            i = $("<tr></tr>"), $("<td></td>").text(o).appendTo(i), $("<td></td>").text(n).appendTo(i), i.appendTo(t), $(i).on("click", function() { e.ow(this) }), e.jw.push({ index: o, count: n })
                        }), $(".remove-print-range").on("click", function() {
                            var t, i, o, n, r, a, s;
                            if (e.pw) {
                                if (t = $(e.pw).find("td"), 2 !== $(t).length) return;
                                for (i = $(t[0]).text(), o = $(t[1]).text(), n = e.jw, r = n.length, a = 0; a < r; a++)
                                    if (s = n[a], s.index === parseInt(i, 10) && s.count === parseInt(o, 10)) { n.splice(a, 1); break } $(e.pw).remove()
                            }
                        })
                    }, t.prototype.ok = function() {
                        var e = $(".copies-number").find("option:selected").text(),
                            i = $(".scaling-type").get(0).selectedIndex,
                            o = $(".duplex-mode").get(0).selectedIndex,
                            n = $(".papersource-by-pagesize").prop("checked");
                        t.printerSettings = { scalingType: i, duplexMode: o, isPageSourceByPageSize: n, numberOfCopies: parseInt(e, 10), printRanges: this.jw }
                    }, t.printerSettings = {}, t
                }(r.BaseDialog), r.PDFPrinterDialog = v, y = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".format-comment") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.formatComment.title, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.ok(), e.close() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.qw = ["font", "alignment", "colors", "size", "protection", "properties"], this.rw = "Arial", this.tw = "9pt", this.uw = this.Lv(this.Eo.find(".fill-color-picker"), { type: "comment-fill" }), this.vw = this.Lv(this.Eo.find(".line-color-picker"), { type: "comment-line" }), this.Eo.find(".color-transparent-slider").slider({ range: "min", min: 0, max: 100 }), this.$v() }, t.prototype.Io = function(e) {
                        var t, o;
                        this.ww = r.wrapper.spread, (t = this.ww.getActiveSheet()) && (e.length > 0 && (this.xw = t.comments.get(e[0].row, e[0].col)), this.xw && (this.Eo.find(".main-comment-tab").tabs(), this.Eo.find(".comment-tab-container li").removeClass("hidden"), e.length > 0 && (o = e[0], o.showTabs && this.yw(o.showTabs), o.activeTab && this.zw(o.activeTab)), this.Aw = {}, this.Bw = {}, this.Cw = i, this.Dw ? this.Ew = { left: 0, right: 0, top: 0, bottom: 0 } : (this.Dw = !1, this.Ew = this.Fw()), this.Gw = {}, this.Hw = {}, this.uq = {}, this.Iw(), this.Jw(), this.Kw(), this.Lw(), this.Mw(), this.Nw()))
                    }, t.prototype.Fw = function() {
                        var e = parseFloat(this.Eo.find("#padding-left").val()),
                            t = parseFloat(this.Eo.find("#padding-right").val()),
                            i = parseFloat(this.Eo.find("#padding-top").val()),
                            o = parseFloat(this.Eo.find("#padding-bottom").val());
                        return e = isNaN(e) ? 0 : e, t = isNaN(t) ? 0 : t, i = isNaN(i) ? 0 : i, o = isNaN(o) ? 0 : o, { left: e, right: t, top: i, bottom: o }
                    }, t.prototype.$v = function() {
                        var e = this;
                        this.Eo.find(".comment-font-picker").fontpicker({
                            changed: function(t, i) {
                                switch (i.name) {
                                    case "family":
                                        e.Aw.family = i.value;
                                        break;
                                    case "style":
                                        e.Aw.style = i.value;
                                        break;
                                    case "size":
                                        e.Aw.size = i.value;
                                        break;
                                    case "weight":
                                        e.Aw.weight = i.value;
                                        break;
                                    case "color":
                                        e.Aw.foreColor = i.value;
                                        break;
                                    case "underline":
                                        i.value ? e.Aw.textDecoration |= 1 : e.Aw.textDecoration &= 254;
                                        break;
                                    case "strikethrough":
                                        i.value ? e.Aw.textDecoration |= 2 : e.Aw.textDecoration &= 253
                                }
                            }
                        }), this.Eo.find(".hAlign-select").change(function() { e.Bw.hAlign = $(this).val().toLowerCase() }), this.Eo.find("#auto-size").change(function() { e.Cw = $(this).prop("checked") }), this.Eo.find("#automatic-padding").change(function() { e.Dw = $(this).prop("checked"), e.Dw ? e.Eo.find(".padding-box").val("") : e.Eo.find(".padding-box").val("0"), e.Ew = { left: 0, right: 0, top: 0, bottom: 0 } }), this.Eo.find("#padding-left").spinner({ min: 0, change: function() { e.Ew.left = parseInt($(this).val()), e.Dw = !1, e.Ow(e.Eo.find("#automatic-padding"), e.Dw) } }), this.Eo.find("#padding-right").spinner({ min: 0, change: function() { e.Ew.right = parseInt($(this).val()), e.Dw = !1, e.Ow(e.Eo.find("#automatic-padding"), e.Dw) } }), this.Eo.find("#padding-top").spinner({ min: 0, change: function() { e.Ew.top = parseInt($(this).val()), e.Dw = !1, e.Ow(e.Eo.find("#automatic-padding"), e.Dw) } }), this.Eo.find("#padding-bottom").spinner({ min: 0, change: function() { e.Ew.bottom = parseInt($(this).val()), e.Dw = !1, e.Ow(e.Eo.find("#automatic-padding"), e.Dw) } }), this.Eo.find(".color-transparent-slider").slider({
                            slide: function(t, i) {
                                e.Eo.find("#colors-transparent-input").val(i.value);
                                var o = parseFloat((i.value / 100).toFixed(2));
                                e.Hw.transparency = o, e.Eo.find(".comment-fill").css("opacity", 1 - o)
                            }
                        }), this.Eo.find("#colors-transparent-input").spinner({
                            min: 0,
                            max: 100,
                            change: function() {
                                var t, i = parseInt($(this).val());
                                isNaN(i) || (i < 0 ? (i = 0, $(this).val(i)) : i > 100 && (i = 100, $(this).val(i)), e.Eo.find(".color-transparent-slider").slider({ value: i }), t = parseFloat((i / 100).toFixed(2)), e.Hw.transparency = t, e.Eo.find(".comment-fill").css("opacity", 1 - t))
                            }
                        }), this.Eo.find(".lines-style-select").change(function() { e.Gw.style = $(this).val() }), this.Eo.find(".lines-width").spinner({
                            min: 0,
                            change: function() {
                                var t = parseFloat($(this).val());
                                isNaN(t) || (e.Gw.width = t)
                            }
                        }), this.Eo.find("#comment-size-height").spinner({
                            min: 0,
                            change: function() {
                                var t = parseFloat($(this).val());
                                isNaN(t) || (e.uq.height = t), e.Cw = !1
                            }
                        }), this.Eo.find("#comment-size-width").spinner({
                            min: 0,
                            change: function() {
                                var t = parseFloat($(this).val());
                                isNaN(t) || (e.uq.width = t), e.Cw = !1
                            }
                        }), this.Eo.find("#comment-locked").change(function() { e.Pw = $(this).prop("checked") }), this.Eo.find("#comment-lock-text").change(function() { e.Qw = $(this).prop("checked") }), this.Eo.find("input[type='radio'][name='dynamic-ratio']").change(function() {
                            var t = e.Eo.find("input[type='radio'][name='dynamic-ratio']:checked");
                            switch (t.attr("id")) {
                                case "move-size":
                                    e.Rw = !0, e.Sw = !0;
                                    break;
                                case "move-no-size":
                                    e.Rw = !0, e.Sw = !1;
                                    break;
                                case "no-move-size":
                                    e.Rw = !1, e.Sw = !1
                            }
                        })
                    }, t.prototype.ok = function() { this.Tw(), this.Uw(), this.Vw(), this.Ww(), this.Xw(), this.Yw() }, t.prototype.Tw = function() {
                        var e, t, i;
                        this.xw && ($.isEmptyObject(this.Aw) || (this.Aw.family && (e = this.xw.fontFamily()) !== this.Aw.family && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "fontFamily", oldValue: e, newValue: this.Aw.family }), this.Aw.size && (e = parseFloat(this.xw.fontSize()), t = parseFloat(this.Aw.size), e !== t && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "fontSize", oldValue: e + "pt", newValue: this.Aw.size + "pt" })), this.Aw.weight && (e = this.xw.fontWeight(), this.Aw.weight !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "fontWeight", oldValue: e, newValue: this.Aw.weight })), this.Aw.style && (e = this.xw.fontStyle(), this.Aw.style !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "fontStyle", oldValue: e, newValue: this.Aw.style })), this.Aw.foreColor && (e = this.xw.foreColor(), i = this.Aw.foreColor, "string" == typeof i ? i !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "foreColor", oldValue: e, newValue: i }) : i.color !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "foreColor", oldValue: e, newValue: i.color })), void 0 !== this.Aw.textDecoration && (e = this.xw.textDecoration(), (t = this.Aw.textDecoration) !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "textDecoration", oldValue: e, newValue: this.Aw.textDecoration }))))
                    }, t.prototype.Iw = function() {
                        var e, t, i, o, n, a, s, l;
                        this.xw && (e = this.xw.fontFamily(), t = this.xw.fontSize(), i = this.xw.fontWeight(), o = this.xw.fontStyle(), n = this.xw.foreColor(), a = this.xw.textDecoration(), this.Aw.family = e || this.rw, this.Aw.size = t || this.tw, this.Aw.weight = i || void 0, this.Aw.style = o || void 0, this.Aw.foreColor = n || void 0, this.Aw.textDecoration = a || 0, s = this.Eo.find(".comment-font-picker"), s.fontpicker("family", this.Aw.family), s.fontpicker("style", this.Aw.style ? this.Aw.style : "normal"), l = this.Aw.size, -1 !== l.indexOf("px") && (l = r.util.px2pt(parseInt(l))), s.fontpicker("size", parseInt(l)), s.fontpicker("weight", this.Aw.weight ? this.Aw.weight : "normal"), this.Aw.foreColor ? s.fontpicker("color", r.ColorHelper.parse(this.Aw.foreColor, r.wrapper.spread.getActiveSheet().currentTheme().colors())) : s.fontpicker("color", null), 1 & this.Aw.textDecoration ? s.fontpicker("underline", !0) : s.fontpicker("underline", !1), 2 & this.Aw.textDecoration ? s.fontpicker("strikethrough", !0) : s.fontpicker("strikethrough", !1))
                    }, t.prototype.Uw = function() {
                        var e, t, i;
                        this.xw && (void 0 !== this.Bw.hAlign && (e = this.xw.horizontalAlign(), (t = n.HorizontalAlign[this.Bw.hAlign]) !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "horizontalAlign", oldValue: e, newValue: t })), void 0 !== this.Cw && (e = this.xw.autoSize(), this.Cw !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "autoSize", oldValue: e, newValue: this.Cw })), void 0 !== this.Dw && (e = this.xw.padding(), i = this.Dw ? null : $.isEmptyObject(this.Ew) ? null : new n.Comments.Padding(this.Ew.top, this.Ew.right, this.Ew.bottom, this.Ew.left), this.Zw(e, i) || r.actions.doAction("setCommentProperty", this.ww, { propertyName: "padding", oldValue: e, newValue: i })))
                    }, t.prototype.Zw = function(e, t) { return !e && !t || !(!e || !t || e.left !== t.left || e.right !== t.right || e.top !== t.top || e.bottom !== t.bottom) }, t.prototype.Jw = function() {
                        var e, t, i;
                        this.xw && (e = this.xw.autoSize(), t = this.xw.horizontalAlign(), void 0 !== t && this.$w(this.Eo.find(".hAlign-select"), n.HorizontalAlign[t]), void 0 !== e && this.Ow(this.Eo.find("#auto-size"), e), i = this.xw.padding(), i ? (void 0 !== i.left && (this._w(this.Eo.find("#padding-left"), i.left), this.Dw = !1), void 0 !== i.right && (this._w(this.Eo.find("#padding-right"), i.right), this.Dw = !1), void 0 !== i.top && (this._w(this.Eo.find("#padding-top"), i.top), this.Dw = !1), void 0 !== i.bottom && (this._w(this.Eo.find("#padding-bottom"), i.bottom), this.Dw = !1)) : (this.Dw = !0, this.Eo.find(".padding-box").val("")), this.Ow(this.Eo.find("#automatic-padding"), this.Dw))
                    }, t.prototype.Vw = function() {
                        var e, t, i, o, n, a = this,
                            s = this.xw;
                        s && (e = a.Hw, e.color !== s.backColor() && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "backColor", oldValue: s.backColor(), newValue: e.color }), e.transparency !== 1 - s.opacity() && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "opacity", oldValue: s.opacity(), newValue: 1 - e.transparency }), $.isEmptyObject(this.Gw) || (t = this.xw.borderColor(), this.Gw.colorItem && (i = this.Gw.colorItem.color) !== t && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "borderColor", oldValue: t, newValue: this.Gw.colorItem.color }), o = this.xw.borderStyle(), this.Gw.style && this.Gw.style !== o && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "borderStyle", oldValue: o, newValue: this.Gw.style }), n = this.xw.borderWidth(), this.Gw.width && this.Gw.width !== n && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "borderWidth", oldValue: n, newValue: this.Gw.width })))
                    }, t.prototype.Kw = function() {
                        var e, t, i, o, n, r;
                        this.xw && (e = this.xw.backColor(), t = parseFloat((1 - this.xw.opacity()).toFixed(2)), this.Hw.color = e, this.Hw.transparency = t, this.uw.colorpicker("option", "value", e), this.Eo.find(".comment-fill").css("background-color", e), i = 100 * t, this.Eo.find(".color-transparent-slider").slider("option", "value", i), this.Eo.find("#colors-transparent-input").val(i), o = this.xw.borderColor(), o && (this.vw.colorpicker("option", "value", o), this.Eo.find(".comment-line").css("background-color", o)), n = parseFloat(this.xw.borderWidth().toFixed(2)), isNaN(n) || this.Eo.find(".lines-width").val(n), (r = this.xw.borderStyle()) && this.Eo.find(".lines-style-select").val(r))
                    }, t.prototype.Ww = function() {
                        var e, t;
                        this.xw && (void 0 === this.uq.height || this.Cw || (e = this.xw.height(), this.uq.height !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "height", oldValue: e, newValue: this.uq.height })), void 0 === this.uq.width || this.Cw || (t = this.xw.width(), this.uq.width !== t && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "width", oldValue: t, newValue: this.uq.width })))
                    }, t.prototype.Lw = function() {
                        var e, t;
                        this.xw && (e = this.xw.height(), t = this.xw.width(), void 0 !== e && this.Eo.find("#comment-size-height").val(e), void 0 !== t && this.Eo.find("#comment-size-width").val(t))
                    }, t.prototype.Xw = function() {
                        if (this.xw) {
                            var e;
                            void 0 !== this.Pw && (e = this.xw.locked(), this.Pw !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "locked", oldValue: e, newValue: this.Pw })), void 0 !== this.Qw && (e = this.xw.lockText(), this.Qw !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "lockText", oldValue: e, newValue: this.Qw }))
                        }
                    }, t.prototype.Mw = function() {
                        var e, t;
                        this.xw && (e = this.xw.locked(), t = this.xw.lockText(), void 0 !== e && this.Eo.find("#comment-locked").prop("checked", e), void 0 !== t && this.Eo.find("#comment-lock-text").prop("checked", t))
                    }, t.prototype.Yw = function() {
                        if (this.xw) {
                            var e;
                            void 0 !== this.Rw && (e = this.xw.dynamicMove(), this.Rw !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "dynamicMove", oldValue: e, newValue: this.Rw })), void 0 !== this.Sw && (e = this.xw.dynamicSize(), this.Sw !== e && r.actions.doAction("setCommentProperty", this.ww, { propertyName: "dynamicSize", oldValue: e, newValue: this.Sw }))
                        }
                    }, t.prototype.Nw = function() {
                        var e, t;
                        this.xw && (e = this.xw.dynamicMove(), t = this.xw.dynamicSize(), e && t ? this.Eo.find("#move-size").prop("checked", !0) : e && !t ? this.Eo.find("#move-no-size").prop("checked", !0) : this.Eo.find("#no-move-size").prop("checked", !0))
                    }, t.prototype.yw = function(e) {
                        var t, i, o = this.Eo.find(".comment-tab-container li");
                        o.addClass("hidden");
                        for (t in e) e.hasOwnProperty(t) && -1 !== (i = $.inArray(t, this.qw)) && e[t] && $(o[i]).removeClass("hidden")
                    }, t.prototype.Lv = function(e, t) {
                        var i, o, n, r, a;
                        if (t.type) return i = this, o = $("<div></div>").addClass("colorpicker-container"), n = $("<span></span>").appendTo(o), $("<span></span>").addClass("colorpicker-preview " + t.type).appendTo(n), r = $("<div></div>").addClass("colorpicker-popup").appendTo(o), a = $("<div></div>").colorpicker({
                            valueChanged: function(e, o) {
                                var n = void 0 === o.color ? "transparent" : o.color;
                                switch (i.Eo.find("." + t.type).css("background-color", n), t.type) {
                                    case "comment-fill":
                                        i.Hw.color = o.color;
                                        break;
                                    case "comment-line":
                                        i.Gw.colorItem = o
                                }
                            },
                            choosedColor: function(e, t) { o.comboframe("close") },
                            openColorDialog: function(e, t) { o.comboframe("close") }
                        }).appendTo(r), o.comboframe().click(function() { o.comboframe("open") }), e.append(o), a
                    }, t.prototype.zw = function(e) {
                        switch (e) {
                            case "font":
                                return 0;
                            case "alignment":
                                return 1;
                            case "colors":
                                return 2;
                            case "size":
                                return 3;
                            case "protection":
                                return 4;
                            case "properties":
                                return 5
                        }
                        return 0
                    }, t.prototype.Ow = function(e, t) { var i = this.Eo.find(e);!0 === t ? (i.prop("indeterminate", !1), i.prop("checked", !0)) : !1 === t ? (i.prop("indeterminate", !1), i.prop("checked", !1)) : (i.prop("indeterminate", !0), i.prop("checked", !1)) }, t.prototype.$w = function(e, t) {
                        var i = this.Eo.find(e);
                        t !== r.BaseMetaObject.indeterminateValue ? i.val(t) : i.val(null)
                    }, t.prototype._w = function(e, t) {
                        var i = this.Eo.find(e);
                        void 0 !== t && null !== t ? i.val(t) : i.val(null)
                    }, t.prototype.ax = function(e) { var t, i, o, n, r, a = e.toLowerCase(); return -1 === a.indexOf("rgb") && -1 === a.indexOf("rgba") ? null : (t = e.split(","), 4 === t.length ? (o = t[0].substr(t[0].indexOf("(") + 1), n = t[1], r = t[2], i = t[3].substr(0, t[3].indexOf(")")), [parseFloat(o), parseFloat(n), parseFloat(r), parseFloat(i)]) : 3 === t.length ? (o = t[0].substr(t[0].indexOf("(") + 1), n = t[1], r = t[2].substr(0, t[2].indexOf(")")), [parseFloat(o), parseFloat(n), parseFloat(r)]) : null) }, t
                }(r.BaseDialog), r.FormatCommentDialog = y, w = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".pie-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.pieSparklineDialog.pieSparklineSetting, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.bx = "pie-color-picker-widget", this.ex(!0), this.gx = { color: "#A9A9A9" } }, t.prototype.Io = function(e) {
                        var t, i, o, n, a, s, l, c, d, p, u, h;
                        if (this.Ov = r.wrapper.spread.getActiveSheet(), this.Ov && e[0] && (t = e[0].row, i = e[0].col, o = r.util.parseFormulaSparkline(t, i), o.arguments)) {
                            if (n = o.arguments[0], a = r.util.unParseFormula(n, t, i), this.Eo.find(".pie-percentage").val(a), s = this.Eo.find(".pie-colors-list").children().length, (l = o.arguments.length - 1) > s)
                                for (c = 0; c < l - s; c++) this.Eo.find(".add-pie-color").trigger("click");
                            else if (l < s)
                                for (c = 0; c < s - l; c++) d = this.Eo.find(".remove-pie-color"), d.length > 0 && $(d[0]).trigger("click");
                            if (0 === l) p = r.ColorHelper.parse(this.gx.color, this.Ov.currentTheme().colors()), $(".pie-color-picker1-widget").colorpicker("option", "selectedItem", p), this.Eo.find(".pie-color-picker1").css("background-color", p.color);
                            else
                                for (c = 1; c <= l; c++) { u = null, h = q.parseColorExpression(o.arguments[c], t, i); try { u = r.ColorHelper.parse(h, this.Ov.currentTheme().colors()) } catch (e) {} $(".pie-color-picker" + c + "-widget").colorpicker("option", "selectedItem", u), this.Eo.find(".pie-color-picker" + c).css("background-color", u && u.color ? u.color : "transparent") }
                        }
                    }, t.prototype.Kv = function() {
                        var e, t = $("#formulaBarText");
                        t.length > 0 && (e = this.Ov.getFormula(this.Ov.getActiveRowIndex(), this.Ov.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                    }, t.prototype._o = function() {
                        var e, t, i, o, n = this.Eo.find(".pie-percentage").val(),
                            a = this.Eo.find(".pie-colors-list").children().length,
                            s = [];
                        for (s.push(n), e = 0; e < a; e++) t = e + 1, i = $(".pie-color-picker" + t + "-widget").colorpicker("option").selectedItem, 1 === a && i.baseColor === this.gx.color || i && i.color && s.push(i.color);
                        for (o = "=PIESPARKLINE(" + s[0], e = 1; e < s.length; e++) o += ',"' + s[e] + '"';
                        o += ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: o, dataRange: n, type: 0 }), this.Kv(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.$v = function() {
                        var e = this;
                        this.Eo.find(".add-pie-color").bind("click", function() { e.ex() })
                    }, t.prototype.ex = function(e) {
                        var t, i, o, n, a, s, l, c = this.Eo.find(".add-pie-color");
                        e ? c.addClass("add-pie-color") : c.addClass("remove-pie-color").removeClass("add-pie-color"), t = this.Eo.find(".pie-colors-list"), i = this.hx(), o = $("<div>").addClass("pie-color").data("value", i).appendTo(t), $("<label>").text(r.res.pieSparklineDialog.color + " " + i).addClass("pie-color-column").appendTo(o), n = "pie-color-picker" + i, a = $("<div>").addClass("pie-color-picker").appendTo(o), this.Lv(a, n), s = $("<div>").addClass("add-pie-color").appendTo(o), $("<span>").addClass("ui-icon ui-icon-plus").appendTo(s), l = this, $(s).bind("click", function() { l.ex() }), this.Eo.find(".remove-pie-color").unbind(), this.Eo.find(".remove-pie-color").bind("click", function(e) { l.ix(e) })
                    }, t.prototype.ix = function(e) {
                        var t = this,
                            i = $(e.target).parents("div.pie-color"),
                            o = i.data("value"),
                            n = $(".pie-color-picker" + o + "-widget");
                        n.length > 0 && (n.colorpicker("destroy"), n.parents("div.color-picker-popup").remove()), i && 0 !== i.length && $(e.target).parents("div.pie-color").remove(), t.jx()
                    }, t.prototype.jx = function() {
                        var e, t, i, o, n, a, s = r.res.pieSparklineDialog.color,
                            l = this.Eo.find(".pie-colors-list label"),
                            c = l.length;
                        for (e = 1; e <= c; e++) $(l[e - 1]).text(s + " " + e), t = $(l[e - 1]).parents("div.pie-color"), i = "pie-color-picker" + e, o = t.find("span.color-picker-preview"), o.length > 0 && o.removeClass(o.attr("class")).addClass("color-picker-preview " + i), n = "pie-color-picker" + e + "-widget", a = $("." + this.bx), a.length > 0 && a[e - 1] && $(a[e - 1]).removeClass($(a[e - 1]).attr("class")).addClass(this.bx + " " + n), t.data("value", e)
                    }, t.prototype.Lv = function(e, t) {
                        var i, o, n = this,
                            a = t + "-widget",
                            s = $("<div></div>").addClass("color-picker-container"),
                            l = $("<span></span>").appendTo(s);
                        return $("<span></span>").addClass("color-picker-preview " + t).appendTo(l), i = $("<div></div>").addClass("color-picker-popup").appendTo(s), o = $("<div></div>").colorpicker({
                            valueChanged: function(e, t) {
                                var i = void 0 === t.color ? "transparent" : t.color;
                                n.Eo.find(".pie-color-picker" + n.kx).css("background-color", i)
                            },
                            choosedColor: function(e, t) { s.comboframe("close") },
                            openColorDialog: function(e, t) { s.comboframe("close") }
                        }).addClass(this.bx + " " + a).appendTo(i), o.colorpicker("option", "themeColors", r.wrapper.getThemeColors()), s.comboframe().click(function(e) {
                            s.comboframe("open");
                            var t = $(e.target).parents("div.pie-color");
                            n.kx = t.data("value")
                        }), e.append(s), o
                    }, t.prototype.hx = function() {
                        var e, t, i = r.res.pieSparklineDialog.color,
                            o = this.Eo.find(".pie-colors-list label");
                        for (e = o.length; e > 0; e--)
                            if ((t = $(o[e - 1]).text()) === i + " " + e) return e + 1;
                        return 1
                    }, t
                }(r.BaseDialog), r.PieSparklineDialog = w, x = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".area-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.areaSparklineDialog.areaSparklineSetting, width: "500px", resizable: !1, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._o = function() {
                        var e, t, i, o, n = this.Eo.find(".area-data-range").val(),
                            a = this.Eo.find(".area-min-value").val(),
                            s = this.Eo.find(".area-max-value").val(),
                            l = this.Eo.find(".area-line1-value").val(),
                            c = this.Eo.find(".area-line2-value").val(),
                            d = $(".positive-color-picker").colorpicker("option").selectedItem,
                            p = "";
                        d && d.color && d.baseColor !== this.gx.colorPositive && (p = '"' + d.color + '"'), e = $(".negative-color-picker").colorpicker("option").selectedItem, t = "", e && e.color && e.baseColor !== this.gx.colorNegative && (t = '"' + e.color + '"'), i = [n, a, s, l, c, p, t], o = this.lx(i), r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: o, dataRange: n, type: 1 }), this.Kv(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.lx = function(e) { for (var t, i, o = e.length; o > 0 && "" === e[o - 1];) o--; for (t = "", i = 0; i < o; i++) t += e[i], i !== o - 1 && (t += ","); return "=AREASPARKLINE(" + t + ")" }, t.prototype.Io = function(e) {
                        var t, i, o, n, a, s, l, c, d, p;
                        if (this.Ov = r.wrapper.spread.getActiveSheet(), this.Ov && e[0] && (t = this.mx, i = e[0].row, o = e[0].col, n = r.util.parseFormulaSparkline(i, o), n.arguments)) {
                            for (a = n.arguments, s = t.length, l = 0; l < s; l++) a[l] ? this.Eo.find(t[l]).val(r.util.unParseFormula(a[l], i, o)) : this.Eo.find(t[l]).val("");
                            c = null, d = q.parseColorExpression(a[5], i, o), d || (d = this.gx.colorPositive);
                            try { c = r.ColorHelper.parse(d, this.Ov.currentTheme().colors()) } catch (e) {} $(".positive-color-picker").colorpicker("option", "selectedItem", c), this.Eo.find(".positive-color-span").css("background-color", c.color), p = q.parseColorExpression(a[6], i, o), p || (p = this.gx.colorNegative);
                            try { c = r.ColorHelper.parse(p, this.Ov.currentTheme().colors()) } catch (e) {} $(".negative-color-picker").colorpicker("option", "selectedItem", c), this.Eo.find(".negative-color-span").css("background-color", c.color)
                        }
                    }, t.prototype._init = function() { this.mx = [".area-data-range", ".area-min-value", ".area-max-value", ".area-line1-value", ".area-line2-value"], this.Lv(this.Eo.find(".positive-color"), "positive-color"), this.Lv(this.Eo.find(".negative-color"), "negative-color"), this.gx = { colorPositive: "#787878", colorNegative: "#CB0000" } }, t.prototype.Kv = function() {
                        var e, t = $("#formulaBarText");
                        t.length > 0 && (e = this.Ov.getFormula(this.Ov.getActiveRowIndex(), this.Ov.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                    }, t.prototype.Lv = function(e, t) {
                        var i, o, n, a = this,
                            s = t + "-span",
                            l = $("<div></div>").addClass("area-color-picker-container"),
                            c = $("<span></span>").appendTo(l);
                        $("<span></span>").addClass("area-color-picker-preview " + s).appendTo(c), i = $("<div></div>").addClass("area-color-picker-popup").appendTo(l), o = t + "-picker", n = $("<div></div>").colorpicker({
                            valueChanged: function(e, t) {
                                var i = void 0 === t.color ? "transparent" : t.color;
                                a.Eo.find("." + s).css("background-color", i)
                            },
                            choosedColor: function(e, t) { l.comboframe("close") },
                            openColorDialog: function(e, t) { l.comboframe("close") }
                        }).addClass(o).appendTo(i), n.colorpicker("option", "themeColors", r.wrapper.getThemeColors()), l.comboframe().click(function(e) { l.comboframe("open") }), e.append(l)
                    }, t
                }(r.BaseDialog), r.AreaSparklineDialog = x, C = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".scatter-sparkline-dialog"), this.nx = "ColorValueChanged" }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.scatterSparklineDialog.scatterSparklineSetting, width: "600px", resizable: !1, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.mx = [".scatter-points1", ".scatter-points2", ".scatter-minx", ".scatter-maxx", ".scatter-miny", ".scatter-maxy", ".scatter-hline", ".scatter-vline", ".scatter-xmin-zone", ".scatter-xmax-zone", ".scatter-ymin-zone", ".scatter-ymax-zone"], this.Lv(this.Eo.find(".scatter-color1"), "scatter-color1"), this.Lv(this.Eo.find(".scatter-color2"), "scatter-color2"), this.gx = { tags: !1, drawSymbol: !0, drawLines: !1, dash: !1, color1: "#969696", color2: "#CB0000" }, this.$v() }, t.prototype._o = function() {
                            var e, t, i, o = this.ox,
                                n = "";
                            for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                            n = this.px(n), i = "=SCATTERSPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, dataRange: this.ox[0], type: 2 }), this.Kv(), this.close(), r.wrapper.setFocusToSpread()
                        }, t.prototype.px = function(e) { for (var t = e.length; t > 0 && "," === e[t - 1];) t--; return e.substr(0, t) }, t.prototype.$v = function() {
                            var e = this,
                                t = e.Eo;
                            t.find(".scatter-points1").keyup(function() { e.ox[0] = $(this).val() }), t.find(".scatter-points2").keyup(function() { e.ox[1] = $(this).val() }), t.find(".scatter-minx").keyup(function() { e.ox[2] = $(this).val() }), t.find(".scatter-maxx").keyup(function() { e.ox[3] = $(this).val() }), t.find(".scatter-miny").keyup(function() { e.ox[4] = $(this).val() }), t.find(".scatter-maxy").keyup(function() { e.ox[5] = $(this).val() }), t.find(".scatter-hline").keyup(function() { e.ox[6] = $(this).val() }), t.find(".scatter-vline").keyup(function() { e.ox[7] = $(this).val() }), t.find(".scatter-xmin-zone").keyup(function() { e.ox[8] = $(this).val() }), t.find(".scatter-xmax-zone").keyup(function() { e.ox[9] = $(this).val() }), t.find(".scatter-ymin-zone").keyup(function() { e.ox[10] = $(this).val() }), t.find(".scatter-ymax-zone").keyup(function() { e.ox[11] = $(this).val() }), t.find(".scatter-tags").change(function() { e.ox[12] = $(this).prop("checked") }), t.find(".scatter-drawsymbol").change(function() { e.ox[13] = $(this).prop("checked") }), t.find(".scatter-drawlines").change(function() { e.ox[14] = $(this).prop("checked") }), $(".scatter-point1").bind(this.nx, function(t, i) {
                                var o = i.value && i.value.color ? i.value.color : "transparent";
                                e.ox[15] = '"' + o + '"'
                            }), $(".scatter-point2").bind(this.nx, function(t, i) {
                                var o = i.value && i.value.color ? i.value.color : "tranparent";
                                e.ox[16] = '"' + o + '"'
                            }), t.find(".scatter-dash").change(function() { e.ox[17] = $(this).prop("checked") })
                        }, t.prototype.Io = function(e) {
                            var t, i, n, a, s, l, c, d, p, u, h, f, g, m, b, v;
                            if (this.ox = [], this.Ov = r.wrapper.spread.getActiveSheet(), this.Ov && e[0] && (t = e[0].row, i = e[0].col, n = r.util.parseFormulaSparkline(t, i), n.arguments)) {
                                for (a = n.arguments, s = this.mx, l = s.length, c = 0; c < l; c++) d = "", a[c] && (d = r.util.unParseFormula(a[c], t, i)), this.Eo.find(s[c]).val(d), this.ox.push(d);
                                p = null, u = null, h = null, f = null, a[12] && (p = a[12].type === o.CalcEngine.ExpressionType.boolean ? a[12].value : null), a[13] && (u = a[13].type === o.CalcEngine.ExpressionType.boolean ? a[13].value : null), a[14] && (h = a[14].type === o.CalcEngine.ExpressionType.boolean ? a[14].value : null), g = q.parseColorExpression(a[15], t, i), m = q.parseColorExpression(a[16], t, i), a[17] && (f = a[17].type === o.CalcEngine.ExpressionType.boolean ? a[17].value : null), b = g ? '"' + g + '"' : null, v = m ? '"' + m + '"' : null, this.qx("scatter-tags", null !== p ? p : this.gx.tags), this.qx("scatter-drawsymbol", null !== u ? u : this.gx.drawSymbol), this.qx("scatter-drawlines", null !== h ? h : this.gx.drawLines), this.qx("scatter-dash", null !== f ? f : this.gx.dash), this.sx("scatter-color1", null !== g ? g : this.gx.color1), this.sx("scatter-color2", null !== m ? m : this.gx.color2), this.ox.push(p, u, h, b, v, f)
                            }
                        }, t.prototype.sx = function(e, t) {
                            var i, o = $("." + e + "-picker");
                            if (0 !== o.length)
                                if (t) { i = null; try { i = r.ColorHelper.parse(t, this.Ov.currentTheme().colors()) } catch (e) {} i && i.color && (o.colorpicker("option", "selectedItem", i), this.Eo.find("." + e + "-span").css("background-color", i.color)) } else o.colorpicker("option", "selectedItem", null), this.Eo.find("." + e + "-span").css("background-color", "transparent")
                        }, t.prototype.Lv = function(e, t) {
                            var i, o, n, a = this,
                                s = t + "-span",
                                l = $("<div></div>").addClass("scatter-color-picker-container"),
                                c = $("<span></span>").appendTo(l);
                            $("<span></span>").addClass("scatter-color-picker-preview " + s).appendTo(c), i = $("<div></div>").addClass("scatter-color-picker-popup").appendTo(l), o = t + "-picker", n = $("<div></div>").colorpicker({ valueChanged: function(e, t) { var i = void 0 === t.color ? "transparent" : t.color; "scatter-color1-picker" === e.target.className ? a.ox[15] = '"' + i + '"' : a.ox[16] = '"' + i + '"', a.Eo.find("." + s).css("background-color", i), $(this).trigger(a.nx, { value: t }) }, choosedColor: function(e, t) { l.comboframe("close") }, openColorDialog: function(e, t) { l.comboframe("close") } }).addClass(o).appendTo(i), n.colorpicker("option", "themeColors", r.wrapper.getThemeColors()), l.comboframe().click(function(e) { l.comboframe("open") }), e.append(l)
                        }, t.prototype.Kv = function() {
                            var e, t = $("#formulaBarText");
                            t.length > 0 && (e = this.Ov.getFormula(this.Ov.getActiveRowIndex(), this.Ov.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                        },
                        t.prototype.tx = function(e, t) {
                            var i = this.Eo.find("." + e);
                            void 0 !== t ? i.val(t) : i.val("")
                        }, t.prototype.qx = function(e, t, i) { void 0 !== t ? this.Eo.find("." + e).prop("checked", t) : this.Eo.find("." + e).prop("checked", i) }, t
                }(r.BaseDialog), r.ScatterSparklineDialog = C, S = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".compatible-style-setting") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.compatibleSparklineDialog.styleSetting, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function(e) {
                        if (this.ux = {}, this.Ov = r.wrapper.spread.getActiveSheet(), void 0 !== e[0]) {
                            var t = e[0];
                            this.vx = e[0], this.sx("axis", (t.axisColor ? t.axisColor : t.ac) || this.gx.axis), this.sx("series", (t.seriesColor ? t.seriesColor : t.sc) || this.gx.series), this.sx("markers", (t.markersColor ? t.markersColor : t.mc) || this.gx.markers), this.sx("negative", (t.negativeColor ? t.negativeColor : t.nc) || this.gx.negativePoints), this.sx("first-marker", (t.firstMarkerColor ? t.firstMarkerColor : t.fmc) || this.gx.firstPoint), this.sx("high-marker", (t.highMarkerColor ? t.highMarkerColor : t.hmc) || this.gx.highPoint), this.sx("last-marker", (t.lastMarkerColor ? t.lastMarkerColor : t.lastmc) || this.gx.lastPoint), this.sx("low-marker", (t.lowMarkerColor ? t.lowMarkerColor : t.lowmc) || this.gx.lowPoint), this.tx("compatible-line-weight", t.lineWeight || t.lw)
                        }
                    }, t.prototype._init = function() { this.gx = { negativePoints: "#A52A2A", markers: "#244062", highPoint: "#0000FF", lowPoint: "#0000FF", firstPoint: "#95B3D7", lastPoint: "#95B3D7", series: "#244062", axis: "#000000" }, this.wx = { axiscolor: "ac", firstmarkercolor: "fmc", highmarkercolor: "hmc", lastmarkercolor: "lastmc", lowmarkercolor: "lowmc", markerscolor: "mc", negativecolor: "nc", seriescolor: "sc", lineweight: "lw" }, this.Lv(this.Eo.find(".compatible-axis"), "axis", "axisColor"), this.Lv(this.Eo.find(".compatible-series"), "series", "seriesColor"), this.Lv(this.Eo.find(".compatible-markers"), "markers", "markersColor"), this.Lv(this.Eo.find(".compatible-negative"), "negative", "negativeColor"), this.Lv(this.Eo.find(".compatible-first-marker"), "first-marker", "firstMarkerColor"), this.Lv(this.Eo.find(".compatible-high-marker"), "high-marker", "highMarkerColor"), this.Lv(this.Eo.find(".compatible-last-marker"), "last-marker", "lastMarkerColor"), this.Lv(this.Eo.find(".compatible-low-marker"), "low-marker", "lowMarkerColor"), this.$v() }, t.prototype.sx = function(e, t) {
                        var i, o = $("." + e + "-picker");
                        if (0 !== o.length)
                            if (t) { i = null; try { i = r.ColorHelper.parse(t, this.Ov.currentTheme().colors()) } catch (e) {} i && i.color && (o.colorpicker("option", "selectedItem", i), this.Eo.find("." + e + "-span").css("background-color", i.color)) } else o.colorpicker("option", "selectedItem", null), this.Eo.find("." + e + "-span").css("background-color", "transparent")
                    }, t.prototype.tx = function(e, t) { void 0 !== t ? this.Eo.find("." + e).val(t) : this.Eo.find("." + e).val("") }, t.prototype.$v = function() {
                        var e = this;
                        this.Eo.find(".compatible-line-weight").keyup(function() {
                            var t = e.Eo.find(".compatible-line-weight").val();
                            e.ux.lineWeight = t
                        })
                    }, t.prototype.xx = function() { this.sx("axis", this.gx.axis), this.sx("series", this.gx.series), this.sx("markers", this.gx.markers), this.sx("negative", this.gx.negativePoints), this.sx("first-marker", this.gx.firstPoint), this.sx("high-marker", this.gx.highPoint), this.sx("last-marker", this.gx.lastPoint), this.sx("low-marker", this.gx.lowPoint), this.tx("compatible-line-weight") }, t.prototype._o = function() { $(this).trigger("compatibleStyleOkClick", this.ux), this.xx(), this.close() }, t.prototype.Lv = function(e, t, i) {
                        var o, n, a, s = this,
                            l = t + "-span",
                            c = $("<div></div>").addClass("compatible-color-picker-container"),
                            d = $("<span></span>").appendTo(c);
                        $("<span></span>").addClass("compatible-color-picker-preview " + l).appendTo(d), o = $("<div></div>").addClass("compatible-color-picker-popup").appendTo(c), n = t + "-picker", a = $("<div></div>").colorpicker({
                            valueChanged: function(e, t) {
                                var o, n = void 0 === t.color ? "transparent" : t.color;
                                s.Eo.find("." + l).css("background-color", n), o = s.wx[i.toLowerCase()], void 0 !== s.vx[o] ? s.ux[o] = n : s.ux[i] = n
                            },
                            choosedColor: function(e, t) { c.comboframe("close") },
                            openColorDialog: function(e, t) { c.comboframe("close") }
                        }).addClass(n).appendTo(o), a.colorpicker("option", "themeColors", r.wrapper.getThemeColors()), c.comboframe().click(function(e) { c.comboframe("open") }), e.append(c)
                    }, t
                }(r.BaseDialog), r.CompatibleStyleSettingDialog = S, k = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".compatible-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.compatibleSparklineDialog.compatibleSparklineSetting, width: "580px", resizable: !1, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function(e) {
                        var t, i, o, n, a;
                        this.yx = "", this.zx = {}, this.Ov = r.wrapper.spread.getActiveSheet(), this.Ov && e[0] && (t = e[0].row, i = e[0].col, (o = r.util.parseFormulaSparkline(t, i)) && (o.function.name && (this.yx = o.function.name), o.arguments && o.arguments.length > 0 && (n = o.arguments, this.tx("com-data", r.util.unParseFormula(n[0], t, i)), this.Ax("com-data-orientation", n[1].value), n[2] ? this.tx("com-date-axis-data", r.util.unParseFormula(n[2], t, i)) : this.tx("com-date-axis-data"), n[3] ? this.Ax("com-date-axis-orientation", n[3].value) : this.Ax("com-date-axis-orientation"), a = q.parseColorExpression(n[4], t, i), a && (this.zx = this.Bx(a)), this.Cx(this.zx))))
                    }, t.prototype.Bx = function(e) {
                        var t, i, o, n, r, a = {},
                            s = !1,
                            l = !0,
                            c = "",
                            d = "";
                        if (e) {
                            for (e = e.substr(1, e.length - 2), t = 0, i = e.length; t < i; t++) o = e.charAt(t), ":" === o ? l = !1 : "," !== o || s ? "'" === o || '"' === o || ("(" === o ? s = !0 : ")" === o && (s = !1), l ? c += o : d += o) : (a[c] = d, c = "", d = "", l = !0);
                            c && (a[c] = d);
                            for (n in a) null !== (r = a[n]) && void 0 !== r && ("TRUE" === r.toUpperCase() ? a[n] = !0 : "FALSE" === r.toUpperCase() ? a[n] = !1 : !isNaN(r) && isFinite(r) && (a[n] = parseFloat(r)))
                        }
                        return a
                    }, t.prototype.xx = function() { this.Ax("com-display-emptycell-as", -1), this.qx("com-display-hidden", this.Dx.displayHidden), this.qx("com-show-first", this.Dx.showFirst), this.qx("com-show-last", this.Dx.showLast), this.qx("com-show-high", this.Dx.showHigh), this.qx("com-show-low", this.Dx.showLow), this.qx("com-show-negative", this.Dx.showNegative), this.qx("com-show-markers", this.Dx.showMarkers), this.qx("com-show-markers", this.Dx.showMarkers), this.qx("com-right-to-left", this.Dx.rightToLeft), this.qx("com-display-xaxis", this.Dx.displayXAxis), this.Ax("com-min-axis-type", -1), this.Ax("com-max-axis-type", -1), this.tx("com-manual-max", ""), this.tx("com-manual-min", "") }, t.prototype.Cx = function(e) {
                        if (e) {
                            this.Ax("com-display-emptycell-as", void 0 !== e.displayEmptyCellsAs ? e.displayEmptyCellsAs : e.deca), this.qx("com-display-hidden", void 0 !== e.displayHidden ? e.displayHidden : e.dh, this.Dx.displayHidden), this.qx("com-show-first", void 0 !== e.showFirst ? e.showFirst : e.sf, this.Dx.showFirst), this.qx("com-show-last", void 0 !== e.showLast ? e.showLast : e.slast, this.Dx.showLast), this.qx("com-show-high", void 0 !== e.showHigh ? e.showHigh : e.sh, this.Dx.showHigh), this.qx("com-show-low", void 0 !== e.showLow ? e.showLow : e.slow, this.Dx.showLow), this.qx("com-show-negative", void 0 !== e.showNegative ? e.showNegative : e.sn, this.Dx.showNegative), this.qx("com-show-markers", void 0 !== e.showMarkers ? e.showMarkers : e.sm, this.Dx.showMarkers), this.qx("com-right-to-left", void 0 !== e.rightToLeft ? e.rightToLeft : e.rtl, this.Dx.rightToLeft), this.qx("com-display-xaxis", void 0 !== e.displayXAxis ? e.displayXAxis : e.dxa, this.Dx.displayXAxis), this.Ax("com-min-axis-type", void 0 !== e.minAxisType ? e.minAxisType : e.minat), this.Ax("com-max-axis-type", void 0 !== e.maxAxisType ? e.maxAxisType : e.maxat), this.tx("com-manual-max", void 0 !== e.manualMax ? e.manualMax : e.mmax), this.tx("com-manual-min", void 0 !== e.manualMin ? e.manualMin : e.mmin);
                            var t = this.Eo.find(".com-min-axis-type").val();
                            this.Ex(t, "com-manual-min-label", "com-manual-min"), t = this.Eo.find(".com-max-axis-type").val(), this.Ex(t, "com-manual-max-label", "com-manual-max")
                        }
                    }, t.prototype.Ax = function(e, t) {
                        var i = this.Eo.find("." + e).get(0);
                        void 0 !== t ? (t >= i.length && (t = i.length - 1), i.selectedIndex = t) : i.selectedIndex = -1
                    }, t.prototype.tx = function(e, t) {
                        var i = this.Eo.find("." + e);
                        void 0 !== t ? i.val(t) : i.val("")
                    }, t.prototype.qx = function(e, t, i) { void 0 !== t ? (t = !!t, this.Eo.find("." + e).prop("checked", t)) : this.Eo.find("." + e).prop("checked", i) }, t.prototype.Ex = function(e, t, i) {
                        var o = this.Eo.find("." + i),
                            n = this.Eo.find("." + t);
                        "custom" !== e ? (o.addClass("manual-disable").attr("disabled", "disabled"), n.addClass("manual-disable")) : (o.removeClass("manual-disable").removeAttr("disabled"), n.removeClass("manual-disable"))
                    }, t.prototype._init = function() { this.Eo.find(".com-color-setting").button(), this.Dx = { displayEmptyCellsAs: 0, rightToLeft: !1, displayHidden: !1, displayXAxis: !1, showFirst: !1, showHigh: !1, showLast: !1, showLow: !1, showNegative: !1, showMarkers: !1, manualMax: 0, manualMin: 0, maxAxisType: 0, minAxisType: 0 }, this.wx = { axiscolor: "ac", firstmarkercolor: "fmc", highmarkercolor: "hmc", lastmarkercolor: "lastmc", lowmarkercolor: "lowmc", markerscolor: "mc", negativecolor: "nc", seriescolor: "sc", displayemptycellsas: "deca", righttoleft: "rtl", displayhidden: "dh", displayxaxis: "dxa", showfirst: "sf", showhigh: "sh", showlast: "slast", showlow: "slow", shownegative: "sn", showmarkers: "sm", manualmax: "mmax", manualmin: "mmin", maxaxistype: "maxat", minaxistype: "minat", lineweight: "lw" }, this.Fx || (this.Fx = new S), this.$v() }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".com-color-setting").bind("click", function() { e.Fx.open(e.zx) }), $(this.Fx).bind("compatibleStyleOkClick", function(t, i) { e.zx = $.extend({}, e.zx, i) }), t.find(".com-display-emptycell-as").change(function() {
                            var t = e.zx,
                                i = n.Sparklines.EmptyValueStyle[e.Eo.find(".com-display-emptycell-as").val()];
                            void 0 !== t.deca ? t.deca = i : t.displayEmptyCellsAs = i
                        }), t.find(".com-display-hidden").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-display-hidden").prop("checked");
                            void 0 !== t.dh ? t.dh = i : t.displayHidden = i
                        }), t.find(".com-show-first").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-first").prop("checked");
                            void 0 !== t.sf ? t.sf = i : t.showFirst = i
                        }), t.find(".com-show-last").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-last").prop("checked");
                            void 0 !== t.slast ? t.slast = i : t.showLast = i
                        }), t.find(".com-show-high").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-high").prop("checked");
                            void 0 !== t.sh ? t.sh = i : t.showHigh = i
                        }), t.find(".com-show-low").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-low").prop("checked");
                            t.slow ? t.slow = i : t.showLow = i
                        }), t.find(".com-show-negative").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-negative").prop("checked");
                            void 0 !== t.sn ? t.sn = i : t.showNegative = i
                        }), t.find(".com-show-markers").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-show-markers").prop("checked");
                            void 0 !== t.sm ? t.sm = i : t.showMarkers = i
                        }), t.find(".com-min-axis-type").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-min-axis-type").val();
                            void 0 !== t.minat ? t.minat = n.Sparklines.SparklineAxisMinMax[i] : t.minAxisType = n.Sparklines.SparklineAxisMinMax[i], e.Ex(i, "com-manual-min-label", "com-manual-min")
                        }), t.find(".com-max-axis-type").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-max-axis-type").val();
                            void 0 !== t.maxat ? t.maxat = n.Sparklines.SparklineAxisMinMax[i] : t.maxAxisType = n.Sparklines.SparklineAxisMinMax[i], e.Ex(i, "com-manual-max-label", "com-manual-max")
                        }), t.find(".com-manual-max").keyup(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-manual-max").val();
                            void 0 !== t.mmax ? t.mmax = i : t.manualMax = i
                        }), t.find(".com-manual-min").keyup(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-manual-min").val();
                            void 0 !== t.mmin ? t.mmin = i : t.manualMin = i
                        }), t.find(".com-right-to-left").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-right-to-left").prop("checked");
                            void 0 !== t.rtl ? t.rtl = i : t.rightToLeft = i
                        }), t.find(".com-display-xaxis").change(function() {
                            var t = e.zx,
                                i = e.Eo.find(".com-display-xaxis").prop("checked");
                            void 0 !== t.dxa ? t.dxa = i : t.displayXAxis = i
                        })
                    }, t.prototype._o = function() {
                        var e, t, i, o, a = this.Eo.find(".com-data").val(),
                            s = n.Sparklines.DataOrientation[this.Eo.find(".com-data-orientation").val()],
                            l = this.Eo.find(".com-date-axis-data").val(),
                            c = n.Sparklines.DataOrientation[this.Eo.find(".com-date-axis-orientation").val()];
                        void 0 === c && (c = ""), e = [];
                        for (t in this.zx) void 0 !== this.zx[t] && "" !== this.zx[t] && e.push(t + ":" + this.zx[t]);
                        if (i = "", e.length > 0 && (i = '"{' + e.join(",") + '}"'), o = "", o = "" !== i ? "=" + this.yx + "(" + a + "," + s + "," + l + "," + c + "," + i + ")" : "" !== c ? "=" + this.yx + "(" + a + "," + s + "," + l + "," + c + ")" : "" !== l ? "=" + this.yx + "(" + a + "," + s + "," + l + ")" : "=" + this.yx + "(" + a + "," + s + ")", o.length >= 250) { e = []; for (t in this.zx) void 0 !== this.zx[t] && "" !== this.zx[t] && e.push(this.Gx(t, !0) + ":" + this.Gx(this.zx[t])), i = '"{' + e.join(",") + '}"', o = "=" + this.yx + "(" + a + "," + s + "," + l + "," + c + "," + i + ")" } r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: o, type: 3, dataRange: a }), this.Kv(), this.xx(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.Gx = function(e, t) {
                        var i, o, n, a, s;
                        if (t) return (i = this.wx[e.toLowerCase()]) || e;
                        if (e.length > 9 && (e = e.toLowerCase(), -1 !== e.indexOf("rgb"))) {
                            if ((o = r.util.parseColorString(e)) && o.length > 0)
                                for (n = "#", a = 0; a < o.length; a++) s = o[a].toString(16), 1 === s.length && (s = "0" + s), n += s;
                            if ("#" !== n) return n
                        }
                        return e
                    }, t.prototype.Kv = function() {
                        var e, t = $("#formulaBarText");
                        t.length > 0 && (e = this.Ov.getFormula(this.Ov.getActiveRowIndex(), this.Ov.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                    }, t
                }(r.BaseDialog), r.CompatibleSparklineDialog = k, T = function(e) {
                    r.extends(t, e);

                    function t(t, i) { e.call(this, t, i), this.sheet = r.wrapper.spread.getActiveSheet(), this.colorValueChanged = "ColorValueChanged" }
                    return t.prototype.updateTextBox = function(e, t) {
                        var i = this.Eo.find("." + e);
                        void 0 !== t ? i.val(t) : i.val("")
                    }, t.prototype.updateColorPicker = function(e, t, i) {
                        var o, n = $("." + e);
                        if (0 !== n.length)
                            if (i) { o = null; try { o = r.ColorHelper.parse(i, this.sheet.currentTheme().colors()) } catch (e) {} o && o.color && (n.colorpicker("option", "selectedItem", o), this.Eo.find("." + t).css("background-color", o.color)) } else n.colorpicker("option", "selectedItem", null), this.Eo.find("." + t).css("background-color", "transparent")
                    }, t.prototype.updateCheckBox = function(e, t, i) {
                        var o = t || i;
                        this.Eo.find("." + e).attr("value", o), this.Eo.find("." + e).prop("checked", o).change()
                    }, t.prototype.updateSelect = function(e, t) {
                        var i = this.Eo.find("." + e);
                        void 0 !== t && i.val(t).change()
                    }, t.prototype.removeContinuousComma = function(e) { for (var t = e.length; t > 0 && "," === e[t - 1];) t--; return e.substr(0, t) }, t.prototype.updateFormulaBar = function() {
                        var e, t = $("#formulaBarText");
                        t.length > 0 && (e = this.sheet.getFormula(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())) && (e = "=" + e, t.text(e))
                    }, t.prototype.Rs = function(e, t) {
                        var i = t;
                        0 === t.indexOf("=") && (i = t.substr(1)), this.Eo.find(e).val(i)
                    }, t.prototype.createColorPicker = function(e, t, i) {
                        var o = this;
                        this.Eo.find("." + i).colorpicker({ valueChanged: function(e, i) { void 0 === i.color ? o.Eo.find("." + t).css("background-color", "transparent") : o.Eo.find("." + t).css("background-color", i.color), $(this).trigger(o.colorValueChanged, { value: i }) }, choosedColor: function(t, i) { o.Eo.find("." + e).comboframe("close") }, openColorDialog: function(t, i) { o.Eo.find("." + e).comboframe("close") } }), this.Eo.find("." + i).colorpicker("option", "themeColors", r.wrapper.getThemeColors()), this.Eo.find("." + e).comboframe()
                    }, t
                }(r.BaseDialog), r.SparklineExBaseDialog = T, A = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".barcode-dialog") }
                    var i = { barcodePrivate: { QRCODE: [{ name: "errorCorrectionLevel", type: "select", option: ["L", "M", "Q", "H"] }, { name: "model", type: "select", option: [2, 1] }, { name: "version", type: "select", dependency: 1, option: ["auto", o(1, 14), o(1, 40)], defaultValue: 2 }, { name: "mask", type: "select", option: ["auto", 0, 1, 2, 3, 4, 5, 6, 7] }, { name: "connection", type: "checkbox" }, { name: "connectionNo", type: "select", option: o(0, 15) }, { name: "charCode", type: "input" }, { name: "charset", type: "select", option: ["UTF-8", "Shift_JIS"] }], EAN13: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["top", "bottom"], dependency: 0 }, { name: "addOn", type: "input" }, { name: "addOnLabelPosition", type: "select", option: ["top", "bottom"] }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], EAN8: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["bottom", "top"], dependency: 0 }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], CODABAR: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["bottom", "top"], dependency: 0 }, { name: "checkDigit", type: "checkbox" }, { name: "nwRatio", type: "select", option: [3, 2] }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], CODE39: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["top", "bottom"], dependency: 0 }, { name: "labelWithStartAndStopCharacter", type: "checkbox" }, { name: "checkDigit", type: "checkbox" }, { name: "nwRatio", type: "select", option: [3, 2] }, { name: "fullASCII", type: "checkbox" }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], CODE93: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["bottom", "top"], dependency: 0 }, { name: "checkDigit", type: "checkbox" }, { name: "fullASCII", type: "checkbox" }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], CODE128: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["top", "bottom"], dependency: 0 }, { name: "codeSet", type: "select", option: ["auto", "A", "B", "C"] }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], GS1_128: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["top", "bottom"], dependency: 0 }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], CODE49: [{ name: "showLabel", type: "checkbox", defaultValue: !0 }, { name: "labelPosition", type: "select", option: ["bottom", "top"], dependency: 0 }, { name: "grouping", type: "checkbox" }, { name: "groupNo", type: "input" }, { name: "fontFamily", type: "select", option: ["sans-serif", "serif", "monospace", "Arial", "Verdana", "Times"], dependency: 0 }, { name: "fontStyle", type: "select", option: ["normal", "italic"], dependency: 0 }, { name: "fontWeight", type: "select", option: ["normal", "bold"], dependency: 0 }, { name: "fontTextDecoration", type: "select", option: ["none", "underline", "overline", "line-through"], dependency: 0 }, { name: "fontTextAlign", type: "select", option: ["center", "left", "right", "group"], dependency: 0 }, { name: "fontSize", type: "select", option: ["12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], dependency: 0 }], PDF417: [{ name: "errorCorrectionLevel", type: "select", option: ["auto", 0, 1, 2, 3, 4, 5, 6, 7, 8] }, { name: "rows", type: "select", option: o(3, 90, !0) }, { name: "columns", type: "select", option: o(1, 30, !0) }, { name: "compact", type: "checkbox" }], DATAMATRIX: [{ name: "eccMode", type: "select", option: ["ECC000", "ECC050", "ECC080", "ECC100", "ECC140", "ECC200"] }, { name: "ecc200SymbolSize", type: "select", dependency: 0, dependencyOrder: 5, option: ["squareAuto", "rectangularAuto", "square10", "square12", "square14", "square16", "square18square20", "square22", "square24", "square26", "square32", "square36", "square40", "square44", "square48", "square52", "square64", "square72", "square80", "square88", "square96", "square104", "square120", "square132", "square144", "rectangular8x18", "rectangular8x32", "rectangular12x26", "rectangular12x36", "rectangular16x36", "rectangular16x48"] }, { name: "ecc200EndcodingMode", type: "select", dependency: 0, dependencyOrder: 5, option: ["auto", "ASCII", "C40", "Text", "X12", "EDIFACT", "Base256"] }, { name: "ecc00_140Symbole", type: "select", dependency: 0, dependencyOrder: 4, option: ["auto", "square9", "square11", "square13", "square15", "square17", "square19", "square21", "square23", "square25", "square27", "square29", "square31", "square33", "square35", "square37", "square39", "square41", "square43", "square45", "square47", "square49"] }, { name: "structureAppend", type: "checkbox", dependency: 0, dependencyOrder: 5 }, { name: "structureNumber", type: "select", option: o(0, 15), dependency: 0, dependencyOrder: 5 }, { name: "fileIdentifier", type: "select", option: o(0, 254), dependency: 0, dependencyOrder: 5 }] } };

                    function o(e, t, i) { var o, n = []; for (i && n.push("auto"), o = e; o <= t; o++) n.push(o); return n }
                    return t.prototype.Vp = function(e) {
                        var t, o, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C = this,
                            S = i.barcodePrivate[e],
                            k = S.length;
                        for (0 === $(".barcode-content").children().length && $(".barcode-content").append("<div class = 'barcode-content-left'></div><div class = 'barcode-content-right'></div>"), o = 0; o < k; o++) switch (t = $(".barcode-content-left"), o >= k / 2 && (t = $(".barcode-content-right")), n = S[o], a = n.name, s = n.type, l = r.res.barcodeDialog[a], c = $("<label>"), c.html(l), c.addClass("barcode-label"), t.append(c), void 0 !== n.dependency && (d = S[n.dependency], p = $(".barcode-" + d.name), u = d.type, void 0 !== n.dependencyOrder && (h = d.option[n.dependencyOrder]), f = p.val()), s) {
                            case "input":
                                g = $("<input>"), g.addClass("barcode-" + a), g.addClass("barcode-option"), t.append(g);
                                break;
                            case "checkbox":
                                m = $("<input type = 'checkbox'>"), m.prop("checked", !1), m.addClass("barcode-" + a), m.addClass("barcode-option"), m.attr("value", !1), m.click(function() { $(this).attr("value", $(this).prop("checked")) }), void 0 !== n.dependency && "select" === u && "DATAMATRIX" === C.Hx && "ECC140" !== f && "ECC200" !== f && (m.prop("disabled", "disabled"), this.Ix(n, u, p, h, m)), t.append(m);
                                break;
                            case "select":
                                if (b = $("<select>"), b.addClass("barcode-" + a), b.addClass("barcode-option"), v = n.option, void 0 !== n.dependency) {
                                    if ("checkbox" === u)
                                        for ("false" === f && b.attr("disabled", "disabled"), y = 0; y < v.length; y++) b.append($("<option></option>").val(v[y]).text(v[y]));
                                    else if ("select" === u)
                                        if ("DATAMATRIX" === C.Hx && "ECC140" !== f && "ECC200" !== f && b.attr("disabled", "disabled"), Array.isArray(v[1])) b.append($("<option></option>").val(v[0]).text(v[0]));
                                        else
                                            for (w = 0; w < v.length; w++) b.append($("<option></option>").val(v[w]).text(v[w]));
                                    this.Ix(n, u, p, h, b)
                                } else
                                    for (x = 0; x < v.length; x++) b.append($("<option></option>").val(v[x]).text(v[x]));
                                t.append(b)
                        }
                    }, t.prototype.Ix = function(e, t, i, o, n) {
                        "checkbox" === t ? i.bind("change", function() {
                            var e = i.val();
                            n.attr("disabled", "false" === e)
                        }) : "select" === t && i.bind("change", function() {
                            var t, r, a = i.val();
                            if ("select" === e.type && Array.isArray(e.option[1]) && a)
                                for (t = e.option[a], n.empty(), r = 0; r < t.length; r++) n.append($("<option></option>").val(r).text(r));
                            else void 0 !== o && n.attr("disabled", !(o === a))
                        })
                    }, t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.barcodeDialog.barcodeDialog, width: 620, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Jx = function() {
                        var e, t, i = $(".barcode-type option:selected");
                        this.Hx = i.val(), this.color = null, this.backgroundColor = null, this.updateColorPicker("barcode-color-picker", "barcode-color-span", "rgb(0,0,0)"), this.updateColorPicker("barcode-backgroundcolor-picker", "barcode-backgroundcolor-span", "rgb(255,255,255)"), e = r.wrapper.spread.getActiveSheet(), t = e.getSelections()[0], this.updateTextBox("barcode-locationReference", r.CEUtility.parseRangeToExpString(new GC.Spread.Sheets.Range(t.row, t.col, 1, 1), !0)), this.updateTextBox("barcode-value", ""), this.updateTextBox("barcode-quietZoneLeft", ""), this.updateTextBox("barcode-quietZoneRight", ""), this.updateTextBox("barcode-quietZoneTop", ""), this.updateTextBox("barcode-quietZoneBottom", ""), 0 !== $(".barcode-content-left").children().length && ($(".barcode-content-left").remove(), $(".barcode-content-right").remove(), $(".barcode-content").append('<div class = "barcode-content-left"></div><div class = "barcode-content-right"></div>')), this.Vp(this.Hx)
                    }, t.prototype._init = function() {
                        var e, t, i = this;
                        i.createColorPicker("barcode-color-frame", "barcode-color-span", "barcode-color-picker"), i.createColorPicker("barcode-backgroundcolor-frame", "barcode-backgroundcolor-span", "barcode-backgroundcolor-picker"), i.Eo.dialog("option", "title", r.res.barcodeDialog.barcodeDialog), e = $(".barcode-type"), t = $(".barcode-type option:selected"), i.Hx = t.val(), e.change(function() { i.Jx() }), i.$v(), i.Kx = "rgb(0,0,0)", i.Lx = "rgb(255,255,255)"
                    }, t.prototype.$v = function() {
                        var e, t = this;
                        t.Mx(), $(".barcode-color-picker").bind(t.colorValueChanged, function(i, o) { e = o.value && o.value.color ? o.value.color : "transparent", t.color = e }), $(".barcode-backgroundcolor-picker").bind(t.colorValueChanged, function(i, o) { e = o.value && o.value.color ? o.value.color : "transparent", t.backgroundColor = e })
                    }, t.prototype.Mx = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Gv || (e.Gv = new r.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), e.Qs || (e.Qs = new r.RangeSelectDialog(e, { absoluteReference: !1, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                e.hide();
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                o = e.Eo.find(".barcode-locationReference").val(), e.Gv.open(t, i, o, [".barcode-locationReference"])
                            }
                        })
                    }, t.prototype.Rs = function(e, t) {
                        var i, o, n = t,
                            a = r.wrapper.spread.getActiveSheet();
                        0 === t.indexOf("=") && (n = t.substr(1)), i = r.CEUtility.parseExpStringToRanges(n, a), o = new GC.Spread.Sheets.Range(i[0].row, i[0].col, 1, 1), this.Eo.find(e).val(r.CEUtility.parseRangeToExpString(o, !0))
                    }, t.prototype.Io = function(e) {
                        var t, i, o, n = r.wrapper.spread.getActiveSheet(),
                            a = e[0],
                            s = n.getActiveRowIndex(),
                            l = n.getActiveColumnIndex(),
                            c = r.util.parseFormulaSparkline(s, l);
                        if (a && c && c.arguments) { for (t = c.arguments, i = 0; i < t.length; i++) t[i].getRange && (o = r.util.unParseFormula(t[i], s, l), t[i] = {}, t[i].value = o, t[i].type = "referenceValue"); if (t.length > 0) return void this.Nx(t, c.functionName) } this.Jx()
                    }, t.prototype.Nx = function(e, t) {
                        var o, n, a, s, l, c, d, p = this,
                            u = r.wrapper.spread.getActiveSheet(),
                            h = e.length,
                            f = i.barcodePrivate,
                            g = t.substr(3);
                        if (0 !== $(".barcode-content").children().length && ($(".barcode-content-left").remove(), $(".barcode-content-right").remove()), $(".barcode-content").append('<div class = "barcode-content-left"></div><div class = "barcode-content-right"></div>'), p.Vp(g), o = f[g].length + 7, h < o)
                            for (n = h; n < o; n++) e[n] = {}, e[n].value = "";
                        for (h = e.length, p.updateSelect("barcode-type", g), p.color = e[1].value || p.Kx, p.backgroundColor = e[2].value || p.Lx, p.updateColorPicker("barcode-color-picker", "barcode-color-span", p.color), p.updateColorPicker("barcode-backgroundcolor-picker", "barcode-backgroundcolor-span", p.backgroundColor), p.updateTextBox("barcode-value", e[0].value || ""), a = 3; a < h - 4; a++) s = f[g][a - 3], l = "barcode-" + s.name, c = s.type, "checkbox" === c ? "showLabel" === s.name && void 0 === e[a].value ? p.updateCheckBox(l, s.defaultValue, !1) : p.updateCheckBox(l, e[a].value, !1) : "input" === c ? "object" == typeof e[a].value && e[a].value.array ? p.updateTextBox(l, "{" + e[a].value.array + "}") : p.updateTextBox(l, e[a].value) : "version" === s.name && void 0 === e[a].value ? p.updateSelect(l, s.defaultValue) : p.updateSelect(l, e[a].value);
                        p.updateTextBox("barcode-quietZoneLeft", e[h - 4].value), p.updateTextBox("barcode-quietZoneRight", e[h - 3].value), p.updateTextBox("barcode-quietZoneTop", e[h - 2].value), p.updateTextBox("barcode-quietZoneBottom", e[h - 1].value), d = u.getSelections()[0], p.updateTextBox("barcode-locationReference", r.CEUtility.parseRangeToExpString(new GC.Spread.Sheets.Range(d.row, d.col, 1, 1), !0))
                    }, t.prototype.applySetting = function() {
                        var e, t, i = r.wrapper.spread.getActiveSheet(),
                            o = this.Eo.find(".barcode-locationReference").val(),
                            n = r.CEUtility.parseExpStringToRanges(o, i);
                        if (!n || n.length < 1) return void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0);
                        e = this.Ox(i), t = n[0], r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, { formula: e, locationRange: new GC.Spread.Sheets.Range(t.row, t.col, 1, 1) }), this.close()
                    }, t.prototype.Ox = function(e) {
                        var t, o, n, r, a, s, l, c, d = "",
                            p = [],
                            u = $(".barcode-type option:selected");
                        this.Hx = u.val(), t = i.barcodePrivate[this.Hx], o = e.getActiveRowIndex(), n = e.getActiveColumnIndex(), r = this.Eo.find(".barcode-value").val();
                        try { U(e, r, o, n) && p.push(r) } catch (e) { p.push('"' + r + '"') }
                        for (p.push('"' + (this.color || this.Kx) + '"'), p.push('"' + (this.backgroundColor || this.Lx) + '"'), a = 0; a < t.length; a++) s = ".barcode-" + t[a].name, l = this.Eo.find(s).prop("disabled") ? "" : this.Eo.find(s).val(), /^[0-9]+.?[0-9]*$/.test(l) || null === l || "" === l || "true" === l || "false" === l || -1 !== l.indexOf("{") || (l = '"' + l + '"'), p.push(l);
                        return p.push(this.Eo.find(".barcode-quietZoneLeft").val()), p.push(this.Eo.find(".barcode-quietZoneRight").val()), p.push(this.Eo.find(".barcode-quietZoneTop").val()), p.push(this.Eo.find(".barcode-quietZoneBottom").val()), c = p.join(","), d += "=BC_" + this.Hx.toUpperCase(), d += "(", d += c, d += ")"
                    }, t
                }(T), r.CreateBarcodeDialog = A, E = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".bullet-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.bulletSparklineDialog.bulletSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function() { this.ox = [], this.Px(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.Px = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f, g = r.util.parseFormulaSparkline(e, t);
                        g && g.arguments ? (i = g.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t), a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0, s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0, l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0, p = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0, u = i[7] ? q.parseColorExpression(i[7], e, t) : void 0, i[8] && (h = i[8].type === o.CalcEngine.ExpressionType.boolean ? i[8].value : null), this.updateTextBox("bullet-measure", n), this.updateTextBox("bullet-target", a), this.updateTextBox("bullet-maxi", s), this.updateTextBox("bullet-good", l), this.updateTextBox("bullet-bad", c), this.updateTextBox("bullet-forecast", d), this.updateTextBox("bullet-tickunit", p), this.updateColorPicker("bullet-color-picker", "bullet-color-span", u || this.gx.colorScheme), this.updateCheckBox("bullet-vertical", h, this.gx.vertical), f = u ? '"' + u + '"' : null, this.ox = [n, a, s, l, c, d, p, f, h]) : this.xx()
                    }, t.prototype.xx = function() { this.updateTextBox("bullet-measure", ""), this.updateTextBox("bullet-target", ""), this.updateTextBox("bullet-maxi", ""), this.updateTextBox("bullet-good", ""), this.updateTextBox("bullet-bad", ""), this.updateTextBox("bullet-forecast", ""), this.updateTextBox("bullet-tickunit", ""), this.updateColorPicker("bullet-color-picker", "bullet-color-span", this.gx.colorScheme), this.updateCheckBox("bullet-vertical", this.gx.vertical) }, t.prototype._init = function() { this.gx = { vertical: !1, colorScheme: "#A0A0A0" }, this.createColorPicker("bullet-color-frame", "bullet-color-span", "bullet-color-picker"), this.fw() }, t.prototype.fw = function() {
                        var e = this,
                            t = this.Eo;
                        t.find(".bullet-measure").keyup(function() { e.ox[0] = $(this).val() }), t.find(".bullet-target").keyup(function() { e.ox[1] = $(this).val() }), t.find(".bullet-maxi").keyup(function() { e.ox[2] = $(this).val() }), t.find(".bullet-forecast").keyup(function() { e.ox[5] = $(this).val() }), t.find(".bullet-good").keyup(function() { e.ox[3] = $(this).val() }), t.find(".bullet-bad").keyup(function() { e.ox[4] = $(this).val() }), t.find(".bullet-tickunit").keyup(function() { e.ox[6] = $(this).val() }), $(".bullet-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[7] = '"' + o + '"'
                        }), t.find(".bullet-vertical").change(function() { e.ox[8] = $(this).prop("checked") })
                    }, t.prototype.applySetting = function() {
                        var e, t, i, o, a = this.ox,
                            s = "";
                        for (e = 0; e < a.length; e++) t = a[e], s += void 0 !== t && null !== t ? t + "," : ",";
                        s = this.removeContinuousComma(s), i = "=BULLETSPARKLINE(" + s + ")", o = this.sheet.getSelections(), r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, { formula: i, type: 4, locationRange: o.length > 0 ? o[0] : new n.Range(0, 0, 1, 1) }), r.ribbon.updateSparkline(), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t
                }(T), r.BulletSparklineDialog = E, I = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".spread-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.spreadSparklineDialog.spreadSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { showAverage: !1, style: 4, colorScheme: "#646464", vertical: !1 }, this.createColorPicker("spread-color-frame", "spread-color-span", "spread-color-picker"), this.$v() }, t.prototype.Io = function() { this.ox = [], this.Qx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".spread-points").keyup(function() { e.ox[0] = $(this).val() }), t.find(".spread-style").change(function() { e.ox[4] = $(this).val() }), t.find(".spread-scale-start").keyup(function() { e.ox[2] = $(this).val() }), t.find(".spread-scale-end").keyup(function() { e.ox[3] = $(this).val() }), $(".spread-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[5] = '"' + o + '"'
                        }), t.find(".spread-show-average").change(function() { e.ox[1] = $(this).prop("checked") }), t.find(".spread-vertical").change(function() { e.ox[6] = $(this).prop("checked") })
                    }, t.prototype.Qx = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h = r.util.parseFormulaSparkline(e, t);
                        h && h.arguments && (i = h.arguments, i && i.length > 0 ? (n = r.util.unParseFormula(i[0], e, t), i[1] && (a = i[1].type === o.CalcEngine.ExpressionType.boolean ? i[1].value : null), i[2] && (s = r.util.unParseFormula(i[2], e, t)), i[3] && (l = r.util.unParseFormula(i[3], e, t)), c = i[4] ? r.util.unParseFormula(i[4], e, t) : null, i[5] && (d = q.parseColorExpression(i[5], e, t)), i[6] && (p = i[6].type === o.CalcEngine.ExpressionType.boolean ? i[6].value : null), this.updateTextBox("spread-points", n), this.updateTextBox("spread-scale-start", s), this.updateTextBox("spread-scale-end", l), this.updateColorPicker("spread-color-picker", "spread-color-span", d || this.gx.colorScheme), this.updateCheckBox("spread-show-average", a, this.gx.showAverage), this.updateCheckBox("spread-vertical", p, this.gx.vertical), this.updateSelect("spread-style", c || this.gx.style), u = d ? '"' + d + '"' : null, this.ox = [n, a, s, l, c, u, p]) : this.xx())
                    }, t.prototype.applySetting = function() {
                        var e, t, i, o = this.ox,
                            n = "";
                        for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                        n = this.removeContinuousComma(n), i = "=SPREADSPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, type: 5, dataRange: this.ox[0] }), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.xx = function() { this.updateTextBox("spread-points", ""), this.updateTextBox("spread-scale-start", ""), this.updateTextBox("spread-scale-end", ""), this.updateColorPicker("spread-color-picker", "spread-color-span", this.gx.colorScheme), this.updateCheckBox("spread-show-average", this.gx.showAverage), this.updateCheckBox("spread-vertical", this.gx.vertical), this.updateSelect("spread-style", this.gx.style) }, t
                }(T), r.SpreadSparklineDialog = I, D = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".stacked-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.stackedSparklineDialog.stackedSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { color: "#646464", vertical: !1, textOrientation: 0 }, this.createColorPicker("stacked-color-frame", "stacked-color-span", "stacked-color-picker"), this.$v() }, t.prototype.$v = function() {
                        var e = this,
                            t = this.Eo;
                        t.find(".stacked-points").keyup(function() { e.ox[0] = $(this).val() }), t.find(".stacked-color-range").keyup(function() { e.ox[1] = $(this).val() }), t.find(".stacked-label-range").keyup(function() { e.ox[2] = $(this).val() }), t.find(".stacked-maximum").keyup(function() { e.ox[3] = $(this).val() }), t.find(".stacked-target-red").keyup(function() { e.ox[4] = $(this).val() }), t.find(".stacked-target-green").keyup(function() { e.ox[5] = $(this).val() }), t.find(".stacked-target-blue").keyup(function() { e.ox[6] = $(this).val() }), t.find(".stacked-target-yellow").keyup(function() { e.ox[7] = $(this).val() }), t.find(".stacked-highlight-position").keyup(function() { e.ox[9] = $(this).val() }), t.find(".stacked-vertical").change(function() { e.ox[10] = $(this).prop("checked") }), t.find(".stacked-text-orientation").change(function() { e.ox[11] = $(this).val() }), t.find(".stacked-text-size").keyup(function() { e.ox[12] = $(this).val() }), $(".stacked-color-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[8] = '"' + o + '"'
                        })
                    }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.Rx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.applySetting = function() {
                        var e, t, i, o = this.ox,
                            n = "";
                        for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                        n = this.removeContinuousComma(n), i = "=STACKEDSPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, type: 6, dataRange: this.ox[0] }), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.Rx = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y = r.util.parseFormulaSparkline(e, t);
                        y && y.arguments ? (i = y.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t), a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0, s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0, l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0, p = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0, u = i[7] ? r.util.unParseFormula(i[7], e, t) : void 0, h = i[8] ? q.parseColorExpression(i[8], e, t) : void 0, f = i[9] ? r.util.unParseFormula(i[9], e, t) : void 0, i[10] && (g = i[10].type === o.CalcEngine.ExpressionType.boolean ? i[10].value : null), m = i[11] ? r.util.unParseFormula(i[11], e, t) : void 0, b = i[12] ? r.util.unParseFormula(i[12], e, t) : void 0, this.updateTextBox("stacked-points", n), this.updateTextBox("stacked-color-range", a), this.updateTextBox("stacked-label-range", s), this.updateTextBox("stacked-maximum", l), this.updateTextBox("stacked-target-red", c), this.updateTextBox("stacked-target-green", d), this.updateTextBox("stacked-target-blue", p), this.updateTextBox("stacked-target-yellow", u), this.updateColorPicker("stacked-color-picker", "stacked-color-span", h || this.gx.color), this.updateTextBox("stacked-highlight-position", f), this.updateCheckBox("stacked-vertical", g, this.gx.vertical), this.updateSelect("stacked-text-orientation", m || this.gx.textOrientation), this.updateTextBox("stacked-text-size", b), v = h ? '"' + h + '"' : null, this.ox = [n, a, s, l, c, d, p, u, v, f, g, m, b]) : this.xx()
                    }, t.prototype.xx = function() { this.updateTextBox("stacked-points", ""), this.updateTextBox("stacked-color-range", ""), this.updateTextBox("stacked-label-range", ""), this.updateTextBox("stacked-maximum", ""), this.updateTextBox("stacked-target-red", ""), this.updateTextBox("stacked-target-green", ""), this.updateTextBox("stacked-target-blue", ""), this.updateTextBox("stacked-target-yellow", ""), this.updateColorPicker("stacked-color-picker", "stacked-color-span", this.gx.color), this.updateTextBox("stacked-highlight-position", ""), this.updateCheckBox("stacked-vertical", this.gx.vertical), this.updateTextBox("stacked-text-orientation", this.gx.textOrientation), this.updateTextBox("stacked-text-size", "") }, t
                }(T), r.StackedSparklineDialog = D, L = function(e) {
                    r.extends(t, e);

                    function t(t, i) { e.call(this, t, i) }
                    return t.prototype._init = function() { this.Kx = "gray", this.createColorPicker("barbase-color-frame", "barbase-color-span", "barbase-color-picker"), this.$v() }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.Sx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.Sx = function(e, t) {
                        var i, o, n, a, s = r.util.parseFormulaSparkline(e, t);
                        s && s.arguments ? (i = s.arguments) && i.length > 0 && (o = r.util.unParseFormula(i[0], e, t), n = i[1] ? q.parseColorExpression(i[1], e, t) : void 0, this.updateTextBox("barbase-value", o), this.updateColorPicker("barbase-color-picker", "barbase-color-span", null === n ? this.Kx : n), a = n ? '"' + n + '"' : null, this.ox = [o, a]) : this.xx()
                    }, t.prototype.$v = function() {
                        var e = this,
                            t = this.Eo;
                        t.find(".barbase-value").keyup(function() { e.ox[0] = $(this).val() }), $(".barbase-color-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[1] = '"' + o + '"'
                        })
                    }, t.prototype.xx = function() { this.updateTextBox("barbase-value", ""), this.updateColorPicker("barbase-color-picker", "barbase-color-span", this.Kx) }, t.prototype.applySetting = function(e) {
                        var t, i, o, a, s = this.ox,
                            l = "";
                        for (t = 0; t < s.length; t++) i = s[t], l += void 0 !== i && null !== i ? i + "," : ",";
                        l = this.removeContinuousComma(l), 7 === e ? o = "=HBARSPARKLINE(" + l + ")" : 8 === e && (o = "=VBARSPARKLINE(" + l + ")"), a = this.sheet.getSelections(), r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, { formula: o, type: e, locationRange: a.length > 0 ? a[0] : new n.Range(0, 0, 1, 1) }), r.ribbon.updateSparkline(), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t
                }(T), r.BarBaseSparklineDialog = L, F = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".barbase-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.barbaseSparklineDialog.hbarSparklineSetting, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting(7) } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t
                }(L), r.HbarSparklineDialog = F, R = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".barbase-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.barbaseSparklineDialog.vbarSparklineSetting, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting(8) } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t
                }(L), r.VbarSparklineDialog = R, B = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".vari-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.variSparklineDialog.variSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { legend: !1, colorPositive: "green", colorNegative: "red", vertical: !1 }, this.createColorPicker("vari-negative-color-frame", "vari-negative-color-span", "vari-negative-color-picker"), this.createColorPicker("vari-positive-color-frame", "vari-positive-color-span", "vari-positive-color-picker"), this.$v() }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.Tx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.Tx = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f, g, m, b = r.util.parseFormulaSparkline(e, t);
                        b && b.arguments ? (i = b.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t), a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0, s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0, l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0, i[6] && (p = i[6].type === o.CalcEngine.ExpressionType.boolean ? i[6].value : null), u = i[7] ? q.parseColorExpression(i[7], e, t) : void 0, h = i[8] ? q.parseColorExpression(i[8], e, t) : void 0, i[9] && (f = i[9].type === o.CalcEngine.ExpressionType.boolean ? i[9].value : null), this.updateTextBox("vari-variance", n), this.updateTextBox("vari-reference", a), this.updateTextBox("vari-mini", s), this.updateTextBox("vari-maxi", l), this.updateTextBox("vari-mark", c), this.updateTextBox("vari-tickunit", d), this.updateColorPicker("vari-positive-color-picker", "vari-positive-color-span", u || this.gx.colorPositive), this.updateColorPicker("vari-negative-color-picker", "vari-negative-color-span", h || this.gx.colorNegative), this.updateCheckBox("vari-legend", p), this.updateCheckBox("vari-vertical", f), g = u ? '"' + u + '"' : null, m = h ? '"' + h + '"' : null, this.ox = [n, a, s, l, c, d, p, g, m, f]) : this.xx()
                    }, t.prototype.xx = function() { this.updateTextBox("vari-variance", ""), this.updateTextBox("vari-reference", ""), this.updateTextBox("vari-mini", ""), this.updateTextBox("vari-maxi", ""), this.updateTextBox("vari-mark", ""), this.updateTextBox("vari-tickunit", ""), this.updateColorPicker("vari-positive-color-picker", "vari-positive-color-span", this.gx.colorPositive), this.updateColorPicker("vari-negative-color-picker", "vari-negative-color-span", this.gx.colorNegative), this.updateCheckBox("vari-legend", this.gx.legend), this.updateCheckBox("vari-vertical", this.gx.vertical) }, t.prototype.applySetting = function() {
                        var e, t, i, o, a = this.ox,
                            s = "";
                        for (e = 0; e < a.length; e++) t = a[e], s += void 0 !== t && null !== t ? t + "," : ",";
                        s = this.removeContinuousComma(s), i = "=VARISPARKLINE(" + s + ")", o = this.sheet.getSelections(), r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, { formula: i, type: 4, locationRange: o.length > 0 ? o[0] : new n.Range(0, 0, 1, 1) }), r.ribbon.updateSparkline(), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".vari-variance").keyup(function() { e.ox[0] = $(this).val() }), t.find(".vari-reference").keyup(function() { e.ox[1] = $(this).val() }), t.find(".vari-mini").keyup(function() { e.ox[2] = $(this).val() }), t.find(".vari-maxi").keyup(function() { e.ox[3] = $(this).val() }), t.find(".vari-mark").keyup(function() { e.ox[4] = $(this).val() }), t.find(".vari-tickunit").keyup(function() { e.ox[5] = $(this).val() }), $(".vari-positive-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[7] = '"' + o + '"'
                        }), $(".vari-negative-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[8] = '"' + o + '"'
                        }), t.find(".vari-legend").change(function() { e.ox[6] = $(this).prop("checked") }), t.find(".vari-vertical").change(function() { e.ox[9] = $(this).prop("checked") })
                    }, t
                }(T), r.VariSparklineDialog = B, O = function(e) {
                    r.extends(t, e);

                    function t(t) { e.call(this, W, ".calendar-sparkline-dialog"), this.Ux = t }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.calendarSparklineDialog.calendarSparklineDialog, width: 535, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e, t;
                        if (this.createColorPicker("calendar-emptyColor-frame", "calendar-emptyColor-span", "calendar-emptyColor-picker"), this.createColorPicker("calendar-startColor-frame", "calendar-startColor-span", "calendar-startColor-picker"), this.createColorPicker("calendar-middleColor-frame", "calendar-middleColor-span", "calendar-middleColor-picker"), this.createColorPicker("calendar-endColor-frame", "calendar-endColor-span", "calendar-endColor-picker"), e = this.Eo.find(".calendar-sparkline-month"), 0 === this.Ux)
                            for (t = 1; t < 13; t++) e.append($("<option></option>").val(t).text(t));
                        else e.attr("disabled", "disabled"), e.addClass("disabled");
                        this.$v(), this.Vx(!0), 0 === this.Ux ? this.Eo.dialog("option", "title", r.res.calendarSparklineDialog.monthSparklineDialog) : 1 === this.Ux && this.Eo.dialog("option", "title", r.res.calendarSparklineDialog.yearSparklineDialog), this.Wx = "lightgray", this.Xx = "lightgreen", this.Yx = "green", this.Zx = "darkgreen"
                    }, t.prototype.$v = function() {
                        var e = this;
                        e.Mx(), e.Eo.find(".calendar-sparkline-checkbox").change(function() { e.Vx(!$(this).prop("checked")) }), $(".calendar-emptyColor-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.$x = o
                        }), $(".calendar-startColor-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e._x = o
                        }), $(".calendar-middleColor-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ay = o
                        }), $(".calendar-endColor-picker").bind(e.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.by = o
                        }), e.Eo.find(".calendar-sparkline-year").keyup(function() { this.value = this.value.replace(/\D+/g, "") }), e.Eo.find(".color-picker-container").comboframe().click(function(e) { $(this).comboframe("open") })
                    }, t.prototype.Mx = function() {
                        var e = this;
                        e.Eo.find(".rangeSelectButton").click(function() {
                            if (e.Gv || (e.Gv = new r.RangeSelectDialog(e, { absoluteReference: !0, needSheetName: !1 })), e.Qs || (e.Qs = new r.RangeSelectDialog(e, { absoluteReference: !1, needSheetName: !1 })), "disabled" !== $(this).attr("disabled")) {
                                e.hide();
                                var t = e.Eo.dialog("option", "title"),
                                    i = e.Rs,
                                    o;
                                switch ($(this).data("name")) {
                                    case "data-range":
                                        o = e.Eo.find(".calendar-sparkline-data").val(), e.Qs.open(t, i, o, [".calendar-sparkline-data"]);
                                        break;
                                    case "location-range":
                                        o = e.Eo.find(".calendar-sparkline-location").val(), e.Gv.open(t, i, o, [".calendar-sparkline-location"]);
                                        break;
                                    case "color-range":
                                        o = e.Eo.find(".calendar-sparkline-color").val(), e.Qs.open(t, i, o, [".calendar-sparkline-color"]);
                                        break;
                                    default:
                                        e.show()
                                }
                            }
                        })
                    }, t.prototype.Io = function(e) {
                        var t, i, o, n, a, s, l, c, d, p, u, h, f, g, m, b = this,
                            v = r.wrapper.spread.getActiveSheet();

                        function y() { t = "", i = 1, n = b.Wx, a = b.Xx, s = b.Yx, l = b.Zx, d = !1, o = r.CEUtility.parseRangeToExpString(v.getSelections()[0]), p = "", c = "" } u = e[0], u ? (h = v.getActiveRowIndex(), f = v.getActiveColumnIndex(), g = r.util.parseFormulaSparkline(h, f), g && g.arguments ? (m = g.arguments, m.length > 0 ? (t = r.util.unParseFormula(m[0], h, f), 0 === this.Ux ? (d = 4 === m.length, i = r.util.unParseFormula(m[1], h, f), o = r.util.unParseFormula(m[2], h, f), d ? c = r.util.unParseFormula(m[3], h, f) : (this.$x = n = m[3] && r.util.unParseFormula(m[3], h, f).replace(/"/g, ""), this._x = a = m[4] && r.util.unParseFormula(m[4], h, f).replace(/"/g, ""), this.ay = s = m[5] && r.util.unParseFormula(m[5], h, f).replace(/"/g, ""), this.by = l = m[6] && r.util.unParseFormula(m[6], h, f).replace(/"/g, ""))) : 1 === this.Ux && (d = 3 === m.length, o = r.util.unParseFormula(m[1], h, f), d ? c = r.util.unParseFormula(m[2], h, f) : (this.$x = n = m[2] && r.util.unParseFormula(m[2], h, f).replace(/"/g, ""), this._x = a = m[3] && r.util.unParseFormula(m[3], h, f).replace(/"/g, ""), this.ay = s = m[4] && r.util.unParseFormula(m[4], h, f).replace(/"/g, ""), this.by = l = m[5] && r.util.unParseFormula(m[5], h, f).replace(/"/g, ""))), p = r.CEUtility.parseRangeToExpString(v.getSelections()[0], !0)) : y()) : y()) : y(), this.Nx({ dataRange: o, locationRange: p, year: t, month: i, emptyColor: n, startColor: a, middleColor: s, endColor: l, isRangeColor: d, colorRange: c })
                    }, t.prototype.Nx = function(e) { this.updateTextBox("calendar-sparkline-data", e.dataRange), this.updateTextBox("calendar-sparkline-location", e.locationRange), this.updateTextBox("calendar-sparkline-year", e.year), this.updateTextBox("calendar-sparkline-color", e.colorRange), 0 === this.Ux && this.updateSelect("calendar-sparkline-month", e.month), this.updateColorPicker("calendar-emptyColor-picker", "calendar-emptyColor-span", e.emptyColor), this.updateColorPicker("calendar-startColor-picker", "calendar-startColor-span", e.startColor), this.updateColorPicker("calendar-middleColor-picker", "calendar-middleColor-span", e.middleColor), this.updateColorPicker("calendar-endColor-picker", "calendar-endColor-span", e.endColor), this.Vx(!e.isRangeColor) }, t.prototype.applySetting = function() {
                        var e, t = r.wrapper.spread.getActiveSheet(),
                            i = this.Eo.find(".calendar-sparkline-location").val(),
                            o = r.CEUtility.parseExpStringToRanges(i, t);
                        if (!o || o.length < 1) return void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0);
                        e = this.Ox(), r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, { formula: e, locationRange: o[0] }), this.close()
                    }, t.prototype.Ox = function() {
                        var e, t = "",
                            i = this.Eo.find(".calendar-sparkline-data").val(),
                            o = this.Eo.find(".calendar-sparkline-year").val(),
                            n = this.Eo.find(".calendar-sparkline-month").val(),
                            a = this.$x || this.Wx,
                            s = this._x || this.Xx,
                            l = this.ay || this.Yx,
                            c = this.by || this.Zx,
                            d = this.Eo.find(".calendar-sparkline-checkbox").prop("checked"),
                            p = this.Eo.find(".calendar-sparkline-color").val(),
                            u = [];
                        return u.push(o), 0 === this.Ux && u.push(n), !i || i.length < 1 ? void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0) : (u.push(i), d ? u.push(p) : (u.push('"' + a + '"'), u.push('"' + s + '"'), u.push('"' + l + '"'), u.push('"' + c + '"')), e = u.join(","), 0 === this.Ux ? t += "=MONTHSPARKLINE" : 1 === this.Ux && (t += "=YEARSPARKLINE"), t += "(", t += e, t += ")")
                    }, t.prototype.Vx = function(e) { e ? (this.Eo.find(".calendar-sparkline-checkbox").prop("checked", !1), this.Eo.find(".calendar-sparkline-color").attr("disabled", "disabled"), this.Eo.find(".color-range-button").attr("disabled", "disabled")) : (this.Eo.find(".calendar-sparkline-checkbox").prop("checked", !0), this.Eo.find(".calendar-sparkline-color").removeAttr("disabled", "disabled"), this.Eo.find(".color-range-button").removeAttr("disabled", "disabled")) }, t
                }(T), r.CalendarSparklineDialog = O, P = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".boxplot-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.boxplotSparklineDialog.boxplotSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { boxplotClass: "5ns", style: 0, colorScheme: "#D2D2D2", vertical: !1, showAverage: !1 }, this.createColorPicker("boxplot-color-frame", "boxplot-color-span", "boxplot-color-picker"), this.$v() }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.ey(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()) }, t.prototype.ey = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f, g, m, b, v = r.util.parseFormulaSparkline(e, t);
                        v && v.arguments && (i = v.arguments, i && i.length > 0 ? (n = this.gx, a = r.util.unParseFormula(i[0], e, t), i[1] && (s = i[1].type === o.CalcEngine.ExpressionType.string ? i[1].value : null), i[2] && (l = i[2].type === o.CalcEngine.ExpressionType.boolean ? i[2].value : null), c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, p = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0, u = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0, h = i[7] ? q.parseColorExpression(i[7], e, t) : void 0, f = i[8] ? r.util.unParseFormula(i[8], e, t) : void 0, i[9] && (g = i[9].type === o.CalcEngine.ExpressionType.boolean ? i[9].value : null), this.updateTextBox("boxplot-points", a), this.updateSelect("boxplot-class", null === s ? n.boxplotClass : s), this.updateTextBox("boxplot-scale-start", c), this.updateTextBox("boxplot-scale-end", d), this.updateTextBox("boxplot-acceptable-start", p), this.updateTextBox("boxplot-acceptable-end", u), this.updateColorPicker("boxplot-color-picker", "boxplot-color-span", null === h ? n.colorScheme : h), this.updateSelect("boxplot-style", null === f ? n.style : f), this.updateCheckBox("boxplot-vertical", null === g ? n.vertical : g), this.updateCheckBox("boxplot-show-average", null === l ? n.showAverage : l), m = s ? '"' + s + '"' : null, b = h ? '"' + h + '"' : null, this.ox = [a, m, l, c, d, p, u, b, f, g]) : this.xx())
                    }, t.prototype.xx = function() { this.updateTextBox("boxplot-points", ""), this.updateSelect("boxplot-class", this.gx.boxplotClass), this.updateTextBox("boxplot-scale-start", ""), this.updateTextBox("boxplot-scale-end", ""), this.updateTextBox("boxplot-acceptable-start", ""), this.updateTextBox("boxplot-acceptable-end", ""), this.updateColorPicker("boxplot-color-picker", "boxplot-color-span", this.gx.colorScheme), this.updateSelect("boxplot-style", this.gx.style), this.updateCheckBox("boxplot-vertical", this.gx.vertical), this.updateCheckBox("boxplot-show-average", this.gx.showAverage) }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".boxplot-points").keyup(function() { e.ox[0] = $(this).val() }), t.find(".boxplot-class").change(function() { e.ox[1] = '"' + $(this).val() + '"' }), t.find(".boxplot-scale-start").keyup(function() { e.ox[3] = $(this).val() }), t.find(".boxplot-scale-end").keyup(function() { e.ox[4] = $(this).val() }), t.find(".boxplot-acceptable-start").keyup(function() { e.ox[5] = $(this).val() }), t.find(".boxplot-acceptable-end").keyup(function() { e.ox[6] = $(this).val() }), $(".boxplot-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[7] = '"' + o + '"'
                        }), t.find(".boxplot-style").change(function() { e.ox[8] = $(this).val() }), t.find(".boxplot-show-average").change(function() { e.ox[2] = $(this).prop("checked") }), t.find(".boxplot-vertical").change(function() { e.ox[9] = $(this).prop("checked") })
                    }, t.prototype.applySetting = function() {
                        var e, t, i, o = this.ox,
                            n = "";
                        for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                        n = this.removeContinuousComma(n), i = "=BOXPLOTSPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, type: 10, dataRange: this.ox[0] }), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t
                }(T), r.BoxPlotSparklineDialog = P, N = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".cascade-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.cascadeSparklineDialog.cascadeSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { colorPositive: "#8CBF64", colorNegative: "#D6604D", vertical: !1 }, this.createColorPicker("cascade-positive-color-frame", "cascade-positive-color-span", "cascade-positive-color-picker"), this.createColorPicker("cascade-negative-color-frame", "cascade-negative-color-span", "cascade-negative-color-picker"), this.$v() }, t.prototype.applySetting = function() {
                        var e, t, i, o = this.ox,
                            n = "";
                        for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                        n = this.removeContinuousComma(n), i = "=CASCADESPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, type: 11, dataRange: this.ox[0], parameterSets: this.ox }), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".cascade-points-range").keyup(function() { e.ox[0] = $(this).val() }), t.find(".cascade-point-index").keyup(function() { e.ox[1] = $(this).val() }), t.find(".cascade-mini").keyup(function() { e.ox[3] = $(this).val() }), t.find(".cascade-maxi").keyup(function() { e.ox[4] = $(this).val() }), $(".cascade-positive-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[5] = '"' + o + '"'
                        }), $(".cascade-negative-color-picker").bind(this.colorValueChanged, function(t, i) {
                            var o = i.value && i.value.color ? i.value.color : "transparent";
                            e.ox[6] = '"' + o + '"'
                        }), t.find(".cascade-labels-range").keyup(function() { e.ox[2] = $(this).val() }), t.find(".cascade-vertical").change(function() { e.ox[7] = $(this).prop("checked") })
                    }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.gy(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()), this.hy() }, t.prototype.hy = function() {
                        var e, t = this.sheet.getSelections();
                        t && t.length > 0 && (e = t[0], t.length > 1 || e.rowCount > 1 || e.colCount > 1 ? this.Eo.find(".cascade-point-index").attr("disabled", "disabled") : this.Eo.find(".cascade-point-index").removeAttr("disabled"))
                    }, t.prototype.gy = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f, g, m = r.util.parseFormulaSparkline(e, t);
                        m && m.arguments && (i = m.arguments, i && i.length > 0 ? (n = this.gx, a = r.util.unParseFormula(i[0], e, t), s = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0, l = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0, c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, p = i[5] ? q.parseColorExpression(i[5], e, t) : void 0, u = i[6] ? q.parseColorExpression(i[6], e, t) : void 0, i[7] && (h = i[7].type === o.CalcEngine.ExpressionType.boolean ? i[7].value : null), this.updateTextBox("cascade-points-range", a), this.updateTextBox("cascade-point-index", s), this.updateTextBox("cascade-maxi", d), this.updateTextBox("cascade-mini", c), this.updateTextBox("cascade-labels-range", l), this.updateColorPicker("cascade-positive-color-picker", "cascade-positive-color-span", null === p ? n.colorPositive : p), this.updateColorPicker("cascade-negative-color-picker", "cascade-negative-color-span", null === u ? n.colorNegative : u), this.updateCheckBox("cascade-vertical", null === h ? n.vertical : h), f = u ? '"' + u + '"' : null, g = p ? '"' + p + '"' : null, this.ox = [a, s, l, c, d, g, f, h]) : this.xx())
                    }, t.prototype.xx = function() { this.updateTextBox("cascade-points-range", ""), this.updateTextBox("cascade-point-index", ""), this.updateTextBox("cascade-maxi", ""), this.updateTextBox("cascade-mini", ""), this.updateTextBox("cascade-labels-range", ""), this.updateColorPicker("cascade-positive-color-picker", "cascade-positive-color-span", this.gx.colorPositive), this.updateColorPicker("cascade-negative-color-picker", "cascade-negative-color-span", this.gx.colorNegative), this.updateCheckBox("cascade-vertical", this.gx.vertical) }, t
                }(T), r.CascadeSparklineDialog = N, z = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".pareto-sparkline-dialog") }
                    return t.prototype.Do = function() { var e = this; return { modal: !0, title: r.res.paretoSparklineDialog.paretoSparklineSetting, minWidth: 500, resizable: !1, buttons: [{ text: r.res.ok, click: function() { e.applySetting() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { this.gx = { label: 0, vertical: !1 }, this.$v() }, t.prototype.applySetting = function() {
                        var e, t, i, o = this.ox,
                            n = "";
                        for (e = 0; e < o.length; e++) t = o[e], n += void 0 !== t && null !== t ? t + "," : ",";
                        n = this.removeContinuousComma(n), i = "=PARETOSPARKLINE(" + n + ")", r.actions.doAction("setFormulaSparkline", r.wrapper.spread, { formula: i, type: 12, dataRange: this.ox[0], parameterSets: this.ox }), this.updateFormulaBar(), this.close(), r.wrapper.setFocusToSpread()
                    }, t.prototype.$v = function() {
                        var e = this,
                            t = e.Eo;
                        t.find(".pareto-points").keyup(function() { e.ox[0] = $(this).val() }), t.find(".pareto-point-index").keyup(function() { e.ox[1] = $(this).val() }), t.find(".pareto-color-range").keyup(function() { e.ox[2] = $(this).val() }), t.find(".pareto-target").keyup(function() { e.ox[3] = $(this).val() }), t.find(".pareto-target2").keyup(function() { e.ox[4] = $(this).val() }), t.find(".pareto-highlightPosition").keyup(function() { e.ox[5] = $(this).val() }), t.find(".pareto-label").change(function() { e.ox[6] = $(this).val() }), t.find(".pareto-vertical").change(function() { e.ox[7] = $(this).prop("checked") })
                    }, t.prototype.Io = function() { this.ox = [], this.sheet = r.wrapper.spread.getActiveSheet(), this.iy(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()), this.hy() }, t.prototype.hy = function() {
                        var e, t = this.sheet.getSelections();
                        t && t.length > 0 && (e = t[0], t.length > 1 || e.rowCount > 1 || e.colCount > 1 ? this.Eo.find(".pareto-point-index").attr("disabled", "disabled") : this.Eo.find(".pareto-point-index").removeAttr("disabled"))
                    }, t.prototype.iy = function(e, t) {
                        var i, n, a, s, l, c, d, p, u, h, f = r.util.parseFormulaSparkline(e, t);
                        f && f.arguments && (i = f.arguments, i && i.length > 0 ? (n = this.gx, a = r.util.unParseFormula(i[0], e, t), s = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0, l = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0, c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0, d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0, p = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0, i[6] && (u = i[6].type === o.CalcEngine.ExpressionType.number ? i[6].value : null), i[7] && (h = i[7].type === o.CalcEngine.ExpressionType.boolean ? i[7].value : null), this.updateTextBox("pareto-points", a), this.updateTextBox("pareto-point-index", s), this.updateTextBox("pareto-color-range", l), this.updateTextBox("pareto-highlightPosition", p), this.updateTextBox("pareto-target", c), this.updateTextBox("pareto-target2", d), this.updateSelect("pareto-label", null === u ? n.label : u), this.updateCheckBox("cascade-vertical", null === h ? n.vertical : h), this.ox = [a, s, l, c, d, p, u, h]) : this.xx())
                    }, t.prototype.xx = function() { this.updateTextBox("pareto-points", ""), this.updateTextBox("pareto-point-index", ""), this.updateTextBox("pareto-color-range", ""), this.updateTextBox("pareto-highlightPosition", ""), this.updateTextBox("pareto-target", ""), this.updateTextBox("pareto-target2", ""), this.updateSelect("pareto-label", this.gx.label), this.updateCheckBox("cascade-vertical", this.gx.vertical) }, t
                }(T), r.ParetoSparklineDialog = z, M = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".protection-option") }
                    return t.prototype.Do = function() {
                        var e = this;
                        return {
                            resizable: !1,
                            modal: !0,
                            title: e.jy("title"),
                            width: 250,
                            buttons: [{
                                text: r.res.ok,
                                click: function() {
                                    var i, o, n = {},
                                        a = e.Eo.find("div[class='protection-option-container']").children(),
                                        s = t.itemIDPre.length;
                                    for (i = 0; i < a.length; i++) o = a[i].id.substring(s), e.ky(n, o, a[i].checked);
                                    r.actions.doAction("confirmProtectSheet", r.wrapper.spread, n), e.close(), e._o(), r.wrapper.setFocusToSpread()
                                }
                            }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }]
                        }
                    }, t.prototype.Io = function() {
                        var e, i, o = r.wrapper.spread.getActiveSheet(),
                            n = o.options.protectionOptions,
                            a = this.Eo.find("div[class='protection-option-container']").children(),
                            s = t.itemIDPre.length;
                        for (e = 0; e < a.length; e++) i = a[e].id.substring(s), a[e].checked = this.ly(n, i)
                    }, t.prototype.ly = function(e, t) { var i = e[t]; return void 0 === i ? "allowSelectLockedCells" === t || "allowSelectUnlockedCells" === t : i }, t.prototype.ky = function(e, t, i) { "allowSelectLockedCells" === t || "allowSelectUnlockedCells" === t ? i || (e[t] = !1) : i && (e[t] = !0) }, t.prototype.ny = function() { return ["allowSelectLockedCells", "allowSelectUnlockedCells", "allowSort", "allowFilter", "allowResizeRows", "allowResizeColumns", "allowEditObjects", "allowDragInsertRows", "allowDragInsertColumns", "allowInsertRows", "allowInsertColumns", "allowDeleteRows", "allowDeleteColumns"] }, t.prototype.jy = function(e) { return r.res.protectionOptionDialog ? r.res.protectionOptionDialog[e] : e }, t.prototype._init = function() {
                        var e, i, o, n = this,
                            r = n.Eo.find("div[class='protection-option-container']"),
                            a = n.ny();
                        for (e = 0; e < a.length; e++) i = n.jy(a[e]), o = t.itemIDPre + a[e], r.append($('<input id="' + o + '" type="checkbox"/><label for="' + o + '">' + i + "</label></br>"))
                    }, t.prototype._o = function() {
                        var e = r.wrapper.spread.getActiveSheet();
                        this.oy() && !e.options.protectionOptions.allowEditObjects && r.ribbon.clearSlicerTab()
                    }, t.prototype.oy = function() {
                        var e, t, i = r.wrapper.spread.getActiveSheet(),
                            o = r.util.getSelectedSlicers(i);
                        if (o && 0 !== o.length) {
                            e = !0;
                            for (t in o)
                                if (!(e = o[t].isLocked())) break;
                            return e
                        }
                    }, t.itemIDPre = "protectionOption-", t
                }(r.BaseDialog), r.ProtectionOptionDialog = M, V = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".insert-slicer-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.insertSlicerDialog.insertSlicer, buttons: [{ text: r.res.ok, id: "slicerDialogOK", click: function() { e._o(), e.close(), r.actions.doAction("baseDialogCommand", r.wrapper.spread, { value: { tableName: e.eh.name(), columnsChecked: e.py }, execute: r.spreadActions.dialogAction.insertSlicerForDialog }), r.ribbon.insertTableSlicer(e.eh, e.py), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype.Io = function(e) { this.py = [], this.qy(), $(".insert-slicer-container").empty(), this.eh = e[0], this.sy(this.eh) }, t.prototype._o = function() {
                        var e = this;
                        this.ty.each(function(t) { $(this).prop("checked") && e.py.push(t) }), this.uy.unbind(), this.ty.unbind()
                    }, t.prototype.sy = function(e) {
                        var t, i, o, n, r, a = this,
                            s = $(".insert-slicer-container");
                        for (t = 0; t < this.eh.range().colCount; t++) i = this.eh.getColumnName(t), o = $("<div class='insert-slicer-block'></div>"), o.appendTo(s), n = $("<input type='checkbox' />"), n.appendTo(o), r = $("<label>" + i + "</label>"), r.appendTo(o);
                        this.uy = $(".insert-slicer-block"), this.ty = $(this.uy).find("input"), this.uy.bind("mousedown", function() {
                            var e = $(this).find("input");
                            e.prop("checked") ? e.prop("checked", !1) : e.prop("checked", !0), a.qy()
                        }), this.ty.bind("mousedown", function(e) { e.stopPropagation() }), this.ty.change(function() { a.qy() })
                    }, t.prototype.qy = function() {
                        var e = $("#slicerDialogOK");
                        $(this.uy).find($("input:checked")).length > 0 ? (e.hasClass("insert-slicer-ok") && (e.removeClass("insert-slicer-ok"), e.addClass("ui-state-default")), e.attr("disabled", !1)) : (e.removeClass("ui-state-default"), e.addClass("insert-slicer-ok"), e.attr("disabled", !0))
                    }, t
                }(r.BaseDialog), r.InsertSlicerDialog = V, G = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".slicer-setting-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, title: r.res.slicerSettingDialog.slicerSetting, buttons: [{ text: r.res.ok, click: function() { e._o() } }, { text: r.res.cancel, click: function() { e.close() } }] } }, t.prototype._init = function() {
                        var e = this;
                        $("#hide-item").change(function() { e.vy() }), $("#visually-item").change(function() { e.wy() })
                    }, t.prototype.vy = function() { $("#hide-item").prop("checked") ? ($("#visually-item").attr("disabled", !0), $("#show-item").attr("disabled", !0)) : ($("#visually-item").attr("disabled", !1), $("#visually-item").prop("checked") && $("#show-item").attr("disabled", !1)) }, t.prototype.wy = function() { $("#hide-item").prop("checked") || ($("#visually-item").prop("checked") ? $("#show-item").attr("disabled", !1) : $("#show-item").attr("disabled", !0)) }, t.prototype.Io = function() {
                        var e, t;
                        this.xy(), e = r.wrapper.spread.getActiveSheet(), (t = r.util.getSelectedSlicers(e)) && 0 !== t.length && (t.length > 1 ? ($("#slicer-setting-name").css("color", "#9b6d84"), $("#slicer-name").attr("disabled", !0).css("background-color", "#f0f0f0"), this.yy(t)) : 1 === t.length && ($("#slicer-setting-name").css("color", "#000000"), $("#slicer-name").attr("disabled", !1).css("background-color", "#ffffff"), this.zy(t[0])), this.vy(), this.wy())
                    }, t.prototype._o = function() {
                        var e = [],
                            t = $("#slicer-name").val();
                        e.push(t), e.push($("#display-header").prop("checked")), e.push($("#slicer-caption").val()), e.push($("input[name='item-sort']:checked").val()), e.push($("#hide-item").prop("checked")), e.push($("#visually-item").prop("checked")), e.push($("#show-item").prop("checked")), this.Ay(e)
                    }, t.prototype.Ay = function(e) {
                        var t = r.wrapper.spread,
                            i = t.getActiveSheet(),
                            o = r.util.getSelectedSlicers(i),
                            n = o[0],
                            a = e[0];
                        if (o && 1 === o.length) { if (this.By(t, n.name(), a)) return r.MessageBox.show(r.res.sameSlicerName, r.res.title, 2), !1; if (!a || 0 === a.length) return r.MessageBox.show(r.res.nullSlicerName, r.res.title, 2), !1 } r.actions.doAction("baseDialogCommand", r.wrapper.spread, { value: { slicerSettings: e, selectedSlicers: o }, execute: r.spreadActions.dialogAction.SlicerSettingForDialog }), this.close()
                    }, t.prototype.By = function(e, t, i) {
                        var o, n, r, a, s, l, c = e.getSheetCount();
                        for (t = t.toLowerCase(), i = i.toLowerCase(), n = 0; n < c; n++) {
                            o = e.getSheet(n), r = o.slicers.all();
                            for (a in r)
                                if (s = r[a], l = s.name(), (l = l.toLowerCase()) === i && l !== t) return !0
                        }
                        return !1
                    }, t.prototype.xy = function() { $("#source-name").text(""), $("#slicer-name").val(""), $("#slicer-caption").val(""), $("#display-header").prop("checked", !0), $("#ascending").prop("checked", !0), $("#hide-item").prop("checked", !1), $("#visually-item").prop("checked", !0), $("#show-item").prop("checked", !0) }, t.prototype.zy = function(e) {
                        var t = e;
                        $("#source-name").text(t.sourceName()), $("#slicer-name").val(t.name()), $("#slicer-caption").val(t.captionName()), t.showHeader() ? $("#display-header").prop("checked", !0) : $("#display-header").prop("checked", !1), 1 === t.sortState() ? $("#ascending").prop("checked", !0) : $("#descending").prop("checked", !0), t.showNoDataItems() ? $("#hide-item").prop("checked", !1) : $("#hide-item").prop("checked", !0), t.visuallyNoDataItems() ? $("#visually-item").prop("checked", !0) : $("#visually-item").prop("checked", !1), t.showNoDataItemsInLast() ? $("#show-item").prop("checked", !0) : $("#show-item").prop("checked", !1)
                    }, t.prototype.yy = function(e) {
                        var t, i, o, n, r, a, s, l, c, d;
                        if (e && 0 !== e.length) {
                            t = !1, i = !1, o = !1, n = !1, r = !0, a = !0, s = e[0].sortState(), l = e[0].captionName();
                            for (c in e) d = e[c], t = t || d.showHeader(), i = i || !d.showNoDataItems(), o = o || d.visuallyNoDataItems(), n = n || d.showNoDataItemsInLast(), d.sortState() !== s && (r = !1), d.captionName() !== l && (a = !1);
                            a ? $("#slicer-caption").val(l) : $("#slicer-caption").val(""), t ? $("#display-header").prop("checked", !0) : $("#display-header").prop("checked", !1), i ? $("#hide-item").prop("checked", !0) : $("#hide-item").prop("checked", !1), o ? $("#visually-item").prop("checked", !0) : $("#visually-item").prop("checked", !1), n ? $("#show-item").prop("checked", !0) : $("#show-item").prop("checked", !1), r ? 1 === s ? $("#ascending").prop("checked", !0) : $("#descending").prop("checked", !0) : ($("#ascending").prop("checked", !1), $("#descending").prop("checked", !1))
                        }
                    }, t
                }(r.BaseDialog), r.SlicerSettingDialog = G, j = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".slicer-style-dialog") } t.prototype.Do = function() { var e = this; return { width: 600, modal: !0, title: r.res.formatSlicerStyle.slicerStyle, buttons: [{ text: r.res.ok, click: function() { e.Cy() ? r.MessageBox.show(r.res.formatSlicerStyle.exception, r.res.title, 2) : (t.currentId++, e.Qv(), r.actions.isFileModified = !0, e.close(), r.wrapper.setFocusToSpread()) } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() {
                        var e = "- - - -";
                        $(".slicer-pre-style").find("span").text(e), $(".slicer-pre-style").attr("style", ""), $("#slicer-pre-header").attr("style", ""), $("#selected-item-data").attr("style", ""), $("#selected-item-no-data").attr("style", ""), $("#unselected-item-data").attr("style", ""), $("#unselected-item-no-data").attr("style", ""), $("#hovered-selected-item-data").attr("style", ""), $("#hovered-selected-item-no-data").attr("style", ""), $("#hovered-unselected-item-data").attr("style", ""), $("#hovered-unselected-item-no-data").attr("style", ""), $(".slicer-pre-style").find("span").css("text-decoration", "none"), this.Dy = this.Eo.find(".slicer-element-select"), this.Ey = this.Eo.find(".format-slicer-element"), this.Fy = this.Eo.find(".clear-slicer-element"), this.Gy = new GC.Spread.Sheets.Slicers.SlicerStyle, this.Hy = new GC.Spread.Sheets.Style, this.Iy = new GC.Spread.Sheets.Style, this.Jy = new GC.Spread.Sheets.Style, this.Ky = new GC.Spread.Sheets.Style, this.Ly = new GC.Spread.Sheets.Style, this.My = new GC.Spread.Sheets.Style, this.Ny = new GC.Spread.Sheets.Style, this.Oy = new GC.Spread.Sheets.Style, this.Py = new GC.Spread.Sheets.Style, this.Qy = new GC.Spread.Sheets.Style, this.Ry(), this.Sy(), this.$v()
                    }, t.prototype.Ry = function() {
                        var e = r.res.formatSlicerStyle.slicerStyle + " " + t.currentId;
                        this.Eo.find(".slicer-style-input").val(e)
                    }, t.prototype.Sy = function() {
                        var e, t = r.res.slicerElement;
                        for (e in t) $("<option></option>").attr("strip-size", 1).val(e).text(t[e]).appendTo(this.Dy);
                        this.Dy.attr("size", 8), this.Dy.get(0).selectedIndex = 0
                    };
                    var i = { 9: 1, 1: 1, 3: 1, 4: 1, 7: 1, 11: 1, 2: 2, 10: 2, 12: 2, 8: 2, 13: 2, 5: 3, 6: 3 };
                    return t.prototype.Ty = function(e) { var t = new GC.Spread.Sheets.Slicers.SlicerBorder; return e ? (t.borderColor(e.color), t.borderStyle(this.Uy(e.style)), t.borderWidth(i[e.style]), t) : null }, t.prototype.Uy = function(e) {
                        if (e) switch (e) {
                            case 6:
                                return "double";
                            case 9:
                            case 11:
                            case 4:
                            case 13:
                            case 10:
                            case 12:
                                return "dotted";
                            case 2:
                            case 3:
                            case 8:
                                return "dashed";
                            default:
                                return "solid"
                        }
                        return "solid"
                    }, t.prototype.$v = function() {
                        var e = this;
                        this.Ey.click(function() {
                            var t = new n.Style;
                            t = e.Vy(t), void 0 === e.dw && (e.dw = new r.FormatDialog), e.dw.open("font", void 0, t, !0), e.dw.selectTabOptions = { font: !0, border: !0, fill: !0 }, e.dw.setFormatDirectly(!1), $(e.dw).on("okClicked", function(t, i) { e.cw(i) })
                        }), this.Fy.click(function() { e.Wy() })
                    }, t.prototype.ew = function() { this.Ey.unbind("click"), this.Fy.unbind("click") }, t.prototype.Wy = function() {
                        var e = new GC.Spread.Sheets.Slicers.SlicerStyleInfo,
                            t = this.Dy.find("option:selected").val();
                        switch (t) {
                            case "wholeSlicer":
                                this.Hy = new GC.Spread.Sheets.Style, this.Xy(), this.Gy.wholeSlicerStyle(e);
                                break;
                            case "header":
                                this.Iy = new GC.Spread.Sheets.Style, this.Yy($("#slicer-pre-header")), this.Gy.headerStyle(e);
                                break;
                            case "selectedItemWithData":
                                this.Jy = new GC.Spread.Sheets.Style, this.Yy($("#selected-item-data")), this.Gy.selectedItemWithDataStyle(e);
                                break;
                            case "selectedItemWithNoData":
                                this.Ky = new GC.Spread.Sheets.Style, this.Yy($("#selected-item-no-data")), this.Gy.selectedItemWithNoDataStyle(e);
                                break;
                            case "unselectedItemWithData":
                                this.Ly = new GC.Spread.Sheets.Style, this.Yy($("#unselected-item-data")), this.Gy.unSelectedItemWithDataStyle(e);
                                break;
                            case "unselectedItemWithNoData":
                                this.My = new GC.Spread.Sheets.Style, this.Yy($("#unselected-item-no-data")), this.Gy.unSelectedItemWithNoDataStyle(e);
                                break;
                            case "hoveredSelectedItemWithData":
                                this.Ny = new GC.Spread.Sheets.Style, this.Yy($("#hovered-selected-item-data")), this.Gy.hoveredSelectedItemWithDataStyle(e);
                                break;
                            case "hoveredSelectedItemWithNoData":
                                this.Oy = new GC.Spread.Sheets.Style, this.Yy($("#hovered-selected-item-no-data")), this.Gy.hoveredSelectedItemWithNoDataStyle(e);
                                break;
                            case "hoveredUnselectedItemWithData":
                                this.Py = new GC.Spread.Sheets.Style, this.Yy($("#hovered-unselected-item-data")), this.Gy.hoveredUnSelectedItemWithDataStyle(e);
                                break;
                            case "hoveredUnselectedItemWithNoData":
                                this.Qy = new GC.Spread.Sheets.Style, this.Yy($("#hovered-unselected-item-no-data")), this.Gy.hoveredUnSelectedItemWithNoDataStyle(e)
                        }
                    }, t.prototype.Xy = function() {
                        var e, t = $(".slicer-pre-style");
                        t.removeAttr("style"), t.find("span").css("text-decoration", "none"), e = this.Gy.headerStyle(), e && this.Zy($("#slicer-pre-header"), e.textDecoration()), e = this.Gy.selectedItemWithDataStyle(), e && this.Zy($("#selected-item-data"), e.textDecoration()), e = this.Gy.selectedItemWithNoDataStyle(), e && this.Zy($("#selected-item-no-data"), e.textDecoration()), e = this.Gy.unSelectedItemWithDataStyle(), e && this.Zy($("#unselected-item-data"), e.textDecoration()), e = this.Gy.unSelectedItemWithNoDataStyle(), e && this.Zy($("#unselected-item-no-data"), e.textDecoration()), e = this.Gy.hoveredSelectedItemWithDataStyle(), e && this.Zy($("#hovered-selected-item-data"), e.textDecoration()), e = this.Gy.hoveredSelectedItemWithNoDataStyle(), e && this.Zy($("#hovered-selected-item-no-data"), e.textDecoration()), e = this.Gy.hoveredUnSelectedItemWithDataStyle(), e && this.Zy($("#hovered-unselected-item-data"), e.textDecoration()), (e = this.Gy.hoveredUnSelectedItemWithNoDataStyle()) && this.Zy($("#hovered-unselected-item-no-data"), e.textDecoration())
                    }, t.prototype.Yy = function(e) {
                        e.removeAttr("style");
                        var t = this.Gy.wholeSlicerStyle();
                        t && this.Zy(e, t.textDecoration())
                    }, t.prototype.Vy = function(e) {
                        var t = this.Dy.find("option:selected").val();
                        switch (t) {
                            case "wholeSlicer":
                                e = this.Hy;
                                break;
                            case "header":
                                e = this.Iy;
                                break;
                            case "selectedItemWithData":
                                e = this.Jy;
                                break;
                            case "selectedItemWithNoData":
                                e = this.Ky;
                                break;
                            case "unselectedItemWithData":
                                e = this.Ly;
                                break;
                            case "unselectedItemWithNoData":
                                e = this.My;
                                break;
                            case "hoveredSelectedItemWithData":
                                e = this.Ny;
                                break;
                            case "hoveredSelectedItemWithNoData":
                                e = this.Oy;
                                break;
                            case "hoveredUnselectedItemWithData":
                                e = this.Py;
                                break;
                            case "hoveredUnselectedItemWithNoData":
                                e = this.Qy
                        }
                        return e
                    }, t.prototype.cw = function(e) {
                        var t, i, o, n, r = new GC.Spread.Sheets.Slicers.SlicerStyleInfo,
                            a = this.Dy.find("option:selected").val();
                        if (e) switch (r.backColor(e.backColor), r.foreColor(e.foreColor), r.font(e.font), r.textDecoration(e.textDecoration), t = this.Ty(e.borderLeft), i = this.Ty(e.borderTop), o = this.Ty(e.borderRight), n = this.Ty(e.borderBottom), t && r.borderLeft(t), i && r.borderTop(i), o && r.borderRight(o), n && r.borderBottom(n), a) {
                            case "wholeSlicer":
                                this.Hy = e, this.$y($(".slicer-pre-style"), e), this.Gy.wholeSlicerStyle(r);
                                break;
                            case "header":
                                this.Iy = e, this.$y($("#slicer-pre-header"), e), this.Gy.headerStyle(r);
                                break;
                            case "selectedItemWithData":
                                this.Jy = e, this.$y($("#selected-item-data"), e), this.Gy.selectedItemWithDataStyle(r);
                                break;
                            case "selectedItemWithNoData":
                                this.Ky = e, this.$y($("#selected-item-no-data"), e), this.Gy.selectedItemWithNoDataStyle(r);
                                break;
                            case "unselectedItemWithData":
                                this.Ly = e, this.$y($("#unselected-item-data"), e), this.Gy.unSelectedItemWithDataStyle(r);
                                break;
                            case "unselectedItemWithNoData":
                                this.My = e, this.$y($("#unselected-item-no-data"), e), this.Gy.unSelectedItemWithNoDataStyle(r);
                                break;
                            case "hoveredSelectedItemWithData":
                                this.Ny = e, this.$y($("#hovered-selected-item-data"), e), this.Gy.hoveredSelectedItemWithDataStyle(r);
                                break;
                            case "hoveredSelectedItemWithNoData":
                                this.Oy = e, this.$y($("#hovered-selected-item-no-data"), e), this.Gy.hoveredSelectedItemWithNoDataStyle(r);
                                break;
                            case "hoveredUnselectedItemWithData":
                                this.Py = e, this.$y($("#hovered-unselected-item-data"), e), this.Gy.hoveredUnSelectedItemWithDataStyle(r);
                                break;
                            case "hoveredUnselectedItemWithNoData":
                                this.Qy = e, this.$y($("#hovered-unselected-item-no-data"), e), this.Gy.hoveredUnSelectedItemWithNoDataStyle(r)
                        }
                    }, t.prototype.$y = function(e, t) {
                        var i, o, n, r, a = this._y(t.backColor),
                            s = this._y(t.foreColor),
                            l = t.borderLeft,
                            c = t.borderTop,
                            d = t.borderRight,
                            p = t.borderBottom,
                            u = t.textDecoration;
                        a && e.css("background-color", a), s && e.css("color", s), l && (i = this._y(t.borderLeft.color)) && e.css("border-left", "1px solid" + i), c && (o = this._y(t.borderTop.color)) && e.css("border-top", "1px solid" + o), d && (n = this._y(t.borderRight.color)) && e.css("border-right", "1px solid" + n), p && (r = this._y(t.borderBottom.color)) && e.css("border-bottom", "1px solid" + r), this.Zy(e, u)
                    }, t.prototype.Zy = function(e, t) { e.find("span").length > 0 && (e = e.find("span")), 2 === t ? e.css("text-decoration", "line-through") : 1 === t ? e.css("text-decoration", "underline") : 3 === t && e.css("text-decoration", "line-through underline") }, t.prototype._y = function(e) { var t, i, o; return e && 0 !== e.length ? (t = r.wrapper.spread, i = t.getActiveSheet(), o = i.currentTheme(), o ? o.getColor(e) : null) : null }, t.prototype.Cy = function() {
                        var e, i = this.Eo.find(".slicer-style-input").val();
                        for (e in t.customSlicerStyle)
                            if ((e = e.substring(e.indexOf("-") + 1)) === i) return !0;
                        return !1
                    }, t.prototype.Qv = function() {
                        var e, i = "custom",
                            o = 1,
                            n = this.Eo.find(".slicer-style-input").val();
                        this.Gy.name(n);
                        for (e in t.customSlicerStyle) o++;
                        n = i + "" + o + "-" + n, t.customSlicerStyle[n] = this.Gy
                    }, t.prototype.refresh = function() { this.ew(), 0 !== this.Dy.children().length && this.Dy.empty(), this._init() }, t.currentId = 1, t.customSlicerStyle = {}, t
                }(r.BaseDialog), r.SlicerStyleDialog = j, H = function(e) {
                    r.extends(t, e);

                    function t() { e.call(this, W, ".format-slicer-dialog") }
                    return t.prototype.Do = function() { var e = this; return { width: "auto", modal: !0, resizable: !1, title: r.res.slicerPropertyDialog.formatSlicer, buttons: [{ text: r.res.ok, click: function() { e.close(), e._o(), r.wrapper.setFocusToSpread() } }, { text: r.res.cancel, click: function() { e.close(), r.wrapper.setFocusToSpread() } }] } }, t.prototype._init = function() { $(".slicer-property-tab > ul").css("margin-top", "0px"), this.az = this.Eo.find("#slicer-layout-item-width"), this.bz = this.Eo.find("#slicer-size-width"), this.cz = this.Eo.find("#slicer-size-scale-width"), this.dz = this.Eo.find("#slicer-size-height"), this.ez = this.Eo.find("#slicer-size-scale-height"), this.fz = this.Eo.find("#slicer-disable-resize"), this.gz = this.Eo.find("#slicer-layout-column-count") }, t.prototype.Io = function() {
                        var e = r.wrapper.spread.getActiveSheet();
                        this.hz = !0, this.iz = !0, this.jz = !0, this.kz = r.util.getSelectedSlicers(e), this.kz && 0 !== this.kz.length && (this.lz(), this.kz.length > 1 ? this.mz(this.kz) : 1 === this.kz.length && this.nz(this.kz[0]), $("#slicer-size-scale-height").val("100"), $("#slicer-size-scale-width").val("100"))
                    }, t.prototype._o = function() {
                        var e, t, i, o, n, a, s, l, c, d, p, u;
                        if (this.kz && 0 !== this.kz.length) {
                            if (this.kz.length >= 1) {
                                if (!this.kz || 0 === this.kz.length) return;
                                e = $("#slicer-position-horizontal").val(), t = $("#slicer-position-vertial").val(), i = $("#slicer-layout-column-count").val(), o = $("#slicer-layout-item-height").val(), n = $("#slicer-size-height").val(), a = $("#slicer-size-width").val(), s = $("#slicer-disable-resize").prop("checked"), l = $("#slicer-locked").prop("checked"), c = $("#no-move-size").prop("checked"), d = $("#move-no-size").prop("checked"), p = $("#move-size").prop("checked"), u = { horizontal: e, vertical: t, columnCount: i, itemHeight: o, slicerHeight: n, slicerWidth: a, disableResizingAndMoving: s, locked: l, noMoveSize: c, moveNoSize: d, moveSize: p }, r.actions.doAction("baseDialogCommand", r.wrapper.spread, { value: { formatOption: u, selectedSlicers: this.kz }, execute: r.spreadActions.dialogAction.FormatSlicerForDialog })
                            }
                            this.oz()
                        }
                    }, t.prototype.lz = function() {
                        var e = this;
                        this.Eo.find(".slicer-property-tab").tabs(), $("#position-layout").width(120), $("#size").width(60), $("#properties").width(80), this.Eo.find("#slicer-position-horizontal").spinner({ min: 0 }), this.Eo.find("#slicer-position-vertial").spinner({ min: 0 }), this.Eo.find("#slicer-layout-item-height").spinner({ min: 0 }), this.gz.spinner({ min: 1, spin: function(t, i) { e.pz(i.value) } }), this.dz.spinner({ min: 0, spin: function(t, i) { e.qz(i.value) } }), this.ez.spinner({ min: 0, spin: function(t, i) { e.rz(i.value) } }), this.az.spinner({ min: 0, spin: function(t, i) { e.sz(i.value) } }), this.bz.spinner({ min: 0, spin: function(t, i) { e.tz(i.value) } }), this.cz.spinner({ min: 0, spin: function(t, i) { e.uz(i.value) } }), this.gz.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.pz(t)
                        }), this.az.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.sz(t)
                        }), this.bz.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.tz(t)
                        }), this.cz.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.uz(t)
                        }), this.dz.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.qz(t)
                        }), this.ez.bind("input", function() {
                            var t = e.vz($(this).val());
                            e.rz(t)
                        }), this.fz.bind("change", function() { $(this).prop("checked") ? e.wz() : e.xz() })
                    }, t.prototype.oz = function() { this.gz.unbind(), this.az.unbind(), this.bz.unbind(), this.cz.unbind(), this.dz.unbind(), this.ez.unbind(), this.fz.unbind() }, t.prototype.vz = function(e) { return r.util.formatNumber(e) }, t.prototype.wz = function() { $("#slicer-position-horizontal").spinner("disable"), $("#slicer-position-vertial").spinner("disable"), $("#slicer-layout-column-count").spinner("disable"), $("#slicer-layout-item-height").spinner("disable"), $("#slicer-layout-item-width").spinner("disable"), $("#slicer-size-height").spinner("disable"), $("#slicer-size-width").spinner("disable"), $("#slicer-size-scale-height").spinner("disable"), $("#slicer-size-scale-width").spinner("disable") }, t.prototype.xz = function() { $("#slicer-position-horizontal").spinner("enable"), $("#slicer-position-vertial").spinner("enable"), $("#slicer-layout-column-count").spinner("enable"), $("#slicer-layout-item-height").spinner("enable"), $("#slicer-layout-item-width").spinner("enable"), $("#slicer-size-height").spinner("enable"), $("#slicer-size-width").spinner("enable"), $("#slicer-size-scale-height").spinner("enable"), $("#slicer-size-scale-width").spinner("enable") }, t.prototype.nz = function(e) { e && ($("#slicer-position-horizontal").val(e.position().x), $("#slicer-position-vertial").val(e.position().y), $("#slicer-layout-column-count").val(e.columnCount()), $("#slicer-layout-item-height").val(Math.round(e.itemHeight())), $("#slicer-layout-item-width").val(r.util.getSlicerItemWidth(e.columnCount(), e.width())), $("#slicer-size-height").val(Math.round(e.height())), $("#slicer-size-width").val(Math.round(e.width())), e.disableResizingAndMoving() ? ($("#slicer-disable-resize").prop("checked", !0), this.wz()) : ($("#slicer-disable-resize").prop("checked", !1), this.xz()), e.isLocked() ? $("#slicer-locked").prop("checked", !0) : $("#slicer-locked").prop("checked", !1), e.dynamicMove() ? e.dynamicSize() ? $("#move-size").prop("checked", !0) : $("#move-no-size").prop("checked", !0) : $("#no-move-size").prop("checked", !0)) }, t.prototype.mz = function(e) {
                        var t, i, o, n, a, s, l, c, d, p, u, h, f, g, m;
                        if (e && 0 !== e.length) {
                            t = e[0], i = !0, o = !0, n = !0, a = !0, s = !0, l = !0, c = e[0].columnCount(), d = e[0].itemHeight(), p = r.util.getSlicerItemWidth(t.columnCount(), t.width()), u = e[0].height(), h = e[0].width(), f = e[0].dynamicMove(), g = e[0].dynamicSize();
                            for (m in e) t = e[m], i = i && t.disableResizingAndMoving(), o = o && t.isLocked(), s = s && t.dynamicMove(), l = l && t.dynamicSize(), t.columnCount() !== c && (n = !1), t.itemHeight() !== d && (a = !1), t = e[m], r.util.getSlicerItemWidth(t.columnCount(), t.width()) !== p && (this.iz = !1), t.height() !== u && (this.hz = !1), t.width() !== h && (this.jz = !1), t.dynamicMove() !== f && (s = !1), t.dynamicSize() !== g && (l = !1);
                            $("#slicer-position-horizontal").val(""), $("#slicer-position-vertial").val(""), s && l && f ? g ? $("#move-size").prop("checked", !0) : $("#move-no-size").prop("checked", !0) : $("#no-move-size").prop("checked", !0), n ? $("#slicer-layout-column-count").val(c) : $("#slicer-layout-column-count").val(""), a ? $("#slicer-layout-item-height").val(Math.round(d)) : $("#slicer-layout-item-height").val(""), this.iz ? $("#slicer-layout-item-width").val(p) : $("#slicer-layout-item-width").val(""), this.hz ? $("#slicer-size-height").val(Math.round(u)) : $("#slicer-size-height").val(""), this.jz ? $("#slicer-size-width").val(Math.round(h)) : $("#slicer-size-width").val(""), i ? ($("#slicer-disable-resize").prop("checked", !0), this.wz()) : ($("#slicer-disable-resize").prop("checked", !1), this.xz()), o ? $("#slicer-locked").prop("checked", !0) : $("#slicer-locked").prop("checked", !1)
                        }
                    }, t.prototype.yz = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = r.util.getSelectedSlicers(e);
                        return t && 0 !== t.length ? Math.round(t[0].height()) : void 0
                    }, t.prototype.zz = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = r.util.getSelectedSlicers(e);
                        return t && 0 !== t.length ? Math.round(t[0].width()) : void 0
                    }, t.prototype.Az = function() {
                        var e = r.wrapper.spread.getActiveSheet(),
                            t = r.util.getSelectedSlicers(e);
                        return t && 0 !== t.length ? t[0].columnCount() : void 0
                    }, t.prototype.pz = function(e) {
                        var t, i;
                        e <= 0 || ($("#slicer-layout-column-count").val(e), t = this.zz(), i = r.util.getSlicerItemWidth(e, t), $("#slicer-layout-item-width").val(i))
                    }, t.prototype.qz = function(e) {
                        var t, i;
                        if (!this.hz) return $("#slicer-size-scale-height").val(""), void $("#slicer-size-scale-width").val("");
                        t = this.yz(), i = Math.round(e / t * 100), $("#slicer-size-scale-height").val(i)
                    }, t.prototype.tz = function(e) {
                        var t = this.zz(),
                            i = Math.round(e / t * 100),
                            o = this.Az(),
                            n = r.util.getSlicerItemWidth(o, e);
                        this.iz ? $("#slicer-layout-item-width").val(n) : $("#slicer-layout-item-width").val(""), this.jz ? $("#slicer-size-scale-width").val(i) : $("#slicer-size-scale-width").val("")
                    }, t.prototype.rz = function(e) {
                        var t, i;
                        this.hz && (t = this.yz(), i = Math.round(e * t / 100), $("#slicer-size-height").val(i))
                    }, t.prototype.uz = function(e) {
                        var t, i, o, n;
                        this.jz && (t = this.zz(), i = Math.round(e * t / 100), o = this.Az(), n = r.util.getSlicerItemWidth(o, i), $("#slicer-size-width").val(i), $("#slicer-layout-item-width").val(n))
                    }, t.prototype.sz = function(e) {
                        var t, i, o, n;
                        if (!this.iz) return $("#slicer-size-width").val(""), void $("#slicer-size-scale-width").val("100");
                        t = this.zz(), i = this.Az(), o = r.util.getSlicerWidthFromItem(i, e), n = Math.round(o / t * 100), $("#slicer-size-width").val(o), $("#slicer-size-scale-width").val(n)
                    }, t
                }(r.BaseDialog), r.FormatSlicerDialog = H
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e, t = function() {
                function e(e) { this.rootElem = e, this.selectedTab = null, this.onSelectItem = null, this.Bz(), this.selectedTab = e.find("a:first").closest("li"), this.showTab(this.selectedTab.children("a").attr("href")) }
                return e.prototype.showTab = function(e) {
                    if (this.selectedTab) {
                        var t = $(this.selectedTab.children(":first").attr("href"));
                        t.hide(), this.selectedTab.removeClass("menu-item-selected")
                    }
                    this.selectedTab = $("li > a[href=" + e + "]").parent(), this.selectedTab.addClass("menu-item-selected"), this.hideUnselectedViews(), $(e).show("fast")
                }, e.prototype.hideUnselectedViews = function() {
                    var e = this.rootElem.children("li:not(.selected)");
                    e.each(function(e, t) {
                        var i = $(t).children("a").attr("href");
                        $(i).hide()
                    })
                }, e.prototype.Bz = function() {
                    var e = this;
                    this.rootElem.find("a").on("click", function(t) { return e.Cz(t), !1 })
                }, e.prototype.Cz = function(e) {
                    var t = $(e.target).attr("href");
                    0 !== $(t).length && this.showTab(t), this.onSelectItem && this.onSelectItem.call(null, e)
                }, e
            }();
            i.Menu = t, e = function() {
                function e() { this.mainMenu = new t($(".menu-panel ul")), this.importMenu = new t($("#import-page .left-view ul")), this.exportMenu = new t($("#export-page .left-view ul")) }
                return e.isNotSupportFileApi = function() { var e = window; return !e.File && !e.FileReader }, e.showNotSupportFileApiDialog = function() { i.MessageBox.show(i.res.fileAPINotSupported, i.res.title, i.MessageBoxIcon.warning) }, e.checkFileApiSupport = function() { return !e.isNotSupportFileApi() || (e.showNotSupportFileApiDialog(), !1) }, e.checkBolbSupport = function() { return !!window.Blob || (i.MessageBox.show(i.res.blobNotSupported, i.res.title, i.MessageBoxIcon.warning), !1) }, e.prototype.Dz = function() {
                    var e, t, o = i.wrapper.spread.sheets,
                        n = o.length;
                    if (n <= 0) return null;
                    if (e = $(".export-sheet-select"))
                        for (e.children().length > 0 && e.empty(), $("<option>").text(i.res.fileMenu.allSheet).appendTo(e), t = 0; t < n; t++) $("<option>").text(o[t].name()).appendTo(e)
                }, e.prototype.showFileScreen = function() { $(".file-menu").hasClass("hidden") && $(".file-menu").removeClass("hidden") }, e.prototype.closeFileScreen = function() { $(".file-menu").hasClass("hidden") || $(".file-menu").addClass("hidden") }, e.prototype.clickOnMainMenuTab = function(e) { "#" !== e.target.getAttribute("href") && $(".menu-title span").text(e.target.textContent) }, e.prototype.bindNavigatorHandlers = function() {
                    var e = this;
                    $("#file-menu-goback").on("click", function() { return e.closeFileScreen() }), this.mainMenu.onSelectItem = this.clickOnMainMenuTab
                }, e.prototype.initPage = function() { this.Ez(), $(".menu-title span").text(i.res.fileMenu.new), this.mainMenu.showTab("#new-page"), this.bindNavigatorHandlers() }, e.prototype.Ez = function() { this.Fz(), this.Gz(), this.Hz() }, e.prototype.Fz = function() {
                    var e = this;
                    $.ajax({ url: "../resources/templates/templatesconfig.js", type: "GET", dataType: "json", success: function(t) { return e.Iz(t) }, error: function() { return i.MessageBox.show(i.res.requestTemplateConfigFail, i.res.title, 3) } })
                }, e.prototype.Jz = function(e) {
                    var t, i, o = this,
                        n = $("<div>");
                    return n.addClass("template-item"), t = $("<div>"), t.addClass("template-item-thumb").addClass(e.thumbClass), t.appendTo(n), i = $("<span>"), i.text(e.name), i.appendTo(n), n.on("click", function() { return o.Kz(e.name) }), n
                }, e.prototype.Kz = function(e) { i.actions.openTemplate(i.wrapper.spread, e) }, e.prototype.Iz = function(e) { var t, i, o = $("#new-page"); for (t = 0; t < e.length; t++) i = this.Jz(e[t]), i.appendTo(o) }, e.prototype.Gz = function() { this.Lz() }, e.prototype.Lz = function() {
                    /* MY CODE henry */
                    console.log('instance',i.wrapper.spread);
                    getInstance(i.wrapper.spread),
                    /* MY CODE */
                    $("#import-json").on("click", function(t) {
                        if (!e.checkFileApiSupport()) return !1;
                        var o = $(t.currentTarget),
                            n = o.data("action"),
                            r = o.data("actionArgs");
                        i.actions.doAction(n, i.wrapper.spread, r)
                    }), $("#import_excel_rowAndColumnHeaders").on("click", function(e) {
                        var t = $(e.currentTarget).prop("checked");
                        $("#import_excel_rowHeaders").prop("checked", t), $("#import_excel_columnHeaders").prop("checked", t)
                    }), $("#import_excel_rowHeaders").on("click", function() {
                        var e = $("#import_excel_rowHeaders").prop("checked") && $("#import_excel_columnHeaders").prop("checked");
                        $("#import_excel_rowAndColumnHeaders").prop("checked", e)
                    }), $("#import_excel_columnHeaders").on("click", function() {
                        var e = $("#import_excel_rowHeaders").prop("checked") && $("#import_excel_columnHeaders").prop("checked");
                        $("#import_excel_rowAndColumnHeaders").prop("checked", e)
                    }), $("#import-excel").on("click", function(t) {
                        var o, n, r, a, s, l, c, d;
                        if (!e.checkFileApiSupport()) return !1;
                        o = $(t.currentTarget), n = o.data("action"), r = !!$("#import_excel_ignoreStyle").prop("checked"), a = !!$("#import_excel_ignoreFormula").prop("checked"), s = !!$("#import_excel_rowHeaders").prop("checked"), l = !!$("#import_excel_columnHeaders").prop("checked"), c = !!$("#import_excel_doNotRecalculateAfterLoad").prop("checked"), d = { excelOpenFlags: { ignoreStyle: r, ignoreFormula: a, frozenColumnsAsRowHeaders: s, frozenRowsAsColumnHeaders: l, doNotRecalculateAfterLoad: c }, password: $("#import_excel_password").val() }, i.actions.doAction(n, i.wrapper.spread, d)
                    }), $("#import-csv").on("click", function(t) {
                        var o = $(t.currentTarget),
                            n = o.data("action"),
                            r = $("#import_csv_includeRowHeader").prop("checked") ? 1 : 0,
                            a = $("#import_csv_includeColumnHeader").prop("checked") ? 2 : 0,
                            s = $("#import_csv_unformatted").prop("checked") ? 8 : 0,
                            l = $("#import_csv_importFormula").prop("checked") ? 16 : 0,
                            c = { textFileOpenFlags: "" + (r | a | s | l), rowDelimiter: e.Mz($("#import_csv_rowDelimiter").val()), columnDelimiter: e.Mz($("#import_csv_columnDelimiter").val()), cellDelimiter: e.Mz($("#import_csv_cellDelimiter").val()), encoding: $("#import_csv_encoding").val() };
                        i.actions.doAction(n, i.wrapper.spread, c)
                    })
                }, e.prototype.Hz = function() { this.Nz() }, e.prototype.Oz = function() { var e = $(".export-setting-input").get(0).selectedIndex; return 0 === e ? void 0 : e - 1 }, e.prototype.Nz = function() {
                    $("#export-json, #export-js").on("click", function(t) {
                        if (!e.checkBolbSupport()) return !1;
                        var o = $(t.currentTarget),
                            n = o.data("action"),
                            r = o.data("actionArgs");
                        i.actions.doAction(n, i.wrapper.spread, r)
                    }), $("#export_excel_saveBothCustomRowAndColumnHeaders").on("click", function(e) {
                        var t = $(e.currentTarget).prop("checked");
                        $("#export_excel_saveCustomRowHeaders").prop("checked", t), $("#export_excel_saveCustomColumnHeaders").prop("checked", t)
                    }), $("#export_excel_saveCustomRowHeaders").on("click", function() {
                        var e = $("#export_excel_saveCustomRowHeaders").prop("checked") && $("#export_excel_saveCustomColumnHeaders").prop("checked");
                        $("#export_excel_saveBothCustomRowAndColumnHeaders").prop("checked", e)
                    }), $("#export_excel_saveCustomColumnHeaders").on("click", function() {
                        var e = $("#export_excel_saveCustomRowHeaders").prop("checked") && $("#export_excel_saveCustomColumnHeaders").prop("checked");
                        $("#export_excel_saveBothCustomRowAndColumnHeaders").prop("checked", e)
                    }), $("#export-excel").on("click", function(e) {
                        var t = $(e.currentTarget),
                            o = t.data("action"),
                            n = !!$("#export_excel_ignoreStyle").prop("checked"),
                            r = !!$("#export_excel_ignoreFormulas").prop("checked"),
                            a = !!$("#export_excel_saveCustomRowHeaders").prop("checked"),
                            s = !!$("#export_excel_saveCustomColumnHeaders").prop("checked"),
                            l = { excelSaveFlags: { ignoreStyle: n, ignoreFormula: r, rowHeadersAsFrozenColumns: a, columnHeadersAsFrozenRows: s }, password: $("#export_excel_password").val() };
                        i.actions.doAction(o, i.wrapper.spread, l)
                    }), $("#export-csv").on("click", function(t) {
                        var o = $(t.currentTarget),
                            n = o.data("action"),
                            r = $("#export_csv_includeRowHeader").prop("checked") ? 1 : 0,
                            a = $("#export_csv_includeColumnHeader").prop("checked") ? 2 : 0,
                            s = $("#export_csv_unFormatted").prop("checked") ? 8 : 0,
                            l = $("#export_csv_exportFormula").prop("checked") ? 16 : 0,
                            c = $("#export_csv_asViewed").prop("checked") ? 32 : 0,
                            d = { saveFlags: r | a | s | l | c, sheetIndex: e.Pz($("#export_csv_sheetIndex").val()), encoding: $("#export_csv_encoding").val(), row: e.Pz($("#export_csv_row").val() || "0"), column: e.Pz($("#export_csv_column").val() || "0"), rowCount: e.Pz($("#export_csv_rowCount").val() || "-1"), columnCount: e.Pz($("#export_csv_columnCount").val() || "-1"), rowDelimiter: e.Mz($("#export_csv_rowDelimiter").val()), columnDelimiter: e.Mz($("#export_csv_columnDelimiter").val()), cellDelimiter: e.Mz($("#export_csv_cellDelimiter").val()) };
                        if (!i.wrapper.spread.sheets[d.sheetIndex]) return void i.MessageBox.show(i.res.exportCsvSheetIndexError, i.res.title, 2, 0);
                        i.actions.doAction(n, i.wrapper.spread, d)
                    });
                    var t = this;
                    $("#export-pdf").on("click", function(e) {
                        var o = $(e.currentTarget),
                            n = o.data("action"),
                            r = { title: $(".pdf-title").val(), author: $(".pdf-author").val(), subject: $(".pdf-subject").val(), creator: $(".pdf-application").val(), keywords: $(".pdf-keywords").val() },
                            a = { sheetIndex: t.Oz(), setting: r };
                        i.actions.doAction(n, i.wrapper.spread, a)
                    })
                }, e.Pz = function(e) { return e = parseInt(e), isNaN(e) ? null : e }, e.Mz = function(e) { return e.replace(/\\r/g, "\r").replace(/\\n/g, "\n") }, e
            }(), i.FileMenu = e, i.fileMenu, i.loader.ready(function() { i.fileMenu = new e, $("#file-menu-tab").on("click", function() { i.fileMenu.showFileScreen(), i.fileMenu.Dz() }), i.fileMenu.initPage() })
        }()
    }, function(e, t) {
        var i = void 0,
            o = null,
            n = GC.Spread.Sheets,
            r = n.Designer;
        ! function() {
            "use strict";
            var e = function(e) {
                r.extends(t, e);

                function t() { e.call(this, r.util.resolveHtmlPath("../formatDialog", "formatDialog.html"), ".format-dialog"), t.hw++ }
                var a = { "zh-cn": "804", "ja-jp": "411", "ko-kr": "412" };
                return t.prototype.Do = function() {
                    var e = this;
                    return {
                        width: "auto",
                        modal: !0,
                        title: r.res.formatDialog.title,
                        buttons: [{
                            text: r.res.ok,
                            click: function() {
                                if (e.Qz || void 0 === e.Qz) e.Rz();
                                else {
                                    var t;
                                    t = e.Sz ? e.Tz.result() : e.Uz(), $(e).trigger("okClicked", t), e.Vz()
                                }
                                e.close()
                            }
                        }, { text: r.res.cancel, click: function() { e.cancel(), e.close() } }]
                    }
                }, t.prototype.Vz = function() {
                    var e, t = r.wrapper.spread.getActiveSheet(),
                        i = t.getActiveRowIndex(),
                        o = t.getActiveColumnIndex(),
                        n = t.tables.find(i, o);
                    n && (e = n.getSlicerData()) && e.refresh()
                }, t.prototype.Rz = function() {
                    var e, t, i = this,
                        o = i.Tz.result(),
                        n = { fontFamily: i.Mq, fontSize: i.Oq, fontStyle: i.Nq, fontWeight: i.Pq };
                    void 0 === i.Wz && void 0 === i.Gw || (e = { orignalBorder: i.Xz, borderType: i.Yz() }), t = { merged: i.Zz }, r.actions.doAction("baseDialogCommand", r.wrapper.spread, { value: { styleInfo: o, fontInfo: n, borderInfo: e, mergeInfo: t }, execute: r.spreadActions.dialogAction.formatDialogApplySetting }), i.$z()
                }, t.prototype.Io = function(e) {
                    var o, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C = 0;
                    e = e || [], void 0 !== e && e.length > 0 && (r.util.assert("string" == typeof e[0]), C = t.getTabIndexById(e[0])), void 0 !== e[1] && this.Eo.find(".font-picker").fontpicker("option", "customFontStyle", e[1]), void 0 !== e[2] ? this.Tz = new r.StyleShadowObject(e[2]) : this.Tz = new r.SpreadStyleShadowObject(r.wrapper.spread), e[3] ? (this._z(!0, e[4]), o = { borderTop: this.Tz.borderTop(), borderBottom: this.Tz.borderBottom(), borderRight: this.Tz.borderRight(), borderLeft: this.Tz.borderLeft(), borderVertical: this.Tz.borderVertical(), borderHorizontal: this.Tz.borderHorizontal(), diagonalUp: this.Tz.diagonalUp(), diagonalDown: this.Tz.diagonalDown() }, this.aA(o), this.Sz = !0) : (this._z(!1), n = this.bA(), n && this.aA(n), this.Sz = !1), this.Eo.find(".main-tab").tabs("option", "active", C), this.$w(".input-horizontal-align", this.Tz.hAlign()), this.$w(".input-vertical-align", this.Tz.vAlign()), this.Tz.textIndent() !== r.BaseMetaObject.indeterminateValue ? this.Eo.find(".input-indent").spinner("value", this.Tz.textIndent()) : this.Eo.find(".input-indent").spinner("value", ""), this.Ow(".input-wrap", this.Tz.wordWrap()), this.Ow(".input-shrink", this.Tz.shrinkToFit()), this.Ow(".input-vertical-text", this.Tz.isVerticalText()), this.Zz = this.cA(), this.Ow(".input-merge", this.Zz), this.dA(this.Tz.font(), this.Tz.foreColor(), this.Tz.textDecoration()), this.Ow(".cell-protection", this.Tz.locked()), this.eA(".show-color-span", this.Tz.backColor()), void 0 !== e[2] ? this.fA(this.Tz.formatter()) : this.gA(this.Tz.formatter(), r.wrapper.spread), void 0 !== this.selectTabOptions && this.selectTab(this.selectTabOptions), this.selectTabOptions && !this.selectTabOptions.padding || (a = this.Tz.font(), a && "string" == typeof a && (s = r.util.parseFont(a), this.Mq = s.fontFamily, this.Oq = s.fontSize.replace(/(pt|px)$/, ""), this.Nq = s.fontStyle, this.Pq = s.fontWeight), this.hA.getActiveSheet().setStyle(0, 0, null), this.iA = i, this.jA = i, this.kA = i, this.lA = i, l = this.Tz.cellPadding(), c = r.util.parsePadding(l), this.Eo.find(".label-top-padding").spinner("value", parseInt(c[0]) || 0), this.Eo.find(".label-right-padding").spinner("value", parseInt(c[1]) || 0), this.Eo.find(".label-bottom-padding").spinner("value", parseInt(c[2]) || 0), this.Eo.find(".label-left-padding").spinner("value", parseInt(c[3]) || 0), this.mA("top-padding", parseInt(c[0]) || 0), this.mA("right-padding", parseInt(c[1]) || 0), this.mA("bottom-padding", parseInt(c[2]) || 0), this.mA("left-padding", parseInt(c[3]) || 0), d = this.Tz.watermark(), d !== r.BaseMetaObject.undefinedValue && d !== r.BaseMetaObject.indeterminateValue || (d = ""), this.nA(".label-text-input", d), this.oA(d), p = this.Tz.labelOptions() || {}, u = p.alignment, this.pA(u || 0), this.qA(p.foreColor || "grey"), this.rA(p.font || a || r.res.defaultFont), h = p.font, h && "string" == typeof h && (s = r.util.parseFont(h), this.iA = s.fontFamily, this.jA = s.fontSize.replace(/(pt|px)$/, ""), this.kA = s.fontStyle, this.lA = s.fontWeight), f = r.util.getFromCache("defaultFont", function() { return r.util.parseFont(r.res.defaultFont) }), g = this.iA || this.Mq || f.fontFamily, g.match(/^["'].*["']$/) && (g = g.substring(1, g.length - 1)), this.$w(".label-font-family", g), this.$w(".label-font-size", this.jA || this.Oq || f.fontSize.replace(/(pt|px)$/, "")), m = this.lA || this.Pq || "normal", "normal" === m ? this.Eo.find(".label-font-weight").val(!1).removeClass("button-active") : "bold" === m && this.Eo.find(".label-font-weight").val(!0).addClass("button-active"), b = this.kA || this.Nq || "normal", "normal" === b ? this.Eo.find(".label-font-style").val(!1).removeClass("button-active") : "italic" === b && this.Eo.find(".label-font-style").val(!0).addClass("button-active"), v = p.visibility, this.sA(void 0 !== v ? v : 2), y = ["visible", "hidden", "auto"], this.$w(".label-visibility", y[v] || "auto"), w = p.margin, x = r.util.parsePadding(w), this.Eo.find(".label-top-margin").spinner("value", parseInt(x[0]) || 0), this.Eo.find(".label-right-margin").spinner("value", parseInt(x[1]) || 0), this.Eo.find(".label-bottom-margin").spinner("value", parseInt(x[2]) || 0), this.Eo.find(".label-left-margin").spinner("value", parseInt(x[3]) || 0), this.mA("top-margin", parseInt(x[0]) || 0), this.mA("right-margin", parseInt(x[1]) || 0), this.mA("bottom-margin", parseInt(x[2]) || 0), this.mA("left-margin", parseInt(x[3]) || 0))
                }, t.prototype._init = function() {
                    var e = this;
                    this.tA = new GC.Spread.Sheets.Workbook(this.Eo.find(".sample-spread")[0]), this.Sz = !1, this.uA = [], this.vA = "3/14/2001 13:30:00", this.Wz = "Text 1", this.Gw = 1, this.wA = new r.ColorDailog, this.wA._create(), this.xA(), this.Eo.find("button").button(), this.Eo.find(".tabs").tabs(), this.Eo.find(".small-border-icon").button(), this.Eo.find(".big-border-icon").button(), this.Eo.find(".input-indent").spinner({ min: 0, max: 1e4, change: function() { e.Tz.textIndent($(this).spinner("value")) }, spin: function() {} }), this.Eo.find(".font-picker").fontpicker({
                        changed: function(t, i) {
                            var o, n, r, a, s, l, c;
                            switch (i.name) {
                                case "family":
                                    e.Mq = i.value;
                                    break;
                                case "style":
                                    e.Nq = i.value;
                                    break;
                                case "size":
                                    e.Oq = i.value;
                                    break;
                                case "weight":
                                    e.Pq = i.value;
                                    break;
                                case "color":
                                    o = i.value, o ? o.name ? e.Tz.foreColor(o.name) : e.Tz.foreColor(o.color) : e.Tz.foreColor(o);
                                    break;
                                case "underline":
                                    e.yA = i.value;
                                    break;
                                case "doubleUnderline":
                                    e.zA = i.value;
                                    break;
                                case "strikethrough":
                                    e.AA = i.value
                            }
                            n = 0, e.yA ? n |= 1 : e.zA && (n |= 8), e.AA && (n |= 2), e.Tz.textDecoration(n), e.Mq || e.Nq || e.Oq || e.Pq ? (r = e.Mq ? e.Mq : "Arial", a = e.Nq ? e.Nq : "normal", s = e.Oq ? e.Oq + "pt" : "10pt", l = e.Pq ? e.Pq : "normal", c = a + " " + l + " " + s + " " + r, e.Tz.font(c)) : e.Tz.font("")
                        }
                    }), this.Eo.find(".format-tab-li").click(function() { $("button[dialogtobefocused='true']").focus() }), this.Eo.find(".input-horizontal-align").change(function() {
                        var t = e.Eo.find(".input-horizontal-align").val();
                        e.Tz.hAlign(t)
                    }), this.Eo.find(".input-vertical-align").change(function() {
                        var t = e.Eo.find(".input-vertical-align").val();
                        e.Tz.vAlign(t)
                    }), this.Eo.find(".input-indent").change(function() {
                        var t = e.Eo.find(".input-indent").val();
                        e.Tz.textIndent(t)
                    }), this.Eo.find(".input-wrap").change(function() {
                        var t = e.Eo.find(".input-wrap").prop("checked");
                        e.Tz.wordWrap(t)
                    }), this.Eo.find(".input-shrink").change(function() {
                        var t = e.Eo.find(".input-shrink").prop("checked");
                        e.Tz.shrinkToFit(t)
                    }), this.Eo.find(".input-merge").click(function() {!0 === e.Zz ? e.Zz = !1 : !1 === e.Zz ? e.Zz = r.BaseMetaObject.indeterminateValue : e.Zz = !0, e.Ow(".input-merge", e.Zz) }), this.Eo.find(".input-vertical-text").change(function() {
                        var t = e.Eo.find(".input-vertical-text").prop("checked");
                        e.Tz.isVerticalText(t)
                    }), this.Eo.find(".cell-protection").change(function() {
                        var t = e.Eo.find(".cell-protection").prop("checked");
                        e.Tz.locked(t)
                    }), this.Eo.find(".colorPicker").colorpicker({
                        valueChanged: function(t, i) {
                            if (i.name) {
                                var o = r.ColorHelper.parse(i.name, r.wrapper.spread.getActiveSheet().currentTheme().colors());
                                e.Eo.find(".show-color-span").css("background-color", o.color), e.Tz.backColor(i.name)
                            } else e.Eo.find(".show-color-span").css("background-color", i.color), e.Tz.backColor(i.color)
                        }
                    }), this.Eo.find(".border-picker").borderpicker({ colorChanged: function(t, i) { i.name ? e.Wz = i.name : e.Wz = i.color }, lineStyleChanged: function(t, i) { e.Gw = i } }), this.Eo.find(".border-picker").borderpicker("option", "colorOptions", { showNoFill: !1 }), this.Eo.find(".more-color-button").click(function() { void 0 === e.wA && (e.wA = new r.ColorDailog, e.wA._create()), e.wA.value = e.BA, "" === e.BA || void 0 === e.BA ? e.wA.CA(!0, "rgb(0,0,0)") : e.wA.CA(!0, e.BA), e.wA.open() }), $(this.wA).on("dialogClose", function(t, i) { i && (e.Eo.find(".colorPicker").colorpicker("option", "selectedItem", this.value), e.Eo.find(".show-color-span").css("background-color", this.value), e.Tz.backColor(this.value)) }), this.Eo.find(".no-color-button").click(function() { e.Eo.find(".colorPicker").colorpicker("option", "selectedItem", null), e.Eo.find(".show-color-span").css("background-color", "transparent"), e.Tz.backColor(null) }), this.Eo.find(".no-border-button").click(function() { e.Eo.find(".small-border-icon").prop("checked", !1).button("refresh"), e.DA(1, 1), e.DA(1, 2), e.DA(2, 1), e.DA(2, 2) }), this.Eo.find(".outside-border-button").click(function() { e.Eo.find(".top-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".top-line-input").trigger("change"), e.Eo.find(".bottom-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".bottom-line-input").trigger("change"), e.Eo.find(".left-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".left-line-input").trigger("change"), e.Eo.find(".right-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".right-line-input").trigger("change") }), this.Eo.find(".inside-border-button").click(function() { e.Eo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".horizontal-inner-line-input").trigger("change"), e.Eo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"), e.Eo.find(".vertical-inner-line-input").trigger("change") }), this.Eo.find(".top-line-input").change(function() {
                        var t, i = e.Eo.find(".top-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).borderTop(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).borderTop(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderTop(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderTop.color || a.borderTop.style !== e.Gw ? (o.getCell(1, 1).borderTop(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).borderTop(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".top-line-input").prop("checked", !0).button("refresh"), e.Tz.borderTop(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).borderTop(new n.LineBorder(e.Wz, 0)), o.getCell(1, 2).borderTop(new n.LineBorder(e.Wz, 0)), e.Tz.borderTop(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".bottom-line-input").change(function() {
                        var t, i = e.Eo.find(".bottom-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(2, 1);
                        i ? (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).borderBottom(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderBottom(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderBottom.color || a.borderBottom.style !== e.Gw ? (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).borderBottom(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".bottom-line-input").prop("checked", !0).button("refresh"), e.Tz.borderBottom(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Wz, 0)), o.getCell(2, 2).borderBottom(new n.LineBorder(e.Wz, 0)), e.Tz.borderBottom(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".left-line-input").change(function() {
                        var t, i = e.Eo.find(".left-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).borderLeft(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderLeft(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderLeft.color || a.borderLeft.style !== e.Gw ? (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).borderLeft(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".left-line-input").prop("checked", !0).button("refresh"), e.Tz.borderLeft(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Wz, 0)), o.getCell(2, 1).borderLeft(new n.LineBorder(e.Wz, 0)), e.Tz.borderLeft(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".right-line-input").change(function() {
                        var t, i = e.Eo.find(".right-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 2);
                        i ? (o.getCell(1, 2).borderRight(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).borderRight(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderRight(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderRight.color || a.borderRight.style !== e.Gw ? (o.getCell(1, 2).borderRight(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).borderRight(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".right-line-input").prop("checked", !0).button("refresh"), e.Tz.borderRight(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 2).borderRight(new n.LineBorder(e.Wz, 0)), o.getCell(2, 2).borderRight(new n.LineBorder(e.Wz, 0)), e.Tz.borderRight(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".horizontal-inner-line-input").change(function() {
                        var t, i = e.Eo.find(".horizontal-inner-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).borderBottom(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderHorizontal(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderBottom.color || a.borderBottom.style !== e.Gw ? (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).borderBottom(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"), e.Tz.borderHorizontal(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Wz, 0)), o.getCell(1, 2).borderBottom(new n.LineBorder(e.Wz, 0)), e.Tz.borderHorizontal(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".vertical-inner-line-input").change(function() {
                        var t, i = e.Eo.find(".vertical-inner-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).borderRight(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).borderRight(new n.LineBorder(e.Wz, e.Gw)), e.Tz.borderVertical(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.borderRight.color || a.borderRight.style !== e.Gw ? (o.getCell(1, 1).borderRight(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).borderRight(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"), e.Tz.borderVertical(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).borderRight(new n.LineBorder(e.Wz, 0)), o.getCell(2, 1).borderRight(new n.LineBorder(e.Wz, 0)), e.Tz.borderVertical(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".diagonal-up-line-input").change(function() {
                        var t, i = e.Eo.find(".diagonal-up-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), e.Tz.diagonalUp(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.diagonalUp.color || a.diagonalUp.style !== e.Gw ? (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".diagonal-up-line-input").prop("checked", !0).button("refresh"), e.Tz.diagonalUp(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Wz, 0)), o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Wz, 0)), o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Wz, 0)), o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Wz, 0)), e.Tz.diagonalUp(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".diagonal-down-line-input").change(function() {
                        var t, i = e.Eo.find(".diagonal-down-line-input").prop("checked"),
                            o = e.EA.getActiveSheet(),
                            a = o.getActualStyle(1, 1);
                        i ? (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), e.Tz.diagonalDown(new n.LineBorder(e.Wz, e.Gw))) : (t = r.ColorHelper.parse(e.Wz, r.wrapper.spread.getActiveSheet().currentTheme().colors()), t.color !== a.diagonalDown.color || a.diagonalDown.style !== e.Gw ? (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Wz, e.Gw)), e.Eo.find(".diagonal-down-line-input").prop("checked", !0).button("refresh"), e.Tz.diagonalDown(new n.LineBorder(e.Wz, e.Gw))) : (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Wz, 0)), o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Wz, 0)), o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Wz, 0)), o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Wz, 0)), e.Tz.diagonalDown(new n.LineBorder(e.Wz, 0))))
                    }), this.Eo.find(".border-line-panel").click(function(t) {
                        var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b;
                        t = t || window.event, i = t.target || t.srcElement, o = e.Eo.find(".corner").width(), n = e.Eo.find(".corner").height(), r = $(i).height(), a = $(i).width(), s = o, l = n, c = e.EA, d = c.getActiveSheet(), p = d.getSpans(), u = t.offsetX || t.clientX - $(i).offset().left, h = t.offsetY || t.clientY - $(i).offset().top, f = a, g = r, m = !1, 0 === p.length ? (Math.abs(a / 2 - u) < s && h > s && r - h > l ? (e.FA(".vertical-inner-line-input"), m = !0) : Math.abs(r / 2 - h) < l && u > s && a - u > s && (e.FA(".horizontal-inner-line-input"), m = !0), f = a / 2, g = r / 2) : 2 === p.length && (p[0].rowCount > 1 ? (Math.abs(a / 2 - u) < s && (e.FA(".vertical-inner-line-input"), m = !0), f = a / 2) : (Math.abs(r / 2 - h) < l && (e.FA(".horizontal-inner-line-input"), m = !0), g = r / 2)), m || (b = e.GA(f, g, u, h), u >= 0 && u <= s && h >= n && h <= r - n ? e.FA(".left-line-input") : a - u >= 0 && a - u <= s && h >= n && h <= r - n ? e.FA(".right-line-input") : h >= 0 && h <= l && u >= o && u <= a - o ? e.FA(".top-line-input") : r - h >= 0 && r - h <= l && u >= o && u <= a - o ? e.FA(".bottom-line-input") : b ? e.FA(".diagonal-down-line-input") : e.FA(".diagonal-up-line-input"))
                    }), this.Eo.find(".colorPicker").colorpicker("option", "showThemeColorTitle", !1), this.Eo.find(".colorPicker").colorpicker("option", "showStandardColorTitle", !1), this.Eo.find(".colorPicker").colorpicker("option", "showOutline", !1), this.Eo.find(".colorPicker").colorpicker("option", "showNoFill", !1), this.Eo.find(".colorPicker").colorpicker("option", "showMoreColors", !1), this.Eo.find(".colorPicker").colorpicker("option", "themeColors", r.wrapper.getThemeColors()), this.Eo.find(".border-picker").borderpicker("option", "colorOptions", { themeColors: r.wrapper.getThemeColors() }), this.HA(), this.Eo.find(".tab-border-li").click(function() { setTimeout(function() { e.EA.refresh() }, 0) }), this.IA()
                }, t.prototype.GA = function(e, t, i, o) {
                    var n = e / 2,
                        r = t / 2;
                    return i > e && (i -= e), o > t && (o -= t), i < n && o < r || i > n && o > r
                }, t.prototype.Vz = function() {
                    var e, t = r.wrapper.spread,
                        i = t.getActiveSheet(),
                        o = i.getActiveRowIndex(),
                        n = i.getActiveColumnIndex(),
                        a = i.tables.find(o, n);
                    a && (e = a.getSlicerData()) && e.refresh()
                }, t.prototype.xA = function() { this.Eo.find(".top-line-input").attr("id", "top-line-border-" + t.hw), this.Eo.find(".top-line").attr("for", "top-line-border-" + t.hw), this.Eo.find(".horizontal-inner-line-input").attr("id", "horizontal-inner-line-border-" + t.hw), this.Eo.find(".horizontal-inner-line").attr("for", "horizontal-inner-line-border-" + t.hw), this.Eo.find(".bottom-line-input").attr("id", "bottom-line-border-" + t.hw), this.Eo.find(".bottom-line").attr("for", "bottom-line-border-" + t.hw), this.Eo.find(".diagonal-up-line-input").attr("id", "diagonal-up-line-border-" + t.hw), this.Eo.find(".diagonal-up-line").attr("for", "diagonal-up-line-border-" + t.hw), this.Eo.find(".left-line-input").attr("id", "left-line-border-" + t.hw), this.Eo.find(".left-line").attr("for", "left-line-border-" + t.hw), this.Eo.find(".vertical-inner-line-input").attr("id", "vertical-inner-line-border-" + t.hw), this.Eo.find(".vertical-inner-line").attr("for", "vertical-inner-line-border-" + t.hw), this.Eo.find(".right-line-input").attr("id", "right-line-border-" + t.hw), this.Eo.find(".right-line").attr("for", "right-line-border-" + t.hw), this.Eo.find(".diagonal-down-line-input").attr("id", "diagonal-down-line-border-" + t.hw), this.Eo.find(".diagonal-down-line").attr("for", "diagonal-down-line-border-" + t.hw) }, t.getTabIndexById = function(e) {
                    switch (e) {
                        case "number":
                            return 0;
                        case "alignment":
                            return 1;
                        case "font":
                            return 2;
                        case "border":
                            return 3;
                        case "fill":
                            return 4;
                        case "protected":
                            return 5
                    }
                    return 0
                }, t.prototype.cancel = function() {}, t.prototype.Uz = function() {
                    var e = this.Tz.result(),
                        t = this.Yz();
                    return { formatter: e.formatter, backColor: e.backColor, foreColor: e.foreColor, hAlign: e.hAlign, vAlign: e.vAlign, textIndent: e.textIndent, wordWrap: e.wordWrap, shrinkToFit: e.shrinkToFit, isVerticalText: e.isVerticalText, font: e.font, locked: e.locked, borderTop: t.topLineBorder, borderBottom: t.bottomLineBorder, borderLeft: t.leftLineBorder, borderRight: t.rightLineBorder, borderInnerVertical: t.innerVerticalLineBorder, borderInnerHorizontal: t.innerHorizontalLineBorder, textDecoration: e.textDecoration }
                }, t.prototype.Ow = function(e, t) { var i = this.Eo.find(e);!0 === t ? (i.prop("indeterminate", !1), i.prop("checked", !0)) : !1 === t ? (i.prop("indeterminate", !1), i.prop("checked", !1)) : (i.prop("indeterminate", !0), i.prop("checked", !1)) }, t.prototype.$w = function(e, t) {
                    var i = this.Eo.find(e);
                    t !== r.BaseMetaObject.indeterminateValue ? i.val(t) : i.val(null)
                }, t.prototype.dA = function(e, t, o) {
                    var n, a, s, l, c = this.Eo.find(".font-picker");
                    e && e !== r.BaseMetaObject.indeterminateValue && e !== r.BaseMetaObject.undefinedValue ? (n = r.util.parseFont(e), a = n.fontFamily.split(","), a.length > 1 ? c.fontpicker("family", a[0]) : c.fontpicker("family", n.fontFamily), c.fontpicker("style", n.fontStyle), -1 !== n.fontSize.indexOf("pt") ? c.fontpicker("size", n.fontSize.substring(0, n.fontSize.length - 2)) : -1 !== n.fontSize.indexOf("px") ? (s = this.Eo.find(".gcui-fontpicker-preview").get(0).style.fontSize, c.fontpicker("size", s.substring(0, s.length - 2))) : c.fontpicker("size", n.fontSize), c.fontpicker("weight", n.fontWeight)) : (l = r.util.getFromCache("defaultFont", function() { return r.util.parseFont(r.res.defaultFont) }), c.fontpicker("family", l.fontFamily), c.fontpicker("style", l.fontStyle), c.fontpicker("size", l.fontSize.replace(/(pt|px)$/, "")), c.fontpicker("weight", l.fontWeight)), this.Mq = i, this.Nq = i, this.Oq = i, this.Pq = i, t !== r.BaseMetaObject.indeterminateValue && t !== r.BaseMetaObject.undefinedValue ? c.fontpicker("color", r.ColorHelper.parse(t, r.wrapper.spread.getActiveSheet().currentTheme().colors())) : c.fontpicker("color", null), c.fontpicker("colorOption", "themeColors", r.wrapper.getThemeColors()), 1 & o ? (c.fontpicker("underline", !0), this.yA = !0, c.fontpicker("doubleUnderline", !1), this.zA = !1) : 8 & o ? (c.fontpicker("underline", !1), this.yA = !1, c.fontpicker("doubleUnderline", !0), this.zA = !0) : (c.fontpicker("underline", !1), this.yA = !1, c.fontpicker("doubleUnderline", !1), this.zA = !1), 2 & o ? (c.fontpicker("strikethrough", !0), this.AA = !0) : (c.fontpicker("strikethrough", !1), this.AA = !1)
                }, t.prototype.eA = function(e, t) {
                    var i, o = this.Eo.find(e);
                    t === r.BaseMetaObject.indeterminateValue || t === r.BaseMetaObject.undefinedValue || void 0 === t || null === t ? (o.css("background-color", ""), this.Eo.find(".colorPicker").colorpicker("option", "selectedItem", null), this.BA = "rgb(0,0,0)") : (i = r.ColorHelper.parse(t, r.wrapper.spread.getActiveSheet().currentTheme().colors()), this.Eo.find(".colorPicker").colorpicker("option", "selectedItem", i), o.css("background-color", i.color), this.BA = i.color)
                }, t.prototype.nA = function(e, t) {
                    var i = this.Eo.find(e);
                    i.val(t || "")
                }, t.prototype.JA = function(e, t) {
                    var i, o, n, a, s, l = this,
                        c = !1,
                        d = !1;
                    for (this.EA = new GC.Spread.Sheets.Workbook(this.Eo.find(".border-sheet")[0]), this.EA.options.showHorizontalScrollbar = !1, this.EA.options.showVerticalScrollbar = !1, this.EA.options.tabStripVisible = !1, this.EA.options.allowUserResize = !1, i = this.EA.getActiveSheet(), $(r.util.getCanvas(this.EA)).unbind("gcmousewheel.gcSheet"), i.currentTheme(r.wrapper.spread.getActiveSheet().currentTheme()), i.options.gridline = { showVerticalGridline: !1, showHorizontalGridline: !1 }, i.options.colHeaderVisible = !1, i.options.rowHeaderVisible = !1, i.options.allowUserDragDrop = !1, i.options.allowUserDragFill = !1, i.options.selectionBackColor = "transparent", i.options.selectionBorderColor = "transparent", i.options.isProtected = !0, i.setColumnCount(4), i.setRowCount(4), i.setValue(1, 1, r.res.formatDialog.sampleText), i.setValue(1, 2, r.res.formatDialog.sampleText), i.setValue(2, 1, r.res.formatDialog.sampleText), i.setValue(2, 2, r.res.formatDialog.sampleText), o = 1; o < 3; o++)
                        for (n = 1; n < 3; n++) i.getCell(o, n).vAlign(1), i.getCell(o, n).hAlign(1);
                    if (i.setRowHeight(0, 2), i.setRowHeight(1, 33), i.setRowHeight(2, 34), i.setRowHeight(3, 1), i.setColumnWidth(0, 2), i.setColumnWidth(1, 77), i.setColumnWidth(2, 78), i.setColumnWidth(3, 1), this.Eo.find(".diagonal-up-line-input").button("enable"), this.Eo.find(".diagonal-down-line-input").button("enable"), e) t ? (this.Eo.find(".horizontal-middle").show(), this.Eo.find(".vertical-middle").show(), this.Eo.find(".vertical-inner-line-input").button("enable"), this.Eo.find(".horizontal-inner-line-input").button("enable"), this.Eo.find(".inside-border-button").button("enable")) : (i.addSpan(1, 1, 2, 2), this.Eo.find(".horizontal-middle").hide(), this.Eo.find(".vertical-middle").hide(), this.Eo.find(".vertical-inner-line-input").button("disable"), this.Eo.find(".horizontal-inner-line-input").button("disable"), this.Eo.find(".inside-border-button").button("disable"));
                    else { for (a = r.wrapper.spread.getActiveSheet().getSelections(), s = this.cA(), o = 0; o < a.length; o++) a[o].rowCount > 1 && (d = !0), a[o].colCount > 1 && (c = !0);!0 === s && (d = !1, c = !1), !c && d ? (i.addSpan(1, 1, 1, 2), i.addSpan(2, 1, 1, 2), this.Eo.find(".vertical-middle").hide(), this.Eo.find(".horizontal-middle").show(), this.Eo.find(".vertical-inner-line-input").button("disable"), this.Eo.find(".horizontal-inner-line-input").button("enable"), this.Eo.find(".inside-border-button").button("enable")) : c && !d ? (i.addSpan(1, 1, 2, 1), i.addSpan(1, 2, 2, 1), this.Eo.find(".vertical-middle").show(), this.Eo.find(".horizontal-middle").hide(), this.Eo.find(".horizontal-inner-line-input").button("disable"), this.Eo.find(".vertical-inner-line-input").button("enable"), this.Eo.find(".inside-border-button").button("enable")) : c || d ? (this.Eo.find(".horizontal-middle").show(), this.Eo.find(".vertical-middle").show(), this.Eo.find(".vertical-inner-line-input").button("enable"), this.Eo.find(".horizontal-inner-line-input").button("enable"), this.Eo.find(".inside-border-button").button("enable")) : (i.addSpan(1, 1, 2, 2), this.Eo.find(".horizontal-middle").hide(), this.Eo.find(".vertical-middle").hide(), this.Eo.find(".vertical-inner-line-input").button("disable"), this.Eo.find(".horizontal-inner-line-input").button("disable"), this.Eo.find(".inside-border-button").button("disable")) } setTimeout(function() { l.EA.refresh() }, 0)
                }, t.prototype.KA = function() {
                    var e = this.Eo.find(".border-sheet");
                    "gcSpread" === e.attr("gcuielement") && (this.EA.destroy(),
                        this.Eo.find(".border-sheet").html(""))
                }, t.prototype._z = function(e, t) { void 0 !== this.EA && this.KA(), this.JA(e, t) }, t.prototype.Yz = function() {
                    var e, t, i, o, r, a, s, l, c = this.Eo.find(".top-line-input").prop("checked"),
                        d = this.Eo.find(".right-line-input").prop("checked"),
                        p = this.Eo.find(".bottom-line-input").prop("checked"),
                        u = this.Eo.find(".left-line-input").prop("checked"),
                        h = this.Eo.find(".horizontal-inner-line-input").prop("checked"),
                        f = this.Eo.find(".vertical-inner-line-input").prop("checked"),
                        g = this.Eo.find(".diagonal-up-line-input").prop("checked"),
                        m = this.Eo.find(".diagonal-down-line-input").prop("checked"),
                        b = this.EA.getActiveSheet().getStyle(1, 1),
                        v = this.EA.getActiveSheet().getStyle(2, 2);
                    return c && (e = new n.LineBorder(b.borderTop.color, b.borderTop.style)), p && (t = new n.LineBorder(v.borderBottom.color, v.borderBottom.style)), d && (i = new n.LineBorder(v.borderRight.color, v.borderRight.style)), u && (o = new n.LineBorder(b.borderLeft.color, b.borderLeft.style)), h && (r = new n.LineBorder(b.borderBottom.color, b.borderBottom.style)), f && (a = new n.LineBorder(b.borderRight.color, b.borderRight.style)), g && (s = new n.LineBorder(b.diagonalUp.color, b.diagonalUp.style)), m && (l = new n.LineBorder(b.diagonalDown.color, b.diagonalDown.style)), { topLineBorder: e, bottomLineBorder: t, rightLineBorder: i, leftLineBorder: o, innerHorizontalLineBorder: r, innerVerticalLineBorder: a, diagonalUpBorder: s, diagonalDownBorder: l }
                }, t.prototype.FA = function(e) {
                    var t = this.Eo.find(e),
                        i = t.prop("checked");
                    i = !i, t.prop("checked", i).button("refresh"), t.trigger("change")
                }, t.prototype.DA = function(e, t) {
                    var i = this.EA.getActiveSheet();
                    i.getCell(e, t).borderTop(new n.LineBorder(this.Wz, 0)), i.getCell(e, t).borderBottom(new n.LineBorder(this.Wz, 0)), i.getCell(e, t).borderLeft(new n.LineBorder(this.Wz, 0)), i.getCell(e, t).borderRight(new n.LineBorder(this.Wz, 0)), i.getCell(e, t).diagonalUp(new n.LineBorder(this.Wz, 0)), i.getCell(e, t).diagonalDown(new n.LineBorder(this.Wz, 0)), this.Tz.borderTop(void 0), this.Tz.borderLeft(void 0), this.Tz.borderRight(void 0), this.Tz.borderBottom(void 0), this.Tz.diagonalUp(void 0), this.Tz.diagonalDown(void 0)
                }, t.prototype.bA = function() {
                    var e, t, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, S = r.wrapper.spread,
                        k = S.getActiveSheet(),
                        T = k.getSelections(),
                        A = T.length;
                    if (0 === A) return null;
                    for (e = -1 === T[0].row ? 0 : T[0].row, t = -1 === T[0].col ? 0 : T[0].col, n = k.getStyle(e, t), a = e + T[0].rowCount - 1, s = t + T[0].colCount - 1, l = k.getStyle(a, s), b = !1, v = !1, n && (c = n.borderTop, p = n.borderLeft, g = n.diagonalUp, m = n.diagonalDown), l && (d = l.borderBottom, u = l.borderRight), C = 0; C < A; C++) {
                        for (e = -1 === T[C].row ? 0 : T[C].row, t = -1 === T[C].col ? 0 : T[C].col, T[C].rowCount > 1 && !b && (y = k.getStyle(e, t), y && (h = y.borderBottom), b = !0), T[C].colCount > 1 && !v && (y = k.getStyle(e, t), y && (f = y.borderRight), v = !0), x = 0; x < T[C].colCount; x++) { if (!(y = k.getStyle(e, t + x)) || !c) { c = i; break } if (void 0 === y.borderTop || y.borderTop === o || y.borderTop.color !== c.color || y.borderTop.style !== c.style) { c = i; break } }
                        for (w = 0; w < T[C].rowCount; w++) { if (!(y = k.getStyle(e + w, t)) || !p) { p = i; break } if (void 0 === y.borderLeft || y.borderLeft === o || y.borderLeft.color !== p.color || y.borderLeft.style !== p.style) { p = i; break } }
                        for (x = 0; x < T[C].colCount; x++) { if (!(y = k.getStyle(e + T[C].rowCount - 1, t + x)) || !d) { d = i; break } if (void 0 === y.borderBottom || y.borderBottom === o || y.borderBottom.color !== d.color || y.borderBottom.style !== d.style) { d = i; break } }
                        for (w = 0; w < T[C].rowCount; w++) { if (!(y = k.getStyle(e + w, t + T[C].colCount - 1)) || !u) { u = i; break } if (void 0 === y.borderRight || y.borderRight === o || y.borderRight.color !== u.color || y.borderRight.style !== u.style) { u = i; break } }
                        for (w = 0; w < T[C].rowCount; w++)
                            for (x = 0; x < T[C].colCount; x++) { if (!(y = k.getStyle(e + w, t + x)) || !g) { g = i; break } if (void 0 === y.diagonalUp || y.diagonalUp === o || y.diagonalUp.color !== g.color || y.diagonalUp.style !== g.style) { g = i; break } }
                        for (w = 0; w < T[C].rowCount; w++)
                            for (x = 0; x < T[C].colCount; x++) { if (!(y = k.getStyle(e + w, t + x)) || !m) { m = i; break } if (void 0 === y.diagonalDown || y.diagonalDown === o || y.diagonalDown.color !== m.color || y.diagonalDown.style !== m.style) { m = i; break } }
                        if (b)
                            for (w = 0; w < T[C].rowCount - 1; w++)
                                for (x = 0; x < T[C].colCount; x++) { if (!(y = k.getStyle(e + w, t + x)) || !h) { h = i; break } if (void 0 === y.borderBottom || y.borderBottom === o || y.borderBottom.color !== h.color || y.borderBottom.style !== h.style) { h = i; break } }
                        if (v)
                            for (w = 0; w < T[C].rowCount; w++)
                                for (x = 0; x < T[C].colCount - 1; x++) { if (!(y = k.getStyle(e + w, t + x)) || !f) { f = i; break } if (void 0 === y.borderRight || y.borderRight === o || y.borderRight.color !== f.color || y.borderRight.style !== f.style) { f = i; break } }
                    }
                    return { borderTop: c, borderBottom: d, borderLeft: p, borderRight: u, borderVertical: f, borderHorizontal: h, diagonalUpBorder: g, diagonalDownBorder: m }
                }, t.prototype.aA = function(e) {
                    var t, i, o, n, a, s = this;
                    s.Xz = e, t = !1, i = !1, e.borderTop ? (this.Wz = e.borderTop.color, this.Gw = e.borderTop.style, this.Eo.find(".top-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".top-line-input").trigger("change")) : this.Eo.find(".top-line-input").prop("checked", !1).button("refresh"), e.borderBottom ? (this.Wz = e.borderBottom.color, this.Gw = e.borderBottom.style, this.Eo.find(".bottom-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".bottom-line-input").trigger("change")) : this.Eo.find(".bottom-line-input").prop("checked", !1).button("refresh"), e.borderLeft ? (this.Wz = e.borderLeft.color, this.Gw = e.borderLeft.style, this.Eo.find(".left-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".left-line-input").trigger("change")) : this.Eo.find(".left-line-input").prop("checked", !1).button("refresh"), e.borderRight ? (this.Wz = e.borderRight.color, this.Gw = e.borderRight.style, this.Eo.find(".right-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".right-line-input").trigger("change")) : this.Eo.find(".right-line-input").prop("checked", !1).button("refresh"), e.borderHorizontal ? (t = !0, this.Wz = e.borderHorizontal.color, this.Gw = e.borderHorizontal.style, this.Eo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".horizontal-inner-line-input").trigger("change")) : this.Eo.find(".horizontal-inner-line-input").prop("checked", !1).button("refresh"), e.borderVertical ? (i = !0, this.Wz = e.borderVertical.color, this.Gw = e.borderVertical.style, this.Eo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".vertical-inner-line-input").trigger("change")) : this.Eo.find(".vertical-inner-line-input").prop("checked", !1).button("refresh"), e.diagonalUpBorder ? (this.Wz = e.diagonalUpBorder.color, this.Gw = e.diagonalUpBorder.style, this.Eo.find(".diagonal-up-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".diagonal-up-line-input").trigger("change")) : this.Eo.find(".diagonal-up-line-input").prop("checked", !1).button("refresh"), e.diagonalDownBorder ? (this.Wz = e.diagonalDownBorder.color, this.Gw = e.diagonalDownBorder.style, this.Eo.find(".diagonal-down-line-input").prop("checked", !0).button("refresh"), this.Eo.find(".diagonal-down-line-input").trigger("change")) : this.Eo.find(".diagonal-down-line-input").prop("checked", !1).button("refresh"), !e.borderTop || !e.borderBottom || !e.borderLeft || !e.borderRight || t && !e.borderHorizontal || i && !e.borderVertical ? (this.Gw = 1, this.Wz = "Text 1", o = r.ColorHelper.parse("Text 1", r.wrapper.spread.getActiveSheet().currentTheme().colors()), this.Eo.find(".border-picker").borderpicker("option", "borderColor", o), this.Eo.find(".border-picker").borderpicker("option", "lineStyle", 1)) : (n = e.borderTop.color, a = e.borderTop.style, n !== e.borderBottom.color || i && n !== e.borderVertical.color || t && n !== e.borderHorizontal.color || n !== e.borderLeft.color || n !== e.borderRight.color ? (this.Wz = "Text 1", o = r.ColorHelper.parse("Text 1", r.wrapper.spread.getActiveSheet().currentTheme().colors()), this.Eo.find(".border-picker").borderpicker("option", "borderColor", o)) : (o = r.ColorHelper.parse(n, r.wrapper.spread.getActiveSheet().currentTheme().colors()), this.Eo.find(".border-picker").borderpicker("option", "borderColor", o), this.Wz = n), a !== e.borderBottom.style || i && a !== e.borderVertical.style || t && a !== e.borderHorizontal.style || a !== e.borderLeft.style || a !== e.borderRight.style ? (this.Gw = 1, this.Eo.find(".border-picker").borderpicker("option", "lineStyle", 1)) : (this.Eo.find(".border-picker").borderpicker("option", "lineStyle", a), this.Gw = a)), setTimeout(function() { s.EA.refresh() }, 0)
                }, t.prototype.cA = function() {
                    var e, t, i = r.wrapper.spread.getActiveSheet(),
                        o = i.getSelections();
                    if (1 === o.length) return e = i.getSpans(o[0]), 1 === e.length && e[0].row === o[0].row && e[0].rowCount === o[0].rowCount && e[0].col === o[0].col && e[0].colCount === o[0].colCount || e.length > 0 && r.BaseMetaObject.indeterminateValue;
                    for (t = 0; t < o.length; t++)
                        if (e = i.getSpans(o[t]), e.length > 0) return r.BaseMetaObject.indeterminateValue;
                    return !1
                }, t.prototype.setFormatDirectly = function(e) { this.Qz = e }, t.prototype.LA = function(e, t, i) { var o = $("<div></div>").addClass("gcui-numberpicker hidden " + i); return $("<label></label>").attr("for", t).css({ "vertical-align": "middle", "margin-right": "5px" }).text(r.res.formatNumberPickerSetting.decimalPlaces).appendTo(o), $("<input>").attr({ id: t, value: "2" }).addClass(e + " format-decimal-input").appendTo(o), o }, t.prototype.MA = function(e, t, i) { var o = $("<div></div>").addClass("gcui-numberpicker hidden " + i); return $("<input>").attr({ id: t, type: "checkbox" }).addClass(e).appendTo(o), $("<label></label>").attr("for", t).text(r.res.formatNumberPickerSetting.separator).appendTo(o), o }, t.prototype.NA = function(e, t, i) { var o, n, a = $("<div></div>").addClass("gcui-numberpicker hidden " + i); for ($("<label><label>").css({ "margin-right": "5px" }).text(r.res.formatNumberPickerSetting.symbol).appendTo(a), o = $("<select></select>").attr("size", 1).addClass(t), n = 0; n < e.length; n++) o.append($("<option></option>").text(e[n][0])); return a.append(o), a }, t.prototype.OA = function(e, t, i, o) {
                    var n, r, a, s, l = i + "-container",
                        c = $("<div></div>").addClass("gcui-numberpicker hidden " + o + " " + l),
                        d = "format-number-label",
                        p = $("<div></div>").addClass(d);
                    if ($("<label></label>").text(t).appendTo(p), n = $("<select></select>").attr({ name: i + "-list", size: 6 }).addClass(i + "-select"), Array.isArray(e))
                        for (r = 0; r < e.length; r++) n.append($("<option></option>").val(e[r]).text(e[r]));
                    else
                        for (a in e) - 1 !== a.indexOf("red") ? n.append($("<option></option>").css("color", "red").val(a).text(e[a])) : n.append($("<option></option>").val(a).text(e[a]));
                    return n.get(0).selectedIndex = 0, "custom-type" === i ? (s = $("<input></input>").addClass("custom-type-input"), c.append(p).append(s).append(n)) : c.append(p).append(n), c
                }, t.prototype.PA = function(e, t) { var i = "spread-format-" + t; return $("<p></p>").text(e).addClass("gcui-numberpicker hidden " + i) }, t.prototype.QA = function(e, t, i, o, n) {
                    var r, a, s = i + "-container",
                        l = $("<div></div>").addClass("gcui-numberpicker hidden " + o + " " + s),
                        c = "format-number-label",
                        d = $("<div></div>").addClass(c);
                    $("<label></label>").text(t).appendTo(d), r = $("<select></select>").addClass(i + "-select " + n);
                    for (a in e) r.append($("<option></option>").val(a).text(e[a]));
                    return r.get(0).selectedIndex = 0, l.append(d).append(r), l
                }, t.prototype.HA = function() {
                    var e, t;
                    this.RA(), this.SA(), this.TA(), this.UA(), this.VA(), this.WA(), this.XA(), this.YA(), this.ZA(), this.$A(), this._A(), this.aB(), e = this;

                    function i(t) {
                        var i, o;
                        e.Eo.find(".gcui-numberpicker").addClass("hidden"), i = e.Eo.find(".category-select option:selected").val(), o = "spread-format-" + i, e.Eo.find(".gcui-numberpicker").each(function(e, t) { $(t).hasClass(o) && $(t).removeClass("hidden") }), e.bB(t, i)
                    }
                    t = this.Eo.find(".category-select"), t.bind("click", i), t.bind("mousemove", function(e) { return !1 }), t.bind("change", i)
                }, t.prototype.bB = function(e, t) {
                    if ("general" === t) this.cB();
                    else if ("numbers" === t) {
                        var i = this.Eo.find(".negative-number-select").get(0).selectedIndex;
                        this.dB(i), this.eB()
                    } else "accounting" === t ? this.fB() : "currency" === t ? (this.gB(), this.hB()) : "date" === t ? this.iB() : "time" === t ? this.jB() : "percentage" === t ? this.kB() : "fraction" === t ? this.lB() : "scientific" === t ? this.mB() : "text" === t ? this.nB() : "special" === t ? this.oB() : "custom" === t && (this.pB(), this.qB());
                    this.$z(), this.rB()
                }, t.prototype.UA = function() {
                    var e = this,
                        t = this.LA("currency-decimal-places-input", "currency-decimal-places", "spread-format-currency"),
                        i = this.NA(r.res.accountingSymbol, "currency-symbol-dropdown", "spread-format-currency"),
                        o = this.PA(r.res.formatNumberComments.currencyComments, "currency"),
                        n = this.OA(r.res.currencyNegativeNumbers, r.res.formatNumberPickerSetting.negativeNumber, "currency-type", "spread-format-currency");
                    this.Eo.find(".tab-number-setting").append(t).append(i), this.Eo.find(".tab-number-comments").append(o), this.Eo.find(".tab-number-setting").append(n), this.Eo.find(".currency-symbol-dropdown").get(0).selectedIndex = 1, this.Eo.find(".currency-type-select").change(function() { e.gB() }), this.Eo.find(".currency-symbol-dropdown").change(function() { e.gB(), e.hB() }), this.Eo.find(".currency-decimal-places-input").spinner({
                        min: 0,
                        max: 16,
                        change: function() {
                            var t = e.Eo.find(".currency-decimal-places-input").val();
                            e.Eo.find(".format-decimal-input").val(t), e.gB(), e.hB()
                        },
                        spin: function() {
                            var t = arguments[1].value;
                            e.Eo.find(".format-decimal-input").val(t), e.gB(), e.hB()
                        }
                    })
                }, t.prototype.VA = function() {
                    var e, t, i, o, n, a = this,
                        s = [],
                        l = r.res.dateFormats;
                    for (e = 0; e < l.length; e++) s.push(this.sB(this.vA, l[e]));
                    t = this.OA(s, r.res.formatNumberPickerSetting.type, "date-type", "spread-format-date"), i = this.PA(r.res.formatNumberComments.dateComments, "date"), o = this.QA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "date-type-locale", "spread-format-date", "type-locale-select"), n = this.QA(r.res.calendarType, r.res.formatNumberPickerSetting.calendar, "date-type-calendar", "spread-format-date-calendar"), this.Eo.find(".tab-number-setting").append(t).append(o).append(n), this.Eo.find(".tab-number-comments").append(i), this.Eo.find(".date-type-select").change(function() { a.iB() }), this.Eo.find(".date-type-locale-select").change(function() {
                        var e = a.Eo.find(".date-type-locale-select").find("option:selected").val();
                        a.Eo.find(".type-locale-select").val(e), a.tB(), a.iB(), a.Eo.find(".date-type-select").change(function() { a.iB() })
                    }), this.Eo.find(".date-type-calendar-select").change(function() { a.tB(), a.iB(), a.Eo.find(".date-type-select").change(function() { a.iB() }) })
                }, t.prototype.tB = function() {
                    var e, t, i, o, n, a, s, l, c = [],
                        d = this.Eo.find(".date-type-locale-select").find("option:selected").val(),
                        p = new Date(this.vA);
                    switch (d) {
                        case "ja_jp":
                            if (this.Eo.find(".spread-format-date-calendar").removeClass("hidden"), "western" === (t = this.Eo.find(".date-type-calendar-select").find("option:selected").val()))
                                for (i = r.res.japanWesternDateFormat, e = 0; e < i.length; e++) c.push(this.sB(p, i[e]));
                            else if ("JER" === t)
                                for (o = r.res.japanEmperorReignDateFormat, e = 0; e < o.length; e++) c.push(this.sB(p, o[e]));
                            break;
                        case "en_us":
                            for (this.Eo.find(".spread-format-date-calendar").addClass("hidden"), n = r.res.dateFormats, e = 0; e < n.length; e++) c.push(this.sB(p, n[e]));
                            break;
                        case "ko_kr":
                            for (this.Eo.find(".spread-format-date-calendar").addClass("hidden"), a = r.res.koreanDateFormat, e = 0; e < a.length; e++) c.push(this.sB(p, a[e]));
                            break;
                        case "zh_cn":
                            for (this.Eo.find(".spread-format-date-calendar").addClass("hidden"), s = r.res.chinaDateFormat, e = 0; e < s.length; e++) c.push(this.sB(p, s[e]))
                    }
                    0 !== c.length && (this.Eo.find(".date-type-container").remove(), l = this.OA(c, r.res.formatNumberPickerSetting.type, "date-type", "spread-format-date"), l.insertBefore(this.Eo.find(".date-type-locale-container")), l.removeClass("hidden"))
                }, t.prototype.aB = function() {
                    var e = this,
                        t = this.OA(r.res.customFormats, r.res.formatNumberPickerSetting.type, "custom-type", "spread-format-custom"),
                        o = this.PA(r.res.formatNumberComments.customComments, "custom"),
                        n = $("<div></div>").addClass("custom-type-div custom-class gcui-numberpicker hidden spread-format-custom"),
                        a = $("<button></button>").addClass("custom-type-button custom-class");
                    $("<span></span>").text(r.res.formatNumberPickerSetting.deleted).appendTo(a), n.append(a), this.Eo.find(".tab-number-setting").append(t).append(n), this.Eo.find(".tab-number-comments").append(o), this.Eo.find(".custom-type-select").change(function() {
                        var t = e.Eo.find(".custom-type-select").find("option:selected").text();
                        e.Eo.find(".custom-type-input").val(t), e.qB(), e.rB()
                    }), this.Eo.find(".custom-type-input").bind("input propertychange", function() { e.qB(), e.rB() }), this.Eo.find(".custom-type-button").click(function() { e.$z(!1), e.uB = i, e.Eo.find(".custom-type-input").val(""), e.Eo.find(".sample-display").text(e.sB(e.vB, "")) })
                }, t.prototype.rB = function() {
                    var e = r.res.customFormats,
                        t = this.Eo.find(".custom-type-input").val();
                    if ($.inArray(t, this.uA) >= 0 || $.inArray(t, e) < 0) return void this.Eo.find(".custom-type-button").attr("disabled", !1);
                    this.Eo.find(".custom-type-button").attr("disabled", !0)
                }, t.prototype.$z = function(e) {
                    var t, i, o, n, a, s = this.Eo.find(".custom-type-input").val();
                    if (void 0 === e && (e = !0), s) {
                        if (t = r.res.customFormats, e) {
                            if ($.inArray(s, t) >= 0) return;
                            $.inArray(s, this.uA) < 0 && (this.uA.push(s), $.merge(r.res.customFormats, [s]))
                        } else {
                            if ($.inArray(s, t) < 0) return;
                            i = $.inArray(s, t), o = $.inArray(s, this.uA), i >= 0 && o >= 0 && (this.uA.splice(o, 1), t.splice(i, 1))
                        }
                        for (n = this.Eo.find(".custom-type-select"), n.empty(), a = 0; a < t.length; a++) n.append($("<option></option>").val(t[a]).text(t[a]))
                    }
                }, t.prototype.WA = function() {
                    var e, t, i, o, n = this,
                        a = [],
                        s = r.res.timeFormats;
                    for (e = 0; e < s.length; e++) a.push(this.sB(this.vA, s[e]));
                    t = this.OA(a, r.res.formatNumberPickerSetting.type, "time-type", "spread-format-time"), i = this.PA(r.res.formatNumberComments.timeComments, "time"), o = this.QA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "time-type-locale", "spread-format-time", "type-locale-select"), this.Eo.find(".tab-number-setting").append(t).append(o), this.Eo.find(".tab-number-comments").append(i), this.Eo.find(".time-type-select").change(function() { n.jB() }), this.Eo.find(".time-type-locale-select").change(function() {
                        var e = n.Eo.find(".time-type-locale-select").find("option:selected").val();
                        n.Eo.find(".type-locale-select").val(e), n.wB(), n.jB(), n.Eo.find(".time-type-select").change(function() { n.jB() })
                    })
                }, t.prototype.wB = function() {
                    var e, t, i, o, n, a, s = [],
                        l = this.Eo.find(".time-type-locale-select").find("option:selected").val();
                    switch (l) {
                        case "ja_jp":
                            for (t = r.res.japanTimeFormats, e = 0; e < t.length; e++) s.push(this.sB(this.vA, t[e]));
                            break;
                        case "en_us":
                            for (i = r.res.timeFormats, e = 0; e < i.length; e++) s.push(this.sB(this.vA, i[e]));
                            break;
                        case "zh_cn":
                            for (o = r.res.chinaTimeFormats, e = 0; e < o.length; e++) s.push(this.sB(this.vA, o[e]));
                            break;
                        case "ko_kr":
                            for (n = r.res.koreanTimeFormats, e = 0; e < n.length; e++) s.push(this.sB(this.vA, n[e]))
                    }
                    0 !== s.length && (this.Eo.find(".time-type-container").remove(), a = this.OA(s, r.res.formatNumberPickerSetting.type, "time-type", "spread-format-time"), a.insertBefore(this.Eo.find(".time-type-locale-container")), a.removeClass("hidden"))
                }, t.prototype.XA = function() {
                    var e = this,
                        t = this.LA("percentage-decimal-places-input", "percentage-decimal-places", "spread-format-percentage"),
                        i = this.PA(r.res.formatNumberComments.percentageComments, "percentage");
                    this.Eo.find(".tab-number-comments").append(i), this.Eo.find(".tab-number-setting").append(t), this.Eo.find(".percentage-decimal-places-input").spinner({
                        min: 0,
                        max: 16,
                        change: function() {
                            var t = e.Eo.find(".percentage-decimal-places-input").val();
                            e.Eo.find(".format-decimal-input").val(t), e.kB()
                        },
                        spin: function() {
                            var t = arguments[1].value;
                            e.Eo.find(".format-decimal-input").val(t), e.kB()
                        }
                    })
                }, t.prototype.ZA = function() {
                    var e = this,
                        t = this.LA("scientific-decimal-places-input", "scientific-decimal-places", "spread-format-scientific");
                    this.Eo.find(".tab-number-setting").append(t), this.Eo.find(".scientific-decimal-places-input").spinner({
                        min: 0,
                        max: 16,
                        change: function() {
                            var t = e.Eo.find(".scientific-decimal-places-input").val();
                            e.Eo.find(".format-decimal-input").val(t), e.mB()
                        },
                        spin: function() {
                            var t = arguments[1].value;
                            e.Eo.find(".format-decimal-input").val(t), e.mB()
                        }
                    })
                }, t.prototype.YA = function() {
                    var e = this,
                        t = this.OA(r.res.fractionType, r.res.formatNumberPickerSetting.type, "fraction-type", "spread-format-fraction");
                    this.Eo.find(".tab-number-setting").append(t), this.Eo.find(".fraction-type-select").change(function() { e.lB() })
                }, t.prototype._A = function() {
                    var e = this,
                        t = this.OA(r.res.specialType, r.res.formatNumberPickerSetting.type, "special-type", "spread-format-special"),
                        i = this.PA(r.res.formatNumberComments.specialComments, "special"),
                        o = this.QA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "special-type-locale", "spread-format-special", "special-locale-select");
                    this.Eo.find(".tab-number-setting").append(t).append(o), this.Eo.find(".tab-number-comments").append(i), this.Eo.find(".special-type-select").change(function() { e.oB() }), this.Eo.find(".special-type-locale-select").change(function() {
                        var t = e.Eo.find(".special-type-locale-select").find("option:selected").val();
                        e.Eo.find(".type-locale-select").val(t), e.xB(), e.oB(), e.Eo.find(".special-type-select").change(function() { e.oB() })
                    })
                }, t.prototype.xB = function() {
                    var e, t = r.res.specialType,
                        i = this.Eo.find(".special-type-locale-select").find("option:selected").val();
                    switch (i) {
                        case "ja_jp":
                            t = r.res.specialJapanType;
                            break;
                        case "en_us":
                            t = r.res.specialType;
                            break;
                        case "ko_kr":
                            t = r.res.specialKoreanType;
                            break;
                        case "zh_cn":
                            t = r.res.specialChinaType
                    }
                    0 !== t.length && (this.Eo.find(".special-type-container").remove(), e = this.OA(t, r.res.formatNumberPickerSetting.type, "special-type", "spread-format-special"), e.insertBefore(this.Eo.find(".special-type-locale-container")), e.removeClass("hidden"))
                }, t.prototype.TA = function() {
                    var e = this,
                        t = this.LA("accounting-decimal-places-input", "accounting-decimal-places", "spread-format-accounting"),
                        i = this.NA(r.res.accountingSymbol, "accounting-symbol-dropdown", "spread-format-accounting"),
                        o = this.PA(r.res.formatNumberComments.accountingComments, "accounting");
                    this.Eo.find(".tab-number-setting").append(t).append(i), this.Eo.find(".tab-number-comments").append(o), this.Eo.find(".accounting-symbol-dropdown").get(0).selectedIndex = 1, this.Eo.find(".accounting-symbol-dropdown").change(function() { e.fB() }), this.Eo.find(".accounting-decimal-places-input").spinner({
                        min: 0,
                        max: 16,
                        change: function() {
                            var t = e.Eo.find(".accounting-decimal-places-input").val();
                            e.Eo.find(".format-decimal-input").val(t), e.fB()
                        },
                        spin: function() {
                            var t = arguments[1].value;
                            e.Eo.find(".format-decimal-input").val(t), e.fB()
                        }
                    })
                }, t.prototype.yB = function() { this.Eo.find(".category-select").val("general").trigger("change"), this.Eo.find(".category-select").get(0).selectedIndex = -1, this.Eo.find(".format-decimal-input").val(2), this.Eo.find(".currency-symbol-dropdown").get(0).selectedIndex = 1, this.Eo.find(".accounting-symbol-dropdown").get(0).selectedIndex = 1, this.Eo.find(".currency-type-select").get(0).selectedIndex = 0, this.uB = i, this.Tz.formatter(this.uB) }, t.prototype.RA = function() {
                    var e = this.PA(r.res.formatNumberComments.generalComments, "general");
                    this.Eo.find(".tab-number-setting").append(e)
                }, t.prototype.$A = function() {
                    var e = this.PA(r.res.formatNumberComments.textComments, "text");
                    this.Eo.find(".tab-number-setting").append(e)
                }, t.prototype.SA = function() {
                    var e = this,
                        t = this.LA("decimal-places-input", "decimal-places", "spread-format-numbers"),
                        i = this.MA("separator-input", "thousand-separator", "spread-format-numbers"),
                        o = this.OA(r.res.negativeNumbers, r.res.formatNumberPickerSetting.negativeNumber, "negative-number", "spread-format-numbers"),
                        n = this.PA(r.res.formatNumberComments.numberComments, "numbers");
                    this.Eo.find(".tab-number-setting").append(t).append(i), this.Eo.find(".tab-number-setting").append(o), this.Eo.find(".tab-number-comments").append(n), this.Eo.find(".negative-number-select").change(function() {
                        var t = this.selectedIndex;
                        e.dB(t)
                    }), this.Eo.find(".separator-input").change(function() {
                        e.eB();
                        var t = e.Eo.find(".negative-number-select").get(0).selectedIndex;
                        e.dB(t)
                    }), this.Eo.find(".decimal-places-input").spinner({
                        min: 0,
                        max: 16,
                        change: function() {
                            var t, i = e.Eo.find(".decimal-places-input").val();
                            e.Eo.find(".format-decimal-input").val(i), e.eB(), t = e.Eo.find(".negative-number-select").get(0).selectedIndex, e.dB(t)
                        },
                        spin: function() {
                            var t, i = arguments[1].value;
                            e.Eo.find(".format-decimal-input").val(i), e.eB(), t = e.Eo.find(".negative-number-select").get(0).selectedIndex, e.dB(t)
                        }
                    })
                }, t.prototype.cB = function() { this.Eo.find(".sample-display").text(this.sB(this.vB, r.res.generalFormat)), this.uB = "General", this.Tz.formatter(this.uB) }, t.prototype.nB = function() { this.Eo.find(".sample-display").text(this.sB(this.vB, r.res.textFormats[0])), this.uB = "@", this.Tz.formatter(this.uB) }, t.prototype.fB = function() {
                    var e = this.Eo.find(".accounting-symbol-dropdown").get(0).selectedIndex,
                        t = this.Eo.find(".accounting-decimal-places-input").val(),
                        i = this.zB(t, e);
                    this.Eo.find(".sample-display").text(this.sB(this.vB, i)), this.uB = i, this.Tz.formatter(this.uB)
                }, t.prototype.eB = function() {
                    var e, t, i, o, n, a, s = this.Eo.find(".separator-input").prop("checked"),
                        l = r.res.negativeNumbers,
                        c = "1234.10",
                        d = parseInt(this.Eo.find(".decimal-places-input").val());
                    if (d > 0) {
                        for (e = "", t = 0; t < d; t++) e = "" + t % 10 + e.substring(0);
                        c = c.substring(0, c.indexOf(".") + 1) + e
                    } else c = c.substring(0, c.indexOf("."));
                    s && (i = c.indexOf("1"), c = c.substring(0, i + 1) + "," + c.substring(i + 1));
                    for (o in l) n = c, a = l[o], -1 !== a.indexOf("-") && (n = "-" + n), -1 !== a.indexOf(")") && (n = "(" + n + ")"), this.Eo.find(".negative-number-select").find("option[value='" + o + "']").text(n)
                }, t.prototype.hB = function() {
                    var e, t, i, o, n, a, s, l = parseInt(this.Eo.find(".currency-decimal-places-input").val()),
                        c = r.res.currencyNegativeNumbers,
                        d = "1,234.10",
                        p = this.Eo.find(".currency-symbol-dropdown").get(0).selectedIndex;
                    if (l > 0) {
                        for (e = "", t = 0; t < l; t++) e = "" + t % 10 + e.substring(0);
                        d = d.substring(0, d.indexOf(".") + 1) + e
                    } else d = d.substring(0, d.indexOf("."));
                    i = r.res.accountingSymbol[p][1], i === r.res.accountingSymbol[0][1] && (i = ""), o = !0;
                    for (n in c) a = d, s = c[n], -1 !== s.indexOf("-") && o ? (a = "-" + i + a, o = !1) : a = -1 !== s.indexOf("-") ? i + "-" + a : i + a, this.Eo.find(".currency-type-select").find("option[value='" + n + "']").text(a)
                }, t.prototype.dB = function(e) {
                    var t = this.Eo.find(".separator-input").prop("checked"),
                        i = parseInt(this.Eo.find(".decimal-places-input").val()),
                        o = this.AB(e, i, t);
                    this.Eo.find(".sample-display").text(this.sB(this.vB, o)), this.uB = o, this.Tz.formatter(this.uB)
                }, t.prototype.qB = function() {
                    var e = this.Eo.find(".custom-type-input").val();
                    this.BB(e) && (this.Eo.find(".sample-display").text(this.sB(this.vB, e)), this.uB = e, this.Tz.formatter(this.uB))
                }, t.prototype.BB = function(e) {
                    var t, i = [];
                    for (t = 0; t < e.length; t++)
                        if ("[" === e[t] && i.push(t), "]" === e[t]) {
                            if (0 === i.length) return !1;
                            i.pop()
                        } return 0 === i.length
                }, t.prototype.pB = function() {
                    if (this.uB) this.Eo.find(".custom-type-input").val(this.uB);
                    else {
                        var e = this.Eo.find(".custom-type-select").find("option:selected").text();
                        this.Eo.find(".custom-type-input").val(e)
                    }
                }, t.prototype.lB = function() {
                    var e = r.res.fractionFormats,
                        t = this.Eo.find(".fraction-type-select").get(0).selectedIndex,
                        i = e[t];
                    this.Eo.find(".sample-display").text(this.sB(this.vB, i)), this.uB = i, this.Tz.formatter(this.uB)
                }, t.prototype.oB = function() {
                    var e, t = r.res.specialFormats,
                        i = this.Eo.find(".special-type-select").get(0).selectedIndex,
                        o = this.Eo.find(".special-type-locale-select").find("option:selected").val();
                    switch (o) {
                        case "ja_jp":
                            t = r.res.specialJapanFormats;
                            break;
                        case "en_us":
                            t = r.res.specialFormats;
                            break;
                        case "ko_kr":
                            t = r.res.specialKoreanFormats;
                            break;
                        case "zh_cn":
                            t = r.res.specialChinaFormats
                    }
                    e = t[i], this.Eo.find(".sample-display").text(this.sB(this.vB, e)), this.uB = e, this.Tz.formatter(this.uB)
                }, t.prototype.mB = function() {
                    var e, t, i = this.Eo.find(".scientific-decimal-places-input").val(),
                        o = "";
                    if (i > 0) {
                        for (t = 0; t < i; t++) o += "0";
                        e = "0." + o + "E+00"
                    } else e = "0E+00";
                    this.Eo.find(".sample-display").text(this.sB(this.vB, e)), this.uB = e, this.Tz.formatter(this.uB)
                }, t.prototype.kB = function() {
                    var e, t, i = this.Eo.find(".percentage-decimal-places-input").val(),
                        o = "";
                    if (i > 0) {
                        for (t = 0; t < i; t++) o += "0";
                        e = "0." + o + "%"
                    } else e = "0%";
                    this.Eo.find(".sample-display").text(this.sB(this.vB, e)), this.uB = e, this.Tz.formatter(this.uB)
                }, t.prototype.jB = function() {
                    var e, t = this.Eo.find(".time-type-select").get(0).selectedIndex,
                        i = r.res.timeFormats,
                        o = this.Eo.find(".time-type-locale-select").find("option:selected").val();
                    switch (o) {
                        case "ja_jp":
                            i = r.res.japanTimeFormats;
                            break;
                        case "en_us":
                            i = r.res.timeFormats;
                            break;
                        case "ko_kr":
                            i = r.res.koreanTimeFormats;
                            break;
                        case "zh_cn":
                            i = r.res.chinaTimeFormats
                    }
                    e = i[t], this.Eo.find(".sample-display").text(this.sB(this.vB, e)), this.uB = e, this.Tz.formatter(this.uB)
                }, t.prototype.iB = function() {
                    var e, t, i = this.Eo.find(".date-type-select").get(0).selectedIndex,
                        o = r.res.dateFormats,
                        n = this.Eo.find(".date-type-locale-select").find("option:selected").val();
                    switch (n) {
                        case "ja_jp":
                            this.Eo.find(".spread-format-date-calendar").removeClass("hidden"), e = this.Eo.find(".date-type-calendar-select").find("option:selected").val(), "western" === e ? o = r.res.japanWesternDateFormat : "JER" === e && (o = r.res.japanEmperorReignDateFormat);
                            break;
                        case "en_us":
                            this.Eo.find(".spread-format-date-calendar").addClass("hidden"), o = r.res.dateFormats;
                            break;
                        case "ko_kr":
                            this.Eo.find(".spread-format-date-calendar").addClass("hidden"), o = r.res.koreanDateFormat;
                            break;
                        case "zh_cn":
                            this.Eo.find(".spread-format-date-calendar").addClass("hidden"), o = r.res.chinaDateFormat
                    }
                    t = o[i], this.Eo.find(".sample-display").text(this.sB(this.vB, t)), this.uB = t, this.Tz.formatter(this.uB)
                }, t.prototype.gB = function() {
                    var e = this.Eo.find(".currency-decimal-places-input").val(),
                        t = this.Eo.find(".currency-type-select").get(0).selectedIndex,
                        i = this.CB(t, e);
                    this.Eo.find(".sample-display").text(this.sB(this.vB, i)), this.uB = i, this.Tz.formatter(this.uB)
                }, t.prototype.sB = function(e, t) { var i = this.tA.getActiveSheet(); return i.setFormatter(0, 0, t), i.setValue(0, 0, e), i.getText(0, 0) }, t.prototype.CB = function(e, t) {
                    var i, o, n, s, l, c, d, p, u, h, f, g, m, b;
                    if (-1 === e && (e = 0), n = r.res.currencyFormats[e], t > 0) {
                        for (l = "", s = 0; s < t; s++) l += "0";
                        n = n.replace(/#0/g, "#0." + l)
                    }
                    if (c = n.split(";"), d = r.res.accountingSymbol, p = this.Eo.find(".currency-symbol-dropdown").get(0).selectedIndex, i = d[p][1], u = d[p][2], h = a[u && u.toLowerCase()] || u, null === i) return n;
                    if ("$" === i)
                        for (n = "", o = "$", s = 0; s < c.length; s++) f = c[s], g = f.indexOf("[Red]"), m = 5, -1 !== g ? (b = f.substring(0, g + m) + o + f.substring(g + m), n = n + b + ";") : n = n + o + f + ";";
                    else
                        for (n = "", s = 0; s < c.length; s++) f = c[s], g = f.indexOf("[Red]"), m = 5, -1 !== g ? (b = f.substring(0, g + m) + "[$" + i + "-" + h + "]" + f.substring(g + m), n = n + b + ";") : n = n + "[$" + i + "-" + h + "]" + f + ";";
                    return "" !== n && ";" === n.charAt(n.length - 1) && (n = n.substring(0, n.length - 1)), n
                }, t.prototype.zB = function(e, t) {
                    var i, o, n, s, l, c, d, p, u = r.res.accountingSymbol,
                        h = r.res.accountingFormats[0],
                        f = u[t][1],
                        g = u[t][2],
                        m = a[g && g.toLowerCase()] || g;
                    if (e > 0) {
                        for (o = "", n = 0; n < e; n++) o += "0";
                        h = h.replace(/#0/g, "#0." + o)
                    }
                    return s = h.split(";"), null === f ? h : ("$" === f ? (i = " $", l = s[0].replace(/_\(\*/g, i + "*"), l = l.replace(/_\)/g, " "), c = s[1].replace(/_\(\*/g, i + "*"), c = c.replace(/\(/g, ""), c = c.replace(/\)/g, " "), d = s[2].replace(/_\(\*/, i + "*"), d = d.replace(/_\)/g, " "), p = s[3].replace(/_\(/g, " "), p = p.replace(/_\)/g, " "), h = l + ";" + c + ";" + d + ";" + p) : (l = s[0].replace(/_\(\*/g, "_-[$" + f + "-" + m + "]*"), l = l.replace(/_\)/, "_-"), c = s[1].replace(/_\(\*/g, "-[$" + f + "-" + m + "]*"), c = c.replace(/\(/g, ""), c = c.replace(/\)/g, "_-"), d = s[2].replace(/_\(\*/g, "_-[$" + f + "-" + m + "]*"), d = d.replace(/_\)/g, "_-"), p = s[3].replace(/_\(/g, "_-"), p = p.replace(/_\)/g, "_-"), h = l + ";" + c + ";" + d + ";" + p), h)
                }, t.prototype.AB = function(e, t, i) {
                    var o, n, a = r.res.numberFormats,
                        s = a.length / 2,
                        l = a[e];
                    if (i && (l = a[e + s]), t > 0) {
                        for (o = "", n = 0; n < t; n++) o += "0";
                        l = l.replace(/0/g, "0." + o)
                    }
                    return l
                }, t.prototype.gA = function(e, t) {
                    var o, n, r, a, s, l = t.getActiveSheet(),
                        c = l.getSelections(),
                        d = c.length;
                    if (0 !== d) {
                        for (o = -1 === c[0].row ? 0 : c[0].row, n = -1 === c[0].col ? 0 : c[0].col, r = l.getValue(o, n), null !== r && void 0 !== r || (r = ""), a = 0; a < d; a++)
                            if (o = -1 === c[a].row ? 0 : c[a].row, n = -1 === c[a].col ? 0 : c[a].col, void 0 === e) { if ("" === r) break } else e !== l.getFormatter(o, n) && (e = i);
                        s = this.DB(), s && !this.EB(e) && (e = s), this.vB = r, this.uB = e, void 0 !== e ? (this.Eo.find(".sample-display").text(this.sB(r, e)), this.FB(e)) : this.yB()
                    }
                }, t.prototype.fA = function(e) { this.uB = e, void 0 !== e ? this.FB(e) : this.yB() }, t.prototype.FB = function(e) {
                    var t, i, o, n, a, s, l, c, d, p, u, h, f, g = 0,
                        m = !1,
                        b = r.res.dateFormats,
                        v = r.res.japanWesternDateFormat,
                        y = r.res.japanEmperorReignDateFormat,
                        w = r.res.timeFormats,
                        x = r.res.japanTimeFormats,
                        C = r.res.specialFormats,
                        S = r.res.specialJapanFormats,
                        k = r.res.numberFormats,
                        T = r.res.currencyFormats,
                        A = r.res.accountingFormats,
                        E = r.res.percentageFormats,
                        I = r.res.scientificFormats,
                        D = r.res.fractionFormats,
                        L = r.res.customFormats;
                    if (this.Eo.find(".custom-type-input").val(e), i = this.EB(e)) {
                        if (this.Eo.find(".category-select").val("date").trigger("change"), (o = $.inArray(i, b)) >= 0) return this.Eo.find(".date-type-locale-select").val("en_us").trigger("change"),
                            this.Eo.find(".date-type-select").get(0).selectedIndex = o, void this.Eo.find(".date-type-select").trigger("change");
                        if ((o = $.inArray(i, v)) >= 0) return this.Eo.find(".date-type-locale-select").val("ja_jp").trigger("change"), this.Eo.find(".date-type-calendar-select").val("western").trigger("change"), this.Eo.find(".date-type-select").get(0).selectedIndex = o, void this.Eo.find(".date-type-select").trigger("change");
                        if ((o = $.inArray(i, y)) >= 0) return this.Eo.find(".date-type-locale-select").val("ja_jp").trigger("change"), this.Eo.find(".date-type-calendar-select").val("JER").trigger("change"), this.Eo.find(".date-type-select").get(0).selectedIndex = o, void this.Eo.find(".date-type-select").trigger("change")
                    }
                    if ((n = $.inArray(e, w)) >= 0) return this.Eo.find(".category-select").val("time").trigger("change"), this.Eo.find(".time-type-locale-select").val("en_us").trigger("change"), this.Eo.find(".time-type-select").get(0).selectedIndex = n, void this.Eo.find(".time-type-select").trigger("change");
                    if ((n = $.inArray(e, x)) >= 0) return this.Eo.find(".category-select").val("time").trigger("change"), this.Eo.find(".time-type-locale-select").val("ja_jp").trigger("change"), this.Eo.find(".time-type-select").get(0).selectedIndex = n, void this.Eo.find(".time-type-select").trigger("change");
                    if ((a = $.inArray(e, C)) >= 0) return this.Eo.find(".category-select").val("special").trigger("change"), this.Eo.find(".special-type-locale-select").val("en_us").trigger("change"), this.Eo.find(".special-type-select").get(0).selectedIndex = a, void this.Eo.find(".special-type-select").trigger("change");
                    if ((a = $.inArray(e, S)) >= 0) return this.Eo.find(".category-select").val("special").trigger("change"), this.Eo.find(".special-type-locale-select").val("ja_jp").trigger("change"), this.Eo.find(".special-type-select").get(0).selectedIndex = a, void this.Eo.find(".special-type-select").trigger("change");
                    for (t = 0; t < D.length; t++)
                        if (e === D[t]) return this.Eo.find(".category-select").val("fraction").trigger("change"), this.Eo.find(".fraction-type-select").get(0).selectedIndex = t, void this.Eo.find(".fraction-type-select").trigger("change");
                    if ("General" === e) return void this.Eo.find(".category-select").val("general").trigger("change");
                    if ("@" === e) return void this.Eo.find(".category-select").val("text").trigger("change");
                    if (-1 !== e.indexOf(".")) {
                        for (s = e.indexOf("."), t = s + 1; t < e.length && "0" === e.substring(t, t + 1); t++) g++;
                        this.Eo.find(".format-decimal-input").val(g)
                    }
                    for (l = e.substring(e.indexOf("."), e.indexOf(".") + g + 1), c = e.replace(RegExp(l, "g"), ""), t = 0; t < k.length; t++)
                        if (c === k[t]) return this.Eo.find(".category-select").val("numbers").trigger("change"), this.Eo.find(".negative-number-select").get(0).selectedIndex = t % 4, this.Eo.find(".negative-number-select").trigger("change"), void(-1 !== e.indexOf("#,") && (m = !0, this.Eo.find(".separator-input").prop("checked", m)));
                    for (-1 !== e.indexOf("$") && (c = c.replace(/\$/g, "")), d = c.replace(/\[\xa5-804]|\[\xa5-411]/g, ""), t = 0; t < T.length; t++)
                        if (d === T[t]) return this.Eo.find(".category-select").val("currency").trigger("change"), this.Eo.find(".currency-type-select").get(0).selectedIndex = t % 4, this.Eo.find(".currency-type-select").trigger("change"), p = c.indexOf("\xa5-804") >= 0 ? 2 : c.indexOf("\xa5-411") >= 0 ? 3 : 1, void(this.Eo.find(".currency-symbol-dropdown").get(0).selectedIndex = p);
                    for (u = A.length, h = 0; h < u; h++)
                        if (e === A[h]) return this.Eo.find(".category-select").val("accounting").trigger("change"), void(this.Eo.find(".accounting-symbol-dropdown").get(0).selectedIndex = h % u - 1);
                    return c === I[0] ? void this.Eo.find(".category-select").val("scientific").trigger("change") : c === E[0] ? void this.Eo.find(".category-select").val("percentage").trigger("change") : (f = $.inArray(e, L)) >= 0 ? (this.Eo.find(".category-select").val("custom").trigger("change"), this.Eo.find(".custom-type-select").get(0).selectedIndex = f, void this.Eo.find(".custom-type-select").trigger("change")) : void this.Eo.find(".category-select").val("custom").trigger("change")
                }, t.prototype.selectTab = function(e) { e.numbers ? this.Eo.find(".tab-number-li").css("display", "block") : this.Eo.find(".tab-number-li").css("display", "none"), e.alignment ? this.Eo.find(".tab-alignment-li").css("display", "block") : this.Eo.find(".tab-alignment-li").css("display", "none"), e.font ? this.Eo.find(".tab-font-li").css("display", "block") : this.Eo.find(".tab-font-li").css("display", "none"), e.border ? this.Eo.find(".tab-border-li").css("display", "block") : this.Eo.find(".tab-border-li").css("display", "none"), e.fill ? this.Eo.find(".tab-fill-li").css("display", "block") : this.Eo.find(".tab-fill-li").css("display", "none"), e.protection ? this.Eo.find(".tab-protection-li").css("display", "block") : this.Eo.find(".tab-protection-li").css("display", "none"), e.padding ? this.Eo.find(".tab-cellLabel-li").css("display", "block") : this.Eo.find(".tab-cellLabel-li").css("display", "none") }, t.prototype.GB = function() { r.ribbon.updateCellStyle(), r.ribbon.updateMerge(), r.ribbon.updateFormat() }, t.prototype.DB = function() {
                    var e, t, i, o, n, a, s, l, c, d, p = r.wrapper.spread.getActiveSheet(),
                        u = p.getSelections();
                    if (!u || 0 === u.length) return null;
                    if (t = -1 === u[0].row ? 0 : u[0].row, i = -1 === u[0].col ? 0 : u[0].col, !(p.getValue(t, i) instanceof Date)) return null;
                    for (e = this.HB(p.getValue(t, i), t, i), o = 0; o < u.length; o++)
                        for (n = u[o], t = -1 === n.row ? 0 : n.row, i = -1 === n.col ? 0 : n.col, a = n.rowCount, s = n.colCount, l = t; l < t + a; l++)
                            for (c = i; c < i + s; c++)
                                if (!((d = p.getValue(l, c)) instanceof Date && this.HB(p.getValue(l, c), l, c) === e)) return null;
                    return e
                }, t.prototype.HB = function(e, t, i) {
                    var o, n = r.res.dateFormats,
                        a = r.res.japanWesternDateFormat,
                        s = r.res.japanEmperorReignDateFormat,
                        l = r.wrapper.spread.getActiveSheet(),
                        c = l.getText(t, i);
                    for (o = 0; o < n.length; o++)
                        if (this.sB(e, n[o]) === c) return n[o];
                    for (o = 0; o < a.length; o++)
                        if (this.sB(e, a[o]) === c) return a[o];
                    for (o = 0; o < s.length; o++)
                        if (this.sB(e, s[o]) === c) return s[o]
                }, t.prototype.EB = function(e) {
                    var t, i, o, n, a, s, l;
                    if (null === e || void 0 === e) return !1;
                    if (t = r.res.dateFormats, i = r.res.japanWesternDateFormat, o = r.res.japanEmperorReignDateFormat, n = "1992", -1 !== e.indexOf("G") || -1 !== e.indexOf("g") || -1 !== e.indexOf("e")) return e;
                    for (a = 0; a < t.length; a++)
                        if (s = this.sB(n, t[a]), l = this.sB(n, e), s === l && -1 !== t[a].indexOf(e)) return t[a];
                    for (a = 0; a < i.length; a++)
                        if (s = this.sB(n, i[a]), l = this.sB(n, e), s === l && -1 !== i[a].indexOf(e)) return i[a];
                    for (a = 0; a < o.length; a++)
                        if (s = this.sB(n, o[a]), l = this.sB(n, e), s === l && -1 !== o[a].indexOf(e)) return o[a];
                    return !1
                }, t.prototype.mA = function(e, t) {
                    var i, o, n, a, s, l, c;
                    e && (-1 !== e.indexOf("top") ? i = 0 : -1 !== e.indexOf("right") ? i = 1 : -1 !== e.indexOf("bottom") ? i = 2 : -1 !== e.indexOf("left") && (i = 3), o = this.hA.getActiveSheet(), n = o.getStyle(0, 0), n || (n = new GC.Spread.Sheets.Style), -1 !== e.indexOf("padding") ? (a = r.util.parsePadding(n.cellPadding), a[i] = t, n.cellPadding = a.join(" "), o.setStyle(0, 0, n), this.Tz.cellPadding(a.join(" "))) : -1 !== e.indexOf("margin") && (s = n.labelOptions || {}, l = r.util.parsePadding(s.margin), l[i] = t, c = l.join(" "), this.IB("margin", c)))
                }, t.prototype.IA = function() {
                    var e, t, i, o, n, a, s, l, c, d = this;
                    d.Eo.find(".numeric").spinner({ min: 0, max: 99, stop: function() { d.mA($(this).data("name"), $(this).spinner("value")) }, change: function() { d.mA($(this).data("name"), $(this).spinner("value")) } }), e = d.Eo.find(".label-font-family"), t = r.res.fontPicker.fontFamilies;
                    for (i in t) t.hasOwnProperty(i) && (o = t[i], $("<option></option>").text(o).val(o).appendTo(e));
                    n = d.Eo.find(".label-font-size"), a = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72], a.forEach(function(e) { $("<option></option>").text(e).val(e).appendTo(n) }), s = d.Eo.find(".label-visibility"), l = r.res.formatDialog.labelVisibility;
                    for (c in l) l.hasOwnProperty(c) && $("<option></option>").text(l[c]).val(c).appendTo(s);
                    d.JB(), d.KB(), d.Eo.find(".label-font-color").click(function() { d.LB.gcuipopup("show") }), d.Eo.find(".label-text-input").keyup(function() { d.oA($(this).val()) }), d.Eo.find(".label-alignment-button").click(function() { d.pA(GC.Spread.Sheets.LabelAlignment[$(this).data("name")]) }), d.Eo.find(".label-font-family").change(function() { d.iA = $(this).val(), d.rA() }), d.Eo.find(".label-font-size").change(function() { d.jA = $(this).val() + "pt", d.rA() }), d.Eo.find(".label-font-weight").click(function() { $(this).val(!$(this).val()), d.lA = $(this).val() ? "bold" : "normal", $(this).val() ? $(this).addClass("button-active") : $(this).removeClass("button-active"), d.rA() }), d.Eo.find(".label-font-style").click(function() { $(this).val(!$(this).val()), d.kA = $(this).val() ? "italic" : "normal", $(this).val() ? $(this).addClass("button-active") : $(this).removeClass("button-active"), d.rA() }), d.Eo.find(".label-visibility").change(function() { d.sA(GC.Spread.Sheets.LabelVisibility[$(this).val()]) })
                }, t.prototype.oA = function(e) {
                    var t = this.hA.getActiveSheet(),
                        i = t.getStyle(0, 0);
                    i || (i = new GC.Spread.Sheets.Style), i.watermark = e, t.setStyle(0, 0, i), this.Tz.watermark(e)
                }, t.prototype.pA = function(e) { this.IB("alignment", e), this.MB(e) }, t.prototype.MB = function(e) {
                    this.Eo.find(".label-alignment-button").removeClass("button-active");
                    var t = this.Eo.find(".label-alignment-button");
                    t.each(function(t, i) { GC.Spread.Sheets.LabelAlignment[$(i).data("name")] === e && $(i).addClass("button-active") })
                }, t.prototype.rA = function(e) {
                    if (e) return void this.IB("font", e);
                    var t = $("<span></span>");
                    t.css("font", "normal normal 11pt Calibri"), t.css("font-weight", this.lA || "normal"), t.css("font-style", this.kA || "normal"), t.css("font-size", this.jA || "11pt"), t.css("font-family", this.iA || "Calibri"), this.IB("font", t.css("font"))
                }, t.prototype.qA = function(e) { this.IB("foreColor", e || "grey") }, t.prototype.sA = function(e) { this.IB("visibility", e) }, t.prototype.IB = function(e, t) {
                    var i = this.hA.getActiveSheet(),
                        o = i.getStyle(0, 0);
                    o || (o = new GC.Spread.Sheets.Style), o.labelOptions || (o.labelOptions = {}), o.labelOptions[e] = t, i.setStyle(0, 0, o), this.Tz.labelOptions(o.labelOptions)
                }, t.prototype.KB = function() {
                    var e = this;
                    $("#label-color-picker").colorpicker({ valueChanged: function(t, i) { e.qA(i.color) }, choosedColor: function(t, i) { e.LB.gcuipopup("hide") }, openColorDialog: function() { e.LB.gcuipopup("hide") } }), e.LB = $("#label-color-popup").gcuipopup({ autoHide: !0, position: { of: e.Eo.find(".label-font-color"), my: "right top", at: "right bottom" }, showing: function(e, t) { $("#label-color-picker").colorpicker("option", "themeColors", r.wrapper.getThemeColors()) } })
                }, t.prototype.JB = function() {
                    var e, t, i = this.Eo.find(".preview-spread-container"),
                        o = new GC.Spread.Sheets.Workbook(i[0]),
                        n = o.getActiveSheet();
                    n.suspendPaint(), o.options.showHorizontalScrollbar = !1, o.options.showVerticalScrollbar = !1, o.options.tabStripVisible = !1, o.options.allowUserResize = !1, o.options.allowUserDragDrop = !1, o.options.allowUserDragFill = !1, o.options.allowUserZoom = !1, $(r.util.getCanvas(o)).unbind("gcmousewheel.gcSheet"), n.options.colHeaderVisible = !1, n.options.rowHeaderVisible = !1, n.options.selectionBackColor = "transparent", n.options.selectionBorderColor = "transparent", n.options.gridline = { showVerticalGridline: !1, showHorizontalGridline: !1 }, n.options.isProtected = !0, n.setColumnCount(1), n.setRowCount(1), e = i.width(), t = i.height(), n.setColumnWidth(0, e), n.setRowHeight(0, t), n.setValue(0, 0, r.res.formatDialog.paddingPreviewText), n.resumePaint(), this.hA = o
                }, t.myRes = r.res.formatDialog, t.hw = 0, t
            }(r.BaseDialog);
            r.FormatDialog = e
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets,
            o = GC.Spread.Sheets.Designer;
        ! function(e) {
            "use strict";
            var t, n, r, a, s, l = !1,
                c = !1,
                d = GC.Spread.CalcEngine.ExpressionType;

            function p(e) { return void 0 === e || null === e }

            function u(e) {
                var t, n, r;
                e && (s = new i.FormulaTextBox.FormulaTextBox($("#formulaBarText").get(0))), s.workbook(o.wrapper.spread), x(void 0, $(".ok-btn"), !1), x(void 0, $(".cancel-btn"), !1), f(e), t = o.wrapper.spread.getActiveSheet(), n = t.getActiveColumnIndex(), r = t.getActiveRowIndex(), o.util.triggerSheetEvent(t, i.Events.EnterCell, { sheet: t, sheetName: t.name(), row: r, col: n }), o.util.triggerSheetEvent(t, i.Events.SelectionChanged, null)
            }
            e.initFormulaBar = u;

            function h() { s && (s.destroy(), s = null) } e.resetFormulaBar = h;

            function f(e) {
                var s, d, p = o.wrapper.spread,
                    u = o.wrapper.spreadElement;
                p.bind(i.Events.InvalidOperation, function(e, t) { 0 !== t.invalidType && 4 !== t.invalidType || (o.MessageBox.show(t.message, o.res.title, 2, 0, function() { $(".fill-content").focus() }), c = !0) });

                function h(e, i) {
                    var a = o.wrapper.spread.getActiveSheet(),
                        s = a.getActiveColumnIndex(),
                        l = a.getActiveRowIndex(),
                        c = a.getCell(l, s);
                    x(!0, $(".functions-btn")), t = c.value(), n = c.formula(), r = !0
                }
                p.bind(i.Events.EnterCell, h), u.bind(i.Events.EnterCell, h);

                function f(e, t) {
                    var i, n, r = o.wrapper.spread.getActiveSheet(),
                        a = r.getSelections()[r.getSelections().length - 1];
                    null !== a && void 0 !== a && (i = m(a), n = $("[name=namedRangeSelector]"), n.val(i))
                }
                p.bind(i.Events.SelectionChanging, f), u.bind(i.Events.SelectionChanging, f);

                function w(e, t) {
                    var i, n = $("[name=namedRangeSelector]"),
                        r = o.wrapper.spread.getActiveSheet(),
                        a = r.getSelections()[r.getSelections().length - 1];
                    null !== a && void 0 !== a && (i = l ? m(a) : b(o.wrapper.spread, o.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, o.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1, a), n.val(i))
                }
                p.bind(i.Events.SelectionChanged, w), u.bind(i.Events.SelectionChanged, w), o.wrapper.spread.bind(i.Events.ActiveSheetChanged, function(e, t) {
                    var n = o.wrapper.spread.getActiveSheet();
                    o.util.triggerSheetEvent(n, i.Events.SelectionChanging, void 0), o.util.triggerSheetEvent(n, i.Events.SelectionChanged, void 0), o.util.triggerSheetEvent(n, i.Events.EnterCell, void 0)
                }), e && (o.wrapper.spreadElement.bind("FileOpened", function(e, t) {
                    var n = o.wrapper.spread.getActiveSheet();
                    o.util.triggerSheetEvent(n, i.Events.SelectionChanging, void 0), o.util.triggerSheetEvent(n, i.Events.SelectionChanged, void 0), o.util.triggerSheetEvent(n, i.Events.EnterCell, void 0)
                }), $(document).bind("keydown", function(e) { e.shiftKey && (l = !0) }), $(document).bind("keyup", function(e) {
                    var t, i, n, r;
                    e.shiftKey || (l = !1, t = $("[name=namedRangeSelector]"), (i = o.wrapper.spread.getActiveSheet()) && (r = i.getSelections()[i.getSelections().length - 1], n = b(o.wrapper.spread, o.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, o.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1, r), t.val(n)))
                }), $(".fill-content").bind("keyup", function(e) {
                    var t = $(".fill-content"),
                        i = t.text();
                    "" !== i && "=" !== i.substring(0, 1) ? x(!1, $(".functions-btn")) : x(!0, $(".functions-btn"))
                }), $(".fill-content").focus(function(e) { r = !1, x(void 0, $(".ok-btn"), !0), x(void 0, $(".cancel-btn"), !0) }), $(".functions-btn").click(function() { a || (a = new o.InsertFunctionDialog), a.open() }), $(".cancel-btn").click(function() { y(), o.wrapper.setFocusToSpread() }), $(".ok-btn").click(function() { o.wrapper.setFocusToSpread(), v(null) }), d = !1, $(".splitter").mousedown(function(e) { s = e.pageX, d = !0 }), $(document).mousemove(function(e) {
                    var t, i, o, n;
                    d && (t = e.pageX - s, i = $(".named-range-selector"), o = $(".union-container"), n = $("#formulaBarText"), i.width() + t < 0 && (t = i.width()), n.width() - t < 0 && (t = n.width()), i.width(i.width() + t), n.css("left", parseFloat(n.css("left")) + t), o.width(o.width() + t), s = e.pageX, g())
                }), $(document).mouseup(function(e) { d = !1 }), $(o).bind("layoutChanged", g))
            }
            e.addEvents = f;

            function g() {
                var e, t = $(".formulaBar"),
                    i = $("#formulaBarText"),
                    o = t.find("td"),
                    n = t.width(),
                    r = 0,
                    a = [];
                o.each(function(e, t) {
                    var i = $(t).outerWidth();
                    r += i, a.push(i)
                }), e = n - r - 10, i.css({ width: e + a[a.length - 1] - 10 })
            }

            function m(e) {
                var t = "",
                    i = e.rowCount,
                    n = e.colCount,
                    r = e.row + 1,
                    a = e.col + 1;
                return t = 1 === i && 1 === n ? b(o.wrapper.spread, r, a) : i < 0 && n > 0 ? n + "C" : n < 0 && i > 0 ? i + "R" : i < 0 && n < 0 ? o.wrapper.spread.getActiveSheet().getRowCount() + "R x " + o.wrapper.spread.getActiveSheet().getColumnCount() + "C" : i + "R x " + n + "C"
            }
            e.GetSelectedRangeString = m;

            function b(e, t, i, o) {
                var n, r, a, s, l, c, p, u, h, f;
                if (t < 1 || i < 1) return null;
                if (n = "", r = e.getActiveSheet().name(), o) {
                    if (null !== (s = e.getActiveSheet().getSpans()))
                        for (l = 0; l < s.length; l++) s[l].row === o.row && s[l].col === o.col && s[l].rowCount === o.rowCount && s[l].colCount === o.colCount && (a = !0);
                    if (void 0 !== (c = e.getCustomNames()))
                        for (h = 0; h < c.length; h++)
                            if ((u = c[h].getExpression()) && u.type === d.reference && u.source && u.source.getName && r === u.source.getName() && null !== (p = u.getRange(0, 0)) && void 0 !== p && (p.row === o.row && p.column === o.col && p.row + p.rowCount === o.row + o.rowCount && p.column + p.columnCount === o.col + o.colCount || p.row === o.row && p.column === o.col && a)) { n = c[h].getName(); break } if ("" === n && void 0 !== (c = e.getActiveSheet().getCustomNames()))
                        for (h = 0; h < c.length; h++)(u = c[h].getExpression()) && u.type === d.reference && (p = u.getRange(0, 0), (p.row === o.row && p.column === o.col && p.row + p.rowCount === o.row + o.rowCount && p.column + p.columnCount === o.col + o.colCount || p.row === o.row && p.column === o.col && a) && (n = c[h].getName()))
                }
                if ("" === n) switch (e.options.referenceStyle) {
                    case 0:
                        for (; i > 0;) f = i % 26, 0 == f ? (n = "Z" + n, i--) : n = String.fromCharCode("A".charCodeAt(0) + f - 1) + n, i = parseInt("" + i / 26);
                        n += "" + t;
                        break;
                    case 1:
                        n = "R" + t + "C" + i
                }
                return n
            }
            e.GetCellPositionString = b;

            function v(e) {
                var i, a, s, l, d = o.wrapper.spread.getActiveSheet(),
                    u = d.getActiveColumnIndex(),
                    h = d.getActiveRowIndex(),
                    f = d.getCell(h, u),
                    g = o.wrapper.spread;
                if (p(e)) i = g.sheets[e.sheetIndex].getCell(e.row, e.col);
                else {
                    if (!p(f)) return !1;
                    i = f
                }
                if (!r)
                    if (a = $(".fill-content"), "" !== (s = "" + a.text())) { if ("=" === s.substring(0, 1) && (l = { cmd: "editCell", sheetName: i.sheet.name(), row: i.row, col: i.col, newValue: s, autoFormat: !0 }, g.commandManager().execute(l), !0 === c)) return c = !1, !1 } else i.value(""), l = { cmd: "editCell", sheetName: i.sheet.name(), row: i.row, col: i.col, newValue: "", autoFormat: !0 }, g.commandManager().execute(l);
                return x(!0, $(".functions-btn")), x(void 0, $(".ok-btn"), !1), x(void 0, $(".cancel-btn"), !1), t = i.value(), n = i.formula(), r = !0, !0
            }
            e.CommitFormula = v;

            function y() {
                var e = $(".fill-content"),
                    i = o.wrapper.spread.getActiveSheet(),
                    a = i.getActiveColumnIndex(),
                    s = i.getActiveRowIndex(),
                    l = i.getCell(s, a);
                null != l && (r || (x(!0, $(".functions-btn")), x(void 0, $(".ok-btn"), !1), x(void 0, $(".cancel-btn"), !1), l.value(t), l.formula(n), r = !0, o.wrapper.spread.focus(!0), e.text(w(l, n))))
            }
            e.CancelFormula = y;

            function w(e, t) { var i, o = ""; return "" === t || null === t ? (i = e.value(), o = null != i ? i instanceof Date ? i.toLocaleString() : "" + i : e.text()) : o = "=" !== t.substring(0, 1) ? "=" + t : t, null == o ? "" : o } e.GetTextOfFormulaTextBox = w;

            function x(e, t, i) { void 0 !== e ? e ? (t.prop("disabled", !1), t.fadeTo("faster", 1)) : (t.prop("disabled", !0), t.fadeTo("faster", .2)) : i ? t.fadeTo("faster", 1) : t.fadeTo("faster", 0) } e.setButtonStatus = x, o.formulaBar = e
        }(o.formulaBar || {})
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function(e) {
            "use strict";
            var t, o, n = 600;

            function r() {
                $(".content").css("height", $(".content").children(".fill-spread-content").height()), $(".header").css("width", $(window).width() + "px"), $(".ribbon-bar").data("gcui-gcuiribbon") && $(".ribbon-bar").data("gcui-gcuiribbon").updateRibbonSize();
                var e = i.wrapper.spread;
                e && e.isPaintSuspended() && (e.resumePaint(), e.refresh(), t = !0)
            }
            o = null;

            function a() { o && window.clearTimeout(o), o = window.setTimeout(function() { r(), o = null, t && (t = !1, window.setTimeout(function() { i.wrapper.spread.suspendPaint() }, 300)) }, 100) } $(document).ready(function() {
                i.loader.loadContent(), $(window).resize(a), $(window).resize(), $("#verticalSplitter").draggable({
                    axis: "y",
                    containment: ".container",
                    scroll: !1,
                    zIndex: 100,
                    stop: function(e, t) {
                        var o = $(this),
                            n = o.offset().top,
                            r = n - $(".header").height(),
                            a = $(".content .fill-spread-content"),
                            s = $("#formulaBarText").height(),
                            l = s + r,
                            c = 20;
                        l < c ? ($("#formulaBarText").css({ height: c }), n = n + c - l) : $("#formulaBarText").css({ height: l }), a.css({ top: n + 10 }), a.parent().css({ height: a.height() }), $(".header").css({ height: n }), o.css({ top: 0 }), i.wrapper.spread.refresh()
                    }
                });

                function e(e) { e && (e.effectAllowed = "none", e.dropEffect = "none") } window.addEventListener("dragenter", function(t) { t = t || event, t.preventDefault(), e(t.dataTransfer) }, !1), window.addEventListener("dragover", function(t) { t = t || event, t.preventDefault(), e(t.dataTransfer) }, !1), window.addEventListener("drop", function(t) { t = t || event, t.preventDefault(), e(t.dataTransfer) }, !1)
            }), i.loader.ready(function() { $(window).unbind("resize.gcuiribbon"), $("#verticalSplitter").show(), r() }), i.index = e
        }(i.index || {})
    }, function(e, t) {! function() { GC.Spread.Sheets.LicenseKey = "GrapeCity-Internal-Use-Only,*.grapecity.com|*.componentone.com,E347353251763156#B0MtLULRHcBd5ZrY5QrMXRalHW5Ejc75Wb58EV4E4LoV6aDJldEBjaZRGUXNXNhJjZ0plSyMnR8YHZI54a7oUMsFTNYVUMOhFOPx6UKtib9J7KZdzVs5GMxIlM5olVj3USyMHUVlEThtkdk5GdRB7dIhlV6MHZz3GNWdVbCdmZpt4NGtSYZV6Ywcme6kEdItydTVjUGF4Z4RmSZdUbQNkW93ybC3ySSdmd6onQ0dlYOFWanxWMwsWczdUMv2yRi3yQRtEcL9WT4N4VSRnNUlnbhF5UTFHMOV6YGJ7R42Ge5VjUuNnNoRkboNGZVJ5V58mdzYlc7g6cGRlI0IyUiwiIBJDRCZDOzEjI0ICSiwSOzcjM4ITOyEjM0IicfJye35XX3JSSGljQiojIDJCLiITMuYHITpEIkFWZyB7UiojIOJyebpjIkJHUiwiIyITOxATMgYTMwEDOxAjMiojI4J7QiwiIt36YuUmbvRnbl96bw56bj9iKs46bj9Se4l6YlBXYydmLqIiOiMXbEJCLikHdpNUZwFmcHJiOiEmTDJCLlVnc4pjIsZXRiwiI6UTMzYzNxUjMzUzM7QzMiojIklkIs4XZzxWYmpjIyNHZisnOiwmbBJye0ICRiwiI34zdI5kWS9WR79mdYJ7LRRENGNmZUp6TBN4LiJ4Sxd7Rr4UOyp7bIJzR0RFTzNHOlxmRBFGanV7SIVVWoNWbhVFS5QHcS96SvonNrEnWwklWZ9UQ9UTVQ3iSC5kYJhxe" }() }, function(e, t, i) {
        var o = GC.Spread.Sheets,
            n = GC.Spread.Sheets.Designer,
            r = GC.Spread.Sheets.Charts,
            a = r.Chart,
            s = n.util.chartHelper,
            l = n.ColorHelper,
            c = void 0,
            d = i(15),
            p = i(4),
            u = i(32),
            h = i(35),
            f = i(33),
            g = i(0);
        ! function(e) {
            "use strict";
            var t, a, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L = "schema-type-button",
                F = "ztree-container",
                R = "ztree-container",
                B = "other",
                O = !1,
                P = !1,
                N = !1,
                z = i(14),
                M = i(1),
                V = i(13),
                G = i(3),
                j = i(34);
            e.slicerSettingDialog;

            function H() {
                var i, r, a, u, h, f, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R, B, P, N, G, j, H, q, Y, Q, ie, re, ae, le, ce, de, pe, ue, he, fe, ge, be, ve, ye, we, xe, Ce, Se, Ee, Ie, De, $e, Le, Fe, Re, Be, Oe, Pe, Ne, ze, Me, Ve, Ge, je, He, We, Ue, qe, _e, Ke, Xe, Qe, Ze, et, tt, it = 200,
                    ot = 4,
                    nt = "50",
                    rt = new n.CellValueRuleFormatDialog,
                    st = new n.TextRuleFormatDialog,
                    ct = new n.DateOccurringFormatDialog,
                    pt = new n.DuplicateValuesFormatDialog,
                    ut = new n.Top10RuleFormatDialog,
                    ht = new n.AverageRuleFormatDialog,
                    ft = new n.FormatRulesManagerDialog,
                    gt = [],
                    mt = [],
                    vt = function() {
                        var e;
                        for (e = 0; e < mt.length; e++) clearTimeout(mt[e]);
                        for (mt = [], e = 0; e < gt.length; e++) clearTimeout(gt[e]);
                        gt = [], _e && (_e.children("ul").addClass("hidden"), _e = c), $("#condition-format-popup").children("ul").addClass("hidden")
                    };
                $(".ribbon-bar").gcuiribbon({
                    click: function(l, c) {
                        var f, m, b, v, y, w, X, J, Z, ee, te, oe, Fe, _e, Ke, Xe, Qe, Ze, et, tt, it, ot, nt, rt, st, ct, pt, ut, ht, ft, gt, mt, wt, xt, St = n.wrapper.spread,
                            kt = St.getActiveSheet(),
                            Tt = s.getSelectedChart(kt),
                            At = g.getActiveShapes(kt);
                        switch (c.name) {
                            case "font-family":
                                n.actions.doAction("setFontFamily", St, $("#" + c.commandName).data("font"));
                                break;
                            case "font-size":
                                n.actions.doAction("setFontSize", St, $("#" + c.commandName).text() + "pt")
                        }
                        switch (c.commandName) {
                            case "copy":
                                n.util.isSlicerSelected(kt) ? n.actions.doAction("floatingObjectCopy", St) : n.actions.doAction("copy", St);
                                break;
                            case "cut":
                                n.util.isSlicerSelected(kt) ? n.actions.doAction("floatingObjectCut", St) : n.actions.doAction("cut", St);
                                break;
                            case "paste-all":
                                n.actions.doAction("paste", St, 0);
                                break;
                            case "paste-formulas":
                                n.actions.doAction("paste", n.wrapper.spread, 3);
                                break;
                            case "paste-values":
                                n.actions.doAction("paste", n.wrapper.spread, 1);
                                break;
                            case "paste-formatting":
                                n.actions.doAction("paste", n.wrapper.spread, 2);
                                break;
                            case "font-weight":
                                n.actions.doAction("setFontWeight", St, $("#" + c.commandName).prop("checked") ? "bold" : "normal");
                                break;
                            case "font-italic":
                                n.actions.doAction("setFontStyle", St, $("#" + c.commandName).prop("checked") ? "italic" : "normal");
                                break;
                            case "font-underline":
                                n.actions.doAction("setUnderline", St, $("#" + c.commandName).prop("checked")), $("#" + c.commandName).prop("checked") && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-double-underline", !1);
                                break;
                            case "font-double-underline":
                                n.actions.doAction("setDoubleUnderline", St, $("#" + c.commandName).prop("checked")), $("#" + c.commandName).prop("checked") && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-underline", !1);
                                break;
                            case "increase-fontsize":
                                y = _(), y && n.actions.doAction("setFontSize", St, y + "pt");
                                break;
                            case "decrease-fontsize":
                                w = K(), w && n.actions.doAction("setFontSize", St, w + "pt");
                                break;
                            case "bottom-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { bottom: !0 } });
                                break;
                            case "top-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { top: !0 } });
                                break;
                            case "left-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { left: !0 } });
                                break;
                            case "right-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { right: !0 } });
                                break;
                            case "no-border":
                                n.actions.doAction("setBorder", St, { lineborder: null, options: { all: !0 } });
                                break;
                            case "all-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { all: !0 } });
                                break;
                            case "outside-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { outline: !0 } });
                                break;
                            case "thickbox-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 5), options: { outline: !0 } });
                                break;
                            case "bottom-double-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 6), options: { bottom: !0 } });
                                break;
                            case "thick-bottom-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 5), options: { bottom: !0 } });
                                break;
                            case "top-bottom-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { bottom: !0, top: !0 } });
                                break;
                            case "top-thick-bottom-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { top: !0 } }), n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 5), options: { bottom: !0 } });
                                break;
                            case "top-double-bottom-border":
                                n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 1), options: { top: !0 } }), n.actions.doAction("setBorder", St, { lineborder: new o.LineBorder("black", 6), options: { bottom: !0 } });
                                break;
                            case "more-border":
                                b = n.formatCellDialog, void 0 === b && (b = new n.FormatDialog, n.formatCellDialog = b), b.open("border");
                                break;
                            case "backcolor":
                                i || ($("#backcolor-picker").colorpicker({ valueChanged: function(e, t) { t.name ? n.actions.doAction("setBackColor", n.wrapper.spread, t.name) : n.actions.doAction("setBackColor", n.wrapper.spread, t.color) }, choosedColor: function(e, t) { i.gcuipopup("hide") }, openColorDialog: function() { i.gcuipopup("hide") } }), i = $("#backcolor-popup").gcuipopup({ autoHide: !0, position: { of: $("#backcolor-button"), my: "left top", at: "left bottom" }, showing: function(e, t) { $("#backcolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors()) } })), i.gcuipopup("show");
                                break;
                            case "forecolor":
                                r || ($("#forecolor-picker").colorpicker({ valueChanged: function(e, t) { t.name ? n.actions.doAction("setForeColor", n.wrapper.spread, t.name) : n.actions.doAction("setForeColor", n.wrapper.spread, t.color) }, choosedColor: function(e, t) { r.gcuipopup("hide") }, openColorDialog: function() { r.gcuipopup("hide") } }), r = $("#forecolor-popup").gcuipopup({ autoHide: !0, position: { of: $("#forecolor-button"), my: "left top", at: "left bottom" }, showing: function(e, t) { $("#forecolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors()) } })), r.gcuipopup("show");
                                break;
                            case "top-align":
                                n.actions.doAction("setVAlign", St, 0);
                                break;
                            case "middle-align":
                                n.actions.doAction("setVAlign", St, 1);
                                break;
                            case "bottom-align":
                                n.actions.doAction("setVAlign", St, 2);
                                break;
                            case "left-align":
                                n.actions.doAction("setHAlign", St, 0);
                                break;
                            case "center-align":
                                n.actions.doAction("setHAlign", St, 1);
                                break;
                            case "right-align":
                                n.actions.doAction("setHAlign", St, 2);
                                break;
                            case "increase-indent":
                                n.actions.doAction("setIndent", St, 1);
                                break;
                            case "vertical-text":
                                n.actions.doAction("setTextVertical", St, $("#vertical-text").prop("checked"));
                                break;
                            case "decrease-indent":
                                n.actions.doAction("setIndent", St, -1);
                                break;
                            case "wrap-text":
                                n.actions.doAction("setWordWrap", St, $("#wrap-text").prop("checked"));
                                break;
                            case "merge-center":
                                $("#merge-center").prop("checked") ? n.actions.doAction("mergeCenter", St) : n.actions.doAction("unmergeCells", St), setTimeout(function() { me() }, 0);
                                break;
                            case "merge-center-button":
                                n.actions.doAction("mergeCenter", St);
                                break;
                            case "merge-across":
                                n.actions.doAction("mergeAcross", St);
                                break;
                            case "merge-cells":
                                n.actions.doAction("mergeCells", St);
                                break;
                            case "unmerge-cells":
                                n.actions.doAction("unmergeCells", St);
                                break;
                            case "format-general":
                                n.actions.doAction("setFormatter", St, null);
                                break;
                            case "format-number":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Number.format);
                                break;
                            case "format-currency":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Currency.format);
                                break;
                            case "format-accouting":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Accounting.format);
                                break;
                            case "format-shortdate":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.ShortDate.format);
                                break;
                            case "format-longdate":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.LongDate.format);
                                break;
                            case "format-time":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Time.format);
                                break;
                            case "format-percentage":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Percentage.format);
                                break;
                            case "format-fraction":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Fraction.format);
                                break;
                            case "format-scientific":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Scientific.format);
                                break;
                            case "format-text":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Text.format);
                                break;
                            case "format-comma":
                                n.actions.doAction("setFormatter", St, n.res.commonFormats.Comma.format);
                                break;
                            case "increase-decimal":
                                n.actions.doAction("increaseDecimal", St);
                                break;
                            case "decrease-decimal":
                                n.actions.doAction("decreaseDecimal", St);
                                break;
                            case "button-celltype":
                                void 0 === q && (q = new n.ButtonCellTypeDialog), q.open();
                                break;
                            case "checkbox-celltype":
                                void 0 === Y && (Y = new n.CheckBoxCellTypeDialog), Y.open();
                                break;
                            case "combobox-celltype":
                                void 0 === Q && (Q = new n.ComboBoxCellTypeDialog), Q.open();
                                break;
                            case "hyperlink-celltype":
                                void 0 === ie && (ie = new n.HyperLinkCellTypeDialog), ie.open();
                                break;
                            case "clear-celltype":
                                n.actions.doAction("clearCellType", St);
                                break;
                            case "conditional-format":
                                h || (h = $("#condition-format-popup").gcuipopup({ autoHide: !0, position: { of: $("#condition-format"), my: "left top", at: "left bottom" }, collision: "fit fit", showing: function(e, t) { $("#condition-format-popup-menu").removeClass("hidden") }, hiding: function() { return vt() } })), h.gcuipopup("show");
                                break;
                            case "insert-cells":
                                switch (m = n.spreadActions.getSelectionType(St)) {
                                    case 0:
                                        n.MessageBox.show(n.res.insertCellInSheet, n.res.title, 2);
                                        break;
                                    case 2:
                                        n.actions.doAction("insertColumns", St);
                                        break;
                                    case 1:
                                        n.actions.doAction("insertRows", St);
                                        break;
                                    case 4:
                                        n.MessageBox.show(n.res.insertCellInMixtureRange, n.res.title, 2);
                                        break;
                                    case 3:
                                        void 0 === A && (A = new n.InsertCellsDialog), A.open()
                                }
                                break;
                            case "insert-rows":
                                n.actions.doAction("insertRows", St);
                                break;
                            case "insert-columns":
                                n.actions.doAction("insertColumns", St);
                                break;
                            case "insert-sheet":
                                n.actions.doAction("insertSheet", St);
                                break;
                            case "delete-cells":
                                switch (m = n.spreadActions.getSelectionType(St)) {
                                    case 0:
                                        n.actions.doAction("clearSheetAllCell", St);
                                        break;
                                    case 2:
                                        n.actions.doAction("deleteColumns", St);
                                        break;
                                    case 1:
                                        n.actions.doAction("deleteRows", St);
                                        break;
                                    case 4:
                                        n.MessageBox.show(n.res.insertCellInMixtureRange, n.res.title, 2);
                                        break;
                                    case 3:
                                        void 0 === E && (E = new n.DeleteCellsDialog), E.open()
                                }
                                break;
                            case "delete-rows":
                                n.actions.doAction("deleteRows", St);
                                break;
                            case "delete-columns":
                                n.actions.doAction("deleteColumns", St);
                                break;
                            case "delete-sheet":
                                n.actions.doAction("deleteSheet", St);
                                break;
                            case "set-rowheight":
                                void 0 === x && (x = new n.RowHeightDialog), x.open();
                                break;
                            case "set-columnwidth":
                                void 0 === C && (C = new n.ColumnWidthDialog), C.open();
                                break;
                            case "autofit-rowheight":
                                n.actions.doAction("autofitRows", St);
                                break;
                            case "default-rowheight":
                                void 0 === S && (S = new n.StandardRowHeightDialog), S.open();
                                break;
                            case "hide-rows":
                                n.actions.doAction("hideRows", St);
                                break;
                            case "unhide-rows":
                                n.actions.doAction("unHideRows", St);
                                break;
                            case "autofit-columnwidth":
                                n.actions.doAction("autofitColumns", St);
                                break;
                            case "default-columnwidth":
                                void 0 === k && (k = new n.StandardColumnWidthDialog), k.open();
                                break;
                            case "hide-columns":
                                n.actions.doAction("hideColumns", St);
                                break;
                            case "unhide-columns":
                                n.actions.doAction("unHideColumns", St);
                                break;
                            case "protect-sheet":
                                Re || (Re = new n.ProtectionOptionDialog), Re.open();
                                break;
                            case "unprotect-sheet":
                                n.actions.doAction("protectSheet", St, !1);
                                break;
                            case "lock-cells":
                                n.actions.doAction("LockCells", St, !0);
                                break;
                            case "unlock-cells":
                                n.actions.doAction("LockCells", St, !1);
                                break;
                            case "auto-sum":
                                n.actions.doAction("setAutoFormula", St, "Sum");
                                break;
                            case "auto-average":
                                n.actions.doAction("setAutoFormula", St, "Average");
                                break;
                            case "auto-count":
                                n.actions.doAction("setAutoFormula", St, "Count");
                                break;
                            case "auto-max":
                                n.actions.doAction("setAutoFormula", St, "Max");
                                break;
                            case "auto-min":
                                n.actions.doAction("setAutoFormula", St, "Min");
                                break;
                            case "fill-down":
                                n.actions.doAction("autoFillByDirection", St, 3);
                                break;
                            case "fill-right":
                                n.actions.doAction("autoFillByDirection", St, 1);
                                break;
                            case "fill-up":
                                n.actions.doAction("autoFillByDirection", St, 2);
                                break;
                            case "fill-left":
                                n.actions.doAction("autoFillByDirection", St, 0);
                                break;
                            case "fill-series":
                                T || (T = new n.FillDialog), T.open();
                                break;
                            case "clear-all":
                                n.actions.doAction("clearAll", St);
                                break;
                            case "clear-format":
                                n.actions.doAction("clearFormat", St);
                                break;
                            case "clear-content":
                                n.actions.doAction("clearContent", St);
                                break;
                            case "clear-comments":
                                n.actions.doAction("clearComments", St);
                                break;
                            case "sort-AZ":
                                n.util.isSlicerSelected(kt) ? n.actions.doAction("sortSlicerItems", St, 1) : n.actions.doAction("sortRange", St, !0);
                                break;
                            case "sort-ZA":
                                n.util.isSlicerSelected(kt) ? n.actions.doAction("sortSlicerItems", St, 2) : n.actions.doAction("sortRange", St, !1);
                                break;
                            case "custom-sort":
                                R || (R = new n.SortDialog), R.open();
                                break;
                            case "set-filter":
                                n.actions.doAction("setRowFilter", St, !0);
                                break;
                            case "clear-filter":
                                n.actions.doAction("clearRowFilter", St);
                                break;
                            case "reapply-filter":
                                n.actions.doAction("reApplyRowFilter", St);
                                break;
                            case "insert-function":
                                H || (H = new n.InsertFunctionDialog), H.open();
                                break;
                            case "calculate-auto":
                                n.actions.doAction("autoCalculate", St, !0);
                                break;
                            case "calculate-manual":
                                n.actions.doAction("autoCalculate", St, !1);
                                break;
                            case "calculate-now":
                                n.actions.doAction("calculateNow", St);
                                break;
                            case "group":
                                if (f = kt.getSelections(), f.length > 1) return void n.MessageBox.show(n.res.NotExecInMultiRanges, n.res.title, 2);
                                if (1 === (m = n.spreadActions.getSelectionType(St))) { n.actions.doAction("groupRows", n.wrapper.spread); break }
                                if (2 === m) { n.actions.doAction("groupColumns", n.wrapper.spread); break } void 0 === D && (D = new n.GroupDialog), D.open();
                                break;
                            case "ungroup":
                                if (f = kt.getSelections(), f.length > 1) return void n.MessageBox.show(n.res.NotExecInMultiRanges, n.res.title, 2);
                                if (1 === (m = n.spreadActions.getSelectionType(St))) { n.actions.doAction("ungroupRows", n.wrapper.spread); break }
                                if (2 === m) { n.actions.doAction("ungroupColumns", n.wrapper.spread); break } void 0 === L && (L = new n.UnGroupDialog), L.open();
                                break;
                            case "template-design-mode":
                                X = St.getActiveSheet(), J = $("#template-design-mode"), Z = J.find("span.ui-button-text"), ee = J.data("checked"), ee = !ee, ee ? (bt(), Z.addClass("template-design-mode-checked"), Jt(), te = $(".slider-panel"), te.sliderpanel("open", "panel1")) : Te(), J.data("checked", ee), X.repaint();
                                break;
                            case "clearBindingPath":
                                at();
                                break;
                            case "loadSchema":
                                lt();
                                break;
                            case "saveSchema":
                                dt();
                                break;
                            case "show-detail":
                                n.actions.doAction("expandGroup", St);
                                break;
                            case "hide-detail":
                                n.actions.doAction("collapseGroup", St);
                                break;
                            case "group-direction":
                                re || (re = new n.GroupDirectionDialog), re.open();
                                break;
                            case "showhide-rowheader":
                                W("showhide-rowheader"), n.actions.doAction("showHideRowHeader", St);
                                break;
                            case "showhide-columnheader":
                                W("showhide-columnheader"), n.actions.doAction("showHideColumnHeader", St);
                                break;
                            case "showhide-vgridline":
                                W("showhide-vgridline"), n.actions.doAction("showHideVGridLine", St);
                                break;
                            case "showhide-hgridline":
                                W("showhide-hgridline"), n.actions.doAction("showHideHGridLine", St);
                                break;
                            case "showhide-tabstrip":
                                W("showhide-tabstrip"), n.actions.doAction("showHideTabStrip", St);
                                break;
                            case "showhide-newtab":
                                W("showhide-newtab"), n.actions.doAction("showHideNewTab", St);
                                break;
                            case "zoom":
                                ae || (ae = new n.ZoomDialog), ae.open();
                                break;
                            case "zoom-default":
                                n.actions.doAction("zoomDefault", St);
                                break;
                            case "zoom-selection":
                                n.actions.doAction("zoomSelection", St), setTimeout(function() { ke() }, 0);
                                break;
                            case "freeze-panes":
                                n.actions.doAction("freeze", St, { row: St.getActiveSheet().getActiveRowIndex(), col: St.getActiveSheet().getActiveColumnIndex() });
                                break;
                            case "freeze-toprow":
                                n.actions.doAction("freeze", St, { row: 1, col: 0, trailingRow: 0, trailingCol: 0 });
                                break;
                            case "freeze-firstcolumn":
                                n.actions.doAction("freeze", St, { row: 0, col: 1, trailingRow: 0, trailingCol: 0 });
                                break;
                            case "freeze-bottomrow":
                                n.actions.doAction("freeze", St, { row: 0, col: 0, trailingRow: 1, trailingCol: 0 });
                                break;
                            case "freeze-lastcolumn":
                                n.actions.doAction("freeze", St, { row: 0, col: 0, trailingRow: 0, trailingCol: 1 });
                                break;
                            case "unfreeze-panes":
                                n.actions.doAction("unfreeze", St);
                                break;
                            case "fontgroup":
                                b = n.formatCellDialog, void 0 === b && (b = new n.FormatDialog, n.formatCellDialog = b), b.open("font");
                                break;
                            case "aligngroup":
                                b = n.formatCellDialog, void 0 === b && (b = new n.FormatDialog, n.formatCellDialog = b), b.open("alignment");
                                break;
                            case "format-more":
                            case "numbergroup":
                                b = n.formatCellDialog, void 0 === b && (b = new n.FormatDialog, n.formatCellDialog = b), b.open("number");
                                break;
                            case "find":
                                void 0 === F && (F = new n.FindDialog), F.open();
                                break;
                            case "goto":
                                void 0 === N && (N = new n.GoToDialog), N.open();
                                break;
                            case "spark-line":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(0);
                                break;
                            case "spark-column":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(1);
                                break;
                            case "spark-winloss":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(2);
                                break;
                            case "spark-pie":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(0, !0);
                                break;
                            case "spark-area":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(1, !0);
                                break;
                            case "spark-scatter":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(2, !0);
                                break;
                            case "spark-bullet":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                we || (we = new n.BulletSparklineDialog), we.open();
                                break;
                            case "spark-spread":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(5, !0);
                                break;
                            case "spark-stacked":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(6, !0);
                                break;
                            case "spark-hbar":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Se || (Se = new n.HbarSparklineDialog), Se.open();
                                break;
                            case "spark-vbar":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Ee || (Ee = new n.VbarSparklineDialog), Ee.open();
                                break;
                            case "spark-variance":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Ie || (Ie = new n.VariSparklineDialog), Ie.open();
                                break;
                            case "spark-boxplot":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(10, !0);
                                break;
                            case "spark-cascade":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(11, !0);
                                break;
                            case "spark-pareto":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                le || (le = new n.InsertSparkLineDialog), le.open(12, !0);
                                break;
                            case "spark-month":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Me || (Me = new n.CalendarSparklineDialog(0)), Me.open();
                                break;
                            case "spark-year":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Ve || (Ve = new n.CalendarSparklineDialog(1)), Ve.open();
                                break;
                            case "name-manager":
                                G || (G = new n.NameManagerDialog), G.open();
                                break;
                            case "spread-setting-general":
                                B || (B = new n.SpreadSettingDialog), B.open("general");
                                break;
                            case "spread-setting-scrollbar":
                                B || (B = new n.SpreadSettingDialog), B.open("scrollbar");
                                break;
                            case "spread-setting-tabstrip":
                                B || (B = new n.SpreadSettingDialog), B.open("tabstrip");
                                break;
                            case "sheet-setting-general":
                                P || (P = new n.SheetSettingDialog), P.open("general");
                                break;
                            case "sheet-setting-gridline":
                                P || (P = new n.SheetSettingDialog), P.open("gridline");
                                break;
                            case "sheet-setting-calculation":
                                P || (P = new n.SheetSettingDialog), P.open("calculation");
                                break;
                            case "sheet-setting-headers":
                                P || (P = new n.SheetSettingDialog), P.open("headers");
                                break;
                            case "data-validation":
                                j || (j = new n.DataValidationDialog), j.open();
                                break;
                            case "circle-invalid":
                                n.actions.doAction("circleInvalidData", St);
                                break;
                            case "clear-circle":
                                n.actions.doAction("unCircleInvalidData", St);
                                break;
                            case "insert-table":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                ue || (ue = new n.CreateTableDialog), ue.open();
                                break;
                            case "insert-chart":
                                if (n.ribbon.selectChartDialog || (n.ribbon.selectChartDialog = new n.SelectChartDialog), !(oe = kt.getSelections()[0]) || 1 === oe.rowCount && 1 === oe.colCount && null === n.wrapper.spread.getActiveSheet().getValue(oe.row, oe.col)) return void n.MessageBox.show(n.res.selectChartDialog.errorPrompt.emptyDataErrorMsg, n.res.title, 2);
                                n.ribbon.selectChartDialog.open(n.SelectChartDialog.dialogType.insertChart);
                                break;
                            case "insert-barcode":
                                if (!(v = n.wrapper.spread.getActiveSheet().getSelections()[0])) return void n.MessageBox.show(n.res.selectionError.selectEmptyArea, n.res.title, 2);
                                Ge || (Ge = new n.CreateBarcodeDialog), Ge.open();
                                break;
                            case "insert-shapes":
                                Ue || (Ue = $("#ribbon-shape-insert-list-popup").gcuipopup({ autoHide: !0, position: { of: $("#insert-Shapes"), my: "left top", at: "left bottom" } }), Fe = $(".shape-insert-list-container"), I = new p(Fe, "insert", function() { Ue.gcuipopup("hide") })), Ue.gcuipopup("show");
                                break;
                            case "insert-picture":
                                _e = { 
                                    title: n.res.insertPictureDialogTitle,
                                    action: "insertPicture",
                                    filters: "image/*",
                                    nameFilters: [n.res.pictureFormatFilter.png, n.res.pictureFormatFilter.jpeg, n.res.pictureFormatFilter.bmp, n.res.pictureFormatFilter.allFiles] },
                                     Ke = function(e) { "cancelled" !== e.status && n.actions.doAction("insertPicture", St, e.data) },
                                      app.showOpenDialog(_e, Ke);
                                
                                break;
                            case "sparkline-type-line":
                                n.actions.doAction("setSparklineType", St, 0);
                                break;
                            case "sparkline-type-column":
                                n.actions.doAction("setSparklineType", St, 1);
                                break;
                            case "sparkline-type-winloss":
                                n.actions.doAction("setSparklineType", St, 2);
                                break;
                            case "sparkline-high-point":
                                W("sparkline-high-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-high-point"), "showHigh"]);
                                break;
                            case "sparkline-low-point":
                                W("sparkline-low-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-low-point"), "showLow"]);
                                break;
                            case "sparkline-first-point":
                                W("sparkline-first-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-first-point"), "showFirst"]);
                                break;
                            case "sparkline-last-point":
                                W("sparkline-last-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-last-point"), "showLast"]);
                                break;
                            case "sparkline-negative-point":
                                W("sparkline-negative-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-negative-point"), "showNegative"]);
                                break;
                            case "sparkline-marker-point":
                                W("sparkline-marker-point"), n.actions.doAction("setSparklineSetting", St, [U("sparkline-marker-point"), "showMarkers"]);
                                break;
                            case "sparkline-group":
                                n.actions.doAction("groupSparkline", St);
                                break;
                            case "sparkline-ungroup":
                                n.actions.doAction("unGroupSparkline", St);
                                break;
                            case "sparkline-clear":
                                n.actions.doAction("clearSparkline", St);
                                break;
                            case "sparkline-clear-group":
                                n.actions.doAction("clearSparklineGroup", St);
                                break;
                            case "sparkline-color":
                                u || ($("#sparklinecolor-picker").colorpicker({ valueChanged: function(e, t) { t.name ? n.actions.doAction("setSparklineSetting", n.wrapper.spread, [t.name, "seriesColor"]) : n.actions.doAction("setSparklineSetting", n.wrapper.spread, [t.color, "seriesColor"]) }, choosedColor: function(e, t) { u.gcuipopup("hide") }, openColorDialog: function() { u.gcuipopup("hide") } }), u = $("#sparklinecolor-popup").gcuipopup({ autoHide: !0, position: { of: $("#sparkline-color"), my: "left top", at: "left bottom" }, showing: function(e, t) { $("#sparklinecolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors()) } })), u.gcuipopup("show");
                                break;
                            case "sparkline-marker-color":
                                de || (de = new n.SparklineMarkerColorDialog), de.open();
                                break;
                            case "sparkline-weight-dot25":
                                n.actions.doAction("setSparklineSetting", St, [.25, "lineWeight"]);
                                break;
                            case "sparkline-weight-dot5":
                                n.actions.doAction("setSparklineSetting", St, [.5, "lineWeight"]);
                                break;
                            case "sparkline-weight-dot75":
                                n.actions.doAction("setSparklineSetting", St, [.75, "lineWeight"]);
                                break;
                            case "sparkline-weight-1":
                                n.actions.doAction("setSparklineSetting", St, [1, "lineWeight"]);
                                break;
                            case "sparkline-weight-1dot5":
                                n.actions.doAction("setSparklineSetting", St, [1.5, "lineWeight"]);
                                break;
                            case "sparkline-weight-2dot25":
                                n.actions.doAction("setSparklineSetting", St, [2.25, "lineWeight"]);
                                break;
                            case "sparkline-weight-3":
                                n.actions.doAction("setSparklineSetting", St, [3, "lineWeight"]);
                                break;
                            case "sparkline-weight-4dot5":
                                n.actions.doAction("setSparklineSetting", St, [4.5, "lineWeight"]);
                                break;
                            case "sparkline-weight-6":
                                n.actions.doAction("setSparklineSetting", St, [6, "lineWeight"]);
                                break;
                            case "sparkline-weight-custom":
                                ce || (ce = new n.SparklineWeightDialog), ce.open();
                                break;
                            case "resize-table":
                                he || (he = new n.ResizeTableDialog), he.open();
                                break;
                            case "table-header-row":
                                W("table-header-row"), n.actions.doAction("setTableHeaderRow", St, U("table-header-row"));
                                break;
                            case "table-total-row":
                                W("table-total-row"), n.actions.doAction("setTableTotalRow", St, U("table-total-row"));
                                break;
                            case "table-banded-rows":
                                W("table-banded-rows"), n.actions.doAction("setTableBandedRows", St, U("table-banded-rows"));
                                break;
                            case "table-first-column":
                                W("table-first-column"), n.actions.doAction("setTableFirstColumn", St, U("table-first-column"));
                                break;
                            case "table-last-column":
                                W("table-last-column"), n.actions.doAction("setTableLastColumn", St, U("table-last-column"));
                                break;
                            case "table-banded-columns":
                                W("table-banded-columns"), n.actions.doAction("setTableBandedColumns", St, U("table-banded-columns"));
                                break;
                            case "table-filter-button":
                                W("table-filter-button"), n.actions.doAction("setTableFilterButton", St, U("table-filter-button"));
                                break;
                            case "table-styles":
                                pe || (Je(), pe = $("#format-table-popup").gcuipopup({ autoHide: !0, showing: function(e, i) { $("#format-table-popup span.container-span").removeClass("table-format-item-selected"), t && $("#format-table-popup span.table-format-preview." + t).parent().addClass("table-format-item-selected"), Ct(), $("#format-table-popup").removeClass("hidden") } })), Ye(), pe.gcuipopup({ position: { of: $("#table-styles-button"), my: "left top", at: "right top" } }), pe.gcuipopup("show");
                                break;
                            case "format-table":
                                pe || (Je(), pe = $("#format-table-popup").gcuipopup({ autoHide: !0, position: { of: $("#format-table-button"), my: "left top", at: "left bottom" }, showing: function(e, t) { Ct() } })), Ye(), pe.gcuipopup({ position: { of: $("#format-table-button"), my: "left top", at: "left bottom" } }), pe.gcuipopup("show");
                                break;
                            case "cell-styles":
                                fe || (fe = $("#cell-styles-popup").gcuipopup({ autoHide: !0, position: { of: $("#cell-styles-button"), my: "left top", at: "left bottom" }, showing: function(e, t) { $("#cell-styles-popup").removeClass("hidden") } })), Ae(), fe.gcuipopup("show");
                                break;
                            case "formulaSparkline-setting":
                                if (Xe = kt.getActiveRowIndex(), Qe = kt.getActiveColumnIndex(), Ze = n.util.parseFormulaSparkline(Xe, Qe), et = Ze.functionName, tt = ["BC_QRCODE", "BC_EAN13", "BC_EAN8", "BC_CODABAR", "BC_CODE39", "BC_CODE93", "BC_CODE128", "BC_GS1_128", "BC_CODE49", "BC_PDF417", "BC_DATAMATRIX"], !Ze) break;
                                for (it = 0; it < tt.length; it++)
                                    if (et === tt[it]) { Ge || (Ge = new n.CreateBarcodeDialog), Ge.open(!0); break } if (ot = n.wrapper.spread.getSparklineEx(Ze.functionName), nt = { row: Xe, col: Qe }, ot)
                                    if (ot instanceof o.Sparklines.PieSparkline) ge || (ge = new n.PieSparklineDialog), ge.open(nt);
                                    else if (ot instanceof o.Sparklines.AreaSparkline) be || (be = new n.AreaSparklineDialog), be.open(nt);
                                else if (ot instanceof o.Sparklines.ScatterSparkline) ve || (ve = new n.ScatterSparklineDialog), ve.open(nt);
                                else if (ot instanceof o.Sparklines.LineSparkline || ot instanceof o.Sparklines.ColumnSparkline || ot instanceof o.Sparklines.WinlossSparkline) ye || (ye = new n.CompatibleSparklineDialog), ye.open(nt);
                                else if (ot instanceof o.Sparklines.BulletSparkline) we || (we = new n.BulletSparklineDialog), we.open();
                                else if (ot instanceof o.Sparklines.SpreadSparkline) xe || (xe = new n.SpreadSparklineDialog), xe.open();
                                else if (ot instanceof o.Sparklines.StackedSparkline) Ce || (Ce = new n.StackedSparklineDialog), Ce.open();
                                else if (ot instanceof o.Sparklines.HBarSparkline) Se || (Se = new n.HbarSparklineDialog), Se.open();
                                else if (ot instanceof o.Sparklines.VBarSparkline) Ee || (Ee = new n.VbarSparklineDialog), Ee.open();
                                else if (ot instanceof o.Sparklines.VariSparkline) Ie || (Ie = new n.VariSparklineDialog), Ie.open();
                                else if (ot instanceof o.Sparklines.BoxPlotSparkline) De || (De = new n.BoxPlotSparklineDialog), De.open();
                                else if (ot instanceof o.Sparklines.CascadeSparkline) $e || ($e = new n.CascadeSparklineDialog), $e.open();
                                else if (ot instanceof o.Sparklines.ParetoSparkline) Le || (Le = new n.ParetoSparklineDialog), Le.open();
                                else if (ot instanceof o.Sparklines.MonthSparkline) Me || (Me = new n.CalendarSparklineDialog(0)), Me.open(!0);
                                else if (ot instanceof o.Sparklines.YearSparkline) { Ve || (Ve = new n.CalendarSparklineDialog(1)), Ve.open(!0); break }
                                break;
                            case "auto-generate-label":
                                W("auto-generate-label"), O = !O;
                                break;
                            case "insert-slicer":
                                rt = kt.tables.find(kt.getActiveRowIndex(), kt.getActiveColumnIndex()), rt && (Be || (Be = new n.InsertSlicerDialog), Be.open(rt));
                                break;
                            case "slicer-styles":
                                Oe || (ui(), Oe = $("#format-slicer-popup").gcuipopup({
                                    autoHide: !0,
                                    showing: function(e, t) {
                                        var i, o;
                                        $("#format-slicer-popup span.container-span").removeClass("slicer-format-item-selected"), i = n.util.getSelectedSlicers(kt), o = i && i[0] && i[0].style() && i[0].style().name().toLowerCase() || "", o && (o = o.substr(11), $("#format-slicer-popup span.slicer-format-" + o).parent().addClass("slicer-format-item-selected")), $("#format-slicer-popup").removeClass("hidden")
                                    }
                                }));
                                for (st in n.SlicerStyleDialog.customSlicerStyle) st ? (ct = st.substring(0, st.indexOf("-")), $(".custom-format-slicer").css("display", "block"), pt = "slicer-format-" + ct, $("." + pt).css("display", "inline-block")) : $(".custom-format-slicer").css("display", "none");
                                Oe.gcuipopup({ position: { of: $("#slicer-styles-button"), my: "left top", at: "left bottom" } }), Oe.gcuipopup("show");
                                break;
                            case "slicer-setting":
                                e.slicerSettingDialog || (e.slicerSettingDialog = new n.SlicerSettingDialog), n.util.isSlicerSelected(kt) && e.slicerSettingDialog.open();
                                break;
                            case "quick-layout":
                                Tt && (s.getChartGroupString(Tt.chartType()) === s.chartTypeDict[50].chartGroup ? ut = s.chartTypeDict[50].chartGroup : Tt.series().get(0) && (ut = s.getChartGroupString(Tt.series().get(0).chartType)), Pe || (Pe = $("#ribbon-chart-layout-list-popup").gcuipopup({ autoHide: !0, position: { of: $("#quick-layout"), my: "left top", at: "left bottom" } }), ht = $(".chart-layout-list-container"), Ne = new d(ht, ut, function(e, t) { Pe.gcuipopup("hide"), n.actions.doAction("setChartLayout", n.wrapper.spread, { layouts: t }) })), Ne._setOption(ut), Pe.gcuipopup("show"));
                                break;
                            case "change-colors":
                                a || (ft = M.chartColors, je = new z($("#chart-color-picker"), yt(ft)), je.onSelectedColorChanged = function(e) {
                                    var t = e.group,
                                        i = e.index;
                                    a.gcuipopup("hide"), n.actions.doAction("changeChartSeriesColor", n.wrapper.spread, { group: t, index: i })
                                }, a = $("#chart-color-popup").gcuipopup({ autoHide: !0 }), a.gcuipopup({ position: { of: $("#change-colors"), my: "left top", at: "left bottom" } })), a.gcuipopup("show"), gt = Tt.colorAndStyle && Tt.colorAndStyle.color, mt = "colorful", wt = 0, gt && (mt = gt.group, wt = gt.index), je.setSelectedItem(mt, wt);
                                break;
                            case "change-styles":
                                ze || (ze = $("#ribbon-chart-styles-list-popup").gcuipopup({ autoHide: !0, position: { of: $("#chart-styles"), my: "left top", at: "left bottom" } })), Tt && (se(ze, Tt), ze.gcuipopup("show"));
                                break;
                            case "switch-row-column":
                                n.actions.doAction("switchChartRowCol", n.wrapper.spread);
                                break;
                            case "select-data":
                                e.chartSelectDataDialog || (e.chartSelectDataDialog = new n.ChartSelectDataDialog), e.chartSelectDataDialog.open(Tt);
                                break;
                            case "change-chart-type":
                                e.selectChartDialog || (e.selectChartDialog = new n.SelectChartDialog), Tt && e.selectChartDialog.open(n.SelectChartDialog.dialogType.changeChartType, Tt);
                                break;
                            case "move-chart":
                                e.moveChartDialog || (e.moveChartDialog = new n.MoveChartDialog), e.moveChartDialog.open();
                                break;
                            case "add-chart-element":
                                He || (He = new V(document.getElementById("add-chart-element-container")), He.Vn = function() { We.gcuipopup("hide") }, We = $("#add-chart-element-popup").gcuipopup({ autoHide: !0, position: { of: $("#add-chart-element"), my: "left top", at: "left bottom" }, collision: "fit fit", showing: function() { He.En() }, hiding: function() { He.Xn() } })), We.gcuipopup("show");
                                break;
                            case "change-shape-type":
                                g.isAllIsAppointedShapeType(At, "connectorShapeType") ? n.MessageBox.show(n.res.selectData.errorPrompt.connectorShapeChangeShapeType, "Error", 2) : (qe || (qe = $("#ribbon-shape-changeType-list-popup").gcuipopup({ autoHide: !0, position: { of: $("#change-shape-type"), my: "left top", at: "left bottom" } }), xt = $(".shape-changeType-list-container"), I = new p(xt, "change", function() { qe.gcuipopup("hide") })), qe.gcuipopup("show"));
                                break;
                            case "rotateright90":
                                n.actions.doAction("changeShapeSizeAndProperties", n.wrapper.spread, { selectShape: At, angle: 90, rotateFlag: !0 });
                                break;
                            case "rotateleft90":
                                n.actions.doAction("changeShapeSizeAndProperties", n.wrapper.spread, { selectShape: At, angle: -90, rotateFlag: !0 });
                                break;
                            case "shapegroup":
                                At && At.length > 1 && (n.actions.doAction("shapeGroup", n.wrapper.spread, { selectShape: At, type: "group" }), ne());
                                break;
                            case "shapeungroup":
                                n.actions.doAction("shapeGroup", n.wrapper.spread, { selectShape: At, type: "ungroup" }), ne()
                        }
                        switch (c.commandName) {
                            case "paste-all":
                            case "paste-formulas":
                            case "paste-values":
                            case "paste-formatting":
                                setTimeout(function() { $("#paste-options").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-paste"), $("#paste-options").find(".ui-button-text").text(n.res.ribbon.home.paste).append('<span class="ui-custom-triangle2"></span>') }, 0);
                                break;
                            case "freeze-panes":
                            case "freeze-toprow":
                            case "freeze-firstcolumn":
                            case "freeze-bottomrow":
                            case "freeze-lastcolumn":
                                setTimeout(function() { $("#freeze-panes").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-freeze"), $("#freeze-panes").find(".ui-button-text").html(n.res.ribbon.view.freezePane).append('<span class="ui-custom-triangle"></span>') }, 0);
                                break;
                            case "format-more":
                                setTimeout(function() { $("#number-format").find(".ui-button-text").text(n.res.ribbon.home.general) }, 0);
                                break;
                            case "set-rowheight":
                            case "set-columnwidth":
                            case "autofit-rowheight":
                            case "default-rowheight":
                            case "hide-rows":
                            case "unhide-rows":
                            case "autofit-columnwidth":
                            case "default-columnwidth":
                            case "hide-columns":
                            case "unhide-columns":
                            case "protect-sheet":
                            case "unprotect-sheet":
                            case "lock-cells":
                            case "unlock-cells":
                                setTimeout(function() { $("#format-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-format"), $("#format-row-column").find(".ui-button-text").text(n.res.ribbon.home.format).append('<span class="ui-custom-triangle2"></span>') }, 0);
                                break;
                            case "find":
                            case "goto":
                                setTimeout(function() { $("#find-goto").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-find"), $("#find-goto").find(".ui-button-text").text(n.res.ribbon.home.find).append('<span class="ui-custom-triangle"></span>') }, 0);
                                break;
                            case "sort-AZ":
                            case "sort-ZA":
                            case "custom-sort":
                            case "set-filter":
                            case "clear-filter":
                            case "reapply-filter":
                                setTimeout(function() { $("#sort-filter").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-sortfilter"), $("#sort-filter").find(".ui-button-text").html(n.res.ribbon.home.sortFilter).append('<span class="ui-custom-triangle"></span>') }, 0);
                                break;
                            case "insert-cells":
                            case "insert-rows":
                            case "insert-columns":
                            case "insert-sheet":
                                setTimeout(function() { $("#insert-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-insert"), $("#insert-row-column").find(".ui-button-text").text(n.res.ribbon.home.insert).append('<span class="ui-custom-triangle2"></span>') }, 0);
                                break;
                            case "delete-cells":
                            case "delete-rows":
                            case "delete-columns":
                            case "delete-sheet":
                                setTimeout(function() { $("#delete-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-delete"), $("#delete-row-column").find(".ui-button-text").text(n.res.ribbon.home.Delete).append('<span class="ui-custom-triangle2"></span>') }, 0);
                                break;
                            case "sparkline-weight-dot25":
                            case "sparkline-weight-dot5":
                            case "sparkline-weight-dot75":
                            case "sparkline-weight-1":
                            case "sparkline-weight-1dot5":
                            case "sparkline-weight-2dot25":
                            case "sparkline-weight-3":
                            case "sparkline-weight-4dot5":
                            case "sparkline-weight-6":
                            case "sparkline-weight-custom":
                                setTimeout(function() { $("#sparkline-weight").find(".ui-button-text").text(n.res.ribbon.sparkLineDesign.sparklineWeight) }, 0);
                                break;
                            case "bottom-border":
                            case "top-border":
                            case "left-border":
                            case "right-border":
                            case "no-border":
                            case "all-border":
                            case "outside-border":
                            case "thickbox-border":
                            case "bottom-double-border":
                            case "thick-bottom-border":
                            case "top-bottom-border":
                            case "top-thick-bottom-border":
                            case "top-double-bottom-border":
                            case "more-border":
                                setTimeout(function() { $("#borders").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-bottomborder") }, 0);
                                break;
                            case "rotateright90":
                            case "rotateleft90":
                                setTimeout(function() { $("#rotate-shape-button").find(".ui-button-text").text(n.res.ribbon.shapeDesign.rotate), $("#rotate-shape-button").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-rotate-shape") }, 0);
                                break;
                            case "shapegroup":
                            case "shapeungroup":
                                setTimeout(function() { $("#group-shape-button").find(".ui-button-text").text(n.res.ribbon.shapeDesign.group), $("#group-shape-button").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-group-shape") }, 0)
                        }
                        switch (c.commandName) {
                            case "protect-sheet":
                                $(".ribbon-bar").find("#protect-sheet").addClass("hidden"), $(".ribbon-bar").find("#unprotect-sheet").removeClass("hidden");
                                break;
                            case "unprotect-sheet":
                                $(".ribbon-bar").find("#protect-sheet").removeClass("hidden"), $(".ribbon-bar").find("#unprotect-sheet").addClass("hidden");
                                break;
                            case "lock-cells":
                                $(".ribbon-bar").find("#lock-cells").addClass("hidden"), $(".ribbon-bar").find("#unlock-cells").removeClass("hidden");
                                break;
                            case "unlock-cells":
                                $(".ribbon-bar").find("#lock-cells").removeClass("hidden"), $(".ribbon-bar").find("#unlock-cells").addClass("hidden")
                        }
                    }
                }), $("#rotate-text-popup-menu").addClass("hidden");

                function yt(e) { var t, i, o, n = {}; for (t in e) e.hasOwnProperty(t) && (i = e[t], o = {}, o.name = i.name, o.colors = wt(i.colors, 6), n[t] = o); return n }

                function wt(e, t) {
                    var i = [];
                    return e.forEach(function(e) {
                        var o, n = {};
                        n.tip = e.tip, o = e.items, o instanceof Array || (o = s.getGradientThemeColor(o.startColor, o.stopColor, t)), n.items = xt(o), i.push(n)
                    }), i
                }

                function xt(e) { var t = n.wrapper.spread.getActiveSheet().currentTheme(); return e.map(function(e) { return l.parse(e, t).color }) }

                function Ct() {
                    var e = 18,
                        t = $("#format-table-popup"),
                        i = $(window).height() - $(".ribbon").height();
                    t.height() >= i ? (t.hasClass("scroll") || (t.addClass("scroll"), t.width(t.width() + e)), t.height(i)) : (t.hasClass("scroll") && t.width(t.width() - e), t.removeClass("scroll"))
                }
                Ke = function(e, t) { var i = e.find("ul"); return e.gcuipopup({ autoHide: !0, position: { of: t, my: "left top", at: "right top" }, collision: "fit fit", showing: function(e, t) { i.removeClass("hidden") } }) }, Xe = function(e, t) {
                    var i;
                    void 0 === t ? (i = setTimeout(function() { e.children("ul").addClass("hidden"), mt.splice(mt.indexOf(i), 1), _e = c }, 0), mt.push(i)) : (i = setTimeout(function() { e.children("ul").addClass("hidden"), mt.splice(mt.indexOf(i), 1), _e = c }, t), mt.push(i))
                }, Qe = function(e, t, i) {
                    var o, n;
                    if (!(_e && _e.is(e) && _e.gcuipopup("isVisible"))) {
                        for (_e && Xe(_e), o = 0; o < gt.length; o++) clearTimeout(gt[o]);
                        gt = [], void 0 === i ? (n = setTimeout(function() { e.gcuipopup("show"), gt.splice(gt.indexOf(n), 1), _e = e }, 0), gt.push(n)) : (n = setTimeout(function() { e.gcuipopup("show"), gt.splice(gt.indexOf(n), 1), _e = e }, i), gt.push(n))
                    }
                }, $("#condition-format-popup button").on("mouseenter", function(e) {
                    var t, i = e.currentTarget,
                        o = $(i).children("span.ui-button-text-big");
                    switch (0 === o.length && (o = $(i).children("span.ui-button-text-small"), 0 === o.length && (o = $(i).children("span.icon-button-container"))), $(o).addClass("ui-state-hover"), i.name) {
                        case "highlight-cells-rules":
                            f || (f = Ke($("#highlight-cells-rules-popup"), $(i))), Qe(f, $(i), it);
                            break;
                        case "top-bottom-rules":
                            m || (m = Ke($("#top-bottom-rules-popup"), $(i))), Qe(m, $(i), it);
                            break;
                        case "data-bars":
                            b || (b = Ke($("#data-bars-popup"), $(i))), Qe(b, $(i), it);
                            break;
                        case "color-scales":
                            v || (v = Ke($("#color-scales-popup"), $(i))), Qe(v, $(i), it);
                            break;
                        case "icon-sets":
                            y || (y = Ke($("#icon-sets-popup"), $(i))), Qe(y, $(i), it);
                            break;
                        case "clear-rules":
                            w || (w = Ke($("#clear-rules-popup"), $(i))), Qe(w, $(i), it);
                            break;
                        case "new-rule":
                        case "manage-rules":
                            for (t = 0; t < gt.length; t++) clearTimeout(gt[t]);
                            gt = [], _e && Xe(_e)
                    }
                }), $("#condition-format-popup button").on("mouseleave", function(e) {
                    var t = e.currentTarget,
                        i = $(t).children("span.ui-button-text-big");
                    0 === i.length && (i = $(t).children("span.ui-button-text-small"), 0 === i.length && (i = $(t).children("span.icon-button-container"))), $(i).removeClass("ui-state-hover")
                }), Ze = function(e, t) {
                    var i, o = n.wrapper.spread.getActiveSheet(),
                        r = o.getSelections();
                    i = 0 === arguments.length ? new GC.Spread.Sheets.ConditionalFormatting.DataBarRule : new GC.Spread.Sheets.ConditionalFormatting.DataBarRule(5, "(Automatic)", 7, "(Automatic)", e, r), i.gradient(t), n.actions.doAction("addRule", n.wrapper.spread, { rule: i, isRemove: !0 })
                }, et = function(e, t, i) {
                    var r, a, s = n.wrapper.spread.getActiveSheet(),
                        l = s.getSelections(),
                        c = 2,
                        d = null,
                        p = e,
                        u = 1,
                        h = null,
                        f = t;
                    i ? (a = t, f = i, r = new o.ConditionalFormatting.ScaleRule(11, u, h, f, ot, nt, a, c, d, p, l)) : r = new o.ConditionalFormatting.ScaleRule(10, u, h, f, null, null, null, c, d, p, l), n.actions.doAction("addRule", n.wrapper.spread, { rule: r, isRemove: !0 })
                }, tt = function(e) {
                    var t = n.wrapper.spread.getActiveSheet(),
                        i = t.getSelections(),
                        r = new o.ConditionalFormatting.IconSetRule(e, i);
                    n.actions.doAction("addRule", n.wrapper.spread, { rule: r, isRemove: !0 })
                }, $("#condition-format-popup button").on("click", function(e) {
                    var t = e.currentTarget;
                    switch (t.name) {
                        case "highlight-cells-rules":
                            f || (f = Ke($("#highlight-cells-rules-popup"), $(t))), Qe(f, $(t));
                            break;
                        case "top-bottom-rules":
                            m || (m = Ke($("#top-bottom-rules-popup"), $(t))), Qe(m, $(t));
                            break;
                        case "data-bars":
                            b || (b = Ke($("#data-bars-popup"), $(t))), Qe(b, $(t));
                            break;
                        case "color-scales":
                            v || (v = Ke($("#color-scales-popup"), $(t))), Qe(v, $(t));
                            break;
                        case "icon-sets":
                            y || (y = Ke($("#icon-sets-popup"), $(t))), Qe(y, $(t));
                            break;
                        case "clear-rules":
                            w || (w = Ke($("#clear-rules-popup"), $(t))), Qe(w, $(t));
                            break;
                        case "manage-rules":
                            ft.open(), vt();
                            break;
                        case "highlight-cells-rules-greater-than":
                            rt.open(0), vt();
                            break;
                        case "highlight-cells-rules-less-than":
                            rt.open(1), vt();
                            break;
                        case "highlight-cells-rules-between":
                            rt.open(2), vt();
                            break;
                        case "highlight-cells-rules-equal-to":
                            rt.open(3), vt();
                            break;
                        case "highlight-cells-rules-text-contains":
                            st.open(), vt();
                            break;
                        case "highlight-cells-rules-a-date-occurring":
                            ct.open(), vt();
                            break;
                        case "highlight-cells-rules-duplicate-values":
                            pt.open(), vt();
                            break;
                        case "highlight-cells-rules-more-rules":
                            Fe || (Fe = new n.NewFormattingRuleDialog, $(Fe).on("dialogClose", function(e, t) { Fe = null })), Fe.open(1, !0, void 0, void 0, void 0, 4), vt();
                            break;
                        case "top-bottom-rules-top-10-items":
                            ut.open(4), vt();
                            break;
                        case "top-bottom-rules-bottom-10-items":
                            ut.open(5), vt();
                            break;
                        case "top-bottom-rules-above-average":
                            ht.open(6), vt();
                            break;
                        case "top-bottom-rules-below-average":
                            ht.open(7), vt();
                            break;
                        case "top-bottom-rules-more-rules":
                            Fe || (Fe = new n.NewFormattingRuleDialog, $(Fe).on("dialogClose", function(e, t) { Fe = null })), Fe.open(2, !0), vt();
                            break;
                        case "gradient-fill-blue-data-bar":
                            Ze("blue", !0), vt();
                            break;
                        case "gradient-fill-green-data-bar":
                            Ze("green", !0), vt();
                            break;
                        case "gradient-fill-red-data-bar":
                            Ze("red", !0), vt();
                            break;
                        case "gradient-fill-orange-data-bar":
                            Ze("orange", !0), vt();
                            break;
                        case "gradient-fill-lightblue-data-bar":
                            Ze("lightblue", !0), vt();
                            break;
                        case "gradient-fill-purple-data-bar":
                            Ze("purple", !0), vt();
                            break;
                        case "solid-fill-blue-data-bar":
                            Ze("blue", !1), vt();
                            break;
                        case "solid-fill-green-data-bar":
                            Ze("green", !1), vt();
                            break;
                        case "solid-fill-red-data-bar":
                            Ze("red", !1), vt();
                            break;
                        case "solid-fill-orange-data-bar":
                            Ze("orange", !1), vt();
                            break;
                        case "solid-fill-lightblue-data-bar":
                            Ze("lightblue", !1), vt();
                            break;
                        case "solid-fill-purple-data-bar":
                            Ze("purple", !1), vt();
                            break;
                        case "data-bars-more-rules":
                            Fe || (Fe = new n.NewFormattingRuleDialog, $(Fe).on("dialogClose", function(e, t) { Fe = null })), Fe.open(0, !0, 2), vt();
                            break;
                        case "gyr-color-scale":
                            et("green", "yellow", "red"), vt();
                            break;
                        case "ryg-color-scale":
                            et("red", "yellow", "green"), vt();
                            break;
                        case "gwr-color-scale":
                            et("green", "white", "red"), vt();
                            break;
                        case "rwg-color-scale":
                            et("red", "white", "green"), vt();
                            break;
                        case "bwr-color-scale":
                            et("blue", "white", "red"), vt();
                            break;
                        case "rwb-color-scale":
                            et("red", "white", "blue"), vt();
                            break;
                        case "wr-color-scale":
                            et("white", "red"), vt();
                            break;
                        case "rw-color-scale":
                            et("red", "white"), vt();
                            break;
                        case "gw-color-scale":
                            et("green", "white"), vt();
                            break;
                        case "wg-color-scale":
                            et("white", "green"), vt();
                            break;
                        case "gy-color-scale":
                            et("green", "yellow"), vt();
                            break;
                        case "yg-color-scale":
                            et("yellow", "green"), vt();
                            break;
                        case "new-rule":
                        case "color-scales-more-rules":
                            Fe || (Fe = new n.NewFormattingRuleDialog, $(Fe).on("dialogClose", function(e, t) { Fe = null })), Fe.open(0, !0, 0), vt();
                            break;
                        case "3-arrows-icon-set":
                            tt(0), vt();
                            break;
                        case "3-arrows-gray-icon-set":
                            tt(1), vt();
                            break;
                        case "3-triangles-icon-set":
                            tt(2), vt();
                            break;
                        case "3-traffic-lights-unrimmed-icon-set":
                            tt(5), vt();
                            break;
                        case "3-traffic-lights-rimmed-icon-set":
                            tt(6), vt();
                            break;
                        case "3-signs-icon-set":
                            tt(7), vt();
                            break;
                        case "3-symbols-circled-icon-set":
                            tt(8), vt();
                            break;
                        case "3-symbols-uncircled-icon-set":
                            tt(9), vt();
                            break;
                        case "3-flags-icon-set":
                            tt(4), vt();
                            break;
                        case "3-stars-icon-set":
                            tt(3), vt();
                            break;
                        case "4-arrows-gray-icon-set":
                            tt(11), vt();
                            break;
                        case "4-arrows-icon-set":
                            tt(10), vt();
                            break;
                        case "4-traffic-lights-icon-set":
                            tt(14), vt();
                            break;
                        case "red-to-black-icon-set":
                            tt(12), vt();
                            break;
                        case "4-ratings-icon-set":
                            tt(13), vt();
                            break;
                        case "5-arrows-gray-icon-set":
                            tt(16), vt();
                            break;
                        case "5-arrows-icon-set":
                            tt(15), vt();
                            break;
                        case "5-quarters-icon-set":
                            tt(18), vt();
                            break;
                        case "5-ratings-icon-set":
                            tt(17), vt();
                            break;
                        case "5-boxes-icon-set":
                            tt(19), vt();
                            break;
                        case "icon-sets-more-rules":
                            Fe || (Fe = new n.NewFormattingRuleDialog, $(Fe).on("dialogClose", function(e, t) { Fe = null })), Fe.open(0, !0, 3), vt();
                            break;
                        case "clear-rules-from-cells":
                            n.actions.doAction("clearRule", n.wrapper.spread, !1), n.actions.isFileModified = !0, vt();
                            break;
                        case "clear-rules-from-sheet":
                            n.actions.doAction("clearRule", n.wrapper.spread, !0), n.actions.isFileModified = !0, vt()
                    }
                }), $(document).on("click", function(e) { if (0 !== $("#condition-format-popup").height() && $("#condition-format-popup").is(":visible")) { var t = e.target;!1 === $.contains($("#condition-format-popup")[0], t) && vt() } }), X(), J(), ee(), Z(), ti(), te(), oe()
            }

            function W(e) { $("#" + e).find(".ui-icon").toggleClass("gcui-ribbon-checked").toggleClass("gcui-ribbon-unchecked") }

            function U(e) { return $("#" + e).find(".ui-icon").hasClass("gcui-ribbon-checked") }

            function q(e, t) {
                var i = $("#" + e).find(".ui-icon").removeClass("gcui-ribbon-checked").removeClass("gcui-ribbon-unchecked");
                t ? i.addClass("gcui-ribbon-checked") : i.addClass("gcui-ribbon-unchecked")
            }

            function _() {
                var e, t = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72],
                    i = $("#font-size").find(".ui-button-text"),
                    o = +i.text();
                if (!(o >= t[t.length - 1]))
                    for (e = 0; e < t.length; e++) { if (o < t[e]) return i.text(t[e]), t[e]; if (o === t[e]) return i.text(t[e + 1]), t[e + 1] }
            }

            function K() {
                var e, t = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72],
                    i = $("#font-size").find(".ui-button-text"),
                    o = +i.text();
                if (!(o <= t[0]))
                    for (e = t.length - 1; e > 0; e--) { if (o > t[e]) return i.text(t[e]), t[e]; if (o === t[e]) return i.text(t[e - 1]), t[e - 1] }
            }

            function X() {
                $("#font-family").addClass("gcui-ribbon-fontfamily"), $("#font-size").addClass("gcui-ribbon-fontsize"), $("#number-format").addClass("gcui-ribbon-number"), $("#paste-options").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-paste"), $("#paste-options").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'), $("#freeze-panes").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-freeze"), $("#freeze-panes").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#find-goto").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-find"), $("#find-goto").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#sort-filter").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-sortfilter"), $("#sort-filter").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#condition-format").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-conditionalformat"), $("#insert-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-insert"), $("#insert-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'), $("#delete-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-delete"), $("#delete-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'), $("#format-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-format"), $("#format-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'), $("#calculate-option").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-calculateoption"), $("#calculate-option").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#borders").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-bottomborder"), $("#borders").find(".ui-button-text").text("borders"), $("#group-shape-button").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-group-shape"), $("#rotate-shape-button").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-rotate-shape"), $("#rotateright90").find(".ui-button-text").addClass("add-image-icon add-rotateright90-icon"), $("#rotateleft90").find(".ui-button-text").addClass("add-image-icon add-rotateleft90-icon"), $("#shapegroup").find(".ui-button-text").addClass("add-image-icon add-shapegroup-icon"), $("#shapeungroup").find(".ui-button-text").addClass("add-image-icon add-shapeungroup-icon"), $(".gcui-ribbon-bigbutton").each(function(e, t) {
                    var i = $(t);
                    i.data("button-size") ? i.width(i.data("button-size")) : i.width(i.width() + 10)
                }), $(".gcui-ribbon-slicerbigbutton").each(function(e, t) {
                    var i = $(t);
                    i.data("button-size") && i.width(i.data("button-size"))
                }), $("#showhide-vgridline").parents(".gcui-ribbon-list").addClass("gcui-ribbon-marginright"), $("#showhide-columnheader").parents(".gcui-ribbon-list").addClass("gcui-ribbon-marginright"), $("#add-chart-element").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#quick-layout").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#chart-styles").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'), $("#change-colors").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>')
            }

            function J() { $("a[href='#sparklineTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "sparklineTab", !1) }

            function Y() { $(".ribbon-bar").gcuiribbon("setTabPageVisible", "sparklineTab", !0), $(".ribbon-bar").gcuitabs("select", "sparklineTab") }

            function Q() { $(".ribbon-bar").gcuiribbon("setTabPageVisible", "formulaSparklineTab", !0), $(".ribbon-bar").gcuitabs("select", "formulaSparklineTab") }

            function Z() { $("a[href='#formulaSparklineTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "formulaSparklineTab", !1) }

            function ee() { $("a[href='#tableTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !1) }

            function te() { $("a[href='#chartTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "chartTab", !1) }

            function ie() { $(".ribbon-bar").gcuiribbon("setTabPageVisible", "chartTab", !0), $(".ribbon-bar").gcuitabs("select", "chartTab") }

            function oe() { $("a[href='#shapeTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "shapeTab", !1) }

            function ne() { $(".ribbon-bar").gcuiribbon("setTabPageVisible", "shapeTab", !0), $(".ribbon-bar").gcuitabs("select", "shapeTab"), re(), ae() }

            function re() {
                var e = $("#change-shape-part-style"),
                    t = $("#reInsert-shape-preview"),
                    i = n.wrapper.spread.getActiveSheet(),
                    o = g.getActiveShapes(i);
                0 !== e.children.length && e.empty(), 0 !== t.children.length && t.empty(), g.isAllIsAppointedShapeType(o, "connectorShapeType") ? new h(e, !1, "connectorShapeType") : new h(e, !1, "autoShapeType"), new u(t)
            }

            function ae() {
                var e, t, i = $("#shapeTab #change-shape-size"),
                    o = n.wrapper.spread.getActiveSheet(),
                    r = g.getActiveShapes(o);
                0 !== i.children.length && i.empty(), n.wrapper.spread.getActiveSheet().unbind(GC.Spread.Sheets.Events.ShapeChanged), e = new f(i, n.res.ribbon.shapeDesign.height, function(e) { n.actions.doAction("changeShapeSizeAndProperties", n.wrapper.spread, { selectShape: r, height: e }) }, { min: 0, max: 900 }), t = new f(i, n.res.ribbon.shapeDesign.width, function(e) { n.actions.doAction("changeShapeSizeAndProperties", n.wrapper.spread, { selectShape: r, width: e }) }, { min: 0, max: 900 }), t.value = g.updataSize(o)[0], t.updateValue(), e.value = g.updataSize(o)[1], e.updateValue(), n.wrapper.spread.getActiveSheet().bind(GC.Spread.Sheets.Events.ShapeChanged, function(i, n) { t.value = g.updataSize(o)[0], t.updateValue(), e.value = g.updataSize(o)[1], e.updateValue() })
            }

            function se(e, t) {
                var i, o, a, l, c, d, p, u, h, f = $("#chart-styles-list-container"),
                    g = n.wrapper.spread,
                    m = g.getActiveSheet(),
                    b = t.series().get(),
                    v = s.getSeriesWithoutStyle(b),
                    y = t.colorAndStyle,
                    w = new r.Chart(m, "chartForGetDefaultStyle", void 0, 20, 20, 480, 288, null);
                for (w.series().add(v), i = t.colorAndStyle && t.colorAndStyle.color, s.applyChartSeriesTheme(w, i || {}), o = ce(w), o.colorAndStyle = y, a = s.getChartTypeString(t.chartType()), l = M.chartStyles[a], l.colorAndStyle = y, s.getChartGroupString(t.chartType()) === s.chartTypeDict[52].chartGroup && le(o, t), c = n.chartPreviewer, c.synchronizeData(n.wrapper.spread), d = c.getPreviewCharts(o, l), n.wrapper.spread.focus(), f.empty(), p = 0; p < d.length; p++)(u = d[p]) && u instanceof r.Chart && (h = s.getImageFromChart(u), de(h, f, p));
                f.off("click"), f.on("click", { templatesChartStyle: l, defaultChartStyle: o }, function(t) {
                    var i, o;
                    e.gcuipopup("hide"), i = $(t.target), $(".chart-style-preview-image").removeClass("chart-style-preview-image-selected"), i.addClass("chart-style-preview-image-selected"), o = i.index(".chart-style-preview-image"), n.actions.doAction("setChartStyle", n.wrapper.spread, { chartStyle: { templatesChartStyle: t.data.templatesChartStyle[o], defaultChartStyle: t.data.defaultChartStyle } })
                })
            }

            function le(e, t) { for (var i, o = 0, n = e.length, r = t.chartType(), a = t.dataRange(); o < n; o++) i = e[o], i.chartType = s.getChartTypeString(r), i.category = s.getChartGroupString(r), i.dataFormula = a }

            function ce(e) { var t = {}; return t.chartArea = e.chartArea(), t.axes = e.axes(), t.dataLabels = e.dataLabels(), t.title = e.title(), t.legend = e.legend(), t.series = e.series().get(), t }

            function de(e, t, i) {
                var o = $("<span></span>");
                o.addClass("chart-style-preview-image"), o.attr("title", "Style " + (i + 1)), o.css("background-image", "url('" + e + "')"), o.appendTo(t)
            }

            function pe(e) {
                var t = n.wrapper.spread.getActiveSheet(),
                    i = e || s.getSelectedChart(t);
                !i || !i.isSelected() || !t.options.protectionOptions.allowEditObjects && t.options.isProtected && i.isLocked() ? te() : ie()
            }
            e.updateChartTab = pe;

            function ue(e) {
                var t = n.wrapper.spread.getActiveSheet(),
                    i = e && e[0] || g.getActiveShapes(t)[0];
                !i || !i.isSelected() || !t.options.protectionOptions.allowEditObjects && t.options.isProtected && i.isLocked() ? oe() : ne()
            }
            e.updateShapeTab = ue;

            function he() { $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0), $(".ribbon-bar").gcuitabs("select", "tableTab") }

            function fe(e, t) { $(e).button("option", "label", t) }

            function ge() {
                var e = n.wrapper.spread.undoManager();
                e && (e.canUndo() ? ($(".quick-access-bar").find('[data-action="undo"]').prop("disabled", !1), $(".quick-access-bar").find('[data-action="undo"]').fadeTo("faster", 1)) : ($(".quick-access-bar").find('[data-action="undo"]').prop("disabled", !0), $(".quick-access-bar").find('[data-action="undo"]').fadeTo("faster", .2)), e.canRedo() ? ($(".quick-access-bar").find('[data-action="redo"]').prop("disabled", !1), $(".quick-access-bar").find('[data-action="redo"]').fadeTo("faster", 1)) : ($(".quick-access-bar").find('[data-action="redo"]').prop("disabled", !0), $(".quick-access-bar").find('[data-action="redo"]').fadeTo("faster", .2)))
            }
            e.updateUndoRedo = ge;

            function me() {
                var e, t, i, o, r, a, s = n.wrapper.spread.getActiveSheet(),
                    l = s.getActualStyle(s.getActiveRowIndex(), s.getActiveColumnIndex());
                if ($(".ribbon-bar").gcuiribbon("setButtonsChecked", { "font-weight": !1, "font-italic": !1, "font-underline": !1, "font-double-underline": !1 }), l && l.font) {
                    if (e = n.util.parseFont(l.font), "normal" !== e.fontWeight && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-weight", !0), "normal" !== e.fontStyle && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-italic", !0), e.fontSize && fe("#font-size", e.fontSize.substring(0, e.fontSize.length - 2)), e.fontFamily) {
                        t = e.fontFamily.split(","), i = t[0], i.match(/^["'].*["']$/) && (i = i.substring(1, i.length - 1)), o = RegExp("^(.*,s*)?[\"']?" + i + "[\"']?s*(,.*)?$");
                        for (r in n.res.ribbon.fontFamilies)
                            if (o.test(n.res.ribbon.fontFamilies[r].name)) { i = n.res.ribbon.fontFamilies[r].text; break } a = be($("#font-family").children(".ui-button-text"), i), fe("#font-family", a)
                    }
                } else e = n.util.parseFont(n.res.defaultFont), fe("#font-size", e.fontSize.substring(0, e.fontSize.length - 2)), fe("#font-family", e.fontFamily);
                if (l && l.textDecoration && 1 & l.textDecoration && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-underline", !0), l && l.textDecoration && 8 & l.textDecoration && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-double-underline", !0), $(".ribbon-bar").gcuiribbon("setButtonsChecked", { "left-align": !1, "center-align": !1, "right-align": !1 }), l && void 0 !== l.hAlign) switch (l.hAlign) {
                    case 0:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "left-align", !0);
                        break;
                    case 1:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "center-align", !0);
                        break;
                    case 2:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "right-align", !0)
                }
                if ($(".ribbon-bar").gcuiribbon("setButtonsChecked", { "top-align": !1, "middle-align": !1, "bottom-align": !1 }), l && void 0 !== l.vAlign) switch (l.vAlign) {
                    case 0:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "top-align", !0);
                        break;
                    case 1:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "middle-align", !0);
                        break;
                    case 2:
                        $(".ribbon-bar").gcuiribbon("setButtonChecked", "bottom-align", !0)
                }
                l && l.wordWrap ? $(".ribbon-bar").gcuiribbon("setButtonChecked", "wrap-text", !0) : $(".ribbon-bar").gcuiribbon("setButtonChecked", "wrap-text", !1), l && l.isVerticalText ? $(".ribbon-bar").gcuiribbon("setButtonChecked", "vertical-text", !0) : $(".ribbon-bar").gcuiribbon("setButtonChecked", "vertical-text", !1)
            }
            e.updateCellStyle = me;

            function be(e, t) { return $(".ribbon-bar").gcuiribbon("getDropdownLabelSubstr", t, e, e.width()) }

            function ve() {
                var e, t, i = n.wrapper.spread.getActiveSheet(),
                    o = i.getActualStyle(i.getActiveRowIndex(), i.getActiveColumnIndex());
                if (o && o.formatter && "general" !== o.formatter) {
                    for (e in n.res.commonFormats)
                        if (t = n.res.commonFormats[e], t.format === o.formatter) return void fe("#number-format", t.label);
                    fe("#number-format", n.res.customFormat)
                } else fe("#number-format", n.res.generalFormat)
            }
            e.updateFormat = ve;

            function ye() {
                var e, t, i = n.wrapper.spread.getActiveSheet(),
                    o = i.getSelections();
                for (e = 0; e < o.length; e++)
                    if (t = i.getSpans(o[e]), t.length > 0) return void $(".ribbon-bar").gcuiribbon("setButtonChecked", "merge-center", !0);
                $(".ribbon-bar").gcuiribbon("setButtonChecked", "merge-center", !1)
            }
            e.updateMerge = ye;

            function we() {
                var e, t, i, r, a, s;
                if (Z(), J(), e = n.wrapper.spread.getActiveSheet(), t = e.getActiveRowIndex(), i = e.getActiveColumnIndex(), !(r = e.getSelections()) || 0 !== r.length)
                    if (e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex()) instanceof o.Sparklines.Sparkline) {
                        switch (Y(), a = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex()), $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-line", !1), $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-column", !1), $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-winloss", !1), a.sparklineType()) {
                            case 0:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-line", !0);
                                break;
                            case 1:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-column", !0);
                                break;
                            case 2:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-winloss", !0)
                        }
                        s = a.setting(), q("sparkline-high-point", s.options.showHigh), q("sparkline-low-point", s.options.showLow), q("sparkline-first-point", s.options.showFirst), q("sparkline-last-point", s.options.showLast), q("sparkline-negative-point", s.options.showNegative), q("sparkline-marker-point", s.options.showMarkers)
                    } else n.util.parseFormulaSparkline(t, i) && Q()
            }
            e.updateSparkline = we;

            function xe() {
                var e, i, r, a = n.wrapper.spread.getActiveSheet(),
                    s = a.getSelections();
                s && 0 === s.length || (a.tables.find(a.getActiveRowIndex(), a.getActiveColumnIndex()) instanceof o.Tables.Table ? (he(), $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !0), e = a.tables.find(a.getActiveRowIndex(), a.getActiveColumnIndex()), q("table-header-row", e.showHeader()), q("table-total-row", e.showFooter()), q("table-banded-rows", e.bandRows()), q("table-first-column", e.highlightFirstColumn()), q("table-last-column", e.highlightLastColumn()), q("table-banded-columns", e.bandColumns()), q("table-filter-button", e.filterButtonVisible()), $(".designer-table-name").val(e.name()), i = e.style(), r = i.name(), t = r && r.toLowerCase() || "") : (ee(), $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !1)))
            }
            e.updateTable = xe;

            function Ce() {
                var e = n.wrapper.spread.getActiveSheet();
                q("showhide-columnheader", e.options.colHeaderVisible), q("showhide-rowheader", e.options.rowHeaderVisible), q("showhide-hgridline", e.options.gridline.showHorizontalGridline), q("showhide-vgridline", e.options.gridline.showVerticalGridline), q("showhide-tabstrip", n.wrapper.spread.options.tabStripVisible), q("showhide-newtab", n.wrapper.spread.options.newTabVisible)
            }
            e.updateShowHide = Ce;

            function Se() {
                var e = n.wrapper.spread.getActiveSheet();
                e.options.isProtected ? ($(".ribbon-bar").find("#protect-sheet").addClass("hidden"), $(".ribbon-bar").find("#unprotect-sheet").removeClass("hidden")) : ($(".ribbon-bar").find("#protect-sheet").removeClass("hidden"), $(".ribbon-bar").find("#unprotect-sheet").addClass("hidden")), e.getCell(e.getActiveRowIndex(), e.getActiveColumnIndex()).locked() ? ($(".ribbon-bar").find("#lock-cells").addClass("hidden"), $(".ribbon-bar").find("#unlock-cells").removeClass("hidden")) : ($(".ribbon-bar").find("#lock-cells").removeClass("hidden"), $(".ribbon-bar").find("#unlock-cells").addClass("hidden"))
            }
            e.updateProtectLock = Se;

            function ke() {
                var e = n.wrapper.spread.getActiveSheet();
                $(".statusBar").find(".statusbar-zoom-value").text(Math.round(100 * e.zoom()) + "%")
            }
            e.updateZoomToStatusBar = ke;

            function Te() {
                var e, t = $("#template-design-mode"),
                    i = t.find("span.ui-button-text"),
                    o = $("#data-binding-setting-indicator"),
                    r = $(".designer-data-binding-icon"),
                    s = $(".slider-panel");
                vt(), i.removeClass("template-design-mode-checked"), o.attr("hidden", "hidden"), r.unbind("click.indicator"), a && (e = n.wrapper.spread.getActiveSheet(), e.setDataSource(a)), s.is(":visible") && s.sliderpanel("close", "panel1"), t.data("checked", !1), nt()
            }

            function Ae() { $(".custom-cell-styles-preview").empty(), Ve(n.CellStyleDialog.existedCustomCellStyle, $(".custom-cell-styles-preview"), !0), Xe() }

            function Ee() {
                var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread;
                for ($(".custom-cell-styles-preview").children().remove(), $(".good-bad-style-preview").children().remove(), $(".data-model-style-preview").children().remove(), $(".titles-headings-preview").children().remove(), $(".themed-preview").children().remove(), $(".number-format-preview").children().remove(), n.CellStyleDialog.existedCustomCellStyle = {}, n.CellStyleDialog.buildInCellStyle = {}, e = Ie(d), t = De(d), i = $e(d), o = Le(d), r = Fe(d), Re(e, t, i, o, r), a = d.getNamedStyles(), s = 0; s < a.length; s++)(l = a[s].name) && (c = l.toLowerCase(), "__builtin" === c.substr(0, 9) || n.CellStyleDialog.buildInCellStyle.hasOwnProperty(c) || (n.CellStyleDialog.existedCustomCellStyle[c] = a[s]));
                Ge(n.CellStyleDialog.existedCustomCellStyle) && ($(".cell-style-custom-li").addClass("hidden"), $(".custom-cell-styles-preview").parent().addClass("hidden")), Ve(n.res.cellStylesDialog.goodBadAndNeutralContent, $(".good-bad-style-preview"), !1, e), Ve(n.res.cellStylesDialog.dataAndModelContent, $(".data-model-style-preview"), !1, t), Ve(n.res.cellStylesDialog.titlesAndHeadingsContent, $(".titles-headings-preview"), !1, i), Ve(n.res.cellStylesDialog.themedCellStyleContent, $(".themed-preview"), !1, o), Ve(n.res.cellStylesDialog.numberFormatContent, $(".number-format-preview"), !1, r), Ke()
            }
            e.resetSpreadNamedStyle = Ee;

            function Ie(e) {
                var t, i, o, n = ["normal", "bad", "good", "neutral"],
                    r = {};
                for (t = 0; t < n.length; t++)
                    if (i = e.getNamedStyle(n[t]), o = n[t], i) r[o] = i;
                    else switch (o) {
                        case "normal":
                            r.normal = { name: "Normal" };
                            break;
                        case "bad":
                            r.bad = { name: "Bad", backColor: "#FFC7CE", foreColor: "#9C0006" };
                            break;
                        case "good":
                            r.good = { name: "Good", backColor: "#C6EFCE", foreColor: "#006100" };
                            break;
                        case "neutral":
                            r.neutral = { name: "Neutral", backColor: "#FFEB9C", foreColor: "#9C6500" }
                    }
                return r
            }

            function De(e) {
                var t, i, o, n = ["calculation", "check cell", "explanatory text", "input", "linked cell", "note", "output", "warning text"],
                    r = {};
                for (t = 0; t < n.length; t++)
                    if (i = e.getNamedStyle(n[t]), o = n[t], i) r[o] = i;
                    else switch (o) {
                        case "calculation":
                            r.calculation = { name: "Calculation", backColor: "#F2F2F2", foreColor: "#FCA957", border: "thin solid black", font: "bold 13px Arial" };
                            break;
                        case "check cell":
                            r["check cell"] = { name: "Check Cell", backColor: "#A5A5A5", foreColor: "#FFFFFF", border: "medium double black", font: "bold 13px Arial" };
                            break;
                        case "explanatory text":
                            r["explanatory text"] = { name: "Explanatory Text", foreColor: "#7F7F7F", font: "italic bold 13px Arial" };
                            break;
                        case "input":
                            r.input = { name: "Input", foreColor: "#3F3F76", backColor: "#FFCC99", border: "thin solid black", font: "bold 13px Arial" };
                            break;
                        case "linked cell":
                            r["linked cell"] = { name: "Linked Cell", foreColor: "#FCA957", borderBottom: "medium double #FDD3A9", font: "bold 13px Arial" };
                            break;
                        case "note":
                            r.note = { name: "Note", backColor: "#FFFFCC", border: "thin solid black", font: "13px Arial" };
                            break;
                        case "output":
                            r.output = { name: "Output", backColor: "#F2F2F2", border: "thin solid black", font: "bold 13px Arial" };
                            break;
                        case "warning text":
                            r["warning text"] = { name: "Warning Text", foreColor: "#FF3030", font: "13px Arial" }
                    }
                return r
            }

            function $e(e) {
                var t, i, o, n = ["heading 1", "heading 2", "heading 3", "heading 4", "title", "total"],
                    r = {};
                for (t = 0; t < n.length; t++)
                    if (i = e.getNamedStyle(n[t]), o = n[t], i) r[o] = i;
                    else switch (o) {
                        case "heading 1":
                            r["heading 1"] = { name: "Heading 1", foreColor: "#1F497D", font: "bold 17px Arial", borderBottom: "medium solid #4F81BD" };
                            break;
                        case "heading 2":
                            r["heading 2"] = { name: "Heading 2", foreColor: "#1F497D", font: "bold 15px Arial", borderBottom: "medium solid #A4BDDD" };
                            break;
                        case "heading 3":
                            r["heading 3"] = { name: "Heading 3", foreColor: "#1F497D", font: "bold 13px Arial", borderBottom: "thin solid #93B1D7" };
                            break;
                        case "heading 4":
                            r["heading 4"] = { name: "Heading 4", foreColor: "#1F497D", font: "bold 13px Arial" };
                            break;
                        case "title":
                            r.title = { name: "Title", foreColor: "#1F497D", font: "bold 17px Century" };
                            break;
                        case "total":
                            r.total = { name: "Total", font: "bold 13px Arial", borderTop: "thin solid #1F497D", borderBottom: "medium double #1F497D" }
                    }
                return r
            }

            function Le(e) {
                var t, i, o, r, a, s, l, c = {},
                    d = n.res.cellStylesDialog.themedCellStyleContent,
                    p = "black";
                for (t in d) i = t.toLowerCase(), o = e.getNamedStyle(t), o ? c[i] = o : (a = t.split("-"), 1 === a.length ? (s = a[0].substr(a[0].length - 1), r = "Accent " + s + " 0", p = "white") : 2 === a.length && (s = a[1].substr(a[1].length - 1), l = 100 - parseInt(a[0]), r = "Accent " + s + " " + l + "%", p = l <= 50 ? "white" : "black"), r = n.ColorHelper.parse(r, n.wrapper.spread.getActiveSheet().currentTheme().colors()), c[i] = { name: t, backColor: r.color, foreColor: p });
                return c
            }

            function Fe(e) {
                var t, i, o, n = ["comma", "comma [0]", "currency", "currency [0]", "percent"],
                    r = {};
                for (t = 0; t < n.length; t++)
                    if (i = e.getNamedStyle(n[t]), o = n[t], i) r[o] = i;
                    else switch (o) {
                        case "comma":
                            r.comma = { name: "Comma", formatter: '_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)' };
                            break;
                        case "comma [0]":
                            r["comma [0]"] = { name: "Comma [0]", formatter: '_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)' };
                            break;
                        case "currency":
                            r.currency = { name: "Currency", formatter: '_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)' };
                            break;
                        case "currency [0]":
                            r["currency [0]"] = { name: "Currency [0]", formatter: '_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)' };
                            break;
                        case "percent":
                            r.percent = { name: "Percent", formatter: "0%" }
                    }
                return r
            }

            function Re() { var e, t, i, r, a, s, l, c = []; for (e = 0; e < arguments.length - 0; e++) c[e] = arguments[e + 0]; for (t = c.length, i = 0; i < t; i++) { r = c[i]; for (a in r) s = r[a], s instanceof o.Style || Be(s), l = s.name.toLowerCase(), n.CellStyleDialog.buildInCellStyle[l] = s } }

            function Be(e) { e.borderTop && (e.borderTop = Oe(e.borderTop)), e.borderBottom && (e.borderBottom = Oe(e.borderBottom)), e.borderLeft && (e.borderLeft = Oe(e.borderLeft)), e.borderRight && (e.borderRight = Oe(e.borderRight)), e.border && (e.borderTop = Oe(e.border), e.borderBottom = Oe(e.border), e.borderLeft = Oe(e.border), e.borderRight = Oe(e.border)) }

            function Oe(e) { var t, i, n; if (e) return t = e.split(" "), i = 1, 3 === t.length ? ("thin" !== t[0] && "medium" !== t[0] && "thick" !== t[0] || (i = o.LineStyle[t[0]]), "solid" !== t[1] && (i = o.LineStyle[t[1]]), n = t[2], new o.LineBorder(n, i)) : void 0 }

            function Pe(e, t) { return t ? (m || (m = document.createElement("span")), $(m).css("font", e), $(m).css("fontFamily", t), $(m).css("font")) : e }

            function Ne(e, t) {
                var i, r;
                $.extend(e, t);
                for (i in t) "backColor" !== i && "foreColor" !== i || !t[i] ? "hAlign" === i && t[i] && (e.textAlign = o.HorizontalPosition[t[i]]) : (r = n.ColorHelper.parse(t[i], n.wrapper.spread.getActiveSheet().currentTheme().colors()), e[i] = r.color);
                e.font && e.themeFont && (e.font = Pe(e.font, n.util.getThemeFont(e.themeFont))), e.borderBottom && (e.borderBottom = ze(e.borderBottom)), e.borderLeft && (e.borderLeft = ze(e.borderLeft)), e.borderRight && (e.borderRight = ze(e.borderRight)), e.borderTop && (e.borderTop = ze(e.borderTop)), e.textDecoration && (e.textDecoration = n.util.toCSSTextDecoration(e.textDecoration))
            }

            function ze(e) {
                var t, i, r, a, s, l;
                if ("string" == typeof e) return e;
                if (t = [], i = ["dotted", "solid", "double", "dashed"], r = "", e.style) {
                    for (a in o.LineStyle)
                        if (e.style === o.LineStyle[a]) switch (e.style) {
                            case 0:
                                r = "empty";
                                break;
                            case 1:
                                r = "thin";
                                break;
                            case 2:
                                r = "medium";
                                break;
                            case 3:
                                r = "dashed";
                                break;
                            case 4:
                                r = "dotted";
                                break;
                            case 5:
                                r = "thick";
                                break;
                            case 6:
                                r = "double";
                                break;
                            case 7:
                                r = "hair";
                                break;
                            case 8:
                                r = "mediumDashed";
                                break;
                            case 9:
                                r = "dashDot";
                                break;
                            case 10:
                                r = "mediumDashDot";
                                break;
                            case 11:
                                r = "dashDotDot";
                                break;
                            case 12:
                                r = "mediumDashDotDot"
                        }
                    for (r = r.toLowerCase(), t[0] = Me(e.style) + "px", a = 0; a < i.length; a++) - 1 !== r.indexOf(i[a]) && (t[1] = i[a]);
                    t[1] || (-1 !== r.indexOf("dot") ? t[1] = "dotted" : -1 !== r.indexOf("dash") ? t[1] = "dashed" : t[1] = "solid")
                }
                for (e.color ? (s = n.ColorHelper.parse(e.color, n.wrapper.spread.getActiveSheet().currentTheme().colors()), t[2] = s.color) : (s = n.ColorHelper.parse("Text 1", n.wrapper.spread.getActiveSheet().currentTheme().colors()), t[2] = s.color), l = "", "thin" === t[0] && "double" === t[1] && (t[0] = c), a = 0; a < t.length; a++) t[a] && (l = l + t[a] + " ");
                return l = l.substring(0, l.lastIndexOf(" "))
            }

            function Me(e) {
                switch (e) {
                    case 9:
                    case 1:
                    case 3:
                    case 4:
                    case 7:
                    case 11:
                        return 1;
                    case 2:
                    case 10:
                    case 12:
                    case 8:
                    case 13:
                        return 2;
                    case 5:
                    case 6:
                        return 3
                }
                return 0
            }

            function Ve(e, t, i, o) {
                var r, a, s, l, c, d;
                if (i) { if (!Ge(e)) { $(".cell-style-custom-li").removeClass("hidden"), $(".custom-cell-styles-preview").parent().removeClass("hidden"); for (r in e) l = e[r].name, a = $("<span></span>").attr({ title: l, "data-name": l }).addClass("cell-style-outer-span"), s = $("<div></div>").text(l).addClass("custom-cell-style-symbol").appendTo(a), a.appendTo(t), c = {}, Ne(c, e[r]), je(c, s), qe(l, n.wrapper.spread) } } else
                    for (r in e) d = r.toLowerCase(), a = $("<span></span>").attr({ title: r, "data-name": r }).addClass("cell-style-outer-span"), s = $("<div></div>").text(e[r]).addClass("cell-style-symbol").appendTo(a), a.appendTo(t), o && je(o[d], s)
            }

            function Ge(e) { return !e || "object" == typeof e && 0 === Object.keys(e).length }

            function je(e, t) {
                if (e) {
                    var i;
                    e.backColor && (i = n.ColorHelper.parse(e.backColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()), t.css("background-color", i.color)), e.border && t.css("border", e.border), e.foreColor && (i = n.ColorHelper.parse(e.foreColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()), t.css("color", i.color)), e.font && (e.themeFont && (e.font = Pe(e.font, n.util.getThemeFont(e.themeFont))), t.css("font", e.font)), e.borderLeft && t.css("border-left", ze(e.borderLeft)), e.borderRight && t.css("border-right", ze(e.borderRight)), e.borderBottom && t.css("border-bottom", ze(e.borderBottom)), e.borderTop && t.css("border-top", ze(e.borderTop)), e.textAlign && t.css("text-align", e.textAlign), e.textDecoration && (isNaN(e.textDecoration) ? t.css("text-decoration", e.textDecoration) : t.css("text-decoration", n.util.toCSSTextDecoration(e.textDecoration)))
                }
            }
            x = function(e, t) {
                var i = n.wrapper.spread,
                    o = i.getActiveSheet();
                switch (t.item[0].id) {
                    case "cellstyle-modify":
                        b || (b = new n.FormatDialog), $("#cell-styles-popup").gcuipopup("hide"), qe(y, n.wrapper.spread), v = i.getNamedStyle(y), b.open("numbers", void 0, v, !0), b.setFormatDirectly(!1), $(b).on("okClicked", function(e, t) {
                            var r, a, s;
                            for (n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(y) ? $.extend(n.CellStyleDialog.existedCustomCellStyle[y], t) : n.CellStyleDialog.buildInCellStyle.hasOwnProperty(y) && $.extend(n.CellStyleDialog.buildInCellStyle[y], t), r = i.sheets, a = 0; a < r.length; a++) r[a].getNamedStyle(y) && $.extend(r[a].getNamedStyle(y), t);
                            i.getNamedStyle(y) && $.extend(i.getNamedStyle(y), t), o.repaint(), s = {}, Ne(s, t), je(s, $(w).children()), n.actions.isFileModified = !0
                        });
                        break;
                    case "cellstyle-delete":
                        $(w).remove(), n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(y) ? (delete n.CellStyleDialog.existedCustomCellStyle[y], Ge(n.CellStyleDialog.existedCustomCellStyle) && ($(".cell-style-custom-li").addClass("hidden"), $(".custom-cell-styles-preview").parent().addClass("hidden"))) : n.CellStyleDialog.buildInCellStyle.hasOwnProperty(y) && delete n.CellStyleDialog.buildInCellStyle[y], o.getNamedStyle(y) && o.removeNamedStyle(y), i.getNamedStyle(y) && i.removeNamedStyle(y), n.actions.isFileModified = !0
                }
            };

            function He(e) {
                var t = e.srcElement || e.target,
                    i = t.parentElement,
                    o = i;
                $(o).addClass("ui-state-hover")
            }

            function We(e) {
                var t = e.srcElement || e.target,
                    i = t.parentElement,
                    o = i;
                $(o).removeClass("ui-state-hover")
            }

            function Ue(e) {
                var t, i = e.srcElement || e.target,
                    o = i.parentElement;
                t = o.title ? o.title : o.innerText, n.actions.doAction("baseDialogCommand", n.wrapper.spread, { value: { styleName: t }, execute: n.spreadActions.dialogAction.addAndSetStyleByName }), $("#cell-styles-popup").gcuipopup("hide")
            }

            function qe(e, t) {
                var i = e.toLowerCase();
                t.getNamedStyle(e) || (n.CellStyleDialog.buildInCellStyle.hasOwnProperty(i) ? n.actions.doAction("addNamedStyle", t, n.CellStyleDialog.buildInCellStyle[i]) : n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(i) && n.actions.doAction("addNamedStyle", t, n.CellStyleDialog.existedCustomCellStyle[i]))
            }

            function _e(e) {
                var t = e.srcElement || e.target;
                w = t.parentElement, y = $(w).attr("data-name").toLowerCase(), $("#cellstyle-menu-container").css({ position: "absolute", top: e.offsetY, left: e.offsetX }), $(".cellstyle-menu").removeClass("hidden"), $(".cellstyle-menu").position({ my: "left top", of: e }), n.util.cancelDefault(e)
            }
            e.cellStyleDialog;

            function Ke() {
                $(".new-cell-style-text").unbind(), $(".cell-style-symbol").unbind(), $(".cellstyle-menu").menu({ select: x }), $(".cell-style-symbol").bind("mouseenter", He), $(".cell-style-symbol").bind("mouseout", We), $(".cell-style-symbol").bind("click", Ue), $(".cell-style-symbol").bind("contextmenu", _e), $(".new-cell-style-text, .new-cell-style-button").bind("mouseout", function() { $(".new-cell-style-text").removeClass("ui-state-hover") }), $(".new-cell-style-text, .new-cell-style-button").bind("mouseenter", function() { $(".new-cell-style-text").addClass("ui-state-hover") }),
                    $(".new-cell-style-button").bind("click", function() { $("#cell-styles-popup").gcuipopup("hide"), void 0 === e.cellStyleDialog && (e.cellStyleDialog = new n.CellStyleDialog), e.cellStyleDialog.open() }), $(document).bind("mouseup", function(e) { 2 === e.button || $(".cellstyle-menu").hasClass("hidden") || $(".cellstyle-menu").addClass("hidden") })
            }

            function Xe() { $(".custom-cell-style-symbol").unbind(), $(".custom-cell-style-symbol").bind("mouseenter", He), $(".custom-cell-style-symbol").bind("mouseout", We), $(".custom-cell-style-symbol").bind("click", Ue), $(".custom-cell-style-symbol").bind("contextmenu", _e) }

            function Je() {
                var e, t = 21,
                    i = 28,
                    r = 11,
                    a = 7;
                Ze("custom-preview", "custom", a), Ze("light-preview", "light", t), Ze("medium-preview", "medium", i), Ze("dark-preview", "dark", r), $(".table-format-preview, .table-format-preview-button").mouseenter(function(e) {
                    var t = e.srcElement || e.target,
                        i = $(t).closest("button").find("span.container-span");
                    i.children().hasClass("hiddenCustomStyle") || i.addClass("ui-state-hover")
                }), $(".table-format-preview, .table-format-preview-button").mouseout(function(e) {
                    var t = e.srcElement || e.target;
                    $(t).closest("button").find("span.container-span").removeClass("ui-state-hover")
                }), $(".table-format-preview-button").mouseup(function(e) {
                    var t, i, r, a, s = n.wrapper.spread,
                        l = e.srcElement || e.target,
                        c = $(l).closest("button").find("span span")[0],
                        d = c.className,
                        p = "",
                        u = d.split(" ");
                    for (t = 0; t < u.length; t++)
                        if (-1 === u[t].indexOf("table-format")) { p = u[t]; break } if (-1 === p.indexOf("custom")) n.actions.doAction("formatAsTable", s, o.Tables.TableThemes[p]), xe();
                    else { i = n.FormatTableDialog.customTableStyle; for (r in i)(a = r.substring(0, r.indexOf("-"))) === p && (n.actions.doAction("formatAsTable", s, i[r]), xe()) } $("#format-table-popup").gcuipopup("hide")
                }), $(".new-table-style").click(function() { $("#format-table-popup").gcuipopup("hide"), void 0 === e ? e = new n.FormatTableDialog : e.refresh(), e.open() }).mouseenter(function() { $(this).css("background", "#DBDBDB") }).mouseleave(function() { $(this).css("background", "white") })
            }

            function Ye() { var e, t, i, o = 1; for (e in n.FormatTableDialog.customTableStyle) e ? (t = e.substring(0, e.indexOf("-")), $(".custom-format-table").css("display", "block"), i = "table-format-" + t, $("." + i).css("display", "inline-block").removeClass("hiddenCustomStyle"), Qe(e, o), o++) : $(".custom-format-table").css("display", "none") }

            function Qe(e, t) {
                var i = "custom",
                    o = "table-format-",
                    n = o + i + t,
                    r = e.substring(e.indexOf("-") + 1);
                $("." + n).attr("title", r)
            }

            function Ze(e, t, i) {
                var o, n, r, a, s = "table-format-",
                    l = "table-format-preview";
                for (n = 1; n <= i; n++) r = s + t + n, o = "custom" === t ? $("<span></span>").addClass(r + " " + l + " " + t + n).addClass("hiddenCustomStyle") : $("<span></span>").attr("title", t + n).addClass(r + " " + l + " " + t + n), a = $("<span></span>").append(o).addClass(r + "-container container-span"), $("<button></button>").append(a).addClass(r + "-button " + l + "-button").appendTo($("." + e))
            }

            function et() { ge(), me(), ve(), ye(), we(), xe(), Ce(), Se(), ti(), Ee(), Te(), P = !1 } e.updateRibbonBarStyle = et;

            function tt(e) {
                var t = e.sheet.getValue(e.row, e.col),
                    i = e.validator,
                    o = i.errorTitle(),
                    r = i.errorMessage();
                o || (o = n.res.title), i.showErrorMessage() ? (e.validationResult = 0, 0 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage1), n.MessageBox.show(r, o, 3, 1, function(i, o) {
                    switch (o) {
                        case 1:
                            e.sheet.setActiveCell(e.row, e.col), e.sheet.setValue(e.row, e.col, t), e.sheet.startEdit(!0);
                            break;
                        case 4:
                            e.sheet.setValue(e.row, e.col, t)
                    }
                })), 1 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage2), n.MessageBox.show(r, o, 2, 2, function(i, o) {
                    switch (o) {
                        case 2:
                            break;
                        case 3:
                            e.sheet.setActiveCell(e.row, e.col), e.sheet.setValue(e.row, e.col, t), e.sheet.startEdit(!0);
                            break;
                        case 4:
                            e.sheet.setValue(e.row, e.col, t)
                    }
                })), 2 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage1), n.MessageBox.show(r, o, 1, 1, function(i, o) {
                    switch (o) {
                        case 1:
                            break;
                        case 4:
                            e.sheet.setValue(e.row, e.col, t)
                    }
                }))) : e.validationResult = 0
            }
            e.validationError = tt, e.eventAttached = !1;

            function it(t) {
                var i, r, a, s, l;

                function c(e, t) { i = !0, setTimeout(function() { i && (i = !1, me(), ve(), we(), oe(), xe(), te(), Se(), ti(), fi(), d()) }, 100) }

                function d() {
                    var e = $(".slider-panel");
                    $(".slider-panel-panel2", e).is(":visible") && e.sliderpanel("close", "panel2")
                }

                function p(e, t) { r = !0, setTimeout(function() { r && (r = !1, ye()) }, 100) }

                function u(e) {
                    var t = n.wrapper.spread.getActiveSheet(),
                        i = g.getActiveShapes(t);
                    0 !== i.length && j.refreshSliderPanel(i), ue(i)
                }

                function h(e) { Zt() }!t && e.eventAttached || (a = n.wrapper.spread, s = a.getHost(), l = n.wrapper.spreadElement, a.bind(o.Events.EnterCell, c), l.bind(o.Events.EnterCell, c), a.bind(o.Events.SelectionChanged, p), l.bind(o.Events.SelectionChanged, p), ge(), a.bind(o.Events.ActiveSheetChanged, function(e, t) { Ce(), ke() }), a.bind(o.Events.EditorStatusChanged, function(e, t) {
                    var i = $(".statusBar").find(".statusbar-edit-status");
                    switch (t.newStatus) {
                        case 2:
                            i.text(n.res.statusBar.edit);
                            break;
                        case 1:
                            i.text(n.res.statusBar.enter);
                            break;
                        case 0:
                            i.text(n.res.statusBar.ready)
                    }
                }), a.bind(o.Events.UserZooming, function(e, t) { ke() }), a.bind(o.Events.ValidationError, function(e, t) { tt(t) }), a.bind(GC.Spread.Sheets.Events.SlicerChanged, function(e, t) { ri(t.sheet, t.slicer, t.propertyName) }), a.bind(GC.Spread.Sheets.Events.FloatingObjectChanged, function(e, t) {
                    var i = t.floatingObject;
                    i && i instanceof o.Charts.Chart && ai(t.sheet, i, t.propertyName)
                }), s.addEventListener("click", u), s.addEventListener("dblclick", h), a.bind(GC.Spread.Sheets.Events.FloatingObjectRemoved, function(e, t) { d() }), a.bind(GC.Spread.Sheets.Events.ShapeRemoved, function(e, t) { oe(), d() }), a.bind(GC.Spread.Sheets.Events.ChartClicked, Yt), e.eventAttached || ($(n).bind("updateRibbon", function(e, t) { me() }), $(".designer-table-name").blur(function() { n.actions.doAction("setTableName", n.wrapper.spread, $(this).val()) })), e.eventAttached = !0, n.util.bindDesignerEvent("chartChanged", function(e, t) { G.refreshSliderPanel(t) }), n.util.bindDesignerEvent("shapeChanged", function() {
                    var e = n.wrapper.spread.getActiveSheet(),
                        t = g.getActiveShapes(e);
                    j.refreshSliderPanel(t)
                }))
            }
            e.attachEvent = it, C = !1, k = { row: 0, col: 0 };

            function ot() {
                var e = o.Events.SelectionChanged + ".bindingPath",
                    t = "click.indicator",
                    i = "click.ok",
                    r = "click.cancel",
                    a = o.Events.TopRowChanged + ".bindingPath",
                    s = "click.autoGenetateColumns",
                    l = "click.dataFieldType",
                    c = n.wrapper.spread,
                    d = $(".designer-data-binding-icon"),
                    p = $(".ok-table-binding-button"),
                    u = $(".cancel-table-binding-button"),
                    h = n.wrapper.spread.getActiveSheet(),
                    f = $(".auto-generate-columns"),
                    g = $(".data-binding-celltype-button");
                nt(), g.bind(l, function(e, t) {
                    var i, o, r, a, s, l, c;
                    $(".data-binding-celltype-option").gcuipopup("hide"), o = $.fn.zTree.getZTreeObj("ztree-container"), o && (r = o.getSelectedNodes()) && r.length >= 0 && (i = r[0]), i && (a = $(this).data("datafieldtype"), s = $("#" + i.tId + "_a"), a && s.length > 0 && (s.find("." + L).remove(), i.dataFieldType = a, l = a + "-icon", c = "<span class='button " + L + " " + l + "' title='" + n.res.ribbon.data[a] + "'></span>", s.prepend(c), a !== n.util.DataFieldType.table && a !== n.util.DataFieldType.combox || ht("ztree-container", i.children)))
                }), c.bind(e, function(e, t) { rt() }), d.bind(t, function(e) {
                    var t, i, o, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w, x, C, k = n.wrapper.spread.getActiveSheet();
                    if (k && (t = k.tables.find(k.getActiveRowIndex(), k.getActiveColumnIndex()))) {
                        for (S = t, i = $("#data-binding-setting-popup"), i.gcuipopup({ autoHide: !0, showing: function(e, t) { $(".data-binding-path-overlay").removeAttr("hidden"), i.removeAttr("hidden") }, hiding: function(e, t) { $(".data-binding-path-overlay").attr("hidden", "hidden"), i.attr("hidden", "hidden") } }), i.gcuipopup("show"), i.offset({ top: $(this).offset().top + 8, left: $(this).offset().left + 8 }), o = t.autoGenerateColumns(), $(".auto-generate-columns").prop("checked", o), r = $(".table-binding-path-input"), r.length > 0 && (a = t.bindingPath(), a || (a = null), r.val(a)), s = $(".table-column-data-field"), s.empty(), l = $(document.createDocumentFragment()), c = 0, d = $.fn.zTree.getZTreeObj("ztree-container"), p = r.val().split("."), u = d.getNodeByParam("name", p[p.length - 1]), u && u.children && u.dataFieldType === n.util.DataFieldType.table && (c = u.children.length), h = $("<select>").addClass("data-field-select"), f = 0; f <= c; f++) u && u.children && (g = u.children[f]) && g.name && $("<option>").val(g.name).text(g.name).appendTo(h), f === c && $("<option>").val("(empty)").text("(empty)").appendTo(h);
                        if (m = t.range()) {
                            for (b = m.colCount, v = 0; v < b; v++) y = t.getColumnDataField(v), w = $("<div>").addClass("data-field-container").appendTo(l), $("<label>").addClass("data-field-block1").text("Column" + v + ": ").appendTo(w), x = h.clone(), o && x.attr("disabled", "disabled"), C = x.find("option[value=" + y + "]"), 0 !== C.length ? C.attr("selected", "selected") : x.find("option[value='(empty)']").attr("selected", "selected"), x.appendTo(w);
                            l.appendTo(s)
                        }
                    }
                }), p.bind(i, function(e) {
                    var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b;
                    if ($("#data-binding-setting-popup").gcuipopup("hide"), t = $(".data-field-select"), !((i = t.length) <= 0) && (r = S) && (a = n.wrapper.spread.getActiveSheet())) {
                        for (s = [], l = 0; l < i; l++) c = new o.Tables.TableColumn(l), d = $(t[l]).val(), d && "(empty)" !== d || (d = null), c.dataField(d), c.name(d), s.push(c);
                        if (r.bindColumns(s), p = $(".auto-generate-columns").prop("checked")) {
                            if (u = r.endRow() - r.startRow() + 1, h = r.endColumn() - r.startColumn() + 1, !(f = $.fn.zTree.getZTreeObj("ztree-container"))) return;
                            g = $(".table-binding-path-input"), m = _t(g.val()), b = m.length, b !== h && n.MessageBox.show(n.res.ribbon.data.warningTable, n.res.title, 2, 1, function(e, t) { if (1 === t) { for (r.autoGenerateColumns(p), s = [], l = 0; l < b; l++) c = new o.Tables.TableColumn(l), c.dataField(m[l]), c.name(m[l]), s.push(c); return a.tables.resize(r, new o.Range(r.startRow(), r.startColumn(), u, b)), r.bindColumns(s), rt(), void a.repaint() } })
                        }
                        r.autoGenerateColumns(p), a.repaint()
                    }
                }), u.bind(r, function(e) { $("#data-binding-setting-popup").gcuipopup("hide") }), h.bind(a, function(e, t) { rt() }), f.bind(s, function(e, t) {
                    var i, o = $(".data-field-select");
                    o.length <= 0 || (i = $(this).prop("checked"), i ? o.attr("disabled", "disabled") : o.removeAttr("disabled"))
                })
            }

            function nt() {
                var e = o.Events.SelectionChanged + ".bindingPath",
                    t = "click.indicator",
                    i = "click.ok",
                    r = "click.cancel",
                    a = o.Events.TopRowChanged + ".bindingPath",
                    s = "click.autoGenetateColumns",
                    l = "click.dataFieldType",
                    c = n.wrapper.spread,
                    d = $(".designer-data-binding-icon"),
                    p = $(".ok-table-binding-button"),
                    u = $(".cancel-table-binding-button"),
                    h = n.wrapper.spread.getActiveSheet(),
                    f = $(".auto-generate-columns"),
                    g = $(".data-binding-celltype-button");
                c.unbind(e), d.unbind(t), p.unbind(i), u.unbind(r), h.unbind(a), f.unbind(s), g.unbind(l)
            }

            function rt() {
                var e, t, i, r, a, s, l, c, d, p, u, h = n.wrapper.spread.getActiveSheet();
                if (h) {
                    if (e = $("#data-binding-setting-indicator"), t = h.getActiveRowIndex(), i = h.getActiveColumnIndex(), (r = h.tables.find(t, i)) && null !== (a = r.bindingPath()) && void 0 !== a && "" !== a) {
                        if (s = r.range(), l = Ht(s), c = Ht(new o.Range(t, i, 1, 1)), 0 === l.length && e.attr("hidden", "hidden"), 0 === c.length) return;
                        for (d = c[0], p = 0; p < l.length; p++)
                            if (u = l[p], u.x <= d.x && d.x + d.width <= u.x + u.width && u.y <= d.y && d.y + d.height <= u.y + u.height) return void e.css({ left: u.x + u.width - e.width(), top: u.y }).removeAttr("hidden")
                    }
                    e.attr("hidden", "hidden")
                }
            }

            function at() {
                var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread.getActiveSheet();
                if (d)
                    for (e = d.getSelections(), t = d.getRowCount(), i = d.getColumnCount(), o = 0; o < e.length; o++)
                        if (r = e[o], a = r.row, s = r.col, -1 === r.col && -1 === r.row)
                            for (l = 0; l < t; l++)
                                for (c = 0; c < i; c++) st(l, c);
                        else if (-1 === r.row)
                    for (l = 0; l < t; l++)
                        for (c = s; c < s + r.colCount; c++) st(l, c);
                else if (-1 === r.col)
                    for (l = a; l < a + r.rowCount; l++)
                        for (c = 0; c < i; c++) st(l, c);
                else
                    for (l = a; l < a + r.rowCount; l++)
                        for (c = s; c < s + r.colCount; c++) st(l, c)
            }

            function st(e, t) {
                var i, o = n.wrapper.spread.getActiveSheet();
                o && (i = o.tables.find(e, t), i && i.bindingPath() && i.bindingPath(null), o.getBindingPath(e, t) && o.setBindingPath(e, t, null))
            }

            function lt() {
                var e = { title: n.res.ribbon.data.loadSchema, nameFilters: [n.res.ribbon.data.loadDataSourceFilter.json, n.res.ribbon.data.loadDataSourceFilter.txt] },
                    t = function(e) { "cancelled" !== e.status && pt(e) };
                app.showOpenDialog(e, t)
            }

            function ct(e) { $.isArray(e) ? $.each(e, function(e, t) { ct(t) }) : e.children && $.isArray(e.children) && $.each(e.children, function(e, t) { ct(t) }), e.isArray && (e.type = "array") }

            function dt() {
                var e = { title: n.res.ribbon.data.saveSchema, nameFilters: [n.res.ribbon.data.saveDataSourceFilter.json] },
                    t = function(e) { var t, i, o; "cancelled" !== e.status && (t = $.fn.zTree.getZTreeObj("ztree-container"), i = t.getNodesByParam("level", 0)[0], o = [], i.children && Gt(i.children, o), app.save(e.fileName, JSON.stringify(n.util.saveJSONSchema(o)), function(e) { "failed" === e.status && n.MessageBox.show(e.message, n.res.title, 3) }, !1)) };
                app.showSaveDialog(e, t)
            }

            function pt(e) {
                var t, i, r;
                if ("failed" === e.status) n.MessageBox.show(e.message, n.res.title, 3);
                else try { t = JSON.parse(e.data), 0 === $("#" + R).length && Jt(), i = [], t.$schema ? i = n.util.parseJsonSchema(t) : $.isArray(t) ? ut(t) ? (t.splice(t.length - 1), ct(t), i = t) : jt(t[0], i) : (jt(t, i), a = new o.Bindings.CellBindingSource(t)), r = { name: "Source" }, i.length > 0 && (r.children = i), yt(R, [r], !0), ht(R) } catch (e) { n.MessageBox.show(n.res.ribbon.data.loadDataError, n.res.title, 3) }
            }

            function ut(e) { var t, i = e.length; return 0 !== i && (t = e[i - 1], !(!t.designerNativeSchemaMark || 1 !== t.designerNativeSchemaMark)) }

            function ht(e, t) {
                var i = $.fn.zTree.getZTreeObj(e);
                i && (i.expandAll(!0), ft(t && t.length > 0 ? t : i.getNodes()))
            }

            function ft(e) { var t, i, o = e.length; for (t = 0; t < o; t++) i = e[t], gt(i), i && i.children && i.children.length > 0 && ft(i.children) }

            function gt(e) {
                var t, i, o, r;
                e && 0 !== e.level && (!(t = $("#" + e.tId + "_a")) || t.length <= 0 || (t.find("." + L).length > 0 && t.children("." + L).remove(), Bt(e) || Ot(e) || (e.dataFieldType ? i = e.dataFieldType : e.enum ? i = n.util.DataFieldType.combox : e.type && n.util.DefaultTypeDic[e.type] && (i = n.util.DefaultTypeDic[e.type]), i || (i = n.util.DataFieldType.text), o = i + "-icon", r = "<span class='button " + L + " " + o + "' title='" + n.res.ribbon.data[i] + "'></span>", t.prepend(r), e.dataFieldType = i)))
            }

            function mt(e) { return typeof e === n.util.BasicDataType.Object ? null === e ? n.util.BasicDataType.Null : e.constructor === [].constructor ? n.util.BasicDataType.Array : n.util.BasicDataType.Object : typeof e } T = o.CellTypes.Text.prototype.getText, A = o.CellTypes.CheckBox.prototype.getText, E = o.CellTypes.Button.prototype.getText, I = o.CellTypes.HyperLink.prototype.getText, D = o.CellTypes.ComboBox.prototype.getText;

            function bt() { o.CellTypes.Text.prototype.getText = function(e, t) { var i = t.sheet.getBindingPath(t.row, t.col); return i ? "[" + i + "]" : T.apply(this, arguments) }, o.CellTypes.CheckBox.prototype.getText = function(e, t) { var i = t.sheet.getBindingPath(t.row, t.col); return i ? "[" + i + "]" : A.apply(this, arguments) }, o.CellTypes.Button.prototype.getText = function(e, t) { var i = t.sheet.getBindingPath(t.row, t.col); return i ? "[" + i + "]" : E.apply(this, arguments) }, o.CellTypes.HyperLink.prototype.getText = function(e, t) { var i = t.sheet.getBindingPath(t.row, t.col); return i ? "[" + i + "]" : I.apply(this, arguments) }, o.CellTypes.ComboBox.prototype.getText = function(e, t) { var i = t.sheet.getBindingPath(t.row, t.col); return i ? "[" + i + "]" : D.apply(this, arguments) } }

            function vt() { o.CellTypes.Text.prototype.getText = T, o.CellTypes.CheckBox.prototype.getText = A, o.CellTypes.Button.prototype.getText = E, o.CellTypes.HyperLink.prototype.getText = I, o.CellTypes.ComboBox.prototype.getText = D }

            function yt(e, t, i) {
                if (null !== $.fn.zTree.getZTreeObj(e)) {
                    if (!i) return;
                    $.fn.zTree.destroy(e)
                }
                var o = { view: { showIcon: !1, addHoverDom: function(e, t) { St(e, t) }, removeHoverDom: Tt, selectedMulti: !1 }, edit: { enable: !0, editNameSelectAll: !0, showRemoveBtn: xt, showRenameBtn: Ct, removeTitle: n.res.ribbon.data.remove, renameTitle: n.res.ribbon.data.rename }, callback: { onDblClick: function(e, t, i) { At(e, i) }, beforeDrop: function(e, t, i, o) { return Mt(e, t, i, o) }, onDrop: function(e, t, i, o, n) { Vt(e, t, i, o, n) }, onMouseDown: function(e, t, i) { Et(e, i) }, beforeRemove: function(e, t) { return wt(e, t) } } };
                $("#" + e).empty(), $.fn.zTree.init($("#" + e), o, t), ht(e)
            }

            function wt(e, t) {
                return !(t && t.children && t.children.length > 0) || (n.MessageBox.show(n.res.ribbon.data.removeNodeWarning, n.res.title, 2, 1, function(e, i) {
                    var o = $.fn.zTree.getZTreeObj("ztree-container");
                    1 === i && o.removeNode(t, !1)
                }), !1)
            }

            function xt(e, t) { return 0 !== t.level }

            function Ct(e, t) { return 0 !== t.level }

            function St(e, t) {
                var i, o, r, a, s, l = $("#" + t.tId + "_span");
                t.editNameFlag || $("#addBtn_" + t.tId).length > 0 || (i = "<span class='button add' id='addBtn_" + t.tId + "' title='" + n.res.ribbon.data.addNode + "'></span>", l.after(i), o = $("#addBtn_" + t.tId), o && o.bind("click", function() {
                    var i = $.fn.zTree.getZTreeObj(e),
                        o = i.addNodes(t, [{ name: kt(i, t) }]);
                    return i.cancelEditName(), i.editName(o[0]), gt(o[0]), !1
                }), $("#arrayBtn_" + t.tId).length <= 0 && 0 !== t.level && (r = "<span class='button options' id='arrayBtn_" + t.tId + "' title='" + n.res.ribbon.data.selectOptions + "' onfocus='this.blur();'></span>", a = $("#" + t.tId + "_a"), a.append(r), (s = $("#arrayBtn_" + t.tId)) && s.bind("click", function(i) { var o, n, r = $.fn.zTree.getZTreeObj(e); return r.selectNode(t), o = $(".data-binding-celltype-button"), o.button(), n = $(".data-binding-celltype-option").gcuipopup({ autoHide: !0, position: { of: $(".button.options"), my: "center top", at: "center bottom" } }), n.gcuipopup("show"), !1 })), (Bt(t) || Ot(t)) && ($("#addBtn_" + t.tId).remove(), $("#arrayBtn_" + t.tId).remove()))
            }

            function kt(e, t) {
                var i, o = "field-",
                    n = t.children ? t.children.length : 0;
                if (0 === t.level) o += n;
                else {
                    for (i = [], i.push(n); !t || 0 !== t.level;) i.splice(0, 0, e.getNodeIndex(t)), t = t.getParentNode();
                    i.length > 0 && (o += i.join(""))
                }
                return o
            }

            function Tt(e, t) { $("#addBtn_" + t.tId).unbind().remove(), $("#arrayBtn_" + t.tId).unbind().remove() }

            function At(e, t) {
                var i, o, r = n.wrapper.spread.getActiveSheet();
                r && (i = r.getSelections(), i.length <= 0 || t && (o = i[0], Ft(t, o.row, o.col, function() { Lt(t, o.row, o.col) })))
            }

            function Et(e, t) { It() }

            function It() { C || ($(document).bind("mousemove.bindingPath", function(e) { Dt(e) }).bind("mouseup.bindingPath", function(e) { $t(e) }), C = !0) }

            function Dt(e) {
                var t, i, r, a, s, l, c, d, p, u, h = $.fn.zTree.getZTreeObj("ztree-container");
                h && (t = n.wrapper.spread.getActiveSheet(), i = Nt(e), isNaN(i.row) || isNaN(i.col) || (r = [], s = t.tables.find(i.row, i.col), l = h.getSelectedNodes()[0], s ? (c = s.range(), d = c.row, p = l.getParentNode(), a = p && zt(p) === s.bindingPath() && p.dataFieldType === n.util.DataFieldType.table ? new o.Range(d, i.col, c.rowCount, 1) : c, r = Ht(a)) : Bt(l) ? r = [] : Ot(l) && t.getCellType(i.row, i.col).constructor !== o.CellTypes.ComboBox ? r = [] : (u = t.getSelections()) && u.length > 0 && (a = u[0], a.contains(i.row, i.col, 1, 1) ? r = Ht(a) : (a = new o.Range(i.row, i.col, 1, 1), r = Ht(a))), Ut(r)))
            }

            function $t(e) {
                var t, i, o, n, r, a;
                $(document).unbind("mousemove.bindingPath"), $(document).unbind("mouseup.bindingPath"), t = $(".data-binding-decoration"), t.remove(), C = !1, i = Nt(e), o = i.row, n = i.col, isNaN(o) || isNaN(n) || (r = $.fn.zTree.getZTreeObj("ztree-container")) && (a = r.getSelectedNodes()[0], Ft(a, o, n, function() { Lt(a, o, n) }))
            }

            function Lt(e, t, i) {
                var r, a, s, l, c, d, p, u, h, f = n.wrapper.spread.getActiveSheet();
                if (f)
                    if (r = e.getParentNode(), a = f.tables.find(t, i), s = f.getCellType(t, i), l = f.getSelections()[0], e.dataFieldType && e.dataFieldType === n.util.DataFieldType.table) c = zt(e), d = _t(c), a ? Kt(a, c, d) : l.contains(t, i, 1, 1) ? Xt(l, c, d) : (p = new o.Range(t, i, 1, 1), Xt(p, c, d));
                    else if (a && r && zt(r) === a.bindingPath() && r.dataFieldType === n.util.DataFieldType.table) u = zt(e).split("."), Wt(i - a.range().col, u[u.length - 1], a);
                else if (s && s.constructor === o.CellTypes.ComboBox && r && r.dataFieldType === n.util.DataFieldType.combox) h = s.items(), -1 === h.indexOf(e.name) && (h.push(e.name), s.items(h));
                else {
                    if (Bt(e)) return void n.MessageBox.show(n.res.ribbon.data.unallowableTableBindingTip, n.res.title, 2, 0);
                    if (Ot(e)) return void n.MessageBox.show(n.res.ribbon.data.unallowComboxBindingTip, n.res.title, 2, 0);
                    l.contains(t, i, 1, 1) ? (k.row = l.row, k.col = l.col) : (k.row = t, k.col = i), Pt(e)
                }
            }

            function Ft(e, t, i, r) {
                var a, s, l, c, d, p, u, h, f, g;
                if (e && !isNaN(t) && !isNaN(i) && (a = $.fn.zTree.getZTreeObj("ztree-container"))) {
                    for (s = n.wrapper.spread.getActiveSheet(), l = a.getNodesByFilter(Rt, !1, e), c = 0, d = 0; d < l.length; d++) p = l[d].level - e.level, c = Math.max(c, p);
                    for (u = O ? i + c + 1 : i + c, h = t + l.length, f = !0, d = t; d <= h; d++)
                        for (g = i; g <= u; g++)
                            if (s.getCellType(d, g).constructor !== o.CellTypes.Text) { f = !1; break } f ? r() : n.MessageBox.show(n.res.ribbon.data.overwriteCellTypeWarning, n.res.title, 2, 1, function(e, t) { 1 === t && r() })
                }
            }

            function Rt(e, t) { return !!e && (!Bt(e) && !Ot(e) || !!t && ("prev" === t || "next" === t)) }

            function Bt(e) { var t = $.extend({}, e.getParentNode()); if (!t || $.isEmptyObject(t)) return !1; for (; t && t.dataFieldType !== n.util.DataFieldType.table && 0 !== t.level;) t = t.getParentNode(); return !t || 0 !== t.level }

            function Ot(e) { var t = $.extend({}, e.getParentNode()); if (!t || $.isEmptyObject(t)) return !1; for (; t && t.dataFieldType !== n.util.DataFieldType.combox && 0 !== t.level;) t = t.getParentNode(); return !t || 0 !== t.level }

            function Pt(e) {
                var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b = $.fn.zTree.getZTreeObj("ztree-container");
                if (b) {
                    if (t = b.getSelectedNodes()[0], i = 0, i = 0 === t.level ? e.level - t.level - 1 : e.level - t.level, r = n.wrapper.spread.getActiveSheet(), a = zt(e), e.dataFieldType === n.util.DataFieldType.table) return s = _t(zt(e)), l = new o.Range(k.row, k.col + i, 1, 1), void((c = Xt(l, a, s)) && (k.row += 2));
                    if (e.dataFieldType === n.util.DataFieldType.combox) return d = new o.CellTypes.ComboBox, p = e.enum ? e.enum : _t(zt(e)), p && p.length > 0 && d.items(p), O ? (r.setValue(k.row, k.col + i, e.name), r.getCell(k.row, k.col + i + 1).bindingPath(a), r.setCellType(k.row, k.col + i + 1, d)) : (r.getCell(k.row, k.col + i).bindingPath(a), r.setCellType(k.row, k.col + i, d)), void k.row++;
                    if ((u = e.children) && u.length > 0)
                        for (0 !== e.level && (r.setValue(k.row, k.col + i, e.name), k.row++), h = 0; h < u.length; h++) Pt(u[h]);
                    else {
                        switch (f = 0, g = 0, O ? (f = k.row, g = k.col + i + 1, r.setValue(f, g - 1, e.name), r.getCell(f, g).bindingPath(a)) : (f = k.row, g = k.col + i, r.getCell(f, g).bindingPath(a)), k.row++, e.dataFieldType) {
                            case n.util.DataFieldType.button:
                                m = new o.CellTypes.Button, m.text("Button");
                                break;
                            case n.util.DataFieldType.checkbox:
                                m = new o.CellTypes.CheckBox, m.caption("CheckBox");
                                break;
                            case n.util.DataFieldType.hyperlink:
                                m = new o.CellTypes.HyperLink, m.text("Hyperlink")
                        }
                        m && r.setCellType(f, g, m)
                    }
                }
            }

            function Nt(e) { var t, i = n.wrapper.spread.getActiveSheet(); if (i) return t = $(n.util.getCanvas(n.wrapper.spread)).offset(), i.hitTest(e.pageX - t.left, e.pageY - t.top) }

            function zt(e) { for (var t = [], i = e; 0 !== i.level;) t.splice(0, 0, i.name), i = i.getParentNode(); return t.join(".") }

            function Mt(e, t, i, o) { var r, a; return !(null === i || "inner" !== o && !i.parentTId) && (!!Rt(i, o) && (r = i.dataFieldType, a = n.util.DataFieldType, r !== a.table && r !== a.combox || !t[0].children || !(t[0].children.length > 0))) }

            function Vt(e, t, i, o, n) { ht(t) }

            function Gt(e, t) {
                var i, o, n;
                if (e)
                    for (i = e.length, o = 0; o < i; o++) n = {}, n.name = e[o].name, e[o].type && (n.type = e[o].type), e[o].dataFieldType && (n.dataFieldType = e[o].dataFieldType), e[o].enum && (n.enum = e[o].enum), e[o].children && e[o].children.length > 0 && (n.children = [], Gt(e[o].children, n.children)), t.push(n)
            }
            e.treeNodeToArray = Gt;

            function jt(e, t) {
                $.each(e, function(e, i) {
                    var o = {};
                    o.name = e, "array" === mt(i) && (o.type = "array"), "object" === mt(i) && (o.children = [], jt(i, o.children)), t.push(o)
                })
            }

            function Ht(e) {
                var t, i, r, a, s, l, c, d, p, u, h, f, g = n.wrapper.spread.getActiveSheet();
                if (g) {
                    for (t = $(n.util.getCanvas(n.wrapper.spread)).offset(), i = [], r = 0; r <= 2; r++)
                        for (a = 0; a <= 2; a++) s = g.getViewportLeftColumn(a), l = g.getViewportRightColumn(a), c = g.getViewportTopRow(r), d = g.getViewportBottomRow(r), p = new o.Range(c, s, d - c + 1, l - s + 1), (u = e.getIntersect(p, Math.max(p.rowCount, e.rowCount), Math.max(p.colCount, e.colCount))) && (h = new o.Rect, f = g.getRangeRect(r, a, u), h.x = f.x + t.left, h.y = f.y + t.top, h.width = f.width - 2, h.height = f.height - 2, i.push(h));
                    return i
                }
            }

            function Wt(e, t, i) {
                var o, r = n.wrapper.spread.getActiveSheet();
                i && t && r && (o = i.autoGenerateColumns(), o ? n.MessageBox.show(n.res.ribbon.data.warningDataField, n.res.title, 2, 1, function(o, n) { 4 !== n && (i.autoGenerateColumns(!1), i.setColumnName(e, t), i.setColumnDataField(e, t), r.repaint()) }) : (i.setColumnName(e, t), i.setColumnDataField(e, t), r.repaint()))
            }

            function Ut(e) {
                var t, i, o, n, r = $(".data-binding-decoration-container");
                if (r.empty(), e && !(e.length <= 0)) {
                    for (t = $(document.createDocumentFragment()), i = 0; i < e.length; i++) o = $("<div>").addClass("data-binding-decoration").appendTo(t), n = e[i], o.css({ width: n.width, height: n.height, display: "inline-block" }), o.offset({ left: n.x, top: n.y });
                    t.appendTo(r)
                }
            }

            function qt() {
                var e, t, i, o, r, a = n.wrapper.spread,
                    s = a.sheets,
                    l = s.length;
                for (e = 0; e < 1e5; e++)
                    for (t = "gcTable" + e, i = 0; i < l && (o = s[i], !(r = o.tables.findByName(t))); i++)
                        if (i === l - 1) return t
            }

            function _t(e) {
                var t, i, o, n, r, a = [];
                if (e && (t = $.fn.zTree.getZTreeObj("ztree-container"))) {
                    if (o = e.split("."), o.length > 0 && (i = o[o.length - 1]), (n = t.getNodeByParam("name", i)) && n.children)
                        for (r = 0; r < n.children.length; r++) a.push(n.children[r].name);
                    return a
                }
            }

            function Kt(e, t, i) {
                var r, a, s, l, c, d, p, u;
                if (e && (r = n.wrapper.spread.getActiveSheet())) {
                    if (e.bindingPath(t), e.autoGenerateColumns(!1), a = i ? i.length : 0, s = e.endColumn() - e.startColumn() + 1, l = Math.max(a, s), c = [], e.bindColumns(c), l > 0) {
                        for (d = 0; d < l; d++) p = null, u = new o.Tables.TableColumn(d), i && i[d] && (p = i[d], u.name(p)), u.dataField(p), c.push(u);
                        e.bindColumns(c)
                    }
                    rt(), r.repaint()
                }
            }

            function Xt(e, t, i) { var o, r, a, s, l, c, d, p; if (e) { o = n.wrapper.spread.getActiveSheet(), r = i ? i.length : 0, a = Math.max(2, e.rowCount), s = Math.max(r, e.colCount), l = -1 === e.row ? 0 : e.row, c = -1 === e.col ? 0 : e.col, d = null; try { O ? (p = t.split(".").pop(), o.setValue(l, c, p), d = o.tables.add(qt(), l, c + 1, a, s)) : d = o.tables.add(qt(), l, c, a, s), Kt(d, t, i), o.clearSelection(), o.setSelection(l, O ? c + 1 : c, a, s) } catch (e) { return void n.MessageBox.show(e.message, n.res.title, 3, 0) } return d } }

            function Jt() {
                var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread.getActiveSheet(),
                    p = $(".slider-panel");
                p.sliderpanel(), e = p.sliderpanel("getContainer", "panel1"), t = $(".design-mode-panel-header"), t.length <= 0 && (i = $("<div>").css({ height: "60px", background: "-webkit-gradient(linear, left top, left bottom, color-stop(15%,#E4E5E8), color-stop(85%, rgb(211, 211, 211)))", color: "rgba(0, 0, 0, 0.6)" }).addClass("design-mode-panel-header").appendTo(e), o = $("<div>").css({ padding: "10px 5px" }).appendTo(i), $("<label>").text(n.res.sliderPanel.title).css({ font: "Bold 12pt Calibri" }).appendTo(o)), r = $(".design-mode-panel-content"), r.length <= 0 && (a = $("<div>").css({ width: "100%", overflow: "auto", position: "absolute", top: "60px", bottom: "0" }).addClass("slider-panel-content design-mode-panel-content").appendTo(e), s = $("#" + F), s.length <= 0 && $("<div>").attr("id", F).addClass("ztree").appendTo(a)), l = { name: "Source" }, n.wrapper.spread.designerBindingPathSchema && !P ? (c = n.wrapper.spread.designerBindingPathSchema, c.$schema ? (l.children = n.util.parseJsonSchema(c), yt("ztree-container", [l], !0)) : $.isArray(c) && ut(c) && (c.splice(c.length - 1), ct(c), l.children = c, yt("ztree-container", l, !0)), P = !0) : yt("ztree-container", [l]), d.getDataSource() && d.setDataSource(null), ot()
            }

            function Yt(e, t) { N ? (N = !1, Qt(e, t)) : (N = !0, setTimeout(function() { N = !1 }, 500)) } e.chartClicked = Yt;

            function Qt(e, t) {
                var i, o, n, r, a, l, c = s.chartElementType,
                    d = t.options.category,
                    p = t.chart;
                0 === t.elementType ? (n = t.options.info && t.options.info.index, i = c[t.elementType] + " " + d[n], o = t.options.info && t.options.info.dataPointIndex) : 1 === t.elementType && (r = "x" === (t.options.info && t.options.info.axisType) ? "Category" : "Value", a = t.options.info && t.options.info.axisPosition, s.isBarGroup(p) && (r = "y" === (t.options.info && t.options.info.axisType) ? "Category" : "Value"), i = a + r), l = c[t.elementType], i = i || l, G.initChartSliderPanel(p, l, i, d, o)
            }
            e.chartDoubleClicked = Qt;

            function Zt() {
                var e = n.wrapper.spread.getActiveSheet(),
                    t = g.getActiveShapes(e);
                0 !== t.length && j.initShapeSliderPanel(t)
            }
            e.shapeClicked = Zt;

            function ei() {
                var e = n.wrapper.spread,
                    t = e.getActiveSheet(),
                    i = n.util.getSelectedSlicers(t)[0];
                ee(), ii(), i && oi(i)
            }
            e.insertTableSlicer = ei;

            function ti() { $("a[href='#slicerTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "slicerTab", !1) }

            function ii() {
                var e, t, i, o, n, r, a, s, l;
                $(".ribbon-bar").gcuiribbon("setTabPageVisible", "slicerTab", !0), $(".ribbon-bar").gcuitabs("select", "slicerTab"), e = $("#slicerTab>ul").find("li:eq(2)"), t = e.find("button:eq(0)").width() + 1, i = e.find("button:eq(1)").width() + 1, o = e.find("button:eq(1)").width() + 1, n = t > i ? t : i, n = n > o ? n : o, r = $("#slicerTab>ul").find("li:eq(3)"), a = r.find("button:eq(0)").width() + 1, s = r.find("button:eq(1)").width() + 1, l = a > s ? a : s, $("#slicerTab>ul").find("li:eq(2)").find("button").width(n), $("#slicerTab>ul").find("li:eq(3)").find("button").width(l), $("#slicerTab>ul").find("li:gt(1)").find("button").find("span:gt(0)").css("text-align", "start")
            }
            e.showSlicerTab = ii;

            function oi(e) {
                if (e) {
                    ee(), $(".slicer-ribbon-icon").attr("disabled", !0), $(".slicer-caption-name").val(e.captionName()), $("#slicer-shape-width").val(Math.round(e.width())), $("#slicer-shape-height").val(Math.round(e.height())), $("#slicer-column-count").val(e.columnCount()), $("#slicer-item-height").val(Math.round(e.itemHeight()));
                    var t = n.util.getSlicerItemWidth(e.columnCount(), e.width());
                    $("#slicer-item-width").val(t), ii(), li("caption-name", $(".slicer-caption-name")), li("shape-width", $("#slicer-shape-width")), li("shape-height", $("#slicer-shape-height")), li("column-count", $("#slicer-column-count")), li("item-height", $("#slicer-item-height")), li("item-width", $("#slicer-item-width"))
                }
            }

            function ni() { $(".slicer-caption-name").val(""), $("#slicer-shape-width").val(""), $("#slicer-shape-height").val(""), $("#slicer-column-count").val(""), $("#slicer-item-height").val(""), $("#slicer-item-width").val(""), ti(), si($(".slicer-caption-name")), si($("#slicer-shape-width")), si($("#slicer-shape-height")), si($("#slicer-column-count")), si($("#slicer-item-height")), si($("#slicer-item-width")), fi() } e.clearSlicerTab = ni;

            function ri(e, t, i) { t && ("isSelected" === i ? t.isSelected() ? !e.options.protectionOptions.allowEditObjects && e.options.isProtected && t.isLocked() || (oi(t), $("#clipboardgroup li:gt(0)").hide()) : ni() : di(t, i)) }

            function ai(e, t, i) { "isSelected" === i && pe(t) }

            function si(e) { e.unbind("input") }

            function li(e, t) {
                var i = n.wrapper.spread;
                t.bind("input", { spread: i }, function(i) {
                    var o, r, a = i.data && i.data.spread,
                        s = a.getActiveSheet();
                    n.util.isSlicerSelected(s) && (o = n.util.getSelectedSlicers(s), r = t.val(), ci(e, o, r))
                })
            }

            function ci(e, t, i) {
                var o, r, a, s, l, c, d, p, u;
                if (t && 0 !== t.length && ($.isNumeric(i) || "caption-name" === e)) switch (e) {
                    case "caption-name":
                        a = i, n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["captionName", a, t]);
                        break;
                    case "shape-width":
                        r = n.util.formatNumber(i), n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["width", r, t]), t.length > 0 && (o = t[t.length - 1], $("#slicer-item-width").val(n.util.getSlicerItemWidth(o.columnCount(), o.width())));
                        break;
                    case "shape-height":
                        s = n.util.formatNumber(i), n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["height", s, t]);
                        break;
                    case "column-count":
                        l = n.util.formatNumber(i), n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["columnCount", l, t]), t.length > 0 && (o = t[t.length - 1], $("#slicer-item-width").val(n.util.getSlicerItemWidth(o.columnCount(), o.width())));
                        break;
                    case "item-height":
                        c = n.util.formatNumber(i), n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["itemHeight", c, t]);
                        break;
                    case "item-width":
                        for (d = n.util.formatNumber(i), p = [], u = 0; u < t.length; u++) o = t[u], r = n.util.getSlicerWidthFromItem(o.columnCount(), d), p.push(r);
                        n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["width", p, t]), t.length > 0 && $("#slicer-shape-width").val(p[p.length - 1])
                }
            }

            function di(e, t) {
                if (e) switch (t) {
                    case "width":
                        $("#slicer-shape-width").val(e.width()), $("#slicer-item-width").val(n.util.getSlicerItemWidth(e.columnCount(), e.width()));
                        break;
                    case "height":
                        $("#slicer-shape-height").val(e.height());
                        break;
                    case "columnCount":
                        $("#slicer-column-count").val(e.columnCount());
                        break;
                    case "itemHeight":
                        $("#slicer-item-height").val(e.itemHeight());
                        break;
                    case "captionName":
                        $(".slicer-caption-name").val(e.captionName())
                }
            }

            function pi(e, t) {
                if (n.util.isSlicerSelected(e)) {
                    var i = null;
                    switch (t) {
                        case "light1":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light1();
                            break;
                        case "light2":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light2();
                            break;
                        case "light3":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light3();
                            break;
                        case "light4":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light4();
                            break;
                        case "light5":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light5();
                            break;
                        case "light6":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.light6();
                            break;
                        case "other1":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.other1();
                            break;
                        case "other2":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.other2();
                            break;
                        case "dark1":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark1();
                            break;
                        case "dark2":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark2();
                            break;
                        case "dark3":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark3();
                            break;
                        case "dark4":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark4();
                            break;
                        case "dark5":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark5();
                            break;
                        case "dark6":
                            i = GC.Spread.Sheets.Slicers.SlicerStyles.dark6()
                    }
                    return i
                }
            }

            function ui() {
                var e, t = 8,
                    i = 8,
                    o = 6;
                hi("slicer-custom-preview", "custom", t), hi("slicer-light-preview", "light", i),
                    hi("slicer-dark-preview", "dark", o), $(".slicer-format-preview, .slicer-format-preview-button").mouseenter(function(e) {
                        var t = e.srcElement || e.target;
                        $(t).closest("button").find("span.container-span").addClass("ui-state-hover")
                    }), $(".slicer-format-preview, .slicer-format-preview-button").mouseout(function(e) {
                        var t = e.srcElement || e.target;
                        $(t).closest("button").find("span.container-span").removeClass("ui-state-hover")
                    }), $(".slicer-format-preview-button").mouseup(function(e) {
                        var t, i, o, r, a, s, l, c = n.wrapper.spread,
                            d = e.srcElement || e.target,
                            p = $(d).closest("button").find("span span")[0],
                            u = p.className,
                            h = u.split(" "),
                            f = c.getActiveSheet();
                        for (i = 0; i < h.length; i++)
                            if (-1 === h[i].indexOf("slicer-format")) { t = h[i]; break } if (t && -1 === t.indexOf("custom")) o = pi(f, t);
                        else {
                            r = n.SlicerStyleDialog.customSlicerStyle;
                            for (a in r)
                                if ((s = a.substring(0, a.indexOf("-"))) === t) { o = n.SlicerStyleDialog.customSlicerStyle[a]; break }
                        }
                        l = { slicerStyle: o }, n.actions.doAction("setSlicerStyle", c, l), $("#format-slicer-popup").gcuipopup("hide")
                    }), $(".new-slicer-style").click(function() { $("#format-slicer-popup").gcuipopup("hide"), void 0 === e ? e = new n.SlicerStyleDialog : e.refresh(), e.open() }).mouseenter(function() { $(this).css("background", "#DBDBDB") }).mouseleave(function() { $(this).css("background", "white") })
            }

            function hi(e, t, i) {
                var o, n, r, a, s, l = "slicer-format-",
                    c = "slicer-format-preview";
                for (n = 1; n <= i; n++) r = l + t + n, "custom" === t ? o = $("<span></span>").addClass(r + " " + c + " " + t + n) : "light" === t && n > 6 ? (a = n - 6, r = l + B + a, o = $("<span></span>").attr("title", B + a).addClass(r + " " + c + " " + B + a)) : o = $("<span></span>").attr("title", t + n).addClass(r + " " + c + " " + t + n), s = $("<span></span>").append(o).addClass(r + "-container container-span"), $("<button></button>").append(s).addClass(r + "-button " + c + "-button").appendTo($("." + e))
            }

            function fi() {
                var e = n.wrapper.spread.getActiveSheet(),
                    t = e;
                t.isPasteFloatingObject() ? $("#clipboardgroup li:gt(0)").hide() : $("#clipboardgroup li:gt(0)").show()
            }

            function gi() {
                var e, t, i, o, r, a = n.res,
                    s = a.name || "en",
                    l = a.ribbon.fontFamilies,
                    c = s + "ff",
                    d = l[c + "1"];
                if (d) {
                    for (e = $("#font-family"), t = e.next("ul"), i = 1, o = c + i, r = []; l[o];) r.push('<li><input type="radio" id="font-family-{id}" name="font-family" /><label for="font-family-{id}" name="{id}" id="{id}" data-bind="text: res.ribbon.fontFamilies.{id}.text, attr: { title: res.ribbon.fontFamilies.{id}.text, \'data-font\': res.ribbon.fontFamilies.{id}.name }"></label></li>'.replace(/\{id\}/g, o)), i++, o = c + i;
                    t.children().first().before(r.join(""))
                }
            }
            e.addLocalFonts = gi;

            function mi() { ge(), me(), ve(), we(), xe(), pe(), ue(), Se(), ye() } e.updateRibbonAll = mi, n.loader.ready(function() { H(), n.wrapper.spread.notWorking || it() }), n.ribbon = e
        }(n.ribbon || {})
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = i(0),
            r = i(4),
            a = o.res.shapeType;
        ! function() {
            "use strict";
            var t = [
                [{ type: "straight", className: "noHeadStraight", name: a.straight, isConnectorType: !0 }, { type: "straight", className: "endArrowHeadStraight", isConnectorType: !0, name: a.straight, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { beginArrowhead: { beginArrowheadStyle: "open", beginArrowheadWidth: "medium", beginArrowheadLength: "medium" }, type: "straight", isConnectorType: !0, className: "beginEndArrowHeadStraight", name: a.straight, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { type: "elbow", className: "Elbow", isConnectorType: !0 }, { type: "elbow", name: a.elbow, className: "endArrowHeadElbow", isConnectorType: !0, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }, { beginArrowhead: { beginArrowheadStyle: "open", beginArrowheadWidth: "medium", beginArrowheadLength: "medium" }, type: "elbow", className: "beginEndArrowHeadElbow", isConnectorType: !0, name: a.elbow, endArrowhead: { endArrowheadStyle: "open", endArrowheadWidth: "medium", endArrowheadLength: "medium" } }],
                [{ type: "rectangle", name: a.rectangle }, { type: "roundedRectangle", name: a.roundedRectangle }, { type: "snip1Rectangle", name: a.snip1Rectangle }, { type: "snip2SameRectangle", name: a.snip2SameRectangle }, { type: "snip2DiagRectangle", name: a.snip2DiagRectangle }, { type: "snipRoundRectangle", name: a.snipRoundRectangle }],
                [{ type: "round1Rectangle", name: a.round1Rectangle }, { type: "round2SameRectangle", name: a.round2SameRectangle }, { type: "round2DiagRectangle", name: a.round2DiagRectangle }, { type: "oval", name: a.oval }, { type: "isoscelesTriangle", name: a.isoscelesTriangle }, { type: "rightTriangle", name: a.rightTriangle }],
                [{ type: "parallelogram", name: a.parallelogram }, { type: "trapezoid", name: a.trapezoid }, { type: "diamond", name: a.diamond }, { type: "regularPentagon", name: a.regularPentagon }, { type: "hexagon", name: a.hexagon }, { type: "heptagon", name: a.heptagon }],
                [{ type: "octagon", name: a.octagon }, { type: "decagon", name: a.decagon }, { type: "dodecagon", name: a.dodecagon }, { type: "pie", name: a.pie }, { type: "chord", name: a.chord }, { type: "tear", name: a.tear }],
                [{ type: "frame", name: a.frame }, { type: "halfFrame", name: a.halfFrame }, { type: "corner", name: a.corner }, { type: "diagonalStripe", name: a.diagonalStripe }, { type: "cross", name: a.cross }, { type: "plaque", name: a.plaque }],
                [{ type: "can", name: a.can }, { type: "cube", name: a.cube }, { type: "bevel", name: a.bevel }, { type: "donut", name: a.donut }, { type: "noSymbol", name: a.noSymbol }, { type: "blockArc", name: a.blockArc }],
                [{ type: "foldedCorner", name: a.foldedCorner }, { type: "smileyFace", name: a.smileyFace }, { type: "heart", name: a.heart }, { type: "lightningBolt", name: a.lightningBolt }, { type: "sun", name: a.sun }, { type: "moon", name: a.moon }],
                [{ type: "cloud", name: a.cloud }, { type: "arc", name: a.arc }, { type: "doubleBracket", name: a.doubleBracket }, { type: "doubleBrace", name: a.doubleBrace }, { type: "leftBracket", name: a.leftBracket }, { type: "rightBracket", name: a.rightBracket }],
                [{ type: "leftBrace", name: a.leftBrace }, { type: "rightBrace", name: a.rightBrace }, { type: "upDownArrowCallout", name: a.upDownArrowCallout }, { type: "actionButtonHome", name: a.actionButtonHome }, { type: "actionButtonHelp", name: a.actionButtonHelp }, { type: "actionButtonInformation", name: a.actionButtonInformation }],
                [{ type: "actionButtonBackorPrevious", name: a.actionButtonBackorPrevious }, { type: "actionButtonForwardorNext", name: a.actionButtonForwardorNext }, { type: "actionButtonBeginning", name: a.actionButtonBeginning }, { type: "actionButtonEnd", name: a.actionButtonEnd }, { type: "actionButtonReturn", name: a.actionButtonReturn }, { type: "actionButtonDocument", name: a.actionButtonDocument }],
                [{ type: "actionButtonSound", name: a.actionButtonSound }, { type: "actionButtonMovie", name: a.actionButtonMovie }, { type: "flowchartOfflineStorage", name: a.flowchartOfflineStorage }, { type: "leftRightRibbon", name: a.leftRightRibbon }, { type: "chartStar", name: a.chartStar }, { type: "chartPlus", name: a.chartPlus }],
                [{ type: "lineInverse", name: a.lineInverse }, { type: "leftCircularArrow", name: a.leftCircularArrow }, { type: "leftRightCircularArrow", name: a.leftRightCircularArrow }, { type: "swooshArrow", name: a.swooshArrow }, { type: "chartX", name: a.chartX }, { type: "gear6", name: a.gear6 }],
                [{ type: "gear9", name: a.gear9 }, { type: "funnel", name: a.funnel }, { type: "pieWedge", name: a.pieWedge }, { type: "nonIsoscelesTrapezoid", name: a.nonIsoscelesTrapezoid }, { type: "cornerTabs", name: a.cornerTabs }, { type: "squareTabs", name: a.squareTabs }],
                [{ type: "plaqueTabs", name: a.plaqueTabs }, { type: "rightArrow", name: a.rightArrow }, { type: "leftArrow", name: a.leftArrow }, { type: "upArrow", name: a.upArrow }, { type: "downArrow", name: a.downArrow }, { type: "leftRightArrow", name: a.leftRightArrow }],
                [{ type: "upDownArrow", name: a.upDownArrow }, { type: "quadArrow", name: a.quadArrow }, { type: "leftRightUpArrow", name: a.leftRightupArrow }, { type: "bentArrow", name: a.bentArrow }, { type: "uTurnArrow", name: a.uturnArrow }, { type: "leftUpArrow", name: a.leftupArrow }],
                [{ type: "bentUpArrow", name: a.bentupArrow }, { type: "curvedRightArrow", name: a.curvedRightArrow }, { type: "curvedLeftArrow", name: a.curvedLeftArrow }, { type: "curvedUpArrow", name: a.curvedUpArrow }, { type: "curvedDownArrow", name: a.curvedDownArrow }, { type: "stripedRightArrow", name: a.stripedRightArrow }],
                [{ type: "notchedRightArrow", name: a.notchedRightArrow }, { type: "pentagon", name: a.pentagon }, { type: "chevron", name: a.chevron }, { type: "rightArrowCallout", name: a.rightArrowCallout }, { type: "downArrowCallout", name: a.downArrowCallout }, { type: "leftArrowCallout", name: a.leftArrowCallout }],
                [{ type: "upArrowCallout", name: a.upArrowCallout }, { type: "leftRightArrowCallout", name: a.leftRightArrowCallout }, { type: "quadArrowCallout", name: a.quadArrowCallout }, { type: "circularArrow", name: a.circularArrow }, { type: "mathPlus", name: a.mathPlus }, { type: "mathMinus", name: a.mathMinus }],
                [{ type: "mathMultiply", name: a.mathMultiply }, { type: "mathDivide", name: a.mathDivide }, { type: "mathEqual", name: a.mathEqual }, { type: "mathNotEqual", name: a.mathNotEqual }, { type: "flowchartProcess", name: a.flowchartProcess }, { type: "flowchartAlternateProcess", name: a.flowchartAlternateProcess }],
                [{ type: "flowchartDecision", name: a.flowchartDecision }, { type: "flowchartData", name: a.flowchartData }, { type: "flowchartPredefinedProcess", name: a.flowchartPredefinedProcess }, { type: "flowchartInternalStorage", name: a.flowchartInternalStorage }, { type: "flowchartDocument", name: a.flowchartDocument }, { type: "flowchartMultidocument", name: a.flowchartMultidocument }],
                [{ type: "flowchartTerminator", name: a.flowchartTerminator }, { type: "flowchartPreparation", name: a.flowchartPreparation }, { type: "flowchartManualInput", name: a.flowchartManualInput }, { type: "flowchartManualOperation", name: a.flowchartManualOperation }, { type: "flowchartConnector", name: a.flowchartConnector }, { type: "flowchartOffpageConnector", name: a.flowchartOffpageConnector }],
                [{ type: "flowchartCard", name: a.flowchartCard }, { type: "flowchartPunchedTape", name: a.flowchartPunchedTape }, { type: "flowchartSummingJunction", name: a.flowchartSummingJunction }, { type: "flowchartOr", name: a.flowchartOr }, { type: "flowchartCollate", name: a.flowchartCollate }, { type: "flowchartSort", name: a.flowchartSort }],
                [{ type: "flowchartExtract", name: a.flowchartExtract }, { type: "flowchartMerge", name: a.flowchartMerge }, { type: "flowchartStoredData", name: a.flowchartStoredData }, { type: "flowchartDelay", name: a.flowchartDelay }, { type: "flowchartSequentialAccessStorage", name: a.flowchartSequentialAccessStorage }, { type: "flowchartMagneticDisk", name: a.flowchartMagneticDisk }],
                [{ type: "flowchartDirectAccessStorage", name: a.flowchartDirectAccessStorage }, { type: "flowchartDisplay", name: a.flowchartDisplay }, { type: "explosion1", name: a.explosion1 }, { type: "explosion2", name: a.explosion2 }, { type: "shape4pointStar", name: a.shape4pointStar }, { type: "shape5pointStar", name: a.shape5pointStar }],
                [{ type: "star6Point", name: a.star6Point }, { type: "star7Point", name: a.star7Point }, { type: "shape8pointStar", name: a.shape8pointStar }, { type: "star10Point", name: a.star10Point }, { type: "star12Point", name: a.star12Point }, { type: "shape16pointStar", name: a.shape16pointStar }],
                [{ type: "shape24pointStar", name: a.shape24pointStar }, { type: "shape32pointStar", name: a.shape32pointStar }, { type: "upRibbon", name: a.upRibbon }, { type: "downRibbon", name: a.downRibbon }, { type: "curvedUpRibbon", name: a.curvedUpRibbon }, { type: "curvedDownRibbon", name: a.curvedDownRibbon }],
                [{ type: "verticalScroll", name: a.verticalScroll }, { type: "horizontalScroll", name: a.horizontalScroll }, { type: "wave", name: a.wave }, { type: "doubleWave", name: a.doubleWave }, { type: "rectangularCallout", name: a.rectangularCallout }, { type: "roundedRectangularCallout", name: a.roundedRectangularCallout }],
                [{ type: "ovalCallout", name: a.ovalCallout }, { type: "cloudCallout", name: a.cloudCallout }, { type: "LineCallout2", name: a.LineCallout2 }, { type: "LineCallout3", name: a.LineCallout3 }, { type: "LineCallout4", name: a.LineCallout4 }, { type: "lineCallout2AccentBar", name: a.lineCallout2AccentBar }],
                [{ type: "lineCallout3AccentBar", name: a.lineCallout3AccentBar }, { type: "lineCallout4AccentBar", name: a.lineCallout4AccentBar }, { type: "lineCallout2NoBorder", name: a.lineCallout2NoBorder }, { type: "lineCallout3NoBorder", name: a.lineCallout3NoBorder }, { type: "lineCallout4NoBorder", name: a.lineCallout4NoBorder }, { type: "lineCallout2BorderandAccentBar", name: a.lineCallout2BorderandAccentBar }],
                [{ type: "lineCallout3BorderandAccentBar", name: a.lineCallout3BorderandAccentBar }, { type: "lineCallout4BorderandAccentBar", name: a.lineCallout4BorderandAccentBar }]
            ];

            function i(e) {
                var t = this;
                t.host = e, t.NB(), t.OB(), t.reInsertShapesPopup = null
            }
            i.prototype.NB = function() {
                var e, i = this,
                    r = $("<div class='insert-shape-preview-content-host'></div>"),
                    a = $("<div class='insert-shape-preview-shadowBox'></div>"),
                    s = $("<img id='insert-shape-preview-imgShape' src='../images/allShapes.png'>");
                r.mouseleave(function() { $(".insert-shape-preview-shadowBox").css("display", "none") }), e = function(e, i) {
                    var o = e.pageX - i.offset().left - 1,
                        n = e.pageY - i.offset().top - 1,
                        r = Math.ceil(o / 20) - 1,
                        a = Math.ceil(n / 20) - 1;
                    if (a >= 0 && r >= 0) return { shapeInfo: t[a][r], x: r, y: a }
                }, s.mousemove(function(t) {
                    var i, o = e(t, s);
                    o && a.attr("title", o.shapeInfo.name), (i = e(t, $(".insert-shape-preview-content-host"))) && (a.css("display", "block"), a.css("top", 20 * i.y + "px"), a.css("left", 20 * i.x + "px"))
                }), a.click(function(t) {
                    var i = e(t, s).shapeInfo,
                        r = i.isConnectorType,
                        a = o.wrapper.spread.getActiveSheet(),
                        l = n.getShapePosition(a);
                    o.actions.doAction("insertShape", o.wrapper.spread, { shapeName: null, shapeInfo: i, isConnectorType: r, position: l })
                }), s.appendTo(r), a.appendTo(r), r.appendTo(i.host)
            }, i.prototype.OB = function() {
                var e, t, i, o, n, a = this,
                    s = $("<div class='insert-shape-preview-control-host'></div>"),
                    l = $("<div class='insert-shape-preview-up-button'></div>"),
                    c = $("<div class='insert-shape-preview-up-button-icon'></div>");
                c.appendTo(l), l.click(function() {
                    var e = document.querySelector("#insert-shape-preview-imgShape"),
                        t = document.defaultView.getComputedStyle(e, null).top;
                    t = parseInt(t), e.style.top = t + 20 <= 0 ? t + 20 + "px" : "0px"
                }), e = $("<div class='insert-shape-preview-down-button'></div>"), t = $("<div class='insert-shape-preview-down-button-icon'></div>"), t.appendTo(e), e.click(function() {
                    var e = document.querySelector("#insert-shape-preview-imgShape"),
                        t = document.defaultView.getComputedStyle(e, null).top;
                    t = parseInt(t), e.style.top = t - 20 > -560 ? t - 20 + "px" : "-560px"
                }), i = $("<div class='insert-shape-preview-Show-all-button'></div>"), o = $("<div class='insert-shape-preview-Show-all-button-icontop'></div>"), n = $("<div class='insert-shape-preview-Show-all-button-iconbottom'></div>"), i.click(function() {
                    if (!a.reInsertShapesPopup) {
                        a.reInsertShapesPopup = $("#ribbon-shape-type-list-popup").gcuipopup({ autoHide: !0, position: { of: $("#reInsert-shape-preview"), my: "left top", at: "left bottom" } }), 0 !== $("#ribbon-shape-type-list-popup").children.length && $("#ribbon-shape-type-list-popup").empty();
                        var e = $("<div class='shape-type-list-container'>");
                        $("#ribbon-shape-type-list-popup").append(e), new r(e, "insert", function() { $("#ribbon-shape-type-list-popup").gcuipopup("hide") })
                    }
                    a.reInsertShapesPopup.gcuipopup("show")
                }), o.appendTo(i), n.appendTo(i), l.appendTo(s), e.appendTo(s), i.appendTo(s), s.appendTo(a.host)
            }, e.exports = i
        }()
    }, function(e, t) {
        ! function() {
            "use strict";

            function t(e) { return void 0 === e || null === e }

            function i(e, t, i, o) { this.valueChanged = i, this.descString = o && o.descString || "", this.maxValue = o && o.max || Number.MAX_VALUE, this.minValue = o && o.min || -Number.MAX_VALUE, this.domInput = this.addInputNumberEditor(t), e.append(this.domInput) } i.prototype.addInputNumberEditor = function(e) {
                var t, i, o, n, r, a = this;
                return this.value = 0, t = $("<span></span>").addClass("ui-spinner ui-widget ui-widget-content ui-corner-all ").css({ width: "65px", float: "right", "margin-right": "3px", height: "23px" }), i = $("<input />", { type: "input" }).addClass("label-top-padding numeric column1 ui-spinner-input").css({ position: "absolute", left: "1px", top: "1px", width: "50px" }).val(a.value + a.descString).change(function() {
                    var e = parseFloat($(i).val());
                    a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), o = $("<a />").addClass("ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-bottom": "3px", "border-left": "4px solid transparent", "border-right": "4px solid transparent", "border-bottom": "6px solid rgba(0, 0, 0, 0.4)", display: "inline-block" })).click(function() {
                    var e = a.value;
                    e += 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), n = $("<a />").addClass("ui-spinner-button ui-spinner-down ui-corner-br ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-top": "3px", "border-width": "6px 4px 6px", "border-style": "solid", "border-color": "rgba(0, 0, 0, 0.4) transparent transparent", display: "inline-block" })).click(function() {
                    var e = a.value;
                    e -= 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), t.append(i).append(o).append(n), r = $("<label></label>").addClass("gcui-ribbon-size-" + e.toLowerCase()).css({ "margin-right": "8px" }).text(e), $("<div></div>").append(r).append(t).css({ "list-style-type": "none", "line-height": "25px", "margin-bottom": "5px" })
            }, i.prototype.adjustValue = function(e) { return isNaN(e) && (e = this.value), t(e) || (t(this.minValue) || (e = Math.max(e, this.minValue)), t(this.maxValue) || (e = Math.min(e, this.maxValue))), Math.round(e) }, i.prototype.updateValue = function() { void 0 === this.value ? $("input", this.domInput).val("") : (this.value = Math.round(this.value), $("input", this.domInput).val(this.value + this.descString)) }, e.exports = i
        }()
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = o.util.chartHelper,
            r = GC.Spread.Sheets,
            a = i(0),
            s = void 0,
            l = o.ColorHelper;
        ! function() {
            "use strict";
            var t, i, r = o.res.ribbon.fontFamilies,
                c = o.res.shapeSliderPanel,
                d = [c.round, c.square, c.flat],
                p = [c.round, c.miter, c.bevel],
                u = [c.top, c.center, c.bottom],
                h = [c.left, c.center, c.right],
                f = ["move and size with cells", "move but don't size with cells", "don't move or size with cells"],
                g = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 24, 26, 28, 36, 48, 72],
                m = [r.ff1.name, r.ff2.name, r.ff3.name, r.ff4.name, r.ff5.name, r.ff6.name, r.ff7.name, r.ff8.name, r.ff9.name, r.ff10.name, r.ff11.name, r.ff12.name, r.ff13.name, r.ff14.name, r.ff15.name, r.ff16.name, r.ff17.name, r.ff18.name, r.ff19.name, r.ff20.name, r.ff21.name, r.ff22.name, r.ff23.name],
                b = [c.normal, c.italic, c.oblique],
                v = [c.bold, c.bolder, c.lighter],
                y = "rgba(91,155,213,1)",
                w = { SHAPEOPTIONS: "shapeOptions", TEXTOPTIONS: "textOptions" },
                x = a.isHasAppointedShapeType,
                C = a.getShapeType,
                S = a.getAppointedShape,
                k = a.isNullOrUndefined,
                T = a.getDataInValueArray;

            function A(e) { return !e || "object" == typeof e && 0 === Object.keys(e).length }

            function E() {
                var e = $(".slider-panel");
                e.sliderpanel("close", "panel2")
            }

            function I(e) { var t, i = document.createElement("span"); return i.style.font = e, t = i.style, { fontFamily: t.fontFamily, fontSize: t.fontSize, fontStyle: t.fontStyle, fontWeight: t.fontWeight } }

            function D(e) {
                var t, i = e.split(" ");
                if (i.length > 0)
                    for (e = i[0].toLocaleLowerCase(), t = 1; t < i.length; t++) e = e + " " + i[t].toLocaleLowerCase();
                return e
            }

            function L(e) { if (e) { var t = e.replace(/&/, ""); return t.toLocaleLowerCase().split(" ").join("-") } } t = { fill: F, line: R, size: B, textFill: O, textBox: P, textEditor: X, properties: N };

            function F(e, t, i, o, n) {
                this.colorChanged = n;
                var r = this;
                this.colorEditor = new z(e, t.backgroundColor, t.backgroundTransparency, i, { noColorText: o.noColorText, solidColorText: o.solidColorText }, function(e) { return r.colorChanged("backgroundColor", e) }, function(e) { return r.colorChanged("backgroundTransparency", e) })
            }

            function R(e, t, i, o, n) {
                var r, a, s;
                this.lineChanged = n, r = this, this.colorEditor = new z(e, t.borderColor, t.borderTransparency, i, { noColorText: o.noColorText, solidColorText: o.solidColorText }, function(e) { return r.lineChanged("borderColor", e) }, function(e) { return r.lineChanged("borderTransparency", e) }), k(t.borderWidth) || (this.widthEditor = new _(e, o.widthText, function(e) {
                    var t = r.lineChanged("borderWidth", e);
                    t && r.updateUI(t)
                }, { min: 0 }), this.updateUI(t.borderWidth), this.dashTypeDropEditor = new U(e, t.dashType, { normal: "../images/dashLine.png", hover: "../images/dashLineHover.png", active: "../images/dashLineActive.png" }, o.dashTypeText, "../images/line.png", [0, 8, 7, 2, 4, 3, 5, 6], function(e) { return r.lineChanged("dashType", parseInt(e)) }, r), a = d[t.capType], this.capTypeDropEditor = new J(e, a, "capType", o.capTypeText, d, function(e) { return r.lineChanged("capType", d.indexOf(e)) }, t.dashType), s = p[t.joinType], this.joinTypeDropEditor = new J(e, s, "joinType", o.joinTypeText, p, function(e) { return r.lineChanged("joinType", p.indexOf(e)) }), this.beginArrowTypeEditor = new U(e, t.beginArrowheadStyle, { normal: "../images/arrowTypeIcon.png", hover: "../images/arrowTypeHover.png", active: "../images/arrowTypeActive.png" }, o.beginArrowTypeText, "../images/arrowTypeLeft.png", [0, 1, 5, 2, 3, 4], function(e) { return r.lineChanged("beginArrowheadStyle", parseInt(e)) }), this.beginArrowSizeEditor = new U(e, t.beginArrowheadSize, { normal: "../images/arrowSizeIcon.png", hover: "../images/arrowSizeHover.png", active: "../images/arrowSizeActive.png" }, o.beginArrowSizeText, "../images/leftArrowSize.png", ["00", "01", "02", "10", "11", "12", "20", "21", "22"], function(e) { return r.lineChanged("beginArrowheadSize", { width: parseInt(e.substr(0, 1)), height: parseInt(e.substr(1, 1)) }) }), this.endArrowTypeEditor = new U(e, t.endArrowheadStyle, { normal: "../images/arrowTypeIcon.png", hover: "../images/arrowTypeHover.png", active: "../images/arrowTypeActive.png" }, o.endArrowTypeText, "../images/arrowTypeRight.png", [0, 1, 5, 2, 3, 4], function(e) { return r.lineChanged("endArrowheadStyle", parseInt(e)) }), this.endArrowSizeEditor = new U(e, t.endArrowheadSize, { normal: "../images/arrowSizeIcon.png", hover: "../images/arrowSizeHover.png", active: "../images/arrowSizeActive.png" }, o.endArrowSizeText, "../images/rightArrowSize.png", ["00", "01", "02", "10", "11", "12", "20", "21", "22"], function(e) { return r.lineChanged("endArrowheadSize", { width: parseInt(e.substr(0, 1)), height: parseInt(e.substr(1, 1)) }) }))
            }
            R.prototype.updateUI = function(e) { this.widthEditor.value = e, this.widthEditor.updateValue() };

            function B(e, t, i, n, r) {
                var s, l = this;
                l.sizeChanged = r, l.heightEditor = new _(e, n.heightText, function(e) { l.sizeChanged("height", e) && l.updateHeightUI(t.height) }, { min: 0 }), l.widthEditor = new _(e, n.widthText, function(e) { l.sizeChanged("width", e) && l.updateWidthUI(t.width) }, { min: 0 }), k(t.angle) || (this.rotateEditor = new _(e, n.rotateText, function(e) { l.sizeChanged("angle", e) && l.updateRotationUI(t.angle) }, { descString: "\xb0" }), l.updateRotationUI(t.angle)), l.updateWidthUI(t.width), l.updateHeightUI(t.height), s = function() {
                    var e = o.wrapper.spread.getActiveSheet();
                    l.widthEditor.value = a.updataSize(e)[0], l.widthEditor.updateValue(), l.heightEditor.value = a.updataSize(e)[1], l.heightEditor.updateValue(), k(t.angle) || (l.rotateEditor.value = a.updataSize(e)[2], l.rotateEditor.updateValue())
                }, o.wrapper.spread.getActiveSheet().bind(GC.Spread.Sheets.Events.ShapeChanged, s)
            }
            B.prototype.updateWidthUI = function(e) { this.widthEditor.value = e, this.widthEditor.updateValue() }, B.prototype.updateHeightUI = function(e) { this.heightEditor.value = e, this.heightEditor.updateValue() }, B.prototype.updateRotationUI = function(e) { k(e) && (e = ""), e = Math.round(e), this.rotateEditor.value = e, this.rotateEditor.updateValue() };

            function O(e, t, i, o, n) {
                this.valueChanged = n;
                var r = this;
                this.colorEditor = new z(e, t.fontColor, t.textTransparency, i, { noColorText: o.noColorText, solidColorText: o.solidColorText }, function(e) { return r.valueChanged("fontColor", e) }, function(e) { return r.valueChanged("textTransparency", e) }), this.fontSizeEditor = new J(e, t.fontSize, "fontSize", o.fontSize, g, function(e) { return r.valueChanged("fontSize", e) }), this.fontFamiliesEditor = new J(e, t.fontFamily, "fontFamily", o.fontFamily, m, function(e) { return r.valueChanged("fontFamily", e) }), this.fontStyleEditor = new J(e, t.fontStyle, "fontStyle", o.fontStyle, b, function(e) { return r.valueChanged("fontStyle", e) }), this.fontWeightEditor = new J(e, t.fontWeight, "fontWeight", o.fontWeight, v, function(e) { return r.valueChanged("fontWeight", e) })
            }

            function P(e, t, i, o, n) {
                var r, a, s;
                this.alignChanged = n, r = this, a = u[t.vAlign], this.vAlignDropEditor = new J(e, a, "vAlign", o.vAlignText, u, function(e) { return r.alignChanged("vAlign", u.indexOf(e)) }), s = h[t.hAlign], this.hAlignDropEditor = new J(e, s, "hAlign", o.hAlignText, h, function(e) { return r.alignChanged("hAlign", h.indexOf(e)) })
            }

            function N(e, t, i, o, n) {
                this.propertiesChanged = n;
                var r = this,
                    a = !1;
                k(t) && (a = !0), r.moveSizeWithCells = o.moveSizeWithCells, r.moveNoSizeWithCells = o.moveNoSizeWithCells, r.noMoveNoSizeWithCells = o.noMoveNoSizeWithCells, r.radiogroup = new G(e, a, [r.moveSizeWithCells, r.moveNoSizeWithCells, r.noMoveNoSizeWithCells], i, function(e) { return r.radioGroupSelectionChanged(e) }), r.updaterRadioGroupUI(t.moveSizeRelationship), r.checkboxGroup = new H(e, [o.locked, o.printObject], ["locked", "printObject"], i, function(e, t) { return r.CheckgroupSelectionChanged(e, t) }), r.updaterCheckGroupUI(3, t.locked), r.updaterCheckGroupUI(4, t.printObject)
            }
            N.prototype.radioGroupSelectionChanged = function(e) {
                var t = this.propertiesChanged("moveSizeRelationship", f.indexOf(e));
                k(t) || this.updaterRadioGroupUI(t)
            }, N.prototype.updaterRadioGroupUI = function(e) {
                var t = [this.moveSizeWithCells, this.moveNoSizeWithCells, this.noMoveNoSizeWithCells];
                this.radiogroup.setSelectedItem(t[e])
            }, N.prototype.CheckgroupSelectionChanged = function(e, t) {
                var i = this.propertiesChanged(e, t);
                i && ("locked" === e && this.updaterCheckGroupUI(3, i), "printObject" === e && this.updaterCheckGroupUI(4, i))
            }, N.prototype.updaterCheckGroupUI = function(e, t) { this.checkboxGroup.setCheckboxSelected(e, t) };

            function z(e, t, i, n, r, a, s) {
                var l, c = this,
                    d = !1;
                k(t) && (d = !0), l = i || 0, c.changedValue = a, c.changedOpacity = s, c.noColorText = r.noColorText, c.solidColorText = r.solidColorText, c.automaticColorText = r.automaticColorText, c.radiogroup = new G(e, d, [this.noColorText, this.solidColorText], n, function(e) { return c.radioGroupSelectionChanged(e) }), c.colorpicker = new V(e, function(e) { c.colorPicked(e) }), c.opacityEditor = new _(e, o.res.chartSliderPanel.transparency, function(e) { c.changedOpacity(e / 100) }, { min: 0, max: 100, descString: "%" }), c.updateUI(t, 100 * l)
            }
            z.prototype.radioGroupSelectionChanged = function(e) {
                var t, i;
                e === (this.noColorText && this.noColorText.toLocaleLowerCase()) ? ((t = this.changedValue("")) || "" === t) && this.updateUI(t, this.opacityEditor.value) : (t = this.changedValue(this.colorpicker.color), i = this.changedOpacity(this.opacityEditor.value / 100), (t || "" === t) && this.updateUI(t, 100 * i))
            }, z.prototype.colorPicked = function(e) {
                var t = this.changedValue(e);
                (t || "" === t) && this.updateUI(t, this.opacityEditor.value)
            }, z.prototype.updateUI = function(e, t) { e ? (this.updateRadiogroup(e.text || e.color || e), this.updateColorPicker(e.color || e), k(t) || this.updateOpacityInputNum(t)) : "" === e ? (this.updateRadiogroup(e), this.updateColorPicker(e), k(t) || this.updateOpacityInputNum(t)) : (this.updateRadiogroup(s), this.updateColorPicker(s), this.updateOpacityInputNum(0)) }, z.prototype.updateRadiogroup = function(e) {
                var t, i, o, n;
                if (e) {
                    for (i = M(e), o = e, n = i; - 1 !== o.indexOf(" ");) o = o.replace(" ", "");
                    for (; - 1 !== n.indexOf(" ");) n = n.replace(" ", "");
                    t = "rgba(0,0,0,0)" === e || "rgba(0,0,0,0)" === n ? this.noColorText : this.solidColorText
                } else t = this.noColorText;
                this.radiogroup.setSelectedItem(t)
            }, z.prototype.updateColorPicker = function(e) {
                var t, i, o;
                if (e) {
                    for (t = M(e), i = e, o = t; - 1 !== i.indexOf(" ");) i = i.replace(" ", "");
                    for (; !0 !== o && -1 !== o.indexOf(" ");) o = o.replace(" ", "");
                    i && "rgba(0,0,0,0)" !== i && !0 !== o && "rgba(0,0,0,0)" !== o ? (this.colorpicker.showColorPicker(), this.opacityEditor.show(), this.colorpicker.color = t || e, this.colorpicker.updateColor()) : (this.colorpicker.hideColorPicker(), this.opacityEditor.hide())
                } else this.colorpicker.hideColorPicker(), this.opacityEditor.hide()
            }, z.prototype.updateOpacityInputNum = function(e) { this.opacityEditor.value = parseInt(e), this.opacityEditor.updateValue() };

            function M(e) {
                var t, i, r, a = n.getPieColorArray(e),
                    s = l.parse(a[0], o.wrapper.spread.getActiveSheet().currentTheme()).color;
                if (a.length > 1) {
                    for (r = 1; r < a.length - 1; r++)
                        if (t = l.parse(a[r], o.wrapper.spread.getActiveSheet().currentTheme()).color, i = l.parse(a[r - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color, t !== i) return !0;
                    return t = l.parse(a[a.length - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color, i = l.parse(a[a.length - 2], o.wrapper.spread.getActiveSheet().currentTheme()).color, t !== i || s
                }
                return s
            }

            function V(e, t) { this.colorChanged = t, this.domColor = this.createColorElement(), e.append(this.domColor) } V.prototype.createColorElement = function(e) {
                var t, i, n, r, a = this;
                return a.color = y || "transparent", t = $("<div></div>").css({ width: "143px", margin: "3px 9px 3px 3px", float: "right", display: "inline-block" }), i = $("<span></span>").appendTo(t), $("<span></span>").addClass("color-picker-span").appendTo(i), n = $("<div></div>").appendTo(t), a.k || (a.k = $("<div></div>").addClass("forecolor-picker").colorpicker({ valueChanged: function(e, t) { a.colorChanged(t.name || t.color) }, choosedColor: function(e, i) { t.comboframe("close") }, openColorDialog: function(e, i) { t.comboframe("close") }, showNoFill: !1, themeColors: o.wrapper.getThemeColors() }).appendTo(n)), n.gcuipopup({
                    autoHide: !0,
                    showing: function(e, t) {
                        var i = a.k;
                        i.colorpicker("option", "value", a.color), i.colorpicker("option", "themeColors", o.wrapper.getThemeColors())
                    }
                }), t.comboframe().click(function() { t.comboframe("open") }), r = $("<label></label>").css({ "margin-left": "6px" }).text(o.res.chartSliderPanel.color), $("<li></li>").append(r).append(t).addClass("format-chart-panel-color").hide()
            }, V.prototype.colorChanged = function(e, t) { this.colorChanged(e.target, t) }, V.prototype.showColorPicker = function() { this.domColor.show() }, V.prototype.hideColorPicker = function() { this.domColor.hide() }, V.prototype.updateColor = function() { $(".color-picker-span", this.domColor).css({ "background-color": this.color }) };

            function G(e, t, i, o, n) {
                var r = this;
                r.updateRaidoSelectedItem = n, r.domRadio = e, i.forEach(function(i) { i && e.append(r.addRadioItem(t, o, i)) })
            }
            G.prototype.addRadioItem = function(e, t, i) {
                var o = this,
                    n = j(e, t, i);
                return $(n.children()[0]).click(function(e) { o.updateRaidoSelectedItem($(e.currentTarget).data("name")) }), n
            }, G.prototype.setSelectedItem = function(e) {
                var t = e.toLocaleLowerCase();
                $("[data-name='" + t + "']", this.domRadio).prop("checked", !0)
            };

            function j(e, t, i) { var o, n, r = $("<input />", { type: "radio", name: t }).attr("data-name", D(i)).attr("id", D(i)); return e && r.attr("disabled", !0), o = $("<label></label>").text(i).attr("for", D(i)), n = $("<span></span>").append(r).append(o).attr("data-name", D(i)).attr("id", D(i)), $("<li></li>").append(n).css({ "list-style-type": "none", "line-height": "25px" }) }

            function H(e, t, i, o, n) { var r, a = this; for (a.updateCheckboxSelected = n, a.domRadio = e, r = 0; r < t.length; r++) e.append(a.addCheckItem(o, t[r], i[r])) } H.prototype.addCheckItem = function(e, t, i) {
                var o = this,
                    n = W(e, t);
                return $(n.children()[0]).find("input[type]").click(function(e) { o.updateCheckboxSelected(i, $(e.currentTarget).prop("checked")) }), n
            }, H.prototype.setCheckboxSelected = function(e, t) { $(this.domRadio.children().get(e)).find("input[type]").prop("checked", t) };

            function W(e, t) {
                var i = $("<input />", { type: "checkbox", name: e }).attr("data-name", D(t)).attr("id", D(t)),
                    o = $("<label></label>").text(t).attr("for", D(t)),
                    n = $("<span></span>").append(i).append(o).attr("data-name", D(t)).attr("id", D(t));
                return $("<li></li>").append(n).css({ "list-style-type": "none", "line-height": "25px" })
            }

            function U(e, t, i, o, n, r, a, s) {
                var l, c;
                k(t) || (l = this, l.listChanged = a, c = $("<li></li>").css({ margin: "4px 1px", "list-style-type": "none", "line-height": "28px" }).append($("<lable></lable>").css({ "margin-left": "6px" }).text(o)), this.defauleItem = this.j(i), c.append(this.defauleItem).appendTo(e), this.itemsImgList = new q(n, t, r, o, function(e, t) { l.changedValue(e, t, s) }), c.append(this.itemsImgList))
            }
            U.prototype.j = function(e) { var t, i = this; return i.buttonClickFlag = !1, t = $("<button></button>").addClass("ui-button ui-widget ui-state-default ui-button-text-icon-secondary ui-corner-left"), t.css({ "background-image": "url(" + e.normal + ")", width: "45px", height: "25px", float: "right", "margin-right": "10px" }), t.mouseover(function() { i.buttonClickFlag || $(this).css({ "background-image": "url(" + e.hover + ")" }) }), t.mouseout(function() { i.buttonClickFlag || $(this).css({ "background-image": "url(" + e.normal + ")" }) }), t.click(function() { i.itemsImgList && (i.buttonClickFlag = !0, $(this).css({ "background-image": "url(" + e.active + ")" }), i.itemsImgList.gcuipopup("show", { of: $(this), my: "left+0 top+22", at: "left top" })) }), t }, U.prototype.changedValue = function(e, t, i) {
                var o = this.listChanged(t);
                this.buttonClickFlag = !1, this.defauleItem.trigger("mouseout"), k(o) || (e.selectItem = o, 0 !== o ? i.capTypeDropEditor.defauleItem.parent().hide() : i.capTypeDropEditor.defauleItem.parent().show())
            };

            function q(e, t, i, o, n) { var r = this; return r.selectItem = t, r.updateSelectedElement = n, r.selectedElementListDom = r.addItems(e, o, i), r.selectedElementListDom } q.prototype.addItems = function(e, t, i) {
                var o = this,
                    n = t.replace(/\s*/g, ""),
                    r = $("<div></div>").addClass("shape-imageList-content-" + n);
                return i.forEach(function(t) {
                    var i = $("<div></div>").attr("data", t).addClass("shape-imageList-item-base-" + n + "  shape-imageList-item-" + t).css("background-image", 'url("' + e + '")');
                    i.click(function(e) { $(".shape-imageList-item-" + o.selectItem).removeClass("shape-imageList-item-hover"), o.changedSelectedElement($(e.currentTarget).attr("data")) }), r.append(i)
                }), r.gcuipopup({ autoHide: !0, showing: function(e, t) { $(".shape-imageList-item-" + o.selectItem).addClass("shape-imageList-item-hover") }, hiding: function(e, t) { $(".shape-imageList-item-" + o.selectItem).removeClass("shape-imageList-item-hover") } }), r
            }, q.prototype.changedSelectedElement = function(e) { this.updateSelectedElement(this, e), this.selectedElementListDom.hide() };

            function _(e, t, i, o) { this.valueChanged = i, this.domInput = this.addInputNumberEditor(t), this.maxValue = o && !k(o.max) ? o.max : Number.MAX_VALUE, this.minValue = o && !k(o.min) ? o.min : -Number.MAX_VALUE, this.descString = o && o.descString || "", e.append(this.domInput) } _.prototype.addInputNumberEditor = function(e) {
                var t, i, o, n, r, a = this;
                return this.value = 0, t = $("<span></span>").addClass("ui-spinner ui-widget ui-widget-content ui-corner-all").css({ width: "85px", float: "right", "margin-right": "9px", height: "23px" }), i = $("<input />", { type: "input" }).addClass("label-top-padding numeric column1 ui-spinner-input").css({ position: "absolute", left: "1px", top: "1px" }).change(function() {
                    var e = parseInt($(i).val());
                    a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), o = $("<a />").addClass("ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-bottom": "3px", "border-left": "4px solid transparent", "border-right": "4px solid transparent", "border-bottom": "6px solid rgba(0, 0, 0, 0.4)", display: "inline-block" })).click(function() {
                    var e = a.value;
                    e += 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), n = $("<a />").addClass("ui-spinner-button ui-spinner-down ui-corner-br ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({ width: "0", height: "0", "margin-left": "-1px", "margin-top": "3px", "border-width": "6px 4px 6px", "border-style": "solid", "border-color": "rgba(0, 0, 0, 0.4) transparent transparent", display: "inline-block" })).click(function() {
                    var e = a.value;
                    e -= 1, a.value = a.adjustValue(e), a.updateValue(), a.valueChanged(a.value)
                }), t.append(i).append(o).append(n), r = $("<label></label>").css({ "margin-left": "6px" }).text(e), $("<li></li>").append(r).append(t).css({ margin: "1px", "list-style-type": "none", "line-height": "25px" })
            }, _.prototype.adjustValue = function(e) { return isNaN(e) && (e = this.value), k(e) || (k(this.minValue) || (e = Math.max(e, this.minValue)), k(this.maxValue) || (e = Math.min(e, this.maxValue))), Math.round(e) }, _.prototype.updateValue = function() { void 0 === this.value || "" === this.value ? $("input", this.domInput).val("") : (this.value = Math.round(this.value), $("input", this.domInput).val(this.value + this.descString)) }, _.prototype.hide = function() { this.domInput.hide() }, _.prototype.show = function() { this.domInput.show() };

            function K(e, t, i) { this.valueChanged = i, this.domInput = this.addInputTextEditor(t), e.append(this.domInput) } K.prototype.addInputTextEditor = function(e) { var t, i, o = this; return this.text = "", t = $("<input />", { type: "input" }).addClass("shape-input-number-editor").change(function(e) { o.valueChanged($(e.target).val()) }), i = $("<label></label>").css({ "margin-left": "6px", float: "left", width: "70px" }).text(e), $("<li></li>").append(i).append(t).css({ margin: "1px", "list-style-type": "none", "line-height": "28px", height: "28px" }) }, K.prototype.updateValue = function() { $("input", this.domInput).val(this.text) };

            function X(e, t, i, o, n) {
                this.textChanged = n;
                var r = this;
                this.textEditor = new K(e, o.text, function(e) {
                    var t = r.textChanged("text", e);
                    t && r.updateUI(t)
                }), this.updateUI(t.text)
            }
            X.prototype.updateUI = function(e) { this.textEditor.text = e, this.textEditor.updateValue() };

            function J(e, t, i, o, n, r, a) {
                var s, l = this;
                l.listChanged = r, s = $("<li></li>").css({ margin: "4px 1px", "list-style-type": "none", "line-height": "28px", "white-space": "nowrap" }).append($("<lable></lable>").css({ "margin-left": "6px" }).text(o)), this.defauleItem = this.j(i), s.append(this.defauleItem).appendTo(e), this.itemsList = new Y(n, i, function(e) { l.changedValue(e) }), k(a) || 0 === a || s.hide(), s.append(this.itemsList), this.updateUI(t)
            }
            J.prototype.j = function(e) {
                var t = this,
                    i = $("<button></button>").addClass("ui-button ui-widget ui-state-default ui-button-text-icon-secondary ui-corner-left").addClass("format-panel-drop-default-button-" + e),
                    o = $("<span></span>").addClass("panel-button-text").addClass("format-panel-drop-default-span-" + e),
                    n = $("<span></span>").addClass("ui-button-icon-secondary ui-icon ui-icon-triangle-1-s");
                return i.append(o).append(n), i.click(function() { t.itemsList && t.itemsList.gcuipopup("show", { of: $(this), my: "left+0 top+22", at: "left top" }) }), i
            }, J.prototype.changedValue = function(e) {
                var t = this.listChanged(e);
                t && this.updateUI(t)
            }, J.prototype.updateUI = function(e) {
                var t = ("" + e).replace(/\"/g, "");
                $("span:first", this.defauleItem).text(t)
            };

            function Y(e, t, i) { var o = this; return o.updateSelectedElement = i, o.selectedElementListDom = o.addItems(e, t), o.selectedElementListDom } Y.prototype.addItems = function(e, t) {
                var i, o = this,
                    n = $("<ul></ul>").css({ background: "white", "z-index": "10", "padding-left": "0px" });
                return "fontFamily" === t && n.css({ width: "210px" }), e.forEach(function(e) {
                    var t = $("<li></li>").attr("name", e).append($("<label></label>").text(e).css({ "margin-left": "2px" })).css({ "list-style-type": "none", "line-height": "25px" });
                    t.click(function(e) {
                        var t = $(e.currentTarget).attr("name");
                        o.changedSelectedElement(t)
                    }).mouseenter(function() { $(this).css("background", "#DBDBDB") }).mouseleave(function() { $(this).css("background", "white") }), n.append(t)
                }), i = $("<div></div>").addClass("format-panel-drop-list-common format-panel-drop-list-" + t).append(n), i.gcuipopup({ autoHide: !0 }), i
            }, Y.prototype.changedSelectedElement = function(e) { this.updateSelectedElement(e), this.selectedElementListDom.hide() };

            function Q(e, t) { return this.changedEditorStatus = t, this.addEditorTitle(e) } Q.prototype.addEditorTitle = function(e) {
                var t = this,
                    i = $("<label>").text(e).css({ font: "Bold 12pt Calibri,Arial" });
                return t.triangleExtend = $("<div><div").css({ width: "0", height: "0", "margin-right": "6px", "margin-bottom": "3px", "border-right": "8px solid rgba(0, 0, 0, 0.8)", "border-top": "8px solid transparent", display: "inline-block" }).attr("name", "extend").click(function(e) {
                    t.triangleCollapse.show(), $(this).hide();
                    var i = $(e.target).attr("name");
                    t.changedEditorStatus(i)
                }), t.triangleCollapse = $("<div><div").css({ width: "0", height: "0", "margin-right": "6px", "border-top": "5px solid transparent", "border-left": "8px solid rgba(0, 0, 0, 0.8)", "border-bottom": "5px solid transparent", display: "inline-block" }).attr("name", "collapse").hide().click(function(e) {
                    t.triangleExtend.show(), $(this).hide();
                    var i = $(e.target).attr("name");
                    t.changedEditorStatus(i)
                }), $("<p></p>").css({ margin: "2px 0px 0px 15px" }).append(t.triangleExtend).append(t.triangleCollapse).append(i)
            }, Q.prototype.changedEditorStatus = function(e) { this.changedEditorStatus(e) };

            function Z(e, i) { var o, n, r = this; return this.changedValue = i, o = $("<ul></ul>").css("padding-left", "30px"), n = t[e.type], this.editorType = new n(o, e.data, e.name, e.resources, function(e, t) { return r.editorValueChanged(e, t) }), o } Z.prototype.editorValueChanged = function(e, t) { return this.changedValue("data." + e, t) };

            function ee(e, t, i) {
                var o, n = this;
                this.tabChanged = i, o = $("<div></div>").addClass("panel-content-header"), t.forEach(function(e) { o.append(n.addTabHeader(e.name)) }), this.activePropertyTabHeader = $(o.children()[0]), this.activePropertyTabHeader.children().remove(), this.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + L(this.activePropertyTabHeader.attr("title"))).addClass("format-shape-panel")), this.propertyTabHeaders = o, e.append(o)
            }
            ee.prototype.addTabHeader = function(e) {
                var t = this,
                    i = $("<span></span>").addClass(L(e)).addClass("format-shape-panel"),
                    o = $("<div></div>").append(i).attr("title", e).addClass("format-shape-panel-background");
                return o.click(function(e) { t.tabChanged($(e.currentTarget).attr("title")) }), o
            };

            function te(e, t, i) {
                var o, n, r, a;
                for (this.changedValue = i, o = this, o.name = e, n = $("<div></div>").hide(), r = 0; r < t.length;) {
                    for (a = 0; a < t[r].editors.length; a++) n.append(new ie(t[r].editors[a], t[r].aggregate, r, a, function(e, t, i) { return o.groupContainerValueChanged(e, t, i) }));
                    r++
                }
                return n
            }
            te.prototype.groupContainerValueChanged = function(e, t, i) { return this.changedValue(this.name, e, t, i) };

            function ie(e, t, i, o, n) { var r, a, s = this; return s.aggregate = t, s.contentIndex = i, s.index = o, this.changedValue = n, r = $("<div></div>"), a = new Q(e.name, function(e) { s.updateEditorContainer(e) }), r.append(a), this.editorContainer = new Z(e, function(e, t) { return s.editorContainerValueChanged(e, t) }), r.append(this.editorContainer), r } ie.prototype.editorContainerValueChanged = function(e, t) { return this.changedValue(["content", this.contentIndex, this.aggregate, this.index], e, t) }, ie.prototype.updateEditorContainer = function(e) { "extend" === e ? this.editorContainer.hide() : this.editorContainer.show() };

            function oe(e, t) { var i, o, n, r, a = this; for (a.owner = t, a.propertyHeaderData = [], a.propertyGroupPanels = [], i = $("<div></div>"), o = 0; o < e.length; o++) this.propertyHeaderData.push({ name: e[o].name }); for (a.propertyHeaderPanel = new ee(i, this.propertyHeaderData, function(e) { a.activeTabChanged(e) }), n = 0; n < e.length; n++) r = new te(e[n].name, e[n].properties, function(e, t, i, o) { return a.activePanelValueChanged(e, t, i, o) }), i.append(r), this.propertyGroupPanels.push({ name: e[n].name, propertyGroupPanel: r }); return a.activePropertyGroupPanel = this.propertyGroupPanels[0].propertyGroupPanel, a.showPropertyGroupPanel(this.activePropertyGroupPanel), i } oe.prototype.activePanelValueChanged = function(e, t, i, o) { return this.owner.updateData(e, t, i, o) }, oe.prototype.activeTabChanged = function(e) { for (var t = 0; t < this.propertyGroupPanels.length; t++) this.propertyGroupPanels[t].name === e && (this.hidePropertyGroupPanel(this.activePropertyGroupPanel), this.activePropertyGroupPanel = this.propertyGroupPanels[t].propertyGroupPanel, this.showPropertyGroupPanel(this.activePropertyGroupPanel, e)) }, oe.prototype.hidePropertyGroupPanel = function(e) { e.hide(), this.propertyHeaderPanel.activePropertyTabHeader.children().remove(), this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass(L(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-shape-panel")) }, oe.prototype.showPropertyGroupPanel = function(e, t) { var i, o; for (e.show(), i = this.propertyHeaderPanel.propertyTabHeaders.children(), o = 0; o < i.length; o++) $(i[o]).attr("title") === t && (this.propertyHeaderPanel.activePropertyTabHeader = $(i[o]), this.propertyHeaderPanel.activePropertyTabHeader.children().remove(), this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + L(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-shape-panel"))) };

            function ne(e, t) { var i = this; return i.updateSelectedShapeElement = t, i.selectedElement = i.createSelectedShapeElement(e), i.selectedElement } ne.prototype.createSelectedShapeElement = function(e) {
                var t, i, n = this,
                    r = $("<div></div>").css({ color: "rgba(0, 0, 0, 0.7)", height: "25px" }),
                    a = $("<div>").addClass("this-class").css({ padding: "2px 15px" }),
                    s = $("<label>").attr("id", "shapeSliderPanel-shapeOptions-text").text(o.res.shapeSliderPanel.shapeOptions).addClass("shape-SliderPanel-headers-text").css({ "font-weight": "bold" });
                return s.click(function() { $("#shapeSliderPanel-textOptions-text").css({ "font-weight": "normal" }), $(this).css({ "font-weight": "bold", color: "rgb(0,0,0)" }), n.updateSelectedShapeElement(w.SHAPEOPTIONS) }), s.hover(function() { "400" === $(this).css("font-weight") && $(this).css({ color: "rgb(8, 137, 44)" }) }, function() { $(this).css({ color: "rgb(0,0,0)" }) }), a.append(s), A(e.G.textOptions) || (t = $("<label>").text(" | ").addClass("shape-SliderPanel-headers-text"), i = $("<label>").attr("id", "shapeSliderPanel-textOptions-text").text(o.res.shapeSliderPanel.textOptions).addClass("shape-SliderPanel-headers-text"), i.click(function() { $("#shapeSliderPanel-shapeOptions-text").css({ "font-weight": "normal" }), $(this).css({ "font-weight": "bold", color: "rgb(0,0,0)" }), n.updateSelectedShapeElement(w.TEXTOPTIONS) }), i.hover(function(e) { "400" === $(this).css("font-weight") && $(this).css({ color: "rgb(8, 137, 44)" }) }, function() { $(this).css({ color: "rgb(0,0,0)" }) }), a.append(t).append(i)), r.append(a), $("#shapeSliderPanel-shapeOptions-text").trigger("click"), r
            };

            function re(e, t, i) {
                var o = this;
                o.owner = t, o.container = e, o.updateSlideCallBack = i, o.container.append(new ne(t, function(e) { o.updateShapePanelTab(e) })), o.initShapePanelContent()
            }
            re.prototype.initShapePanelContent = function() {
                var e = this,
                    t = e.owner.getDatas();
                e.shapePanelContentDom = new oe(t, e.owner), e.container.append(this.shapePanelContentDom)
            }, re.prototype.updateShapePanelTab = function(e) {
                var t = this;
                t.owner.v = e, t.shapePanelContentDom.remove(), t.initShapePanelContent()
            };

            function ae(e) {
                var t, i = $("<div>").css({ color: "rgba(0, 0, 0, 0.8)", height: "40px" }).appendTo(e);
                i.children().remove(), t = $("<div>").css({ padding: "0px 10px", "padding-top": "10px" }).appendTo(i), $("<label>").text(o.res.shapeSliderPanel.formatShape).css({ "font-size": "17pt", "font-weight": "lighter", color: "#08892c" }).appendTo(t), $("<span>").addClass("slider-panel-close-button").appendTo(t).click(E)
            }

            function se(e, t, i) { var o = $("<div>").css({ width: "100%", position: "absolute", top: "40px", bottom: "0" }).addClass("slider-panel-content").appendTo(e); return new re(o, t, i) }

            function le(e, t) {
                e.sliderpanel();
                var i = e.sliderpanel("getContainer", "panel2");
                i.children().remove(), ae(i), se(i, t, function() { le(e, t) })
            }

            function ce(e) { this.Ia = e, this.v = w.SHAPEOPTIONS, this.makeShapeData(e) } ce.prototype.getDatas = function() {
                var e, t, i, o = [],
                    n = this.G[this.v];
                for (e in n) {
                    t = { name: n[e].type, properties: [] };
                    for (i in n[e]) "type" !== i && n[e][i].forEach(function(e) {
                        var i, o, n = {};
                        for (i in e) n.aggregate = i, o = n.editors = [], e[i].forEach(function(e) { o.push({ name: e.name, data: e.data, type: e.type, resources: e.resources }) });
                        t.properties.push(n)
                    });
                    o.push(t)
                }
                return o
            }, ce.prototype.updateData = function(e, t, i, n) {
                var r, a, s, l, c, h, f, g, m, b, v, y, w, x, C = this.v,
                    k = this.G,
                    T = k[C],
                    A = i.split("."),
                    E = this,
                    D = o.wrapper.spread,
                    $ = E.Ia,
                    L = A[A.length - 1],
                    F = { selectShape: $ };
                switch (L) {
                    case "width":
                    case "height":
                    case "angle":
                    case "locked":
                    case "printObject":
                    case "moveSizeRelationship":
                        F[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeSizeAndProperties", D, F), c = S($, ["Shape"]), h = { width: $[0].width(), height: $[0].height(), angle: c && c.rotate(), locked: $[0].isLocked(), printObject: $[0].canPrint() }, $[0].dynamicMove() && $[0].dynamicSize() && (h.moveSizeRelationship = 0), $[0].dynamicMove() && !$[0].dynamicSize() && (h.moveSizeRelationship = 1), $[0].dynamicMove() || $[0].dynamicSize() || (h.moveSizeRelationship = 2), n = h[L];
                        break;
                    case "backgroundTransparency":
                    case "backgroundColor":
                        "backgroundColor" === L && (L = "color"), "backgroundTransparency" === L && (L = "transparency"), F.style = { fill: {} }, F.style.fill[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), c = S($, ["Shape"]), n = c && c.style().fill[L];
                        break;
                    case "borderTransparency":
                    case "borderColor":
                    case "borderWidth":
                    case "dashType":
                    case "joinType":
                    case "capType":
                        "borderColor" === L && (L = "color"), "borderWidth" === L && (L = "width"), "dashType" === L && (L = "lineStyle"), "borderTransparency" === L && (L = "transparency"), F.style = { line: {} }, F.style.line[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), c = S($, ["Shape", "ConnectorShape"]), f = c && c.style().line, g = { color: f.color, transparency: f.transparency, width: f.width, lineStyle: f.lineStyle, joinType: p[f.joinType], capType: d[f.capType] }, n = g[L];
                        break;
                    case "beginArrowheadStyle":
                    case "endArrowheadStyle":
                        F.style = { line: {} }, F.style.line[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), c = S($, ["ConnectorShape"]), n = c && c.style().line[L];
                        break;
                    case "beginArrowheadSize":
                        F.style = { line: {} }, F.style.line.beginArrowheadWidth = n.width, F.style.line.beginArrowheadLength = n.height, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), c = S($, ["ConnectorShape"]), n = c && c.style().line.beginArrowheadWidth + "" + c.style().line.beginArrowheadLength;
                        break;
                    case "endArrowheadSize":
                        F.style = { line: {} }, F.style.line.endArrowheadWidth = n.width, F.style.line.endArrowheadLength = n.height, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), c = S($, ["ConnectorShape"]), n = c && c.style().line.endArrowheadWidth + "" + c.style().line.endArrowheadLength;
                        break;
                    case "fontColor":
                    case "textTransparency":
                    case "fontSize":
                    case "fontFamily":
                    case "fontStyle":
                    case "fontWeight":
                        c = S($, ["Shape"]), F.style = { textEffect: {} }, "fontColor" === L && (L = "color"), "textTransparency" === L && (L = "transparency"), "fontWeight" === L || "fontSize" === L || "fontFamily" === L || "fontStyle" === L ? (m = c.style().textEffect.font, b = document.createElement("span"), b.style.font = m, v = b.style, "fontSize" === L && (v.fontSize = n + "px"), "fontFamily" === L && (v.fontFamily = n), "fontWeight" === L && (v.fontWeight = n), "fontStyle" === L && (v.fontStyle = n), y = v.fontStyle + " " + v.fontWeight + " " + v.fontSize + " " + v.fontFamily, F.style.textEffect.font = y) : F.style.textEffect[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), w = { color: c && c.style().textEffect.color, transparency: c && c.style().textEffect.transparency, fontSize: c && parseInt(I(c.style().textEffect.font).fontSize), fontFamily: c && I(c.style().textEffect.font).fontFamily, fontStyle: c && I(c.style().textEffect.font).fontStyle, fontWeight: c && I(c.style().textEffect.font).fontWeight }, n = w[L];
                        break;
                    case "text":
                        c = S($, ["Shape"]), F[L] = n, o.actions.doAction("setShapeText", D, F), n = c && c.text();
                        break;
                    case "vAlign":
                    case "hAlign":
                        c = S($, ["Shape"]), F.style = { textFrame: {} }, F.style.textFrame[L] = n, F.ignoreEvent = !0, o.actions.doAction("changeShapeStyle", D, F), x = { vAlign: c && u[c.style().textFrame.vAlign], hAlign: c && u[c.style().textFrame.hAlign] }, n = x[L]
                }
                for (s = e.replace(/&/, "and").split(" ").join("").toLowerCase(), T = T[s], l = t, a = 0; a < l.length;) T = T[l[a]][l[a + 1]], a += 2;
                for (a = 0; a < A.length - 1; a++) T = T[A[a]];
                return r = T[L] = n
            }, ce.prototype.makeShapeData = function(e) {
                var t, i, o, n, r = this,
                    a = { shapeOptions: {}, textOptions: {} };
                r.Ia = e, t = r.getFillAndLineData(e), k(t) || A(t) || (a.shapeOptions.fillandline = t), i = r.getSizeData(e), k(i) || A(i) || (a.shapeOptions.size = i), x(e, "autoShapeType") && (o = r.getTextFillData(e), k(o) || A(o) || (a.textOptions.textfill = o), n = r.getTextBoxData(e), k(n) || A(n) || (a.textOptions.textbox = n)), r.G = a
            }, ce.prototype.getPropertyData = function(e, t) {
                var i, o, n, r, a = [];
                for (o = 0; o < e.length; o++)
                    if ("groupShapeType" === C(e[o])) { if ("shapeWidth" === t) { a.push(e[o].width()); continue } if ("shapeHeight" === t) { a.push(e[o].height()); continue } if ("rotate" === t) { a.push(e[o].rotate()); continue } i = this.getPropertyData(e[o].all(), t), a.push(i) } else switch (n = e[o].style(), t) {
                        case "backgroundColor":
                            a.push(n.fill && n.fill.color);
                            break;
                        case "backgroundTransparency":
                            a.push(n.fill && n.fill.transparency);
                            break;
                        case "borderColor":
                            a.push(n.line.color);
                            break;
                        case "borderTransparency":
                            a.push(n.line.transparency);
                            break;
                        case "borderWidth":
                            a.push(n.line.width);
                            break;
                        case "dashType":
                            a.push(n.line.lineStyle);
                            break;
                        case "capType":
                            a.push(n.line.capType);
                            break;
                        case "joinType":
                            a.push(n.line.joinType);
                            break;
                        case "beginArrowheadStyle":
                            a.push(n.line.beginArrowheadStyle);
                            break;
                        case "beginArrowheadSize":
                            k(n.line.beginArrowheadWidth) || k(n.line.beginArrowheadLength) || a.push(n.line.beginArrowheadWidth + "" + n.line.beginArrowheadLength);
                            break;
                        case "endArrowheadStyle":
                            a.push(n.line.endArrowheadStyle);
                            break;
                        case "endArrowheadSize":
                            k(n.line.endArrowheadWidth) || k(n.line.endArrowheadLength) || a.push(n.line.endArrowheadWidth + "" + n.line.endArrowheadLength);
                            break;
                        case "shapeWidth":
                            a.push(e[o].width());
                            break;
                        case "shapeHeight":
                            a.push(e[o].height());
                            break;
                        case "rotate":
                            a.push(e[o].rotate && e[o].rotate());
                            break;
                        case "printObject":
                            a.push(e[o].canPrint());
                            break;
                        case "locked":
                            a.push(e[o].isLocked());
                            break;
                        case "moveSizeRelationship":
                            e[o].dynamicMove() && e[o].dynamicSize() && (r = 0), e[o].dynamicMove() && !e[o].dynamicSize() && (r = 1), e[o].dynamicMove() || e[o].dynamicSize() || (r = 2), a.push(r);
                            break;
                        case "text":
                            a.push(e[o].text && e[o].text());
                            break;
                        case "fontColor":
                            a.push(n.textEffect && n.textEffect.color);
                            break;
                        case "textTransparency":
                            a.push(n.textEffect && n.textEffect.transparency);
                            break;
                        case "fontSize":
                            a.push(parseInt(n.textEffect && I(n.textEffect.font).fontSize));
                            break;
                        case "fontFamily":
                            a.push(n.textEffect && I(n.textEffect.font).fontFamily);
                            break;
                        case "fontStyle":
                            a.push(n.textEffect && I(n.textEffect.font).fontStyle);
                            break;
                        case "fontWeight":
                            a.push(n.textEffect && I(n.textEffect.font).fontWeight);
                            break;
                        case "hAlign":
                            a.push(n.textFrame && n.textFrame.hAlign);
                            break;
                        case "vAlign":
                            a.push(n.textFrame && n.textFrame.vAlign)
                    }
                return T(a)
            }, ce.prototype.getFillAndLineData = function(e) {
                var t = { type: o.res.shapeSliderPanel.fillAndLine, content: [{ Fill: [] }, { Line: [] }] },
                    i = { name: o.res.shapeSliderPanel.fill, data: { backgroundColor: this.getPropertyData(e, "backgroundColor"), backgroundTransparency: this.getPropertyData(e, "backgroundTransparency") }, type: "fill", resources: { noColorText: o.res.shapeSliderPanel.noFill, solidColorText: o.res.shapeSliderPanel.solidFill } },
                    n = { name: o.res.shapeSliderPanel.line, data: { borderColor: this.getPropertyData(e, "borderColor"), borderTransparency: this.getPropertyData(e, "borderTransparency"), borderWidth: this.getPropertyData(e, "borderWidth"), dashType: this.getPropertyData(e, "dashType"), capType: this.getPropertyData(e, "capType"), joinType: this.getPropertyData(e, "joinType"), beginArrowheadStyle: this.getPropertyData(e, "beginArrowheadStyle"), beginArrowheadSize: this.getPropertyData(e, "beginArrowheadSize"), endArrowheadStyle: this.getPropertyData(e, "endArrowheadStyle"), endArrowheadSize: this.getPropertyData(e, "endArrowheadSize") }, type: "line", resources: { noColorText: o.res.shapeSliderPanel.noLine, solidColorText: o.res.shapeSliderPanel.solidLine, widthText: o.res.shapeSliderPanel.width, dashTypeText: o.res.shapeSliderPanel.dashType, capTypeText: o.res.shapeSliderPanel.capType, joinTypeText: o.res.shapeSliderPanel.joinType, beginArrowTypeText: o.res.shapeSliderPanel.beginArrowType, beginArrowSizeText: o.res.shapeSliderPanel.beginArrowSize, endArrowTypeText: o.res.shapeSliderPanel.endArrowType, endArrowSizeText: o.res.shapeSliderPanel.endArrowSize } };
                return t.content[0].Fill.push(i), t.content[1].Line.push(n), t
            }, ce.prototype.getSizeData = function(e) {
                var t = { type: o.res.shapeSliderPanel.size, content: [{ Size: [] }, { Properties: [] }] },
                    i = { name: o.res.shapeSliderPanel.size, data: { width: this.getPropertyData(e, "shapeWidth"), height: this.getPropertyData(e, "shapeHeight"), angle: this.getPropertyData(e, "rotate") }, type: "size", resources: { widthText: o.res.shapeSliderPanel.width, heightText: o.res.shapeSliderPanel.height, rotateText: o.res.shapeSliderPanel.rotation } },
                    n = { name: o.res.shapeSliderPanel.properties, data: { printObject: this.getPropertyData(e, "printObject"), locked: this.getPropertyData(e, "locked"), moveSizeRelationship: this.getPropertyData(e, "moveSizeRelationship") }, type: "properties", resources: { printObject: o.res.shapeSliderPanel.printObject, locked: o.res.shapeSliderPanel.locked, moveSizeWithCells: o.res.shapeSliderPanel.moveSizeWithCells, moveNoSizeWithCells: o.res.shapeSliderPanel.moveNoSizeWithCells, noMoveNoSizeWithCells: o.res.shapeSliderPanel.noMoveNoSizeWithCells } };
                return t.content[0].Size.push(i), t.content[1].Properties.push(n), t
            }, ce.prototype.getTextFillData = function(e) {
                var t = { type: o.res.shapeSliderPanel.textFill, content: [{ TextEditor: [] }, { TextFill: [] }] },
                    i = { name: o.res.shapeSliderPanel.textEditor, data: { text: this.getPropertyData(e, "text") }, type: "textEditor", resources: { text: o.res.shapeSliderPanel.text } },
                    n = { name: o.res.shapeSliderPanel.textFill, data: { fontColor: this.getPropertyData(e, "fontColor"), textTransparency: this.getPropertyData(e, "textTransparency"), fontSize: this.getPropertyData(e, "fontSize"), fontFamily: this.getPropertyData(e, "fontFamily"), fontStyle: this.getPropertyData(e, "fontStyle"), fontWeight: this.getPropertyData(e, "fontWeight") }, type: "textFill", resources: { noColorText: o.res.shapeSliderPanel.noFill, solidColorText: o.res.shapeSliderPanel.solidFill, fontColor: o.res.shapeSliderPanel.color, textTransparency: o.res.shapeSliderPanel.transparency, fontSize: o.res.shapeSliderPanel.fontSize, fontFamily: o.res.shapeSliderPanel.fontFamily, fontStyle: o.res.shapeSliderPanel.fontStyle, fontWeight: o.res.shapeSliderPanel.fontWeight } };
                return t.content[0].TextEditor.push(i), t.content[1].TextFill.push(n), t
            }, ce.prototype.getTextBoxData = function(e) {
                var t = { type: o.res.shapeSliderPanel.textbox, content: [{ TextBox: [] }] },
                    i = { name: o.res.shapeSliderPanel.textbox, data: { vAlign: this.getPropertyData(e, "vAlign"), hAlign: this.getPropertyData(e, "hAlign") }, type: "textBox", resources: { vAlignText: o.res.shapeSliderPanel.vAlign, hAlignText: o.res.shapeSliderPanel.hAlign } };
                return t.content[0].TextBox.push(i), t
            }, i = {
                sliderPanelDataManager: {},
                initShapeSliderPanel: function(e) {
                    var t = $(".slider-panel");
                    i.sliderPanelDataManager = new ce(e), le(t, i.sliderPanelDataManager), t.sliderpanel("open", "panel2")
                },
                refreshSliderPanel: function(e) {
                    var t = i.sliderPanelDataManager,
                        o = $(".slider-panel");
                    !A(t) && o.is(":visible") && (t.makeShapeData(e), le(o, t))
                }
            }, e.exports = i
        }()
    }, function(e, t, i) {
        var o = i(36),
            n = GC.Spread.Sheets.Designer,
            r = i(0);
        ! function() {
            "use strict";

            function t(e, t) { var i, o, n = {}; for (i in e) n[i] = e[i]; for (o in t) n[o] = t[o]; return n }

            function i(e, t, i) {
                var n = this;
                switch (n.host = e, n.shapeTypeFlag = i, n.shapeTypeFlag) {
                    case "autoShapeType":
                        n.dataSource = o.autoShapeStyle;
                        break;
                    case "connectorShapeType":
                        n.dataSource = o.connectorShapeStyle
                }
                n.dataIndex = 0, t ? n.PB() : n.QB()
            }
            i.prototype.QB = function() {
                var e = this;
                e.host.empty(), e.RB(), e.SB()
            }, i.prototype.RB = function() {
                var e, t = this,
                    i = t.dataIndex,
                    o = $("<div class='shape-style-preview-shape-host'></div>"),
                    n = $("<div class='shape-style-preview-con'></div>");
                o.appendTo(n), n.appendTo(t.host), i < t.dataSource.length && (e = t.dataSource[i], t.TB(o, e))
            }, i.prototype.TB = function(e, i) {
                var o, n, r = i.baseStyle,
                    a = i.shapes;
                for (o = 0; o < a.length; o++) n = t(r, a[o]), this.UB(e, n)
            }, i.prototype.UB = function(e, t, i) {
                var n, r, a, s, l, c, d, p = this,
                    u = o.colorCompar,
                    h = $("<div class='shape-style-preview-backGround-item'></div>");
                switch (i && h.css({ "background-color": "#ffffff", border: "6px solid #ffffff" }), p.shapeTypeFlag) {
                    case "autoShapeType":
                        n = $("<div class='shape-style-preview-autoshape-item'>Abc</div>"), n.css(t), n.appendTo(h), h.appendTo(e);
                        break;
                    case "connectorShapeType":
                        n = $("<div class='shape-style-preview-line-item'></div>"), r = t.borderWidth || .5, a = t.borderColor, s = t.lineStyle || "solid", n.css("border", r + "px " + s + " " + a), n.appendTo(h), h.appendTo(e), l = t.Arrow, c = r + "px " + s + " " + a, l && "end" === l && (n.addClass("shape-style-preview-connectorshape-item"), n.addClass("shape-style-preview-connectorshape-item-" + u[a])), l && "beginend" === l && (n.addClass("shape-style-preview-connectorshape-item"), n.addClass("shape-style-preview-connectorshape-item-" + u[a]), d = $("<div class='tool-b'></div>"), d.css({ border: c }), d.addClass("tool-b-" + u[a]), d.appendTo(n))
                }
                h.click(t, function(e) {
                    var t = e.data,
                        o = { line: {}, fill: {}, textEffect: {} };
                    void 0 !== t.borderColor && (o.line.color = t.borderColor), void 0 !== t.borderWidth && (o.line.width = t.borderWidth), void 0 !== t.lineStyle && ("dashed" === t.lineStyle ? o.line.lineStyle = 2 : o.line.lineStyle = t.lineStyle), void 0 !== t.Arrow ? ("end" === t.Arrow && (o.line.beginArrowheadStyle = 0, o.line.endArrowheadStyle = t.arrowHeadStyle, o.line.endArrowheadWidth = t.width, o.line.endArrowheadLength = t.length), "beginend" === t.Arrow && (o.line.endArrowheadStyle = t.arrowHeadStyle, o.line.endArrowheadWidth = t.width, o.line.endArrowheadLength = t.length, o.line.beginArrowheadStyle = t.arrowHeadStyle, o.line.beginArrowheadWidth = t.width, o.line.beginArrowheadLength = t.length)) : (o.line.beginArrowheadStyle = 0, o.line.endArrowheadStyle = 0), void 0 !== t.backgroundColor && (o.fill.color = t.backgroundColor), void 0 !== t.textColor && (o.textEffect.color = t.textColor), p._o(o), i && $("#ribbon-shape-all-style-list-popup").gcuipopup("hide")
                })
            }, i.prototype.SB = function() {
                var e, t, o, n, r, a, s, l = this,
                    c = $("<div class='shape-style-preview-button-host'></div>");
                c.appendTo($(".shape-style-preview-con")), e = $("<div class='shape-style-preview-up-button'></div>"), t = $("<div class='shape-style-preview-up-button-icon'></div>"), t.appendTo(e), e.click(function() { l.dataIndex > 0 && (l.dataIndex--, l.QB()) }), o = $("<div class='shape-style-preview-down-button'></div>"), n = $("<div class='shape-style-preview-down-button-icon'></div>"), n.appendTo(o), o.click(function() { l.dataIndex < l.dataSource.length - 1 && (l.dataIndex++, l.QB()) }), r = $("<div class='shape-style-preview-Show-all-button' name='change-shape-styles'  id='change-shape-styles'></div>"), r.click(function() {
                    if (!l.allShapeStylePreview) {
                        l.allShapeStylePreview = $("#ribbon-shape-all-style-list-popup").gcuipopup({ autoHide: !0, position: { of: $(".shape-preview"), my: "right top", at: "right top" } });
                        var e = $(".shape-all-style-list-container");
                        new i(e, !0, l.shapeTypeFlag)
                    }
                    l.allShapeStylePreview.gcuipopup("show")
                }), a = $("<div class='shape-style-preview-Show-all-button-icontop'></div>"), s = $("<div class='shape-style-preview-Show-all-button-iconbottom'></div>"), a.appendTo(r), s.appendTo(r), e.appendTo(c), o.appendTo(c), r.appendTo(c)
            }, i.prototype.PB = function() {
                var e, i, o, r, a, s, l, c = this;
                for ($(".shape-all-style-list-container").empty(), e = $("<div class='shape-style-preview-all-shape-con'></div>"), i = $("<div class='shape-style-preview-all-shape-header1'></div>"), o = $("<div class='shape-style-preview-all-shape-content'></div>"), i.html(n.res.ribbon.shapeDesign.themeStyle).appendTo(e), r = 0; r < c.dataSource.length; r++)
                    for (a = c.dataSource[r].baseStyle, s = 0; s < c.dataSource[r].shapes.length; s++) l = t(a, c.dataSource[r].shapes[s]), c.UB(o, l, !0);
                o.appendTo(e), e.appendTo(c.host)
            }, i.prototype._o = function(e) {
                var t = n.wrapper.spread.getActiveSheet(),
                    i = r.getActiveShapes(t);
                n.actions.doAction("changeShapeStyle", n.wrapper.spread, { selectShape: i, style: e })
            }, e.exports = i
        }()
    }, function(e, t) {
        e.exports = {
            autoShapeStyle: [{ baseStyle: { borderWidth: 1, backgroundColor: "white", color: "black" }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }, { baseStyle: { borderWidth: 1, color: "white" }, shapes: [{ backgroundColor: "rgb(0,0,0)", borderColor: "rgb(0,0,0)" }, { backgroundColor: "rgb(68,114,196)", borderColor: "rgb(47,82,143)" }, { backgroundColor: "rgb(237,125,49)", borderColor: "rgb(174,90,33)" }, { backgroundColor: "rgb(165,165,165)", borderColor: "rgb(120,120,120)" }, { backgroundColor: "rgb(255,192,0)", borderColor: "rgb(188,140,0)" }, { backgroundColor: "rgb(91,155,213)", borderColor: "rgb(65,113,156)" }, { backgroundColor: "rgb(112,173,71)", borderColor: "rgb(80,126,50)" }] }, { baseStyle: { borderColor: "rgb(255,255,255)", borderWidth: 1.5, color: "white" }, shapes: [{ backgroundColor: "rgb(0,0,0)" }, { backgroundColor: "rgb(68,114,196)" }, { backgroundColor: "rgb(237,125,49)" }, { backgroundColor: "rgb(165,165,165)" }, { backgroundColor: "rgb(255,192,0)" }, { backgroundColor: "rgb(91,155,213)" }, { backgroundColor: "rgb(112,173,71)" }] }],
            connectorShapeStyle: [{ baseStyle: { borderWidth: .3, lineStyle: 0 }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }, { baseStyle: { borderWidth: .9, lineStyle: 0 }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }, { baseStyle: { borderWidth: 1.5, lineStyle: 0 }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }, { baseStyle: { lineStyle: "dashed", arrowHeadStyle: 0 }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }, {
                baseStyle: { Arrow: "end", lineStyle: 0, arrowHeadStyle: 5, width: 1, length: 1 },
                shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, {
                    borderColor: "rgb(255,192,0)"
                }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }]
            }, { baseStyle: { Arrow: "beginend", lineStyle: 0, arrowHeadStyle: 5, width: 1, length: 1 }, shapes: [{ borderColor: "rgb(0,0,0)" }, { borderColor: "rgb(68,114,196)" }, { borderColor: "rgb(237,125,49)" }, { borderColor: "rgb(165,165,165)" }, { borderColor: "rgb(255,192,0)" }, { borderColor: "rgb(91,155,213)" }, { borderColor: "rgb(112,173,71)" }] }],
            colorCompar: { "rgb(0,0,0)": "black", "rgb(68,114,196)": "blue", "rgb(237,125,49)": "orange", "rgb(165,165,165)": "gray", "rgb(255,192,0)": "yellow", "rgb(91,155,213)": "shadowblue", "rgb(112,173,71)": "green" }
        }
    }, function(e, t, i) {
        var o = GC.Spread.Sheets.Designer,
            n = i(2).app;
        ! function(e) {
            "use strict";
            var t, i;
            e.currentFilePath = "";

            function r(e) { var t, i, o = e.split("-"); for (t = 1; t < o.length; t++) i = o[t], o[t] = i[0].toUpperCase() + i.slice(1); return o.join("") }

            function a(e, t, i) {
                var n, a, s, l, c;
                t.suspendPaint();
                try { o.util.assert("string" == typeof e && "doAction" !== e, "actionName invalid"), e = r(e), n = this[e], a = !1, void 0 === n && (n = o.spreadActions[e], a = !0), o.util.assert(void 0 !== n, 'cannot found the action "' + e + '".'), s = t.getActiveSheet(), a ? (c = { sheet: s, selections: s.getSelections(), options: i, sheetName: s.name() }, l = [t, c]) : l = [t, i], n.apply(null, l) } catch (e) { throw t.resumePaint(), e } t.resumePaint(), t.focus(!0)
            }
            e.doAction = a;

            function s(e) { return e.substring(e.lastIndexOf(".") + 1).toLowerCase() }

            function l(t, i) { e.currentFilePath ? d(t, e.currentFilePath, null, !1, i) : c(t, null, null, i) } e.save = l;

            function c(e, t, i, r) {
                var a, s, l = t;
                l || (l = { title: o.res.saveFileDialogTitle, fileExtension: ".ssjson", nameFilters: [o.res.spreadFileFilter, o.res.ssJSONToJSFilter, o.res.excelFileFilter] }), a = null === i || void 0 === i ? null : JSON.stringify(i), s = function(t) { "cancelled" !== t.status && d(e, t.fileName, a, !1, r) }, n.showSaveDialog(l, s)
            }
            e.saveAs = c;

            function d(e, t, i, o, n) {
                var r = s(t);
                switch (r) {
                    case "ssjson":
                    case "json":
                        u(e, t, o, n, !1);
                        break;
                    case "js":
                        u(e, t, o, n, !0);
                        break;
                    case "csv":
                    case "pdf":
                    case "xlsx":
                        g(e, t, i, o, n)
                }
            }

            function p(e, t) { return t || (t = {}), t.includeBindingSource = !0, e.toJSON(t) }

            function u(e, t, i, o, n) {
                f(e);
                var r = p(e);
                e.designerBindingPathSchema && (r.designerBindingPathSchema = e.designerBindingPathSchema), h(t, JSON.stringify(r), { saveAsJS: n }, i, o)
            }

            function h(t, i, r, a, s) { n.save(t, i, function(i) { "failed" === i.status ? o.MessageBox.show(i.message, o.res.title, 3) : (a || (e.currentFilePath = t, e.isFileModified = !1, N()), o.fileMenu.closeFileScreen()), s && s.call(null) }, r) }

            function f(e) {
                var t, i, n = $.fn.zTree.getZTreeObj("ztree-container"),
                    r = null;
                n && (t = [], r = n.getNodes()[0], o.ribbon.treeNodeToArray(r.children, t), i = o.util.saveJSONSchema(t), $.isEmptyObject(i) || (e.designerBindingPathSchema = i))
            }

            function g(e, t, i, n, r) {
                var a, l, c;
                if ($(".loading-placeholder").removeClass("hidden"), a = s(t), i) switch (a) {
                    case "xlsx":
                        l = { spread: p(e, i.excelSaveFlags), exportFileType: a };
                        break;
                    case "csv":
                        try { c = e.sheets[i.sheetIndex].getCsv(i.row, i.column, i.rowCount, i.columnCount, i.rowDelimiter, i.columnDelimiter) } catch (e) { return o.MessageBox.show(e.message, o.res.title, 2, 0), void $(".loading-placeholder").addClass("hidden") } l = { spread: c, exportFileType: a };
                        break;
                    case "pdf":
                        l = { spread: e, exportFileType: a }
                } else l = { spread: p(e), exportFileType: a };
                h(t, l, i, n, function() { r && r.call(null), $(".loading-placeholder").addClass("hidden") })
            }

            function m(e, t, i) {
                var r, a = t;
                a || (a = { title: o.res.exportFileDialogTitle, nameFilters: [o.res.excelFileFilter] }), r = function(t) { "cancelled" !== t.status && d(e, t.fileName, i, !0) }, n.showSaveDialog(a, r)
            }

            function b(e, t) {
                var i = { title: o.res.exportFileDialogTitle, fileExtension: ".ssjson", nameFilters: [o.res.spreadFileFilter] };
                m(e, i, t)
            }
            e.exportJson = b;

            function v(e, t) {
                var i = { title: o.res.exportFileDialogTitle, fileExtension: ".js", nameFilters: [o.res.ssJSONToJSFilter] };
                m(e, i, t)
            }
            e.exportJS = v;

            function y(e, t) {
                var i = { title: o.res.exportFileDialogTitle, fileExtension: ".xlsx", nameFilters: [o.res.excelFileFilter] };
                m(e, i, t)
            }
            e.exportExcel = y;

            function w(e, t) {
                var i = { title: o.res.exportFileDialogTitle, fileExtension: ".csv", nameFilters: [o.res.csvFileFilter] };
                m(e, i, t)
            }
            e.exportCsv = w;

            function x(e, t) {
                var i = { title: o.res.exportFileDialogTitle, nameFilters: [o.res.pdfFileFilter] };
                m(e, i, t)
            }
            e.exportPdf = x;

            function C(e, t) {
                var i, r = t;
                r || (r = { title: o.res.openFileDialogTitle, nameFilters: [o.res.allSpreadFileFilter, o.res.spreadFileFilter, o.res.excelFileFilter, o.res.csvFileFilter] }), r.action = "open", r.filters = ".ssjson, .xlsx, .csv", i = function(t) {
                    var i, r;
                    if ("cancelled" !== t.status && t.file) switch (i = t.file.name, r = n.getExtension(i), r.toLowerCase()) {
                        case "ssjson":
                            E(e, i, t);
                            break;
                        case "xlsx":
                        case "csv":
                            I(e, i, r, t);
                            break;
                        default:
                            return void o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3)
                    }
                }, n.showOpenDialog(r, i)
            }
            e.open = C;

            function S(e, t, i) {
                var r, a = t;
                a || (a = { title: o.res.importFileDialogTitle, nameFilters: [o.res.spreadFileFilter, o.res.excelFileFilter, o.res.csvFileFilter, o.res.allFileFilter] }), a.action = "import", r = function(t) {
                    var o, r;
                    if ("cancelled" !== t.status) switch (o = t.file.name, r = n.getExtension(o), r.toLowerCase()) {
                        case "ssjson":
                            E(e, o, t, !0);
                            break;
                        case "xlsx":
                        case "csv":
                            I(e, o, r, t, i, !0)
                    }
                }, n.showOpenDialog(a, r, i)
            }
            e.VB = S;

            function k(e) { o.MessageBox.show(o.res.closingNotification, o.res.title, 2, 2, e) } e.showUnsavedWarning = k;

            function T(t, i) {
                if ("Blank" === i) return e.reset(), void o.fileMenu.closeFileScreen();
                var n = function(t) { $.ajax({ url: "../resources/templates/" + t + ".ssjson", type: "GET", dataType: "json", success: function(t) { try { o.wrapper.reset(), o.wrapper.spread.fromJSON(t), e.currentFilePath = "", e.isFileModified = !1, N(), o.ribbon.updateRibbonBarStyle(), o.wrapper.spreadElement.trigger("FileOpened"), o.fileMenu.closeFileScreen() } catch (e) { o.fileMenu.closeFileScreen() } }, error: function() { return o.MessageBox.show(o.res.requestTempalteFail, o.res.title, 3) } }) };
                e.isFileModified ? k(function(e, o) {
                    switch (o) {
                        case 2:
                            l(t, function() { n(i) });
                            break;
                        case 3:
                            n(i);
                            break;
                        case 4:
                            return
                    }
                }) : n(i)
            }
            e.openTemplate = T;

            function A(e) {
                var t, i, o;
                if (!e.getActiveSheet()) {
                    if (!(e.getSheetCount() > 0)) throw "no sheet";
                    e.setActiveSheetIndex(0)
                }
                for (t = 0; t < e.getSheetCount(); t++) i = e.getSheet(t).getActiveColumnIndex(), o = e.getSheet(t).getActiveRowIndex(), void 0 !== i && void 0 !== o ? e.getSheet(t).setActiveCell(o, i) : e.getSheet(t).setActiveCell(0, 0)
            }

            function E(t, i, n, r) {
                var a = function(t, i) {
                    var n, a, s, l;
                    if ("failed" === i.status) o.MessageBox.show(i.message, o.res.title, 3);
                    else try { n = i.data, a = n[0], s = "\ufeff" === a || "FFFE" === a, l = JSON.parse(s ? n.substr(1) : n), r ? (t.fromJSON(l), l.designerBindingPathSchema && (o.wrapper.spread.designerBindingPathSchema = l.designerBindingPathSchema), A(t), e.isFileModified = !0) : (o.wrapper.reset(), o.wrapper.spread.fromJSON(l), l.designerBindingPathSchema && (o.wrapper.spread.designerBindingPathSchema = l.designerBindingPathSchema), A(o.wrapper.spread), e.currentFilePath = i.fileName, e.isFileModified = !1), o.fileMenu.closeFileScreen(), N(), o.ribbon.updateRibbonBarStyle(), o.wrapper.spreadElement.trigger("FileOpened") } catch (e) { "no sheet" !== e && -1 === e.message.indexOf("fromJSON") || (o.wrapper.reset(), o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3)) }
                };
                e.isFileModified ? k(function(e, i) {
                    switch (i) {
                        case 2:
                            l(t, function() { a(t, n) });
                            break;
                        case 3:
                            a(t, n);
                            break;
                        case 4:
                            return
                    }
                }) : a(t, n)
            }
            e.openJson = E;

            function I(i, n, r, a, s, c) {
                var d = function(i, n) {
                    function l(e) {
                        var t = o.wrapper.spread.getActiveSheet();
                        t.setCsv(0, 0, e, s.rowDelimiter || "\r\n", s.columnDelimiter || ","), o.fileMenu.closeFileScreen(), N(), o.ribbon.updateRibbonBarStyle()
                    }

                    function d(r) {
                        if ("success" === r.status) { var a = r.data; try { "string" == typeof a && (a = JSON.parse(a)) } catch (e) { return o.fileMenu.closeFileScreen(), o.MessageBox.show("Parse file data error.", o.res.title, 3), void $(".loading-placeholder").addClass("hidden") } try { c ? (i.fromJSON(a, s.excelOpenFlags), A(i), e.isFileModified = !0) : (o.wrapper.reset(), o.wrapper.spread.fromJSON(a), A(o.wrapper.spread), e.currentFilePath = n, e.isFileModified = !1), o.fileMenu.closeFileScreen(), N(), o.ribbon.updateRibbonBarStyle(), o.wrapper.spreadElement.trigger("FileOpened") } catch (e) { "no sheet" === e && (o.wrapper.reset(), o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3)) } } else r.errorData ? c ? o.MessageBox.show(r.errorData.errorMessage, o.res.title, 3) : 0 === r.errorData.errorCode || 1 === r.errorData.errorCode ? o.MessageBox.show(r.errorData.errorMessage, o.res.title, 3) : (void 0 === t && (t = new o.PasswordDialog), t.open(i, n, s, c, r.errorData.errorMessage)) : o.MessageBox.show(r.message, o.res.title, 3);
                        $(".loading-placeholder").addClass("hidden")
                    }
                    $(".loading-placeholder").removeClass("hidden");
                    var p = a.data;
                    setTimeout(function() {
                        switch (r) {
                            case "csv":
                                l(p);
                                break;
                            case "xlsx":
                                d(a)
                        }
                        $(".loading-placeholder").addClass("hidden")
                    }, 400)
                };
                e.isFileModified ? k(function(e, t) {
                    switch (t) {
                        case 2:
                            l(i, function() { d(i, n) });
                            break;
                        case 3:
                            d(i, n);
                            break;
                        case 4:
                            return
                    }
                }) : d(i, n)
            }
            e.openOtherFormat = I;

            function D(e, t) {
                var i = { title: o.res.importFileDialogTitle, filters: ".ssjson", nameFilters: [o.res.spreadFileFilter] };
                S(e, i, t)
            }
            e.importJson = D;

            function L(e, t) {
                var i = { title: o.res.importFileDialogTitle, filters: ".xlsx", nameFilters: [o.res.excelFileFilter] };
                S(e, i, t)
            }
            e.importExcel = L;

            function F(e, t) {
                var i = { title: o.res.importFileDialogTitle, filters: ".csv", nameFilters: [o.res.csvFileFilter] };
                S(e, i, t)
            }
            e.importCsv = F;

            function R() {
                var t = function() { o.wrapper.reset(), o.ribbon.updateRibbonBarStyle(), e.currentFilePath = "", e.isFileModified = !1, N() };
                e.isFileModified ? k(function(e, i) {
                    switch (i) {
                        case 2:
                            l(o.wrapper.spread, t);
                            break;
                        case 3:
                            t();
                            break;
                        case 4:
                            return
                    }
                }) : t()
            }
            e.reset = R;

            function B(e) { e.undoManager().undo() } e.undo = B;

            function O(e) { e.undoManager().redo() } e.redo = O;

            function P() {
                var e, t, i, n, r, a, s = o.wrapper.spread.getActiveSheet(),
                    l = s.getViewportWidth(1),
                    c = s.getViewportHeight(1),
                    d = s.getSelections();
                if (!d || 0 === d.length) return null;
                if (e = d[0], t = 0, i = 0, d.length > 1)
                    for (n = 1; n < d.length; n++) e = e.union(d[n]);
                for (n = 0; n < e.rowCount; n++) i += s.getRowHeight(e.row + n);
                for (r = 0; r < e.colCount; r++) t += s.getColumnWidth(e.col + r);
                return a = Math.min(l / t, c / i), { zoom: a, topRow: e.row, leftCol: e.col }
            }
            e.Ev = P, e.isFileModified = !1;

            function N() { var t, r = e.currentFilePath;!0 === e.isFileModified ? "" !== r && $("title").text() !== i && (t = n.getFileInfo(r).fileName, i = "* " + t + " - " + o.res.title, $("title").text(i)) : "" !== r ? (t = n.getFileInfo(r).fileName, $("title").text(t + " - " + o.res.title), o.wrapper.shouldModifiedHandlerExecute = !0) : $("title").text(o.res.title) } e.updateWindowTitle = N, o.actions = e
        }(o.actions || {})
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function() {
                function e() {}

                function t() { e.calcService || (e.calcService = i.wrapper.spread.getCalcService()) }
                return e.unparse = function(i, o, n, r) { return t(), e.calcService.unparse(i, o, n, r) }, e.parse = function(i, o, n, r, a, s) { return t(), e.calcService.parse(i, o, n, r, a, s) }, e.parseRangeToExpString = function(e, t, i, o, n) {
                    var r = GC.Spread.Sheets.CalcEngine,
                        a = r.RangeReferenceRelative.allRelative;
                    return t && (a = r.RangeReferenceRelative.allAbsolute), r.rangeToFormula(e, i || 0, o || 0, a, n)
                }, e.parseExpStringToRanges = function(e, t) {
                    var i, o, n = GC.Spread.Sheets.CalcEngine,
                        r = [],
                        a = /^\[.+]$/g,
                        s = a.test(e) ? [e] : e.split(",");
                    try { for (i = 0; i < s.length; i++)(o = n.formulaToRange(t, s[i])) && r.push(o) } catch (e) { return null }
                    return r
                }, e.parseExternalRangeToString = function(t, i, o, n) { var r = ""; return t.range && (r += e.parseRangeToExpString(t.range, !1, i, o, n)), r }, e.parseStringToExternalRanges = function(e, t) {
                    var i, o, n = GC.Spread.Sheets.CalcEngine,
                        r = [],
                        a = e.split(",");
                    try { for (i = 0; i < a.length; i++) o = n.formulaToRange(t, a[i]), r.push({ range: o }) } catch (e) { return null }
                    return r
                }, e
            }();
            i.CEUtility = e
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer,
            o = void 0,
            n = {},
            r = GC.Spread.Sheets,
            a = r.Charts,
            s = r.Shapes,
            l = r.CalcEngine.rangeToFormula,
            c = r.CalcEngine.formulaToRange,
            d = i.util.chartHelper,
            p = d.getSelectedChart;
        ! function(e) {
            "use strict";
            var t, u, h, f, g, m, b, v, y, w, x, C, S, k, T, A, E, I, D, L, F, R, B, O, P, N, z, M, V, G, j, H, W, U, q, _, K, X, J, Y, Q, Z, ee, te, ie, oe, ne, re, ae, se, le, ce, de, pe, ue, he, fe, ge, me, be, ve, ye, we, xe, Ce, Se, ke, Te, Ae, Ee, Ie, De, $e, Le, Fe, Re, Be, Oe, Pe, Ne, ze, Me, Ve, Ge, je, He, We, Ue, qe, _e, Ke, Xe, Je, Ye, Qe, Ze, et, tt, it, ot, nt, rt, at, st, lt, ct, dt, pt, ut, ht, ft, gt, mt, bt, vt, yt, wt, xt, Ct, St, kt, Tt, At, Et, It, Dt, $t, Lt, Ft, Rt, Bt, Ot, Pt, Nt, zt, Mt, Vt, Gt, jt, Ht, Wt, Ut, qt, _t, Kt, Xt, Jt, Yt, Qt, Zt, ei, ti, ii, oi, ni, ri, ai, si, li, ci, di, pi, ui, hi, fi, gi, mi, bi, vi, yi, wi, xi, Ci, Si, ki, Ti, Ai, Ei, Ii, Di, $i, Li, Fi, Ri, Bi, Oi, Pi, Ni, zi, Mi, Vi, Gi, ji, Hi, Wi, Ui, qi, _i, Ki, Xi, Ji, Yi, Qi, Zi, eo, to, io, oo, no, ro, ao, so, lo, co, po, uo, ho, fo, go, mo, bo, vo, yo, wo, xo, Co, So, ko, To, Ao, Eo, Io, Do, $o, Lo, Fo, Ro, Bo, Oo, Po, No, zo, Mo, Vo, Go, jo, Ho, Wo, Uo, qo, _o, Ko, Xo, Jo, Yo, Qo, Zo, en, tn, on, nn, rn, an, sn, ln, cn, dn, pn, un, hn, fn, gn, mn, bn, vn, yn, wn, xn, Cn, Sn, kn, Tn, An, En, In, Dn, $n, Ln, Fn, Rn, Bn, On, Pn, Nn, zn, Mn, Vn, Gn, jn, Hn, Wn, Un, qn, _n, Kn, Xn, Jn, Yn, Qn, Zn, er, tr, ir, or, nr, rr, ar, sr, lr, cr, dr, pr, ur, hr, fr, gr, mr;
            i.dialog = {}, t = {}, u = "designer.", h = "cut", f = "copy", g = "pasteFormatting", m = "pasteValues", b = "pasteFormula", v = "pasteAll", y = "insert_dialog", w = "delete_dialog", x = "protectSheet", C = "confirmProtectSheet", S = "formatCells", k = "richText", T = "customSort", A = "defineName", E = "cellTag", I = "colTag", D = "sheetTag", L = "rowTag", F = "rowHeight", R = "columnWidth", B = "formatComment", O = "slicerSortAscend", P = "slicerSortDescend", N = "slicerProperty", z = "slicerSetting", M = "columnHeaders", V = "rowHeaders", G = "tabColor", j = "changeChartTypeDialog", H = "selectChartDataDialog", W = "moveChartDialog", U = "formatChart", q = "floatingObjectCut", _ = "floatingObjectCopy", K = "resetChartColor", X = "cutShapes", J = "copyShapes", Y = "pasteShapes", Q = "groupShapes", Z = "ungroupShapes", ee = "formatShapes";

            function br(e) { i.util.triggerDesignerEvent("chartChanged", e) }

            function vr(e) { i.util.triggerDesignerEvent("shapeChanged", e) }

            function yr(e) { e.register(u + f, t[f], null, !1, !1, !1, !1), e.register(u + h, t[h], null, !1, !1, !1, !1), e.register(u + v, t[v], null, !1, !1, !1, !1), e.register(u + b, t[b], null, !1, !1, !1, !1), e.register(u + g, t[g], null, !1, !1, !1, !1), e.register(u + m, t[m], null, !1, !1, !1, !1), e.register(u + y, t[y], null, !1, !1, !1, !1), e.register(u + w, t[w], null, !1, !1, !1, !1), e.register(u + x, t[x], null, !1, !1, !1, !1), e.register(u + S, t[S], null, !1, !1, !1, !1), e.register(u + k, t[k], null, !1, !1, !1, !1), e.register(u + T, t[T], null, !1, !1, !1, !1), e.register(u + A, t[A], null, !1, !1, !1, !1), e.register(u + E, t[E], null, !1, !1, !1, !1), e.register(u + I, t[I], null, !1, !1, !1, !1), e.register(u + D, t[D], null, !1, !1, !1, !1), e.register(u + L, t[L], null, !1, !1, !1, !1), e.register(u + F, t[F], null, !1, !1, !1, !1), e.register(u + R, t[R], null, !1, !1, !1, !1), e.register(u + B, t[B], null, !1, !1, !1, !1), e.register(u + N, t[N], null, !1, !1, !1, !1), e.register(u + z, t[z], null, !1, !1, !1, !1), e.register(u + M, t[M], null, !1, !1, !1, !1), e.register(u + V, t[V], null, !1, !1, !1, !1), e.register(u + O, t[O], null, !1, !1, !1, !1), e.register(u + P, t[P], null, !1, !1, !1, !1), e.register(u + G, t[G], null, !1, !1, !1, !1), e.register(u + j, t[j], null, !1, !1, !1, !1), e.register(u + H, t[H], null, !1, !1, !1, !1), e.register(u + W, t[W], null, !1, !1, !1, !1), e.register(u + U, t[U], null, !1, !1, !1, !1), e.register(u + K, t[K], null, !1, !1, !1, !1), e.register(u + _, t[_], null, !1, !1, !1, !1), e.register(u + q, t[q], null, !1, !1, !1, !1), e.register(u + X, t[X], null, !1, !1, !1, !1), e.register(u + J, t[J], null, !1, !1, !1, !1), e.register(u + Y, t[Y], null, !1, !1, !1, !1), e.register(u + Q, t[Q], null, !1, !1, !1, !1), e.register(u + Z, t[Z], null, !1, !1, !1, !1), e.register(u + ee, t[ee], null, !1, !1, !1, !1) } e.initDesignerCommands = yr, te = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this), this.ww = t, this.Ov = t.getSheetFromName(i.sheetName), this.WB = i.selections, this.po = i, this.canUndo = !1 }
                return t.prototype.spread = function() { return this.ww }, t.prototype.sheet = function() { return this.Ov }, t.prototype.getSelections = function() { return this.WB }, t.prototype.executeImp = function(e, t, i) {}, t.prototype.undoImp = function(e, t, i) { return e.suspendPaint(), GC.Spread.Sheets.Commands.undoTransaction(e, t), e.resumePaint(), !0 }, t.prototype.execute = function(e, t, o) {
                    var n, r = this,
                        a = !1;
                    if (o) a = r.undoImp.call(r, e, t, o);
                    else if (r.canExecute()) { n = GC.Spread.Sheets.Commands, n.startTransaction(e, t), e.suspendPaint(); try { a = r.executeImp(e, t, o) } finally { e.resumePaint(), n.endTransaction(e, t) } }
                    return !1 !== a && "designer.changeShapeStyle" !== t.cmd && "designer.insertShape" !== t.cmd && i.ribbon.updateRibbonAll(t.style), a
                }, t.prototype.execInSelections = function(e, t) {
                    var i, o, n, r, a, s, l, c, d = this.getSelections();
                    for (n = 0; n < d.length; n++)
                        if (r = d[n], a = r.col, s = r.row, l = r.rowCount, c = r.colCount, -1 === a && -1 === s) t(e, -1, -1);
                        else if (-1 === s)
                        for (i = 0; i < c; i++) t(e, -1, a + i);
                    else if (-1 === a)
                        for (i = 0; i < l; i++) t(e, s + i, -1);
                    else
                        for (i = 0; i < l; i++)
                            for (o = 0; o < c; o++) t(e, s + i, a + o)
                }, t.prototype.execInSelectionsForSetStyle = function(e, t) {
                    var i, o, n, r, a, s, l, c, d, p, u, h = this.getSelections();
                    for (n = 0; n < h.length; n++)
                        if (r = h[n], a = r.col, s = r.row, l = r.rowCount, c = r.colCount, -1 === a || -1 === s) {
                            if (-1 === a && -1 === s) {
                                for (p = 0; p < l; p++) t(e, p, -1);
                                for (u = 0; u < c; u++) t(e, -1, u);
                                for (p = 0; p < l; p++)
                                    for (u = 0; u < c; u++)(d = e.getStyle(p, u)) && t(e, p, u)
                            } else if (-1 === a) {
                                for (p = 0; p < l; p++) t(e, p + s, -1);
                                for (p = 0; p < l; p++)
                                    for (u = 0; u < c; u++)(d = e.getStyle(p + s, u)) && t(e, p + s, u)
                            } else if (-1 === s) {
                                for (u = 0; u < c; u++) t(e, -1, u + a);
                                for (p = 0; p < l; p++)
                                    for (u = 0; u < c; u++)(d = e.getStyle(p, u + a)) && t(e, p, u + a)
                            }
                        } else
                            for (i = 0; i < l; i++)
                                for (o = 0; o < c; o++) t(e, s + i, a + o)
                }, t.prototype.execInSelectionsForRow = function(e, t) {
                    var i, o, n, r, a = this.getSelections();
                    for (i = 0; i < a.length; i++)
                        for (o = a[i], n = -1 === o.row ? 0 : o.row, r = 0; r < o.rowCount; r++) t(e, n + r)
                }, t.prototype.execInSelectionsForCol = function(e, t) {
                    var i, o, n, r, a = this.getSelections();
                    for (i = 0; i < a.length; i++)
                        for (o = a[i], n = -1 === o.col ? 0 : o.col, r = 0; r < o.colCount; r++) t(e, n + r)
                }, t.prototype.execInSelectionsForCell = function(e, t) {
                    var i, o, n, r, a, s, l = this.getSelections();
                    for (i = 0; i < l.length; i++)
                        for (o = l[i], n = -1 === o.col ? 0 : o.col, r = -1 === o.row ? 0 : o.row, a = 0; a < o.rowCount; a++)
                            for (s = 0; s < o.colCount; s++) t(e, r + a, n + s)
                }, t.prototype.getActualFont = function(e, t, o) { return e.getActualStyle(t, o).font || i.res.defaultFont }, t.prototype.clearSpansInSelection = function(e, t) {
                    if (e && t) {
                        var i = [],
                            o = t.row,
                            n = t.col,
                            r = t.rowCount,
                            a = t.colCount;
                        e.getSpans().forEach(function(e) { e.intersect(o, n, r, a) && i.push(e) }), i.forEach(function(t) { e.removeSpan(t.row, t.col) })
                    }
                }, t.prototype.getKey = function(e, t) { return [e, t].join(",") }, t.prototype.getPosition = function(e) { var t = e && e.split(","); return t && 2 === t.length ? { row: +t[0], column: +t[1] } : null }, t.prototype.setFontStyle = function(e, t, i, o, n) {
                    var r, a = this,
                        s = a.Ov;
                    e.font || (e.font = a.getActualFont(s, o, n)), r = $("<span></span>"), r.css("font", e.font), r.css(t, i), e.font = r.css("font"), s.setStyle(o, n, e)
                }, t.prototype.undoSetStyle = function(e, t) {
                    var i, o, n, r, a, s, l = this,
                        c = l.Ov,
                        d = l.ww,
                        p = t.XB;
                    if (p) {
                        d.suspendPaint();
                        for (i in p) o = l.getPosition(i), n = p[i], o && (r = o.row, a = o.column, s = c.getStyle(r, a), s[e] = "backColor" === e ? n || void 0 : n, c.setStyle(r, a, s));
                        d.resumePaint()
                    }
                    return !0
                }, t.prototype.setStyle = function(e, t, i, o, r, a) {
                    var s = this,
                        l = s.Ov,
                        c = s.ww;
                    o.XB = {}, c.suspendPaint(), s.execInSelectionsForSetStyle(l, function(l, c, d) {
                        var p = l.getStyle(c, d);
                        p || (p = new GC.Spread.Sheets.Style), o.XB[s.getKey(c, d)] = p[t], r && (i = r.apply(s, [l, c, d, p, i].concat(a || [])), p[t] = i, l.setStyle(c, d, p)), ["font-size", "font-family", "font-weight", "font-style"].indexOf(e) >= 0 ? s.setFontStyle(p, e, i, c, d) : (p[t] = i, l.setStyle(c, d, p), "wordWrap" !== t || n[c] || s.Ov.defaults.rowHeight !== s.Ov.getRowHeight(c) || l.autoFitRow(c))
                    }), c.resumePaint()
                }, t.prototype.updateRibbon = function() { $(i).trigger("updateRibbon") }, t.prototype.getTextDecoration = function(e, t, i, o, n, r) { var a, s = this; return o.textDecoration || (o.textDecoration = s.getActualDecoration(e, t, i)), a = o.textDecoration, n ? 1 == (1 & a) && 8 == (8 & r) ? (a ^= 1, a |= 8) : 8 == (8 & a) && 1 == (1 & r) ? (a ^= 8, a |= 1) : a |= r : a ^= r, a }, t.prototype.getActualDecoration = function(e, t, i) { return e.getActualStyle(t, i).textDecoration }, t
            }(r.Commands.ActionBase), e.DesignerActionBase = te, ie = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r = this.ww,
                        a = t.sheetName,
                        s = {};
                    s.cmd = "copy", s.sheetName = a, s.ignoreClipboard = !0, n = function() { i.util.clipboard.copyText = s.copyData.copyText, i.util.clipboard.copyHtml = s.copyData.copyHtml }, s.callback = n, r.commandManager().execute(s)
                }, t
            }(te), t[f] = { canUndo: !1, execute: function(e, t, i) { var o = new ie(e, t); return o.execute(e, t, i) } };

            function wr(e, i) { kr(e, f, t[f], i) } e.copy = wr, oe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r = this.ww,
                        a = t.sheetName,
                        s = {};
                    s.cmd = "cut", s.sheetName = a, s.ignoreClipboard = !0, n = function() { i.util.clipboard.copyText = s.cutData.copyText, i.util.clipboard.copyHtml = s.cutData.copyHtml }, s.callback = n, r.commandManager().execute(s)
                }, t
            }(te), t[h] = { canUndo: !1, execute: function(e, t, i) { var o = new oe(e, t); return o.execute(e, t, i) } };

            function xr(e, i) { kr(e, h, t[h], i) } e.cut = xr, ne = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a, s, l, c, d = this;
                    d.hi = t.value, n = d.Ov, r = n.options.clipBoardOptions, n.options.clipBoardOptions = d.hi, n.isPasteFloatingObject() ? d.ww.commandManager().execute({ cmd: "pasteFloatingObjects", sheetName: n.name() }) : n.isPasteShapes && n.isPasteShapes() ? d.ww.commandManager().execute({ cmd: "pasteShapes", sheetName: n.name() }) : (a = i.util.clipboard.copyText, s = i.util.clipboard.copyHtml, c = function() { n.options.clipBoardOptions = r }, e.commandManager().execute({ cmd: "paste", sheetName: n.name(), pasteText: a, pasteHtml: s, callback: c }))
                }, t
            }(te), t[v] = {
                canUndo: !1,
                execute: function(e, t, i) {
                    var o = new ne(e, t),
                        n = { value: 0, spread: e };
                    return o.execute(e, n, i)
                }
            }, t[b] = {
                canUndo: !1,
                execute: function(e, t, i) {
                    var o = new ne(e, t),
                        n = { value: 3, spread: e };
                    return o.execute(e, n, i)
                }
            }, t[g] = {
                canUndo: !1,
                execute: function(e, t, i) {
                    var o = new ne(e, t),
                        n = { value: 2, spread: e };
                    return o.execute(e, n, i)
                }
            }, t[m] = {
                canUndo: !1,
                execute: function(e, t, i) {
                    var o = new ne(e, t),
                        n = { value: 1, spread: e };
                    return o.execute(e, n, i)
                }
            }, re = { canUndo: !1, execute: function(e, t, i) { var o = new ne(e, t); return o.execute(e, t, i) } };

            function Cr(e, t) { kr(e, "paste", re, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.paste = Cr, ae = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.options.sheetTabColor = t.value
                }, t
            }(te), se = { canUndo: !0, execute: function(e, t, i) { var o = new ae(e, t); return o.execute(e, t, i) } };

            function Sr(e, t) { kr(e, "setSheetTabColor", se, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setSheetTabColor = Sr, le = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = ts(t.selections);
                    switch (n) {
                        case 0:
                            i.MessageBox.show(i.res.insertCellInSheet, i.res.title, 2);
                            break;
                        case 4:
                            i.MessageBox.show(i.res.insertCellInMixtureRange, i.res.title, 2);
                            break;
                        case 3:
                            i && i.dialog && (void 0 === i.dialog.insertCellsDialog && (i.dialog.insertCellsDialog = new i.InsertCellsDialog), i.dialog.insertCellsDialog.open())
                    }
                }, t
            }(te), t[y] = { canUndo: !1, execute: function(e, t, i) { var o = new le(e, t); return o.execute(e, t, i) } }, ce = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r = ts(t.selections);
                    switch (r) {
                        case 0:
                            return n = e.getSheetFromName(t.sheetName), void n.clear(0, 0, n.getRowCount(), n.getColumnCount(), 3, 51);
                        case 4:
                            i.MessageBox.show(i.res.insertCellInMixtureRange, i.res.title, 2);
                            break;
                        case 3:
                            i && i.dialog && (void 0 === i.dialog.deleteCellsDialog && (i.dialog.deleteCellsDialog = new i.DeleteCellsDialog), i.dialog.deleteCellsDialog.open())
                    }
                    return !1
                }, t
            }(te), t[w] = { canUndo: !0, execute: function(e, t, i) { var o = new ce(e, t); return o.execute(e, t, i) } }, de = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = e.getSheetFromName(t.sheetName),
                        r = n.options.isProtected;
                    i && i.dialog && (r ? (n.options.isProtected = !!t.value, i.actions.isFileModified = !0) : (void 0 === i.dialog.protectionOptionDialog && (i.dialog.protectionOptionDialog = new i.ProtectionOptionDialog), i.dialog.protectionOptionDialog.open()))
                }, t
            }(te), t[x] = { canUndo: !1, execute: function(e, t, i) { var o = new de(e, t); return o.execute(e, t, i) } }, pe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = e.getSheetFromName(t.sheetName),
                        r = t.value;
                    n.options.protectionOptions = r, n.options.isProtected = !0, i.wrapper.spread.undoManager().clear()
                }, t
            }(te), t[C] = { canUndo: !1, execute: function(e, t, i) { var o = new pe(e, t); return o.execute(e, t, i) } }, ue = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.formatCellDialog && (i.dialog.formatCellDialog = new i.FormatDialog), i.dialog.formatCellDialog.open("number")) }, t
            }(te), t[S] = { canUndo: !1, execute: function(e, t, i) { var o = new ue(e, t); return o.execute(e, t, i) } }, he = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.richTextDialog && (i.dialog.richTextDialog = new i.RichTextDialog), i.dialog.richTextDialog.open()) }, t
            }(te), t[k] = { canUndo: !1, execute: function(e, t, i) { var o = new he(e, t); return o.execute(e, t, i) } }, fe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (i.dialog.sortDialog || (i.dialog.sortDialog = new i.SortDialog), i.dialog.sortDialog.open()) }, t
            }(te), t[T] = { canUndo: !1, execute: function(e, t, i) { var o = new fe(e, t); return o.execute(e, t, i) } }, ge = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.newNameDialog && (i.dialog.newNameDialog = new i.NewNameDialog), i.dialog.newNameDialog.open("new", void 0)) }, t
            }(te), t[A] = { canUndo: !1, execute: function(e, t, i) { var o = new ge(e, t); return o.execute(e, t, i) } }, me = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.tagDialog && (i.dialog.tagDialog = new i.TagDialog), i.dialog.tagDialog.open(t.type), i.wrapper.spread.focus(!1)) }, t
            }(te), t[D] = { canUndo: !1, execute: function(e, t, i) { var o = new me(e, t); return t.type = "sheet", o.execute(e, t, i) } }, t[E] = { canUndo: !1, execute: function(e, t, i) { var o = new me(e, t); return t.type = "cell", o.execute(e, t, i) } }, t[I] = { canUndo: !1, execute: function(e, t, i) { var o = new me(e, t); return t.type = "column", o.execute(e, t, i) } }, t[L] = { canUndo: !1, execute: function(e, t, i) { var o = new me(e, t); return t.type = "row", o.execute(e, t, i) } }, be = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.setRowHeightDialog && (i.dialog.setRowHeightDialog = new i.RowHeightDialog), i.dialog.setRowHeightDialog.open()) }, t
            }(te), t[F] = { canUndo: !1, execute: function(e, t, i) { var o = new be(e, t); return o.execute(e, t, i) } }, ve = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.setColumnWidthDialog && (i.dialog.setColumnWidthDialog = new i.ColumnWidthDialog), i.dialog.setColumnWidthDialog.open()) }, t
            }(te), t[R] = { canUndo: !1, execute: function(e, t, i) { var o = new ve(e, t); return o.execute(e, t, i) } }, ye = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a, s, l = e.getSheetFromName(t.sheetName);
                    i && i.dialog && (void 0 === i.dialog.fcDialog && (i.dialog.fcDialog = new i.FormatCommentDialog), n = t.activeRow, r = t.activeCol, a = l.comments.get(n, r), s = { row: n, col: r }, a && i.dialog.fcDialog.open(s))
                }, t
            }(te), t[B] = { canUndo: !1, execute: function(e, t, i) { var o = new ye(e, t); return o.execute(e, t, i) } }, we = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = e.getSheetFromName(t.sheetName);
                    i && i.dialog && (i.dialog.formatSlicerDialog || (i.dialog.formatSlicerDialog = new i.FormatSlicerDialog), i.util.isSlicerSelected(n) && i.dialog.formatSlicerDialog.open())
                }, t
            }(te), t[N] = { canUndo: !1, execute: function(e, t, i) { var o = new we(e, t); return o.execute(e, t, i) } }, xe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = e.getSheetFromName(t.sheetName);
                    i && (i.ribbon.slicerSettingDialog || (i.ribbon.slicerSettingDialog = new i.SlicerSettingDialog), i.util.isSlicerSelected(n) && i.ribbon.slicerSettingDialog.open())
                }, t
            }(te), t[z] = { canUndo: !1, execute: function(e, t, i) { var o = new xe(e, t); return o.execute(e, t, i) } }, Ce = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { i && i.dialog && (void 0 === i.dialog.headerCellsDialog && (i.dialog.headerCellsDialog = new i.HeaderCellsDialog), i.dialog.headerCellsDialog.open(t.type)) }, t
            }(te), t[M] = { canUndo: !1, execute: function(e, t, i) { var o = new Ce(e, t); return t.type = "col", o.execute(e, t, i) } }, t[V] = { canUndo: !1, execute: function(e, t, i) { var o = new Ce(e, t); return t.type = "row", o.execute(e, t, i) } }, Se = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = t.commandOptions.value;
                    if (!o) return !1;
                    o.name ? kr(e, "setSheetTabColor", se, { value: o.name, selections: t.selections, sheetName: t.sheetName }) : kr(e, "setSheetTabColor", se, { value: o.color, selections: t.selections, sheetName: t.sheetName })
                }, t
            }(te), t[G] = { canUndo: !1, execute: function(e, t, i) { var o = new Se(e, t); return o.execute(e, t, i) } }, t[j] = {
                canUndo: !1,
                execute: function(e, t, o) {
                    i.ribbon.selectChartDialog || (i.ribbon.selectChartDialog = new i.SelectChartDialog);
                    var n = d.getSelectedChart(e.getSheetFromName(t.sheetName));
                    i.ribbon.selectChartDialog.open(i.SelectChartDialog.dialogType.changeChartType, n)
                }
            }, t[H] = {
                canUndo: !1,
                execute: function(e, t, o) {
                    i.ribbon.chartSelectDataDialog || (i.ribbon.chartSelectDataDialog = new i.ChartSelectDataDialog);
                    var n = d.getSelectedChart(e.getSheetFromName(t.sheetName));
                    i.ribbon.chartSelectDataDialog.open(n)
                }
            }, t[W] = { canUndo: !1, execute: function(e, t, o) { i.ribbon.moveChartDialog || (i.ribbon.moveChartDialog = new i.MoveChartDialog), i.ribbon.moveChartDialog.open() } }, t[U] = {
                canUndo: !1,
                execute: function(e, t, o) {
                    var n = e.getSheetFromName(t.sheetName);
                    t.commandOptions.chart = d.getSelectedChart(n), i.ribbon.chartDoubleClicked(null, t.commandOptions)
                }
            }, ke = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this,
                        r = n.Ov,
                        a = d.getSelectedChart(r);
                    a && (o = a.colorAndStyle && a.colorAndStyle.color, d.applyChartSeriesTheme(a, o || {}), br(a))
                }, t
            }(te), t[K] = { canUndo: !0, execute: function(e, t, i) { var o = new ke(e, t); return o.execute(e, t, i) } }, t[_] = { canUndo: !1, execute: function(e, t, i) { e.commandManager().execute({ cmd: "copyFloatingObjects", sheetName: t.sheetName }) } }, t[q] = { canUndo: !1, execute: function(e, t, i) { e.commandManager().execute({ cmd: "cutFloatingObjects", sheetName: t.sheetName }) } };

            function kr(e, t, i, o) {
                var n = e.commandManager(),
                    r = "designer." + t;
                n.getCommand(r) || n.register(r, i, null, !1, !1, !1, !1), o.cmd = r, n.execute(o)
            }
            Te = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("font-family", "font", t.value, t), o.updateRibbon()
                }, t
            }(te), Ae = { canUndo: !0, execute: function(e, t, i) { var o = new Te(e, t); return o.execute(e, t, i) } };

            function Tr(e, t) { kr(e, "setFontFamily", Ae, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setFontFamily = Tr, Ee = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("font-size", "font", t.value, t), o.updateRibbon()
                }, t
            }(te), Ie = { canUndo: !0, execute: function(e, t, i) { var o = new Ee(e, t); return o.execute(e, t, i) } };

            function Ar(e, t) { kr(e, "setFontSize", Ie, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setFontSize = Ar, De = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("font-weight", "font", t.value, t), o.updateRibbon()
                }, t
            }(te), $e = { canUndo: !0, execute: function(e, t, i) { var o = new De(e, t); return o.execute(e, t, i) } };

            function Er(e, t) { kr(e, "setFontWeight", $e, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setFontWeight = Er, Le = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this,
                        n = GC.Spread.Sheets.TextDecorationType.underline;
                    o.setStyle("textDecoration", "textDecoration", t.value, t, o.getTextDecoration, [n]), o.updateRibbon()
                }, t
            }(te), Fe = { canUndo: !0, execute: function(e, t, i) { var o = new Le(e, t); return o.execute(e, t, i) } };

            function Ir(e, t) { kr(e, "setUnderline", Fe, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setUnderline = Ir, Re = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this,
                        n = GC.Spread.Sheets.TextDecorationType.doubleUnderline;
                    o.setStyle("textDecoration", "textDecoration", t.value, t, o.getTextDecoration, [n]), o.updateRibbon()
                }, t
            }(te), Be = { canUndo: !0, execute: function(e, t, i) { var o = new Re(e, t); return o.execute(e, t, i) } };

            function Dr(e, t) { kr(e, "setDoubleUnderline", Be, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setDoubleUnderline = Dr, Oe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("font-style", "font", t.value, t), o.updateRibbon()
                }, t
            }(te), Pe = { canUndo: !0, execute: function(e, t, i) { var o = new Oe(e, t); return o.execute(e, t, i) } };

            function $r(e, t) { kr(e, "setFontStyle", Pe, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setFontStyle = $r, Ne = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("backColor", "backColor", t.value, t), o.updateRibbon()
                }, t
            }(te), ze = { canUndo: !0, execute: function(e, t, i) { var o = new Ne(e, t); return o.execute(e, t, i) } };

            function Lr(e, t) { kr(e, "setBackColor", ze, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setBackColor = Lr, Me = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("foreColor", "foreColor", t.value, t), o.updateRibbon()
                }, t
            }(te), Ve = { canUndo: !0, execute: function(e, t, i) { var o = new Me(e, t); return o.execute(e, t, i) } };

            function Fr(e, t) { kr(e, "setForeColor", Ve, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setForeColor = Fr, Ge = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("hAlign", "hAlign", t.value, t), o.updateRibbon()
                }, t
            }(te), je = { canUndo: !0, execute: function(e, t, i) { var o = new Ge(e, t); return o.execute(e, t, i) } };

            function Rr(e, t) { kr(e, "setHAlign", je, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setHAlign = Rr, He = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("vAlign", "vAlign", t.value, t), o.updateRibbon()
                }, t
            }(te), We = { canUndo: !0, execute: function(e, t, i) { var o = new He(e, t); return o.execute(e, t, i) } };

            function Br(e, t) { kr(e, "setVAlign", We, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setVAlign = Br, Ue = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("formatter", "formatter", t.value, t), o.updateRibbon()
                }, t
            }(te), qe = { canUndo: !0, execute: function(e, t, i) { var o = new Ue(e, t); return o.execute(e, t, i) } };

            function Or(e, t) { kr(e, "setFormatter", qe, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setFormatter = Or, _e = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("formatter", t)
                }, t.prototype.setStyle = function(e, t) {
                    var i = this,
                        o, n, a, s, l;
                    i.execInSelections(i.Ov, function(e, t, c) {
                        var d, p, u, h, f, g, m, b, v, y, w, x, C, S, k = e.getStyle(t, c);
                        if (k || (k = new r.Style), d = i.Ov.getCell(i.po.activeRowIndex, i.po.activeColIndex), p = d.value(), u = d.formatter(), h = d.text(), p) {
                            if (o = null, n = "0", a = "#", s = ".", l = "0" + s + "0", g = i.getScientificNotationCheckingFormattter(u), !u || "General" === u || g && (g.indexOf("E") >= 0 || g.indexOf("e") >= 0)) {
                                if (!isNaN(p))
                                    if (m = h.split("."), 1 === m.length) o = m[0].indexOf("E") >= 0 || m[0].indexOf("e") >= 0 ? l + "E+00" : l;
                                    else if (2 === m.length) {
                                    for (m[0] = "0", b = !1, v = "", f = 0; f < m[1].length + 1; f++)
                                        if (v += "0", f < m[1].length && ("e" === m[1].charAt(f) || "E" === m[1].charAt(f))) { b = !0; break } b && (v += "E+00"), v && (m[1] = "" + v, o = m[0] + s + m[1])
                                }
                            } else if (o = u) {
                                for (y = o.split(";"), f = 0; f < y.length && f < 2; f++) y[f] && y[f].indexOf("/") < 0 && y[f].indexOf(":") < 0 && y[f].indexOf("?") < 0 && (w = y[f].lastIndexOf(s), -1 !== w ? y[f] = y[f].slice(0, w + 1) + n + y[f].slice(w + 1) : (x = y[f].lastIndexOf(n), C = y[f].lastIndexOf(a), (S = x > C ? x : C) >= 0 && (y[f] = y[f].slice(0, S + 1) + s + n + y[f].slice(S + 1))));
                                o = y.join(";")
                            }
                            k.formatter = o, e.setStyle(t, c, k)
                        }
                    })
                }, t.prototype.getScientificNotationCheckingFormattter = function(e) { var t, i, o, n, r; if (!e) return e; for (t = this, o = t.getSubStrings(e, "'", "'"), i = 0; i < o.length; i++) e = e.replace(o[i], ""); for (n = t.getSubStrings(e, '"', '"'), i = 0; i < n.length; i++) e = e.replace(n[i], ""); for (r = this.getSubStrings(e, "[", "]"), i = 0; i < r.length; i++) e = e.replace(r[i], ""); return e }, t.prototype.getSubStrings = function(e, t, i) { var o, n, r, a; if (!e) return []; for (o = [], n = "", r = !1, a = 0; a < e.length; a++) r || e[a] !== t ? r && (n += e[a], e[a] === i && (o.push(n), n = "", r = !1)) : (r = !0, n = e[a]); return o }, t
            }(te), Ke = { canUndo: !0, execute: function(e, t, i) { var o = new _e(e, t); return o.execute(e, t, i) } };

            function Pr(e, t) {
                var i = t.sheet,
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex();
                kr(e, "increaseDecimal", Ke, { selections: t.selections, activeRowIndex: o, activeColIndex: n, sheetName: t.sheetName })
            }
            e.increaseDecimal = Pr, Xe = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("formatter", t)
                }, t.prototype.setStyle = function(e, t) {
                    var i, o = this;
                    o.execInSelections(o.Ov, function(e, t, n) {
                        var a, s, l, c, d, p, u, h, f, g, m, b, v = e.getStyle(t, n);
                        if (v || (v = new r.Style), a = o.Ov.getCell(o.po.activeRowIndex, o.po.activeColIndex), s = a.value(), l = a.formatter(), c = a.text(), i = ".", s) {
                            if (p = null, l && "General" !== l) {
                                for (p = l, g = p.split(";"), d = 0; d < g.length && d < 2; d++) g[d] && g[d].indexOf("/") < 0 && g[d].indexOf(":") < 0 && g[d].indexOf("?") < 0 && -1 !== (m = g[d].lastIndexOf(i)) && m + 1 < g[d].length && (g[d] = g[d].slice(0, m + 1) + g[d].slice(m + 2), "" !== (b = m + 1 < g[d].length ? g[d].substr(m + 1, 1) : "") && "0" === b || (g[d] = g[d].slice(0, m) + g[d].slice(m + 1)));
                                p = g.join(";")
                            } else if (!isNaN(s) && (u = c.split("."), 2 === u.length)) { for (u[0] = "0", h = !1, f = "", d = 0; d < u[1].length - 1; d++) { if (d + 1 < u[1].length && ("e" === u[1].charAt(d + 1) || "E" === u[1].charAt(d + 1))) { h = !0; break } f += "0" } h && (f += "E+00"), u[1] = "" + f, p = u[0] + ("" !== u[1] ? i + u[1] : "") } v.formatter = p, e.setStyle(t, n, v)
                        }
                    })
                }, t
            }(te), Je = { canUndo: !0, execute: function(e, t, i) { var o = new Xe(e, t); return o.execute(e, t, i) } };

            function Nr(e, t) {
                var i = t.sheet,
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex();
                kr(e, "decreaseDecimal", Je, { selections: t.selections, activeRowIndex: o, activeColIndex: n, sheetName: t.sheetName })
            }
            e.decreaseDecimal = Nr, Ye = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this,
                        a = r.getSelections();
                    for (o = 0; o < a.length; o++) n = a[o], r.setRangeBorder(n, t.value)
                }, t.prototype.setRangeBorder = function(e, t) {
                    var i = this.Ov,
                        o = e.row,
                        n = e.col,
                        r = e.rowCount,
                        a = e.colCount;
                    i.getRange(o, n, r, a).setBorder(t.lineborder, t.options)
                }, t
            }(te), Qe = { canUndo: !0, execute: function(e, t, i) { var o = new Ye(e, t); return o.execute(e, t, i) } };

            function zr(e, t) { kr(e, "setBorder", Qe, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setBorder = zr, Ze = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s = this,
                        l = s.getSelections();
                    for (o = 0; o < l.length; o++) n = l[o], r = t.borderType, a = t.orignalBorder, s.borderLineEquals(r.topLineBorder, a.borderTop) || s.setRangeBorder(n, { lineborder: r.topLineBorder, options: { top: !0 } }), s.borderLineEquals(r.bottomLineBorder, a.borderBottom) || s.setRangeBorder(n, { lineborder: r.bottomLineBorder, options: { bottom: !0 } }), s.borderLineEquals(r.rightLineBorder, a.borderRight) || s.setRangeBorder(n, { lineborder: r.rightLineBorder, options: { right: !0 } }), s.borderLineEquals(r.leftLineBorder, a.borderLeft) || s.setRangeBorder(n, { lineborder: r.leftLineBorder, options: { left: !0 } }), s.borderLineEquals(r.innerHorizontalLineBorder, a.borderHorizontal) || s.setRangeBorder(n, { lineborder: r.innerHorizontalLineBorder, options: { innerHorizontal: !0 } }), s.borderLineEquals(r.innerVerticalLineBorder, a.borderVertical) || s.setRangeBorder(n, { lineborder: r.innerVerticalLineBorder, options: { innerVertical: !0 } }), s.borderLineEquals(r.diagonalUpBorder, a.diagonalUpBorder) || s.setRangeBorder(n, { lineborder: r.diagonalUpBorder, options: { diagonalUp: !0 } }), s.borderLineEquals(r.diagonalDownBorder, a.diagonalDownBorder) || s.setRangeBorder(n, { lineborder: r.diagonalDownBorder, options: { diagonalDown: !0 } })
                }, t.prototype.borderLineEquals = function(e, t) { return e === t || !(!e || !t) && (e.style === t.style && e.level === t.level && e.color === t.color) }, t.prototype.setRangeBorder = function(e, t) {
                    var i = this.Ov,
                        o = e.row,
                        n = e.col,
                        r = e.rowCount,
                        a = e.colCount;
                    i.getRange(o, n, r, a).setBorder(t.lineborder, t.options)
                }, t
            }(te), et = { canUndo: !0, execute: function(e, t, i) { var o = new Ze(e, t); return o.execute(e, t, i) } };

            function Mr(e, t) { kr(e, "setAllBorder", et, { orignalBorder: t.options.orignalBorder, borderType: t.options.borderType, selections: t.selections, sheetName: t.sheetName }) } e.setAllBorder = Mr, tt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setIndent(t), o.updateRibbon()
                }, t.prototype.setIndent = function(e) {
                    var t = this;
                    t.execInSelections(t.Ov, function(t, i, o) {
                        var n, a, s = t.getStyle(i, o);
                        s || (s = new r.Style), n = s.textIndent, isNaN(n) && (n = 0), a = n + e.value, a < 0 && (a = 0), s.textIndent = a, t.setStyle(i, o, s)
                    })
                }, t
            }(te), it = { canUndo: !0, execute: function(e, t, i) { var o = new tt(e, t); return o.execute(e, t, i) } };

            function Vr(e, t) { kr(e, "setIndent", it, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setIndent = Vr, ot = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("isVerticalText", "isVerticalText", t.value, t), o.updateRibbon()
                }, t
            }(te), nt = { canUndo: !0, execute: function(e, t, i) { var o = new ot(e, t); return o.execute(e, t, i) } };

            function Gr(e, t) { kr(e, "setTextVertical", nt, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setTextVertical = Gr, rt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("wordWrap", "wordWrap", t.value, t), o.updateRibbon()
                }, t
            }(te), at = { canUndo: !0, execute: function(e, t, i) { var o = new rt(e, t); return o.execute(e, t, i) } };

            function jr(e, t) { kr(e, "setWordWrap", at, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setWordWrap = jr, st = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() {
                    var e, t, i = !0,
                        o = this.getSelections(),
                        n = o.length;
                    for (e = 0; e < n; e++) {
                        for (t = e + 1; t < n; t++)
                            if (o[e].intersect(o[t].row, o[t].col, o[t].rowCount, o[t].colCount)) { i = !1; break } if (!i) break
                    }
                    return i
                }, t.prototype.executeImp = function(e, t, i) {
                    var o, n, a, s, l, c = this,
                        d = c.getSelections();
                    for (o = 0; o < d.length; o++) n = d[o], a = -1 === n.row ? 0 : n.row, s = -1 === n.col ? 0 : n.col, c.Ov.addSpan(a, s, n.rowCount, n.colCount), l = c.Ov.getStyle(a, s), l || (l = new r.Style), l.hAlign = 1, c.Ov.setStyle(a, s, l)
                }, t
            }(te), lt = { canUndo: !0, execute: function(e, t, i) { var o = new st(e, t); return o.execute(e, t, i) } };

            function Hr(e, t) { kr(e, "mergeCenter", lt, { selections: t.selections, sheetName: t.sheetName }) } e.mergeCenter = Hr, ct = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s, l, c, d = this,
                        p = d.getSelections();
                    for (o = 0; o < p.length; o++) {
                        for (n = p[o], r = -1 === n.row ? 0 : n.row, a = -1 === n.col ? 0 : n.col, s = 0; s < n.rowCount; s++)
                            for (l = 0; l < n.colCount; l++) d.Ov.removeSpan(r + s, a + l);
                        for (c = 0; c < n.rowCount; c++) d.Ov.addSpan(r + c, a, 1, n.colCount)
                    }
                }, t
            }(te), dt = { canUndo: !0, execute: function(e, t, i) { var o = new ct(e, t); return o.execute(e, t, i) } };

            function Wr(e, t) { kr(e, "mergeAcross", dt, { selections: t.selections, sheetName: t.sheetName }) } e.mergeAcross = Wr, pt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s = this,
                        l = s.getSelections();
                    for (o = 0; o < l.length; o++) n = l[o], r = -1 === n.row ? 0 : n.row, a = -1 === n.col ? 0 : n.col, s.Ov.addSpan(r, a, n.rowCount, n.colCount)
                }, t
            }(te), ut = { canUndo: !0, execute: function(e, t, i) { var o = new pt(e, t); return o.execute(e, t, i) } };

            function Ur(e, t) { kr(e, "mergeCells", ut, { selections: t.selections, sheetName: t.sheetName }) } e.mergeCells = Ur, ht = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s, l, c = this,
                        d = c.getSelections();
                    for (o = 0; o < d.length; o++)
                        for (n = d[o], r = -1 === n.row ? 0 : n.row, a = -1 === n.col ? 0 : n.col, s = 0; s < n.rowCount; s++)
                            for (l = 0; l < n.colCount; l++) c.Ov.removeSpan(r + s, a + l)
                }, t
            }(te), ft = { canUndo: !0, execute: function(e, t, i) { var o = new ht(e, t); return o.execute(e, t, i) } };

            function qr(e, t) { kr(e, "unmergeCells", ft, { selections: t.selections, sheetName: t.sheetName }) } e.unmergeCells = qr, gt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canDoInsertOrDeleteRow = function() { return !0 }, t.prototype.canDoInsertOrDeleteColumn = function() { return !0 }, t.prototype.getSortedRowSelections = function() {
                    var e, t, i, o = this.getSelections();
                    for (e = 0; e < o.length - 1; e++)
                        for (t = e + 1; t < o.length; t++) o[e].row < o[t].row && (i = o[e], o[e] = o[t], o[t] = i);
                    return o
                }, t.prototype.getSortedColumnSelections = function() {
                    var e, t, i, o = this.getSelections();
                    for (e = 0; e < o.length - 1; e++)
                        for (t = e + 1; t < o.length; t++) o[e].col < o[t].col && (i = o[e], o[e] = o[t], o[t] = i);
                    return o
                }, t
            }(te), e.InsertAndDeleteBase = gt, mt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { var n, r, a, s, l, c = this; if (3 === ts(c.getSelections())) { if (n = c.getSortedColumnSelections(), r = c.Ov.getColumnCount(), !c.canInsertRight(n)) return i.MessageBox.show(i.res.changePartOfArrayWarning, i.res.title, 2, 0, function() { $(".fill-content").focus() }), !1; for (a = 0; a < n.length; a++) s = n[a], l = GC.Spread.Sheets.CopyToOptions.all, c.Ov.addColumns(r, s.colCount), c.Ov.moveTo(s.row, s.col, s.row, s.col + s.colCount, s.rowCount, r - s.col, l) } }, t.prototype.canInsertRight = function(e) {
                    var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g = this.Ov,
                        m = !0;
                    for (t = 0; t < e.length; t++) {
                        for (i = e[t], o = [], n = i.row, r = i.col, a = i.row + i.rowCount, s = i.col + i.colCount, l = n; l < a; l++)
                            for (c = r; c < s; c++) {
                                for (d = 0; d < o.length && !o[d].contains(l, c); d++);
                                d === o.length && g.getFormulaInformation(l, c).isArrayFormula && o.push(g.getFormulaInformation(l, c).baseRange)
                            }
                        if (0 === o.length) return m;
                        for (p = o[0].col, u = o[0].row, h = o[0].row + o[0].rowCount, f = 1; f < o.length; f++) o[f].col < p && (p = o[f].col), o[f].row < u && (u = o[f].row), o[f].row + o[f].rowCount < h && (h = o[f].row + o[f].rowCount);
                        if (p < i.col || u < i.row || h > i.row + i.rowCount) { m = !1; break }
                    }
                    return m
                }, t
            }(gt), bt = { canUndo: !0, execute: function(e, t, i) { var o = new mt(e, t); return o.execute(e, t, i) } };

            function _r(e, t) { kr(e, "insertRightCells", bt, { selections: t.selections, sheetName: t.sheetName }) } e.insertRightCells = _r, vt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) { var n, r, a, s, l, c = this; if (3 === ts(c.getSelections())) { if (n = c.getSortedRowSelections(), r = c.Ov.getRowCount(), !c.canInsertDown(n)) return i.MessageBox.show(i.res.changePartOfArrayWarning, i.res.title, 2, 0, function() { $(".fill-content").focus() }), !1; for (a = 0; a < n.length; a++) s = n[a], l = GC.Spread.Sheets.CopyToOptions.all, c.Ov.addRows(r, s.rowCount), c.Ov.moveTo(s.row, s.col, s.row + s.rowCount, s.col, r - s.row, s.colCount, l) } }, t.prototype.canInsertDown = function(e) {
                    var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g = this.Ov,
                        m = !0;
                    for (t = 0; t < e.length; t++) {
                        for (i = e[t], o = [], n = i.row, r = i.col, a = i.row + i.rowCount, s = i.col + i.colCount, l = n; l < a; l++)
                            for (c = r; c < s; c++) {
                                for (d = 0; d < o.length && !o[d].contains(l, c); d++);
                                d === o.length && g.getFormulaInformation(l, c).isArrayFormula && o.push(g.getFormulaInformation(l, c).baseRange)
                            }
                        if (0 === o.length) return m;
                        for (p = o[0].col, u = o[0].row, h = o[0].col + o[0].colCount, f = 1; f < o.length; f++) o[f].col < p && (p = o[f].col), o[f].row < u && (u = o[f].row), o[f].col + o[f].colCount < h && (h = o[f].row + o[f].rowCount);
                        if (p < i.col || u < i.row || h > i.col + i.colCount) { m = !1; break }
                    }
                    return m
                }, t
            }(gt), yt = { canUndo: !0, execute: function(e, t, i) { var o = new vt(e, t); return o.execute(e, t, i) } };

            function Kr(e, t) { kr(e, "insertDownCells", yt, { selections: t.selections, sheetName: t.sheetName }) } e.insertDownCells = Kr, wt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = this,
                        s = a.getSortedColumnSelections();
                    for (o = 0; o < s.length; o++) n = s[o], r = GC.Spread.Sheets.CopyToOptions.all, a.Ov.moveTo(n.row, n.col + n.colCount, n.row, n.col, n.rowCount, a.Ov.getColumnCount() - (n.col + n.colCount), r)
                }, t
            }(gt), xt = { canUndo: !0, execute: function(e, t, i) { var o = new wt(e, t); return o.execute(e, t, i) } };

            function Xr(e, t) { kr(e, "deleteLeftCells", xt, { selections: t.selections, sheetName: t.sheetName }) } e.deleteLeftCells = Xr, Ct = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = this,
                        s = a.getSortedRowSelections();
                    for (o = 0; o < s.length; o++) n = s[o], r = GC.Spread.Sheets.CopyToOptions.all, a.Ov.moveTo(n.row + n.rowCount, n.col, n.row, n.col, a.Ov.getRowCount() - (n.row + n.rowCount), n.colCount, r)
                }, t
            }(gt), St = { canUndo: !0, execute: function(e, t, i) { var o = new Ct(e, t); return o.execute(e, t, i) } };

            function Jr(e, t) { kr(e, "deleteUpCells", St, { selections: t.selections, sheetName: t.sheetName }) } e.deleteUpCells = Jr, kt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { return this.canDoInsertOrDeleteRow() }, t.prototype.executeImp = function(e, t, o) {
                    var n, r = this,
                        a = r.getSortedRowSelections();
                    for (n = 0; n < a.length; n++) - 1 === a[n].row && 0 === a[n].rowCount && (a[n].row = 0, a[n].rowCount = 1), r.Ov.addRows(a[n].row, a[n].rowCount), i.util.setSpanStyleWhenInsertRowsColumns(r.Ov, a[n].row, -1, a[n].rowCount)
                }, t
            }(gt), Tt = { canUndo: !0, execute: function(e, t, i) { var o = new kt(e, t); return o.execute(e, t, i) } };

            function Yr(e, t) { kr(e, "insertRows", Tt, { selections: t.selections, sheetName: t.sheetName }) } e.insertRows = Yr, At = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { return this.canDoInsertOrDeleteRow() && !this.YB() }, t.prototype.executeImp = function(e, t, i) {
                    var o, n = this,
                        r = n.getSortedRowSelections();
                    for (o = 0; o < r.length; o++) n.Ov.deleteRows(r[o].row, r[o].rowCount)
                }, t.prototype.YB = function() {
                    var e, t, i = this,
                        o = i.getSortedRowSelections(),
                        n = i.Ov.tables.all();
                    for (e in n)
                        for (t in o)
                            if (n[e].headerIndex() === o[t].row) return !0;
                    return !1
                }, t
            }(gt), Et = { canUndo: !0, execute: function(e, t, i) { var o = new At(e, t); return o.execute(e, t, i) } };

            function Qr(e, t) { kr(e, "deleteRows", Et, { selections: t.selections, sheetName: t.sheetName }) } e.deleteRows = Qr, It = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { return this.canDoInsertOrDeleteColumn() }, t.prototype.executeImp = function(e, t, o) {
                    var n, r = this,
                        a = r.getSortedColumnSelections();
                    for (n = 0; n < a.length; n++) - 1 === a[n].col && 0 === a[n].colCount && (a[n].col = 0, a[n].colCount = 1), r.Ov.addColumns(a[n].col, a[n].colCount), i.util.setSpanStyleWhenInsertRowsColumns(r.Ov, -1, a[n].col, a[n].colCount)
                }, t
            }(gt), Dt = { canUndo: !0, execute: function(e, t, i) { var o = new It(e, t); return o.execute(e, t, i) } };

            function Zr(e, t) { kr(e, "insertColumns", Dt, { selections: t.selections, sheetName: t.sheetName }) } e.insertColumns = Zr, $t = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { return this.canDoInsertOrDeleteColumn() }, t.prototype.executeImp = function(e, t, i) {
                    var o, n = this,
                        r = n.getSortedColumnSelections();
                    for (o = 0; o < r.length; o++) n.Ov.deleteColumns(r[o].col, r[o].colCount)
                }, t
            }(gt), Lt = { canUndo: !0, execute: function(e, t, i) { var o = new $t(e, t); return o.execute(e, t, i) } };

            function ea(e, t) { kr(e, "deleteColumns", Lt, { selections: t.selections, sheetName: t.sheetName }) } e.deleteColumns = ea, Ft = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.execute = function(e, t, o) { var n = this; return !!n.canExecute() && (n.spread().addSheet(n.spread().getSheetIndex(n.sheet().name())), i.actions.isFileModified = !0, !0) }, t
            }(te), Rt = { canUndo: !1, execute: function(e, t, i) { var o = new Ft(e, t); return o.execute(e, t, i) } };

            function ta(e, t) { kr(e, "insertSheet", Rt, { selections: t.selections, sheetName: t.sheetName }) } e.insertSheet = ta, Bt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { return this.spread().getSheetCount() > 1 }, t.prototype.executeImp = function(e, t, o) {
                    var n = this;
                    if (!(n.spread().getSheetCount() > 1)) return i.MessageBox.show(i.res.contextMenu.comments, i.res.title, 2, 0), !1;
                    n.spread().removeSheet(n.spread().getSheetIndex(n.sheet().name())), i.actions.isFileModified = !0, n.spread().undoManager().clear()
                }, t
            }(te), Ot = { canUndo: !1, execute: function(e, t, i) { var o = new Bt(e, t); return o.execute(e, t, i) } };

            function ia(e, t) { kr(e, "deleteSheet", Ot, { selections: t.selections, sheetName: t.sheetName }) } e.deleteSheet = ia, Pt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.ZB = function() {
                    var e, t, i = this,
                        o = i.Ov.pictures.all(),
                        n = o.length,
                        r = "",
                        a = [];
                    for (e = 0; e < n; e++) a.push(o[e].name());
                    for (t = 0; t < n; t++)
                        if (r = "picture" + t, $.inArray(r, a) < 0) return r;
                    return r = "picture" + n
                }, t.prototype.$B = function(e) {
                    var t, o, n = this,
                        r = e.activeRowIndex,
                        a = e.activeColIndex,
                        s = e.rowHeight,
                        l = e.colWidth;
                    try { t = n.ZB(), o = e.fileName, n.Ov.pictures.add(t, o, a * l, r * s), i.actions.isFileModified = !0 } catch (e) {}
                }, t.prototype.executeImp = function(e, t, i) { this.$B(t) }, t
            }(te), Nt = { canUndo: !0, execute: function(e, t, i) { var o = new Pt(e, t); return o.execute(e, t, i) } };

            function oa(e, t) {
                var i = t.sheet,
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex(),
                    r = i.defaults.rowHeight,
                    a = i.defaults.colWidth;
                kr(e, "insertPicture", Nt, { selections: t.selections, sheetName: t.sheetName, activeRowIndex: o, activeColIndex: n, fileName: t.options, rowHeight: r, colWidth: a })
            }
            e.insertPicture = oa, zt = [], Mt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() {
                    var e, t, o = this,
                        n = o.spread().sheets,
                        r = 0;
                    for (e = 0; e < n.length; e++) n[e].visible() && r++;
                    if (t = r >= 2) return t;
                    i.MessageBox.show(i.res.contextMenu.comments, i.res.title, 2, 0)
                }, t.prototype.executeImp = function(e, t, o) {
                    var n = this;
                    n.Ov && (zt.push(n.Ov), n.Ov.visible(!1), i.wrapper.setFocusToSpread(), i.actions.isFileModified = !0, i.wrapper.spread.undoManager().clear())
                }, t
            }(te), Vt = { canUndo: !1, execute: function(e, t, i) { var o = new Mt(e, t); return o.execute(e, t, i) } };

            function na(e, t) { kr(e, "hideSheet", Vt, { selections: t.selections, sheetName: t.sheetName }) } e.hideSheet = na, Gt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i), this._B = this.spread().sheets }
                return t.prototype.canExecute = function() {
                    var e, t = this,
                        i = t._B.length;
                    for (e = 0; e < i; e++)
                        if (!t._B[e].visible()) return !0;
                    return !1
                }, t.prototype.executeImp = function(e, t, o) {
                    var n, r, a, s = this,
                        l = s.spread();
                    if (0 === zt.length)
                        for (n = l.sheets, r = 0; r < n.length; r++) n[r].visible() || zt.push(n[r]);
                    zt.length > 0 && (a = zt.pop(), a.visible(!0), l.setActiveSheet(a.name()), i.actions.isFileModified = !0), i.wrapper.setFocusToSpread()
                }, t
            }(te), jt = { canUndo: !0, execute: function(e, t, i) { var o = new Gt(e, t); return o.execute(e, t, i) } };

            function ra(e, t) { kr(e, "unhideSheet", jt, { selections: t.selections, sheetName: t.sheetName }) } e.unhideSheet = ra, Ht = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForRow(o.Ov, function(e, i) { o.Ov.setRowHeight(i, t.height), n[i] = !0 })
                }, t
            }(te), Wt = { canUndo: !0, execute: function(e, t, i) { var o = new Ht(e, t); return o.execute(e, t, i) } };

            function aa(e, t) { kr(e, "setRowsHeight", Wt, { height: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setRowsHeight = aa, Ut = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForRow(o.Ov, function(e, t) { o.Ov.autoFitRow(t), n[t] = !1 })
                }, t
            }(te), qt = { canUndo: !0, execute: function(e, t, i) { var o = new Ut(e, t); return o.execute(e, t, i) } };

            function sa(e, t) { kr(e, "autofitRows", qt, { selections: t.selections, sheetName: t.sheetName }) } e.autofitRows = sa, _t = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForRow(o.Ov, function(e, t) { o.Ov.setRowVisible(t, !1) })
                }, t
            }(te), Kt = { canUndo: !0, execute: function(e, t, i) { var o = new _t(e, t); return o.execute(e, t, i) } };

            function la(e, t) { kr(e, "hideRows", Kt, { selections: t.selections, sheetName: t.sheetName }) } e.hideRows = la, Xt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }

                function o(e, t) { e.setRowVisible(t, !0) }
                return t.prototype.executeImp = function(e, t, i) {
                    var n, r, a, s = this,
                        l = s.Ov,
                        c = s.getSelections();
                    if (1 === c.length && 1 === c[0].rowCount) {
                        for (n = c[0], r = 0, a = 0; a <= n.row; a++)
                            if (l.getRowVisible(a)) { r = a; break } n.row !== r && 0 === r || (l.setRowVisible(r - 1, !0), l.showRow(r - 1))
                    } else s.execInSelectionsForRow(l, o)
                }, t
            }(te), Jt = { canUndo: !0, execute: function(e, t, i) { var o = new Xt(e, t); return o.execute(e, t, i) } };

            function ca(e, t) { kr(e, "unHideRows", Jt, { selections: t.selections, sheetName: t.sheetName }) } e.unHideRows = ca, Yt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.defaults.rowHeight = t.height
                }, t
            }(te), Qt = { canUndo: !0, execute: function(e, t, i) { var o = new Yt(e, t); return o.execute(e, t, i) } };

            function da(e, t) { kr(e, "defaultRowHeight", Qt, { height: t.options, selections: t.selections, sheetName: t.sheetName }) } e.defaultRowHeight = da, Zt = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCol(o.Ov, function(e, i) { o.Ov.setColumnWidth(i, t.width) })
                }, t
            }(te), ei = { canUndo: !0, execute: function(e, t, i) { var o = new Zt(e, t); return o.execute(e, t, i) } };

            function pa(e, t) { kr(e, "setColumnsWidth", ei, { width: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setColumnsWidth = pa, ti = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCol(o.Ov, function(e, t) { o.Ov.autoFitColumn(t) })
                }, t
            }(te), ii = { canUndo: !0, execute: function(e, t, i) { var o = new ti(e, t); return o.execute(e, t, i) } };

            function ua(e, t) { kr(e, "autofitColumns", ii, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.autofitColumns = ua, oi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCol(o.Ov, function(e, t) { o.Ov.setColumnVisible(t, !1) })
                }, t
            }(te), ni = { canUndo: !0, execute: function(e, t, i) { var o = new oi(e, t); return o.execute(e, t, i) } };

            function ha(e, t) { kr(e, "hideColumns", ni, { selections: t.selections, sheetName: t.sheetName }) } e.hideColumns = ha, ri = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }

                function o(e, t) { e.setColumnVisible(t, !0) }
                return t.prototype.executeImp = function(e, t, i) {
                    var n, r, a, s = this,
                        l = s.Ov,
                        c = s.getSelections();
                    if (1 === c.length && 1 === c[0].colCount) {
                        for (n = c[0], r = 0, a = 0; a <= n.col; a++)
                            if (l.getColumnVisible(a)) { r = a; break } n.col !== r && 0 === r || (l.setColumnVisible(r - 1, !0), l.showColumn(r - 1))
                    } else s.execInSelectionsForCol(l, o)
                }, t
            }(te), ai = { canUndo: !0, execute: function(e, t, i) { var o = new ri(e, t); return o.execute(e, t, i) } };

            function fa(e, t) { kr(e, "unHideColumns", ai, { selections: t.selections, sheetName: t.sheetName }) } e.unHideColumns = fa, si = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.defaults.colWidth = t.width
                }, t
            }(te), li = { canUndo: !0, execute: function(e, t, i) { var o = new si(e, t); return o.execute(e, t, i) } };

            function ga(e, t) { kr(e, "defaultColumnWidth", li, { width: t.options, selections: t.selections, sheetName: t.sheetName }) } e.defaultColumnWidth = ga;

            function ma(e, i) { kr(e, "protectSheet", t[x], { value: i.options, selections: i.selections, sheetName: i.sheetName }) } e.protectSheet = ma;

            function ba(e, i) { kr(e, "confirmProtectSheet", t[C], { value: i.options, selections: i.selections, sheetName: i.sheetName }) } e.confirmProtectSheet = ba, ci = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelections(o.Ov, function(e, i, o) {
                        var n = e.getStyle(i, o);
                        n || (n = new r.Style), n.locked = t.value, e.setStyle(i, o, n)
                    })
                }, t
            }(te), di = { canUndo: !0, execute: function(e, t, i) { var o = new ci(e, t); return o.execute(e, t, i) } };

            function va(e, t) { kr(e, "LockCells", di, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.LockCells = va, pi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, a, s, l, c, d = this,
                        p = d.getSelections();
                    if ($.isArray(t.value))
                        for (n = t.value, o = 0; o < n.length; o++) d.sheet().fillAuto(n[o].startRange, n[o].wholeRange, n[o].fillAutoOptions);
                    else
                        for (o = 0; o < p.length; o++) {
                            switch (a = p[o], t.value) {
                                case 3:
                                    s = new r.Range(a.row, a.col, 1, a.colCount);
                                    break;
                                case 2:
                                    l = a.row, l = -1 === l ? d.Ov.getRowCount() - 1 : a.row + a.rowCount - 1, s = new r.Range(l, a.col, 1, a.colCount);
                                    break;
                                case 1:
                                    s = new r.Range(a.row, a.col, a.rowCount, 1);
                                    break;
                                case 0:
                                    c = a.col, c = -1 === c ? d.Ov.getColumnCount() - 1 : a.col + a.colCount - 1, s = new r.Range(a.row, c, a.rowCount, 1)
                            }
                            d.sheet().fillAuto(s, a, { fillType: 0, direction: t.value })
                        }
                }, t
            }(te), ui = { canUndo: !0, execute: function(e, t, i) { var o = new pi(e, t); return o.execute(e, t, i) } };

            function ya(e, t) { kr(e, "autoFillByDirection", ui, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.autoFillByDirection = ya, hi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this,
                        n = o.sheet();
                    n.clear(0, 0, n.getRowCount(), n.getColumnCount(), 3, 51)
                }, t
            }(te), fi = { canUndo: !0, execute: function(e, t, i) { var o = new hi(e, t); return o.execute(e, t, i) } };

            function wa(e, t) { kr(e, "clearSheetAllCell", fi, { selections: t.selections, sheetName: t.sheetName }) } e.clearSheetAllCell = wa, gi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this,
                        a = r.getSelections();
                    for (o = 0; o < a.length; o++) n = a[o], r.sheet().clear(n.row, n.col, n.rowCount, n.colCount, 3, 119), r.clearSpansInSelection(r.Ov, n)
                }, t
            }(te), mi = { canUndo: !0, execute: function(e, t, i) { var o = new gi(e, t); return o.execute(e, t, i) } };

            function xa(e, t) { kr(e, "clearAll", mi, { selections: t.selections, sheetName: t.sheetName }) } e.clearAll = xa, bi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this,
                        a = r.getSelections();
                    for (o = 0; o < a.length; o++) n = a[o], r.Ov.clear(n.row, n.col, n.rowCount, n.colCount, 3, 2), r.clearSpansInSelection(r.Ov, n)
                }, t
            }(te), vi = { canUndo: !0, execute: function(e, t, i) { var o = new bi(e, t); return o.execute(e, t, i) } };

            function Ca(e, t) { kr(e, "clearFormat", vi, { selections: t.selections, sheetName: t.sheetName }) } e.clearFormat = Ca, yi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this,
                        a = r.getSelections();
                    for (o = 0; o < a.length; o++) n = a[o], r.Ov.clear(n.row, n.col, n.rowCount, n.colCount, 3, 1)
                }, t
            }(te), wi = { canUndo: !0, execute: function(e, t, i) { var o = new yi(e, t); return o.execute(e, t, i) } };

            function Sa(e, t) { kr(e, "clearContent", wi, { selections: t.selections, sheetName: t.sheetName }) } e.clearContent = Sa, xi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this,
                        a = r.getSelections();
                    for (o = 0; o < a.length; o++) n = a[o], r.sheet().clear(n.row, n.col, n.rowCount, n.colCount, 3, 4)
                }, t
            }(te), Ci = { canUndo: !0, execute: function(e, t, i) { var o = new xi(e, t); return o.execute(e, t, i) } };

            function ka(e, t) { kr(e, "clearComments", Ci, { selections: t.selections, sheetName: t.sheetName }) } e.clearComments = ka, Si = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r = this,
                        a = r.getSelections();
                    if (a && 0 !== a.length) {
                        if (a.length > 1) return i.MessageBox.show(i.res.NotExecInMultiRanges, i.res.title, 3), !1;
                        n = a[0], r.Ov.sortRange(n.row, n.col, n.rowCount, n.colCount, !0, [{ index: -1 === n.col ? 0 : n.col, ascending: t.value }])
                    }
                }, t
            }(te), ki = { canUndo: !0, execute: function(e, t, i) { var o = new Si(e, t); return o.execute(e, t, i) } };

            function Ta(e, t) { kr(e, "sortRange", ki, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.sortRange = Ta, Ti = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, a = this,
                        s = a.getSelections();
                    return s.length > 1 ? (i.MessageBox.show(i.res.NotExecInMultiRanges, i.res.title, 3), !1) : (n = s[0], a.Ov.rowFilter() ? void(t.isRibbonFilter ? (a.Ov.rowFilter().unfilter(), a.Ov.rowFilter(null)) : (a.Ov.rowFilter().unfilter(), a.Ov.rowFilter(new r.Filter.HideRowFilter(n)))) : void a.Ov.rowFilter(new r.Filter.HideRowFilter(n)))
                }, t
            }(te), Ai = { canUndo: !0, execute: function(e, t, i) { var o = new Ti(e, t); return o.execute(e, t, i) } };

            function Aa(e, t) { kr(e, "setRowFilter", Ai, { isRibbonFilter: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setRowFilter = Aa, Ei = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { var e = this; return !(!e.Ov.rowFilter() || !e.Ov.rowFilter().isFiltered()) }, t.prototype.executeImp = function(e, t, i) { this.Ov.rowFilter().unfilter() }, t
            }(te), Ii = { canUndo: !0, execute: function(e, t, i) { var o = new Ei(e, t); return o.execute(e, t, i) } };

            function Ea(e, t) { kr(e, "clearRowFilter", Ii, { selections: t.selections, sheetName: t.sheetName }) } e.clearRowFilter = Ea, Di = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.canExecute = function() { var e = this; return !(!e.Ov.rowFilter() || !e.Ov.rowFilter().isFiltered()) }, t.prototype.executeImp = function(e, t, i) { this.Ov.rowFilter().filter() }, t
            }(te), $i = { canUndo: !0, execute: function(e, t, i) { var o = new Di(e, t); return o.execute(e, t, i) } };

            function Ia(e, t) { kr(e, "reApplyRowFilter(", $i, { selections: t.selections, sheetName: t.sheetName }) } e.reApplyRowFilter = Ia;

            function Da(e) {
                var t, i = e.getActiveSheet(),
                    o = i.name(),
                    n = e.commandManager(),
                    r = i.getSelections();
                r && 0 !== r.length && (t = r[0], n.execute({ cmd: "outlineRow", sheetName: o, index: t.row, count: t.rowCount }))
            }
            e.groupRows = Da;

            function $a(e) {
                var t, i = e.getActiveSheet(),
                    o = i.name(),
                    n = e.commandManager(),
                    r = i.getSelections();
                r && 0 !== r.length && (t = r[0], n.execute({ cmd: "outlineColumn", sheetName: o, index: t.col, count: t.colCount }))
            }
            e.groupColumns = $a;

            function La(e) {
                var t, i = e.getActiveSheet(),
                    o = i.name(),
                    n = e.commandManager(),
                    r = i.getSelections();
                r && 0 !== r.length && (t = r[0], n.execute({ cmd: "removeRowOutline", sheetName: o, index: t.row, count: t.rowCount }))
            }
            e.ungroupRows = La;

            function Fa(e) {
                var t, i = e.getActiveSheet(),
                    o = i.name(),
                    n = e.commandManager(),
                    r = i.getSelections();
                r && 0 !== r.length && (t = r[0], n.execute({ cmd: "removeColumnOutline", sheetName: o, index: t.col, count: t.colCount }))
            }
            e.ungroupColumns = Fa, Li = function(e) {
                i.extends(o, e);
                var t;

                function o(i, o) { e.call(this, i, o), t = this }
                return o.prototype.expandRowGroup = function(e, i, o) { t.ww.commandManager().execute({ cmd: "expandRowOutline", sheetName: t.Ov.name(), index: e, level: i, collapsed: o }) }, o.prototype.expandColumnGroup = function(e, i, o) { t.ww.commandManager().execute({ cmd: "expandColumnOutline", sheetName: t.Ov.name(), index: e, level: i, collapsed: o }) }, o.prototype.exec = function(e) {
                    var o, n, r, a, s, l, c;
                    if (this.getSelections().length > 1) return i.MessageBox.show("The command cannot be used on multiple selections", APP_NAME, 1, 0), !1;
                    if (o = this.getSelections()[0]) {
                        for (l = 0; l < o.rowCount; l++)
                            if (n = o.row + l, (r = e ? this.aC(this.Ov.rowOutlines, n) : this.bC(this.Ov.rowOutlines, n)) >= 0 && null != (a = this.Ov.rowOutlines.find(n, r))) { s = 1 === this.Ov.rowOutlines.direction() ? a.end + 1 : a.start - 1, this.expandRowGroup(s, r, e); break } for (c = 0; c < o.colCount; c++)
                            if (n = o.col + c, (r = e ? this.aC(this.Ov.columnOutlines, n) : this.bC(this.Ov.columnOutlines, n)) >= 0 && null != (a = this.Ov.columnOutlines.find(n, r))) { s = 1 === this.Ov.columnOutlines.direction() ? a.end + 1 : a.start - 1, t.expandColumnGroup(s, r, e); break }
                    }
                }, o
            }(te), Fi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { this.exec(!1) }, t.prototype.bC = function(e, t) { var i, o, n, r = e.getLevel(t); if (r <= 0) return r; for (i = -1, o = r; o >= 0; o--) n = e.find(t, o), 1 === n.state() && (i = o); return i }, t
            }(Li), Ri = { canUndo: !0, execute: function(e, t, i) { var o = new Fi(e, t); return o.execute(e, t, i) } };

            function Ra(e, t) { kr(e, "expandGroup", Ri, { selections: t.selections, sheetName: t.sheetName }) } e.expandGroup = Ra, Bi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { this.exec(!0) }, t.prototype.aC = function(e, t) {
                    var i, o, n = e.getLevel(t);
                    if (n <= 0) return n;
                    for (i = n; i >= 0; i--)
                        if (o = e.find(t, i), 0 === o.state()) return i;
                    return -1
                }, t
            }(Li), Oi = { canUndo: !0, execute: function(e, t, i) { var o = new Bi(e, t); return o.execute(e, t, i) } };

            function Ba(e, t) { kr(e, "collapseGroup", Oi, { selections: t.selections, sheetName: t.sheetName }) } e.collapseGroup = Ba, Pi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.options.rowHeaderVisible = !o.Ov.options.rowHeaderVisible
                }, t
            }(te), Ni = { canUndo: !1, execute: function(e, t, i) { var o = new Pi(e, t); return o.execute(e, t, i) } };

            function Oa(e, t) { kr(e, "showHideRowHeader", Ni, { selections: t.selections, sheetName: t.sheetName }) } e.showHideRowHeader = Oa, zi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.options.colHeaderVisible = !o.Ov.options.colHeaderVisible
                }, t
            }(te), Mi = { canUndo: !1, execute: function(e, t, i) { var o = new zi(e, t); return o.execute(e, t, i) } };

            function Pa(e, t) { kr(e, "showHideColumnHeader", Mi, { selections: t.selections, sheetName: t.sheetName }) } e.showHideColumnHeader = Pa, Vi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.options.gridline.showVerticalGridline = !o.Ov.options.gridline.showVerticalGridline
                }, t
            }(te), Gi = { canUndo: !1, execute: function(e, t, i) { var o = new Vi(e, t); return o.execute(e, t, i) } };

            function Na(e, t) { kr(e, "showHideVGridLine", Gi, { selections: t.selections, sheetName: t.sheetName }) } e.showHideVGridLine = Na, ji = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.options.gridline.showHorizontalGridline = !o.Ov.options.gridline.showHorizontalGridline
                }, t
            }(te), Hi = { canUndo: !1, execute: function(e, t, i) { var o = new ji(e, t); return o.execute(e, t, i) } };

            function za(e, t) { kr(e, "showHideHGridLine", Hi, { selections: t.selections, sheetName: t.sheetName }) } e.showHideHGridLine = za, Wi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.ww.options.tabStripVisible = !o.ww.options.tabStripVisible
                }, t
            }(te), Ui = { canUndo: !1, execute: function(e, t, i) { var o = new Wi(e, t); return o.execute(e, t, i) } };

            function Ma(e, t) { kr(e, "showHideTabStrip", Ui, { selections: t.selections, sheetName: t.sheetName }) } e.showHideTabStrip = Ma, qi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.ww.options.newTabVisible = !o.ww.options.newTabVisible
                }, t
            }(te), _i = { canUndo: !1, execute: function(e, t, i) { var o = new qi(e, t); return o.execute(e, t, i) } };

            function Va(e, t) { kr(e, "showHideNewTab", _i, { selections: t.selections, sheetName: t.sheetName }) } e.showHideNewTab = Va, Ki = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n = t.value;
                    this.Ov.zoom(n), i.ribbon.updateZoomToStatusBar()
                }, t.prototype.undoImp = function(e, t, o) { return e.suspendPaint(), GC.Spread.Sheets.Commands.undoTransaction(e, t), e.resumePaint(), i.ribbon.updateZoomToStatusBar(), !0 }, t
            }(te), Xi = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new Ki(e, t);
                    o.execute(e, t, i)
                }
            };

            function Ga(e, t) { kr(e, "zoom", Xi, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.zoom = Ga;

            function ja(e, t) { kr(e, "zoom", Xi, { value: 1, selections: t.selections, sheetName: t.sheetName }) } e.zoomDefault = ja;

            function Ha(e, t) {
                var o = e.getActiveSheet(),
                    n = i.actions.Ev();
                o.showCell(n.topRow, n.leftCol, 0, 0), n && kr(e, "zoom", Xi, { value: n.zoom, selections: t.selections, sheetName: t.sheetName })
            }
            e.zoomSelection = Ha, Ji = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    void 0 !== t.value.row && o.Ov.frozenRowCount(+t.value.row), void 0 !== t.value.col && o.Ov.frozenColumnCount(+t.value.col), void 0 !== t.value.trailingRow && o.Ov.frozenTrailingRowCount(+t.value.trailingRow), void 0 !== t.value.trailingCol && o.Ov.frozenTrailingColumnCount(+t.value.trailingCol)
                }, t
            }(te), Yi = { canUndo: !0, execute: function(e, t, i) { var o = new Ji(e, t); return o.execute(e, t, i) } };

            function Wa(e, t) { kr(e, "freeze", Yi, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.freeze = Wa, Qi = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Ov.frozenRowCount(0), o.Ov.frozenColumnCount(0), o.Ov.frozenTrailingColumnCount(0), o.Ov.frozenTrailingRowCount(0)
                }, t
            }(te), Zi = { canUndo: !0, execute: function(e, t, i) { var o = new Qi(e, t); return o.execute(e, t, i) } };

            function Ua(e, t) { kr(e, "unfreeze", Zi, { selections: t.selections, sheetName: t.sheetName }) } e.unfreeze = Ua;

            function qa(e) {} e.calculateNow = qa;

            function _a(e, t) {} e.autoCalculate = _a, eo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.setStyle("", t.value, t), o.updateRibbon()
                }, t.prototype.setStyle = function(e, t, i) {
                    var n = this,
                        r = n.Ov,
                        a = n.ww;
                    a.suspendPaint(), n.execInSelections(r, function(e, i, n) {
                        var r, a = t.clone(),
                            s = e.getStyle(i, n);
                        if (s)
                            for (r in s) "_id" !== r && a[r] === o && (a[r] = s[r]);
                        e.setStyle(i, n, a)
                    }), a.resumePaint()
                }, t
            }(te), to = { canUndo: !0, execute: function(e, t, i) { var o = new eo(e, t); return o.execute(e, t, i) } };

            function Ka(e, t) { kr(e, "setStyle", to, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setStyle = Ka, io = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelections(o.Ov, function(e, i, o) { e.setStyleName(i, o, t.value) })
                }, t
            }(te), oo = { canUndo: !0, execute: function(e, t, i) { var o = new io(e, t); return o.execute(e, t, i) } };

            function Xa(e, t) { kr(e, "setStyleByName", oo, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setStyleByName = Xa, no = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { this.spread().addNamedStyle(t.value) }, t
            }(te), ro = { canUndo: !0, execute: function(e, t, i) { var o = new no(e, t); return o.execute(e, t, i) } };

            function Ja(e, t) { kr(e, "addNameStyle", ro, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.addNamedStyle = Ja, ao = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this,
                        n = o.Ov,
                        r = t.value;
                    o.WB.forEach(function(e) { n.setDataValidator(e.row, e.col, e.rowCount, e.colCount, r) })
                }, t
            }(te), so = { canUndo: !0, execute: function(e, t, i) { var o = new ao(e, t); return o.execute(e, t, i) } };

            function Ya(e, t) { kr(e, "setDataValidation", so, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setDataValidation = Ya, lo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { this.spread().options.highlightInvalidData = !0 }, t
            }(te), co = { canUndo: !1, execute: function(e, t, i) { var o = new lo(e, t); return o.execute(e, t, i) } };

            function Qa(e, t) { kr(e, "circleInvalidData", co, { selections: t.selections, sheetName: t.sheetName }) } e.circleInvalidData = Qa, po = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { this.spread().options.highlightInvalidData = !1 }, t
            }(te), uo = { canUndo: !1, execute: function(e, t, i) { var o = new po(e, t); return o.execute(e, t, i) } };

            function Za(e, t) { kr(e, "unCircleInvalidData", uo, { selections: t.selections, sheetName: t.sheetName }) } e.unCircleInvalidData = Za,
                function(t) { t[t.Sheet = 0] = "Sheet", t[t.OnlyRow = 1] = "OnlyRow", t[t.OnlyColumn = 2] = "OnlyColumn", t[t.OnlyCells = 3] = "OnlyCells", t[t.Mixture = 4] = "Mixture", e.SelectionRangeType = t }(e.SelectionRangeType || {});

            function es(e) { var t = e.getActiveSheet().getSelections(); return ts(t) }

            function ts(e) {
                var t, i, o;
                for (i = 0; i < e.length; i++) {
                    if (o = e[i], -1 === o.col && -1 === o.row) return 0;
                    if (-1 === o.row) {
                        if (void 0 === t) t = 2;
                        else if (2 != t) return 4
                    } else if (-1 === o.col) {
                        if (void 0 === t) t = 1;
                        else if (1 != t) return 4
                    } else if (void 0 === t) t = 3;
                    else if (3 != t) return 4
                }
                return t
            }
            e.getSelectionType = es, ho = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelections(o.Ov, function(e, i, o) {
                        var n = e.getStyle(i, o);
                        n || (n = new r.Style), n.cellType = t.value, e.setStyle(i, o, n)
                    })
                }, t
            }(te), fo = { canUndo: !0, execute: function(e, t, i) { var o = new ho(e, t); return o.execute(e, t, i) } };

            function is(e, t) { kr(e, "setCellType", fo, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setCellType = is, go = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var n = this;
                    n.execInSelections(n.Ov, function(e, t, i) {
                        var n = e.getStyle(t, i);
                        n || (n = new r.Style), n.cellType = o, e.setStyle(t, i, n)
                    })
                }, t
            }(te), mo = { canUndo: !0, execute: function(e, t, i) { var o = new go(e, t); return o.execute(e, t, i) } };

            function os(e, t) { kr(e, "clearCellType", mo, { selections: t.selections, sheetName: t.sheetName }) } e.clearCellType = os, bo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this;
                    if (r.Ov.suspendCalcService(), 3 === ts(r.getSelections()))
                        for (o = r.getSelections(), n = 0; n < o.length; n++) o[n].row + o[n].rowCount !== r.Ov.getRowCount() && r.cC(o[n], t.formulaName);
                    r.Ov.resumeCalcService()
                }, t.prototype.cC = function(e, t) { var i, o, n = this; for (i = 0; i < e.colCount; i++) o = l(e, 0, 0, GC.Spread.Sheets.CalcEngine.RangeReferenceRelative.allAbsolute), o = "=" + t + "(" + o + ")", n.Ov.setFormula(e.row + e.rowCount, e.col + i, o) }, t
            }(te), vo = { canUndo: !0, execute: function(e, t, i) { var o = new bo(e, t); return o.execute(e, t, i) } };

            function ns(e, t) { kr(e, "setAutoFormula", vo, { formulaName: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setAutoFormula = ns, yo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a = this,
                        s = t.value.locationRange,
                        l = t.value.formula;
                    if (s) {
                        if (1 !== s.rowCount || 1 !== s.colCount) return i.MessageBox.show(i.res.createSparklineDialog.notSingleCell, i.res.title, 2, 0), !1;
                        a.Ov.setFormula(s.row, s.col, l)
                    } else n = a.po.activeRowIndex, r = a.po.activeColIndex, l && a.Ov.setFormula(n, r, l)
                }, t
            }(te), wo = { canUndo: !0, execute: function(e, t, i) { var o = new yo(e, t); return o.execute(e, t, i) } };

            function rs(e, t) {
                var i = t.sheet,
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex();
                kr(e, "setFormulaSparklineWithoutDatarange", wo, { value: t.options, selections: t.selections, activeRowIndex: o, activeColIndex: n, sheetName: t.sheetName })
            }
            e.setFormulaSparklineWithoutDatarange = rs;

            function as(e, t, i, o) {
                var n = r.CalcEngine.formulaToRanges(e, t, i, o),
                    a = n[0],
                    s = a && a.ranges && a.ranges[0];
                return s ? { range: s, sheetName: a.sheetName } : null
            }
            xo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, w = this;
                    if (w.hi = t.value, n = t.value.locationRange, r = t.value.type, a = t.activeRowIndex, s = t.activeColumnIndex, l = t.value.formula, c = w.Ov, !(p = as(c, w.hi.dataRange, a, s))) return i.MessageBox.show(i.res.compatibleSparklineDialog.errorMessage, i.res.title, 2, 0), !1;
                    if (d = p.range, n) {
                        if (3 === r)
                            if (1 === n.colCount && n.rowCount === d.rowCount)
                                for (y = 0; y < d.rowCount; y++) c.setFormula(n.row + y, n.col, w.Ox(y));
                            else { if (1 !== n.rowCount || n.colCount !== d.colCount) return i.MessageBox.show(i.res.createSparklineDialog.warningText, i.res.title, 2, 0), !1; for (y = 0; y < d.colCount; y++) c.setFormula(n.row, n.col + y, w.Ox(y)) }
                        else if (void 0 !== i.MultiRangeFormulaType[i.FormulaSparklineType[r]]) w.fC(d, n);
                        else {
                            if (1 !== n.rowCount || 1 !== n.colCount) return i.MessageBox.show(i.res.createSparklineDialog.notSingleCell, i.res.title, 2, 0), !1;
                            c.setFormula(n.row, n.col, w.Ox())
                        }
                        c.setSelection(n.row, n.col, n.rowCount, n.colCount)
                    } else if (void 0 !== i.MultiRangeFormulaType[i.FormulaSparklineType[r]]) {
                        if (!(u = w.hi.parameterSets)) return !1;
                        if ((h = w.getSelections()) && h.length > 0) {
                            if (!(f = w.dC())) return i.MessageBox.show(i.res.multiCellFormula.warningText, i.res.title, 2, 0), !1;
                            g = h.length, m = 1 === g && 1 === h[0].rowCount && 1 === h[0].colCount, w.execInSelections(c, function(e, t, i) {
                                var o = w.eC(t, i, r, u, m);
                                o && e.setFormula(t, i, o)
                            })
                        }
                    } else {
                        if (b = t.activeRowIndex, v = t.activeColumnIndex, 3 === r && 1 !== d.rowCount && 1 !== d.colCount) return i.MessageBox.show(i.res.createSparklineDialog.notSingleCell, i.res.title, 2, 0), !1;
                        l && c.setFormula(b, v, l)
                    }
                }, t.prototype.gC = function(e) {
                    var t, i, o = e.indexOf("="),
                        n = e.indexOf("(");
                    if (-1 === n) return null;
                    switch (n < o ? (i = 0, t = e.substr(i, n + 1)) : (i = -1 === o ? 0 : 1, t = e.substr(i, n - i)), t = t.toLowerCase()) {
                        case "piesparkline":
                            return 0;
                        case "areasparkline":
                            return 1;
                        case "scattersparkline":
                            return 2;
                        case "linesparkline":
                        case "columnsparkline":
                        case "winlosssparkline":
                            return 3;
                        case "bulletsparkline":
                            return 4;
                        case "spreadsparkline":
                            return 5;
                        case "stackedsparkline":
                            return 6;
                        case "hbarsparkline":
                            return 7;
                        case "vbarsparkline":
                            return 8;
                        case "variancesparkline":
                            return 9;
                        case "boxplotsparkline":
                            return 10;
                        case "cascadesparkline":
                            return 11;
                        case "paretosparkline":
                            return 12;
                        default:
                            return null
                    }
                }, t.prototype.dC = function() {
                    var e, t, i = this,
                        o = !1;
                    return i.execInSelections(i.Ov, function(n, r, a) {
                        var s, l = n.getFormulaInformation(r, a);
                        if (l.hasFormula)
                            if (o) { if (s = i.gC(l.formula), t !== s || e.isArrayFormula !== l.isArrayFormula) return !1 } else e = l, t = i.gC(e.formula), o = !0
                    }), o
                }, t.prototype.eC = function(e, t, o, n, r) {
                    var a, s, l, c, d, p = i.util.parseFormulaSparkline(e, t);
                    if (!p || !p.arguments) return null;
                    if (!(a = p.arguments) || a.length <= 0) return null;
                    switch (s = "", o) {
                        case 11:
                            s += "CASCADESPARKLINE", r || (n[1] = i.util.unParseFormula(a[1], e, t));
                            break;
                        case 12:
                            s += "PARETOSPARKLINE", r || (n[1] = i.util.unParseFormula(a[1], e, t))
                    }
                    for (l = "", c = 0; c < n.length; c++) d = n[c], l += void 0 !== d && null !== d ? d + "," : ",";
                    return l = this.px(l), s += "(" + l + ")"
                }, t.prototype.px = function(e) { for (var t = e.length; t > 0 && "," === e[t - 1];) t--; return e.substr(0, t) }, t.prototype.fC = function(e, t) {
                    var i, o, n, r = this,
                        a = 0,
                        s = 1,
                        l = 0,
                        c = "",
                        d = e.rowCount * e.colCount;
                    if (t.rowCount < t.colCount ? (i = !0, l = t.col, a = Math.min(d, t.colCount)) : (i = !1, l = t.row, a = Math.min(d, t.rowCount)), i)
                        for (o = l; o < l + a; o++) c = this.hC(s, i), r.Ov.setFormula(t.row, o, c), s++;
                    else
                        for (n = l; n < l + a; n++) c = this.hC(s, i), r.Ov.setFormula(n, t.col, c), s++
                }, t.prototype.hC = function(e, t) {
                    var i, o = this.hi.dataRange,
                        n = this.hi.type;
                    switch (n) {
                        case 11:
                            i = t ? "=CASCADESPARKLINE(" + o + "," + e + ",,,,,,true)" : "=CASCADESPARKLINE(" + o + "," + e + ",,,,,,false)";
                            break;
                        case 12:
                            i = t ? "=PARETOSPARKLINE(" + o + "," + e + ",,,,,,true)" : "=PARETOSPARKLINE(" + o + "," + e + ",,,,,,false)"
                    }
                    return i
                }, t.prototype.Ox = function(e) {
                    var t, o, n, a, s, l, c, d = this.hi.compatibleType,
                        p = this.hi.locationRange,
                        u = this.hi.dataRange,
                        h = this.po.activeRowIndex,
                        f = this.po.activeColumnIndex,
                        g = this.po.referenceStyle,
                        m = as(this.Ov, u, h, f);
                    if (!m) return null;
                    if (t = m.range, o = m.sheetName, 3 === (n = this.hi.type)) switch (c = t && 1 === t.colCount ? 0 : 1, t && (1 !== t.colCount && 1 !== t.rowCount && (c = 1 === p.colCount ? 1 : 0), s = 1 === p.rowCount && 1 !== p.colCount ? new r.Range(t.row, t.col + e, t.rowCount, 1) : 1 !== p.rowCount && 1 === p.colCount ? new r.Range(t.row + e, t.col, 1, t.colCount) : t), l = i.CEUtility.parseExternalRangeToString({ range: s }), o !== this.Ov.name() && (l = o + "!" + l), d) {
                        case "line":
                            a = "=LINESPARKLINE(" + l + "," + c + ")";
                            break;
                        case "column":
                            a = "=COLUMNSPARKLINE(" + l + "," + c + ")";
                            break;
                        case "winloss":
                            a = "=WINLOSSSPARKLINE(" + l + "," + c + ")"
                    } else switch (l = i.CEUtility.parseExternalRangeToString({ range: t }, p.row, p.col, g), o !== this.Ov.name() && (l = o + "!" + l), n) {
                        case 0:
                            a = "=PIESPARKLINE(" + l + ")";
                            break;
                        case 1:
                            a = "=AREASPARKLINE(" + l + ")";
                            break;
                        case 2:
                            a = "=SCATTERSPARKLINE(" + l + ")";
                            break;
                        case 5:
                            a = "=SPREADSPARKLINE(" + l + ")";
                            break;
                        case 6:
                            a = "=STACKEDSPARKLINE(" + l + ")";
                            break;
                        case 10:
                            a = "=BOXPLOTSPARKLINE(" + l + ")"
                    }
                    return a
                }, t
            }(te), Co = { canUndo: !0, execute: function(e, t, i) { var o = new xo(e, t); return o.execute(e, t, i) } };

            function ss(e, t) {
                var i = e.getSheetFromName(t.sheetName),
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex();
                kr(e, "setFormulaSparkline", Co, { value: t.options, selections: t.selections, sheetName: t.sheetName, activeRowIndex: o, activeColumnIndex: n, referenceStyle: e.options.referenceStyle })
            }
            e.setFormulaSparkline = ss, So = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, a, s, l, c, d, p, u, h, f, g, m, b = this;
                    if (b.hi = t.value, n = [], a = b.hi.dataRange, l = b.Ov.name(), c = b.hi.locationRange, d = t.activeRowIndex, p = t.activeColumnIndex, "string" == typeof a) {
                        if (!(u = as(b.Ov, a, d, p))) return !1;
                        a = u.range, s = u.sheetName
                    }
                    if (h = b.hi.sparklineType, f = b.hi.setting, 1 === c.colCount && c.rowCount === a.rowCount)
                        for (g = 0; g < a.rowCount; g++) m = b.Ov.setSparkline(c.row + g, c.col, new r.Range(a.row + g, a.col, 1, a.colCount), 1, h, new r.Sparklines.SparklineSetting(f)), s && s !== l && m.dataSheetName(s), n.push(m);
                    else { if (1 !== c.rowCount || c.colCount !== a.colCount) return i.MessageBox.show(i.res.createSparklineDialog.warningText, i.res.title, 2, 0), !1; for (g = 0; g < a.colCount; g++) m = b.Ov.setSparkline(c.row, c.col + g, new r.Range(a.row, a.col + g, a.rowCount, 1), 0, h, new r.Sparklines.SparklineSetting(f)), s && s !== l && m.dataSheetName(s), n.push(m) } b.Ov.groupSparkline(n), b.Ov.setSelection(c.row, c.col, c.rowCount, c.colCount)
                }, t
            }(te), ko = { canUndo: !0, execute: function(e, t, i) { var o = new So(e, t); return o.execute(e, t, i) } };

            function ls(e, t) {
                var i = e.getSheetFromName(t.sheetName),
                    o = i.getActiveRowIndex(),
                    n = i.getActiveColumnIndex();
                kr(e, "setDefaultSparkline", ko, { value: t.options, selections: t.selections, sheetName: t.sheetName, activeRowIndex: o, activeColumnIndex: n })
            }
            e.setDefaultSparkline = ls, To = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.Jv = t.sparklineType, o.execInSelectionsForCell(o.Ov, function(e, t, i) {
                        var n = e.getSparkline(t, i);
                        n && n.sparklineType(o.Jv)
                    })
                }, t
            }(te), Ao = { canUndo: !0, execute: function(e, t, i) { var o = new To(e, t); return o.execute(e, t, i) } };

            function cs(e, t) { kr(e, "setSparklineType", Ao, { sparklineType: t.options, selections: t.selections, sheetName: t.sheetName }) } e.setSparklineType = cs, Eo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCell(o.Ov, function(e, i, o) {
                        var n, r = e.getSparkline(i, o);
                        r && (n = r.setting(), n.options[t.property] = t.value, r.setting(n))
                    })
                }, t
            }(te), Io = { canUndo: !0, execute: function(e, t, i) { var o = new Eo(e, t); return o.execute(e, t, i) } };

            function ds(e, t) {
                var i = t.options.length > 0 ? t.options[0] : void 0,
                    o = t.options.length > 1 ? t.options[1] : void 0;
                kr(e, "setSparklineSetting", Io, { value: i, property: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setSparklineSetting = ds, Do = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this,
                        r = [];
                    n.execInSelectionsForCell(n.Ov, function(e, t, i) {
                        (o = e.getSparkline(t, i)) && r.push(o)
                    }), r.length > 1 && n.Ov.groupSparkline(r)
                }, t
            }(te), $o = { canUndo: !0, execute: function(e, t, i) { var o = new Do(e, t); return o.execute(e, t, i) } };

            function ps(e, t) { kr(e, "groupSparkline", $o, { selections: t.selections, sheetName: t.sheetName }) } e.groupSparkline = ps, Lo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this,
                        n;
                    o.execInSelectionsForCell(o.Ov, function(e, t, i) {
                        (n = e.getSparkline(t, i)) && e.ungroupSparkline(n.group())
                    })
                }, t
            }(te), Fo = { canUndo: !0, execute: function(e, t, i) { var o = new Lo(e, t); return o.execute(e, t, i) } };

            function us(e, t) { kr(e, "unGroupSparkline", Fo, { selections: t.selections, sheetName: t.sheetName }) } e.unGroupSparkline = us, Ro = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCell(o.Ov, function(e, t, i) { e.removeSparkline(t, i) })
                }, t
            }(te), Bo = { canUndo: !0, execute: function(e, t, i) { var o = new Ro(e, t); return o.execute(e, t, i) } };

            function hs(e, t) { kr(e, "clearSparkline", Bo, { selections: t.selections, sheetName: t.sheetName }) } e.clearSparkline = hs, Oo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this;
                    o.execInSelectionsForCell(o.Ov, function(e, t, i) {
                        var n, r = e.getSparkline(t, i),
                            a = r ? r.group() : null;
                        if (null !== a && a.count() > 1)
                            for (n = a.all(r); n.length > 0;) o.Ov.removeSparkline(n[n.length - 1].row, n[n.length - 1].column)
                    })
                }, t
            }(te), Po = { canUndo: !0, execute: function(e, t, i) { var o = new Oo(e, t); return o.execute(e, t, i) } };

            function fs(e, t) { kr(e, "clearSparklineGroup", Po, { selections: t.selections, sheetName: t.sheetName }) } e.clearSparklineGroup = fs, No = function(e) {
                i.extends(t, e);

                function t() { e.apply(this, arguments) }
                return t.prototype.getNewTableName = function() {
                    var e, t, i, o, n, r = 0;
                    for (e = 0; e < this.spread().sheets.length; e++)
                        for (t = this.spread().sheets[e].tables.all(), i = 0; i < t.length; i++)(o = t[i].name()) && o.length > 5 && "table" === o.substring(0, 5).toLowerCase() && (n = o.substring(5, o.length), $.isNumeric(n) && +n >= r && (r = +n));
                    return "Table" + (r + 1)
                }, t.prototype.clearMergeInRange = function(e) {
                    var t, i, o = this.Ov,
                        n = -1 === e.col ? 0 : e.col,
                        r = -1 === e.row ? 0 : e.row;
                    for (t = 0; t < e.rowCount; t++)
                        for (i = 0; i < e.colCount; i++) o.removeSpan(r + t, n + i)
                }, t
            }(te), zo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this;
                    r.iC = t.range, o = -1 === r.iC.row ? 0 : r.iC.row, n = -1 === r.iC.col ? 0 : r.iC.col, r.clearMergeInRange(r.iC), r.Ov.tables.add(r.getNewTableName(), o, n, r.iC.rowCount, r.iC.colCount)
                }, t
            }(No), Mo = { canUndo: !0, execute: function(e, t, i) { var o = new zo(e, t); return o.execute(e, t, i) } };

            function gs(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex());
                kr(e, "createDefaultTable", Mo, { range: t.options, activeTable: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.createDefaultTable = gs, Vo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, a, s, l, c = this;
                    c.Rv = t.tableStyle, (o = c.getSelections()[0]) && (n = -1 === o.row ? 0 : o.row, a = -1 === o.col ? 0 : o.col, s = null, t.tableName && (s = c.Ov.tables.findByName(t.tableName)), s instanceof r.Tables.Table ? s.style(c.Rv) : (c.clearMergeInRange(o), l = c.Ov.tables.add(c.getNewTableName(), n, a, o.rowCount, o.colCount, c.Rv), t.tableName ? l.name(t.tableName) : t.tableName = l.name()))
                }, t
            }(No), Go = { canUndo: !0, execute: function(e, t, i) { var o = new Vo(e, t); return o.execute(e, t, i) } };

            function ms(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()),
                    n = o ? o.name() : null;
                kr(e, "formatAsTable", Go, { tableStyle: t.options, tableName: n, selections: t.selections, sheetName: t.sheetName })
            }
            e.formatAsTable = ms, jo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.showHeader(n.hi)
                }, t
            }(te), Ho = { canUndo: !0, execute: function(e, t, i) { var o = new jo(e, t); return o.execute(e, t, i) } };

            function bs(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableHeaderRow", Ho, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableHeaderRow = bs, Wo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.showFooter(n.hi)
                }, t
            }(te), Uo = { canUndo: !0, execute: function(e, t, i) { var o = new Wo(e, t); return o.execute(e, t, i) } };

            function vs(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableTotalRow", Uo, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableTotalRow = vs, qo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.bandRows(n.hi)
                }, t
            }(te), _o = { canUndo: !0, execute: function(e, t, i) { var o = new qo(e, t); return o.execute(e, t, i) } };

            function ys(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableBandedRows", _o, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableBandedRows = ys, Ko = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.highlightFirstColumn(n.hi)
                }, t
            }(te), Xo = { canUndo: !0, execute: function(e, t, i) { var o = new Ko(e, t); return o.execute(e, t, i) } };

            function ws(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableFirstColumn", Xo, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableFirstColumn = ws, Jo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.highlightLastColumn(n.hi)
                }, t
            }(te), Yo = { canUndo: !0, execute: function(e, t, i) { var o = new Jo(e, t); return o.execute(e, t, i) } };

            function xs(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableLastColumn", Yo, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableLastColumn = xs, Qo = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.bandColumns(n.hi)
                }, t
            }(te), Zo = { canUndo: !0, execute: function(e, t, i) { var o = new Qo(e, t); return o.execute(e, t, i) } };

            function Cs(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableBandedColumns", Zo, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableBandedColumns = Cs, en = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.filterButtonVisible(n.hi)
                }, t
            }(te), tn = { canUndo: !0, execute: function(e, t, i) { var o = new en(e, t); return o.execute(e, t, i) } };

            function Ss(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableFilterButton", tn, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableFilterButton = Ss, on = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this;
                    n.hi = t.value, (o = n.Ov.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.name(n.hi)
                }, t
            }(te), nn = { canUndo: !0, execute: function(e, t, i) { var o = new on(e, t); return o.execute(e, t, i) } };

            function ks(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "setTableName", nn, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTableName = ks, rn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, a = this;
                    a.hi = t.value, o = a.Ov, (n = o.tables.findByName(t.tableName)) instanceof r.Tables.Table && o.tables.resize(n, a.hi)
                }, t
            }(te), an = { canUndo: !0, execute: function(e, t, i) { var o = new rn(e, t); return o.execute(e, t, i) } };

            function Ts(e, t) {
                var i = t.sheet,
                    o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                kr(e, "resizeTable", an, { value: t.options, tableName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.resizeTable = Ts, sn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = this,
                        s = t.value.isRemove,
                        l = a.Ov.conditionalFormats;
                    if (s) {
                        for (o = t.value.rule, n = l.count() - 1; n >= 0; n--)
                            if (r = l.getRule(n), r.ruleType() === o.ruleType() && JSON.stringify(r.ranges()) === JSON.stringify(o.ranges())) { l.removeRule(r); break }
                    } else o = t.value;
                    l.addRule(o)
                }, t
            }(te), ln = { canUndo: !0, execute: function(e, t, i) { var o = new sn(e, t); return o.execute(e, t, i) } };

            function As(e, t) { kr(e, "addRule", ln, { value: t.options, selections: t.selections, sheetName: t.sheetName }) } e.addRule = As, cn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this;
                    if (r.hi = t.isFromEntireSheet, o = r.getSelections(), r.hi) r.Ov.conditionalFormats.clearRule();
                    else
                        for (n = 0; n < o.length; n++) r.Ov.conditionalFormats.removeRuleByRange(o[n].row, o[n].col, o[n].rowCount, o[n].colCount)
                }, t
            }(te), dn = { canUndo: !0, execute: function(e, t, i) { var o = new cn(e, t); return o.execute(e, t, i) } };

            function Es(e, t) { kr(e, "clearRule", dn, { isFromEntireSheet: t.options, selections: t.selections, sheetName: t.sheetName }) } e.clearRule = Es;

            function Is(e, t) {
                var i = e.getActiveSheet(),
                    o = i.comments.get(i.getActiveRowIndex(), i.getActiveColumnIndex());
                o && e.commandManager().execute({ cmd: "changeComment", sheetName: i.name(), comment: o, oldValue: t.options.oldValue, newValue: t.options.newValue, propertyName: t.options.propertyName })
            }
            e.setCommentProperty = Is;

            function Ds(e) { e.commandManager().execute({ cmd: "cutFloatingObjects", sheetName: e.getActiveSheet().name() }) } e.floatingObjectCut = Ds;

            function $s(e) { e.commandManager().execute({ cmd: "copyFloatingObjects", sheetName: e.getActiveSheet().name() }) } e.floatingObjectCopy = $s, pn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = t.value.slicerStyle,
                        a = t.slicersName;
                    if (!a || 0 === a.length) return !1;
                    for (o in a) n = this.sheet().slicers.get(a[o]), n.style(r)
                }, t
            }(te), un = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new pn(e, t);
                    o.execute(e, t, i)
                }
            };

            function Ls(e, t) {
                var o, n = t.sheet,
                    r = i.util.getSelectedSlicers(n) || [],
                    a = [];
                for (o = 0; o < r.length; o++) a.push(r[o].name());
                kr(e, "setSlicerStyle", un, { value: t.options, slicersName: a, selections: t.selections, sheetName: t.sheetName })
            }
            e.setSlicerStyle = Ls, hn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = t.value,
                        a = t.slicersName;
                    if (!a || 0 === a.length) return !1;
                    for (o in a) n = this.sheet().slicers.get(a[o]), n.sortState(r)
                }, t
            }(te), fn = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new hn(e, t);
                    o.execute(e, t, i)
                }
            };

            function Fs(e, t) {
                var o, n = t.sheet,
                    r = i.util.getSelectedSlicers(n) || [],
                    a = [];
                for (o = 0; o < r.length; o++) a.push(r[o].name());
                kr(e, "sortSlicerItems", fn, { value: t.options, slicersName: a, selections: t.selections, sheetName: t.sheetName })
            }
            e.sortSlicerItems = Fs, gn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s, l, c = t.value,
                        d = t.type,
                        p = this.sheet(),
                        u = this.getSelections();
                    switch (d) {
                        case "sheet":
                            p.tag(c);
                            break;
                        case "cell":
                            u.forEach(function(e) {
                                for (r = -1 !== e.row ? e.row : 0, a = -1 !== e.col ? e.col : 0, s = r + e.rowCount, l = a + e.colCount, o = r; o < s; o++)
                                    for (n = a; n < l; n++) p.setTag(o, n, c)
                            });
                            break;
                        case "row":
                            u.forEach(function(e) { for (s = e.row + e.rowCount, o = e.row; o < s; o++) p.setTag(o, -1, c) });
                            break;
                        case "column":
                            u.forEach(function(e) { for (l = e.col + e.colCount, n = e.col; n < l; n++) p.setTag(-1, n, c) })
                    }
                }, t
            }(te), mn = { canUndo: !0, execute: function(e, t, i) { var o = new gn(e, t); return o.execute(e, t, i) } };

            function Rs(e, t) {
                var i = t.options.length > 0 ? t.options[0] : void 0,
                    o = t.options.length > 1 ? t.options[1] : void 0;
                kr(e, "setTag", mn, { value: i, type: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.setTag = Rs, bn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a, s, l, c, d, p = [],
                        u = t.slicersName;
                    if (!u || 0 === u.length) return !1;
                    for (o in u) n = this.sheet().slicers.get(u[o]), p.push(n);
                    for (r = t.property, a = t.value, c = a instanceof Array, d = 0; d < p.length; d++) s = p[d], l = c ? a[d] : a, s[r] && void 0 !== l && null !== l && s[r](l)
                }, t
            }(te), vn = { canUndo: !0, execute: function(e, t, i) { var o = new bn(e, t); return o.execute(e, t, i) } };

            function Bs(e, t) {
                var i, o = t.options.length > 0 ? t.options[0] : void 0,
                    n = t.options.length > 1 ? t.options[1] : void 0,
                    r = t.options.length > 2 ? t.options[2] : [],
                    a = [];
                for (i = 0; i < r.length; i++) a.push(r[i].name());
                kr(e, "slicerPropertyChanged", vn, { property: o, value: n, slicersName: a, selections: t.selections, sheetName: t.sheetName })
            }
            e.slicerPropertyChanged = Bs, i.loader.ready(function() {
                if (!i.wrapper.spread.notWorking) {
                    var e = i.wrapper.spread;
                    yr(e.commandManager())
                }
            }), yn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this.getSelections(),
                        a = t.byRows,
                        s = t.sortInfos,
                        l = this.sheet();
                    for (o = 0; o < r.length; o++) n = r[o], l.sortRange(n.row, n.col, n.rowCount, n.colCount, a, s)
                }, t
            }(te), wn = { canUndo: !0, execute: function(e, t, i) { var o = new yn(e, t); return o.execute(e, t, i) } };

            function Os(e, t) { kr(e, "sortCustomRange", wn, { byRows: t.options.byRows, sortInfos: t.options.sortInfos, selections: t.selections, sheetName: t.sheetName }) } e.sortCustomRange = Os, xn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.undoImp = function(e, t, i) { return e.suspendPaint(), GC.Spread.Sheets.Commands.undoTransaction(e, t), this.isSendEvent() && br(t.chart), e.resumePaint(), !0 }, t.prototype.isSendEvent = function(e, t, i) { return !0 }, t
            }(te), Cn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, s, l, p, u, h, f, g, m, b, v, y, w;
                    try {
                        if (n = this, r = n.sheet(), s = t.dataFormula, l = t.category, p = a.ChartType[t.chartType], u = c(r, s), h = u.row, f = u.col + u.colCount, g = n.jC(r, h, f), m = "", w = t.dataOrientation, l === d.chartTypeDict[0].chartGroup)
                            for (b = r.charts.add(m, a.ChartType.columnClustered, g.x, g.y, 480, 300), y = b.series(), v = 0; v < t.series.length; v++) y.add(t.series[v]);
                        else b = l === d.chartTypeDict[52].chartGroup || p === a.ChartType.pie ? r.charts.add(m, p, g.x, g.y, 480, 300, s) : r.charts.add(m, p, g.x, g.y, 480, 300, s, w);
                        b.series().get(8) && b.legend({ visible: !1 }), d.resetChartsFocus(r), b.isSelected(!0)
                    } catch (e) { return i.MessageBox.show(i.res.selectChartDialog.errorPrompt.unexpectedErrorMsg, i.res.title, 2), !1 }
                }, t.prototype.isSendEvent = function(e, t, i) { return !1 }, t.prototype.jC = function(e, t, i) {
                    var o, n, r = 20,
                        a = 20;
                    for (o = 0; o < i; o++) r += e.getColumnWidth(o);
                    for (n = 0; n < t; n++) a += e.getRowHeight(n);
                    return { x: r, y: a }
                }, t
            }(xn), Sn = { canUndo: !0, execute: function(e, t, i) { var o = new Cn(e, t); return o.execute(e, t, i) } };

            function Ps(e, t) { kr(e, "insertChart", Sn, { selections: t.selections, sheetName: t.sheetName, category: t.options.category, chartType: t.options.chartType, dataOrientation: t.options.dataOrientation, series: t.options.series, dataFormula: t.options.dataFormula }) } e.insertChart = Ps, kn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a, s, l, c, d, p, u, h = e,
                        f = h.commandManager(),
                        g = this.sheet();
                    if (g.name() !== t.targetSheetName) {
                        if ("newSheet" === (n = t.type)) {
                            for (a = h.sheets, s = 0, l = a.length; s < l; s++)
                                if (t.targetSheetName === a[s].name()) return i.MessageBox.show(i.res.moveChartDialog.errorPrompt.sameSheetNameError, i.res.title, 2), !1;
                            r = new GC.Spread.Sheets.Worksheet(t.targetSheetName), h.addSheet(0, r)
                        }
                        c = f.getCommand("cutFloatingObjects"), d = f.getCommand("deleteFloatingObjects"), p = d.canUndo, d.canUndo = function() { return !1 }, c.execute(h, { sheetName: g.name() }), d.canUndo = p, u = f.getCommand("pasteFloatingObjects"), p = u.canUndo, u.canUndo = function() { return !1 }, u.execute(h, { sheetName: t.targetSheetName }), u.canUndo = p, i.wrapper.spread.undoManager().clear()
                    }
                }, t
            }(xn), Tn = { canUndo: !1, execute: function(e, t, i) { var o = new kn(e, t); return o.execute(e, t, i) } };

            function Ns(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i);
                kr(e, "moveChart", Tn, { chart: o, selections: t.selections, sheetName: t.sheetName, targetSheetName: t.options.targetSheetName, type: t.options.type })
            }
            e.moveChart = Ns, An = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, s, l = this.sheet(),
                        c = l.charts.get(t.chartName),
                        p = t.isSwitchDataOrientation,
                        u = t.category,
                        h = a.ChartType[t.chartType];
                    try {
                        if (u !== d.chartTypeDict[0].chartGroup) c.chartType(h), p && c.switchDataOrientation();
                        else if (t.series && t.series.length > 0) { for (n = c.series(), s = n.get().length, r = 0; r < s; r++) n.remove(0); for (s = t.series.length, r = 0; r < s; r++) n.add(t.series[r]) } c.colorAndStyle && c.colorAndStyle.color && d.applyChartSeriesTheme(c, c.colorAndStyle.color)
                    } catch (e) { return i.MessageBox.show(i.res.selectData.errorPrompt.unexpectedErrorMsg, i.res.title, 2), !1 } d.resetChartsFocus(l), c.isSelected(!0), br(c)
                }, t
            }(xn), En = { canUndo: !0, execute: function(e, t, i) { var o = new An(e, t); return o.execute(e, t, i) } };

            function zs(e, t) { kr(e, "changeChartType", En, { selections: t.selections, sheetName: t.sheetName, chartType: t.options.chartType, isSwitchDataOrientation: t.options.isSwitchDataOrientation, series: t.options.series, dataFormula: t.options.dataFormula, category: t.options.category, chartName: t.options.chart.name() }) } e.changeChartType = zs, In = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this.sheet(),
                        n = o.charts.get(t.chartName),
                        r = t.chartStyle.templatesChartStyle,
                        a = t.chartStyle.defaultChartStyle;
                    d.SetChartStyle(n, a, "default"), d.SetChartStyle(n, r, "templetes")
                }, t
            }(xn), Dn = { canUndo: !0, execute: function(e, t, i) { var o = new In(e, t); return o.execute(e, t, i) } };

            function Ms(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i).name();
                kr(e, "setChartStyle", Dn, { chartName: o, selections: t.selections, sheetName: t.sheetName, chartStyle: t.options.chartStyle })
            }
            e.setChartStyle = Ms, $n = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = this.sheet(),
                        a = r.charts.get(t.chartName),
                        s = t.layouts;
                    for (o in s) s.hasOwnProperty(o) && (n = s[o], a[o](n));
                    br(a)
                }, t
            }(xn), Ln = { canUndo: !0, execute: function(e, t, i) { var o = new $n(e, t); return o.execute(e, t, i) } };

            function Vs(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i).name();
                kr(e, "setChartLayout", Ln, { chartName: o, layouts: t.options.layouts, selections: t.selections, sheetName: t.sheetName })
            }
            e.setChartLayout = Vs, Fn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this.sheet(),
                        n = o.charts.get(t.chartName),
                        r = GC.Spread.Sheets.Charts.ChartType,
                        a = n.series(),
                        s = t.series.value;
                    n && (n.chartType() !== r.sunburst && n.chartType() !== r.treemap || !0 !== s.isFillSetting || a.set(t.series.index, { backColor: null }), a.set(t.series.index, s))
                }, t
            }(xn), Rn = { canUndo: !0, execute: function(e, t, i) { var o = new Fn(e, t); return o.execute(e, t, i) } };

            function Gs(e, t) { kr(e, "updateChartSeries", Rn, { selections: t.selections, sheetName: t.sheetName, chartName: t.options.chart.name(), series: t.options.element }) } e.updateChartSeries = Gs, Bn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, o) {
                    var n, r, a = this.sheet(),
                        s = a.charts.get(t.chartName),
                        l = d.getChartGroupString(s.chartType());
                    if (s) { if (l === d.chartTypeDict[50].chartGroup || l === d.chartTypeDict[57].chartGroup || l === d.chartTypeDict[58].chartGroup) return i.MessageBox.show(i.res.selectData.errorPrompt.cantSwitchRowColumn, i.res.title, 2), !1; try { return n = s.switchDataOrientation(), n ? (r = s.colorAndStyle && s.colorAndStyle.color, r && d.applyChartSeriesTheme(s, r), br(s), !0) : (i.MessageBox.show(i.res.selectData.errorPrompt.cantSwitchRowColumn, i.res.title, 2), !1) } catch (e) { return i.MessageBox.show(i.res.selectData.errorPrompt.cantSwitchRowColumn, i.res.title, 2), !1 } }
                }, t
            }(xn), On = { canUndo: !0, execute: function(e, t, i) { var o = new Bn(e, t); return o.execute(e, t, i) } };

            function js(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i).name();
                kr(e, "switchChartRowCol", On, { chartName: o, selections: t.selections, sheetName: t.sheetName })
            }
            e.switchChartRowCol = js, Pn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = t.seriesArray,
                        s = this.sheet(),
                        l = s.charts.get(t.chartName),
                        c = l.series().get().length;
                    if (0 < c)
                        for (o = c; o > 0; o--) l.series().remove(o - 1);
                    for (n = 0; n < a.length; n++) r = a[n], l.series().add(r);
                    br(l)
                }, t
            }(xn), Nn = { canUndo: !0, execute: function(e, t, i) { var o = new Pn(e, t); return o.execute(e, t, i) } };

            function Hs(e, t) { kr(e, "updateChartAllSeries", Nn, { selections: t.selections, sheetName: t.sheetName, seriesArray: t.options.seriesArray, chartName: t.options.chart.name() }) } e.updateChartAllSeries = Hs, zn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this.sheet(),
                        n = o.charts.get(t.chartName);
                    n && (n.colorAndStyle || (n.colorAndStyle = {}), n.colorAndStyle.color = { group: t.group, index: t.index }, d.applyChartSeriesTheme(n, t), t.ignoreEvent || br(n))
                }, t
            }(xn), Mn = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new zn(e, t);
                    o.execute(e, t, i)
                }
            };

            function Ws(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i).name();
                kr(e, "changeChartSeriesColor", Mn, { sheetName: t.sheetName, selections: t.selections, group: t.options.group, index: t.options.index, type: t.options.type, ignoreEvent: t.options.ignoreEvent, chartName: o })
            }
            e.changeChartSeriesColor = Ws;

            function Us(e, t) {
                var i = t.sheetName,
                    o = e.commandManager(),
                    n = t.options;
                o.execute({ cmd: "resizeFloatingObjects", sheetName: i, floatingObjects: n.name, offsetX: n.x, offsetY: n.y, offsetWidth: n.width, offsetHeight: n.height })
            }
            e.updateChartSize = Us, Vn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this.sheet(),
                        r = n.charts.get(t.chartName),
                        a = t.elementObj;
                    if (r)
                        for (o in a) a.hasOwnProperty(o) && r[o](a[o]);
                    br(r)
                }, t
            }(xn), Gn = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new Vn(e, t);
                    o.execute(e, t, i)
                }
            };

            function qs(e, t) {
                var i = e.getActiveSheet(),
                    o = p(i).name();
                kr(e, "changeChartElement", Gn, { chartName: o, elementObj: t.options, selections: t.selections, sheetName: t.sheetName })
            }
            e.changeChartElement = qs, jn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n = this.sheet(),
                        r = n.charts.get(t.chartName),
                        a = t.elementObj;
                    if (r)
                        for (o in a) a.hasOwnProperty(o) && r[o](a[o])
                }, t
            }(xn), Hn = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new jn(e, t);
                    o.execute(e, t, i)
                }
            };

            function _s(e, t) { kr(e, "changeChartFormatProperty", Hn, { chartName: t.options.chart.name(), elementObj: t.options.element, selections: t.selections, sheetName: t.sheetName }) } e.changeChartFormatProperty = _s, Wn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o = this.sheet(),
                        n = o.charts.get(t.chartName),
                        r = t.elementObj.dataPointIndex,
                        a = t.elementObj.dataPointOption;
                    n && n.series().dataPoints().set(r, a)
                }, t
            }(xn), Un = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new Wn(e, t);
                    o.execute(e, t, i)
                }
            };

            function Ks(e, t) { kr(e, "changeDataPointProperty", Un, { chartName: t.options.chart.name(), elementObj: t.options, selections: t.selections, sheetName: t.sheetName }) } e.changeDataPointProperty = Ks, qn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.undoImp = function(e, t, i) { return e.suspendPaint(), GC.Spread.Sheets.Commands.undoTransaction(e, t), this.isSendEvent() && vr(t.shape), e.resumePaint(), !0 }, t.prototype.isSendEvent = function(e, t, i) { return !0 }, t
            }(te), _n = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = this,
                        l = a.sheet(),
                        c = s.AutoShapeType,
                        d = s.ConnectorType,
                        p = s.ArrowheadLength,
                        u = s.ArrowheadStyle,
                        h = s.ArrowheadWidth,
                        f = t.shapeInfo,
                        g = t.position,
                        m = t.isConnectorType;
                    m ? (n = d[f.type], o = l.shapes.addConnector("", n, g.x, g.y, g.x + 100, g.y + 100), r = o.style(), void 0 !== f.beginArrowhead && (r.line.beginArrowheadStyle = u[f.beginArrowhead.beginArrowheadStyle], r.line.beginArrowheadWidth = h[f.beginArrowhead.beginArrowheadWidth], r.line.beginArrowheadLength = p[f.beginArrowhead.beginArrowheadLength], o.style(r)), void 0 !== f.endArrowhead && (r.line.endArrowheadStyle = u[f.endArrowhead.endArrowheadStyle], r.line.endArrowheadWidth = h[f.endArrowhead.endArrowheadWidth], r.line.endArrowheadLength = p[f.endArrowhead.endArrowheadLength], o.style(r))) : (n = c[f.type], "leftRightArrow" === f.type || "leftRightArrowCallout" === f.type || "leftRightRibbon" === f.type ? l.shapes.add("", n, g.x, g.y, 200, 150) : "upDownArrow" === f.type || "upDownArrowCallout" === f.type ? l.shapes.add("", n, g.x, g.y, 150, 200) : l.shapes.add("", n, g.x, g.y, 150, 150))
                }, t.prototype.isSendEvent = function(e, t, i) { return !1 }, t
            }(qn), Kn = { canUndo: !0, execute: function(e, t, i) { var o = new _n(e, t); return o.execute(e, t, i) } };

            function Xs(e, t) { kr(e, "insertShape", Kn, { sheetName: t.sheetName, shapeInfo: t.options.shapeInfo, isConnectorType: t.options.isConnectorType, selections: t.selections, position: t.options.position }) } e.insertShape = Xs, Xn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = t.selectShapes,
                        a = s.AutoShapeType,
                        l = a[t.newShapeType.type];
                    for (o = 0; o < r.length; o++) r[o] instanceof GC.Spread.Sheets.Shapes.Shape && r[o].type(l), r[o] instanceof GC.Spread.Sheets.Shapes.GroupShape && (n = r[o].all(), n.forEach(function(e) { e instanceof GC.Spread.Sheets.Shapes.Shape && e.type(l) }))
                }, t
            }(qn), Jn = { canUndo: !0, execute: function(e, t, i) { var o = new Xn(e, t); return o.execute(e, t, i) } };

            function Js(e, t) { kr(e, "changeShapeType", Jn, { sheetName: t.sheetName, selectShapes: t.options.selectShapes, newShapeType: t.options.newShapeType }) } e.changeShapeType = Js, Yn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }

                function o(e, t) { for (var i in t) e[i] && "object" == typeof e[i] ? o(e[i], t[i]) : e[i] = t[i]; return e }

                function n(e, t) {
                    var i, r;
                    if (e && e instanceof GC.Spread.Sheets.Shapes.GroupShape)
                        for (i = e.all(), r = 0; r < i.length; r++) n(i[r], t);
                    else e.style(o(e.style(), t))
                }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, r = t.style,
                        a = t.selectedShape;
                    for (o = 0; o < a.length; o++) n(a[o], r);
                    t.ignoreEvent || vr(a)
                }, t
            }(qn), Qn = { canUndo: !0, execute: function(e, t, i) { var o = new Yn(e, t); return o.execute(e, t, i) } };

            function Ys(e, t) { kr(e, "changeShapeStyle", Qn, { selectedShape: t.options.selectShape, style: t.options.style, sheetName: t.sheetName, ignoreEvent: t.options.ignoreEvent }) } e.changeShapeStyle = Ys, Zn = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r = t.width,
                        a = t.height,
                        s = t.angle,
                        l = t.moveSizeRelationship,
                        c = t.locked,
                        d = t.printObject,
                        p = t.rotateFlag,
                        u = t.selectedShape;
                    for (o = 0; o < u.length; o++) void 0 !== r && u[o].width(r), void 0 !== a && u[o].height(a), void 0 !== s && (p ? (n = u[o].rotate(), u[o].rotate(n + s)) : u[o].rotate(s)), void 0 !== c && u[o].isLocked(c), void 0 !== d && u[o].canPrint(d), void 0 !== l && (0 === l && (u[o].dynamicMove(!0), u[o].dynamicSize(!0)), 1 === l && (u[o].dynamicMove(!0), u[o].dynamicSize(!1)), 2 === l && (u[o].dynamicMove(!1), u[o].dynamicSize(!1)));
                    t.ignoreEvent || vr(u)
                }, t
            }(qn), er = { canUndo: !0, execute: function(e, t, i) { var o = new Zn(e, t); return o.execute(e, t, i) } };

            function Qs(e, t) { kr(e, "changeShapeSizeAndProperties", er, { selectedShape: t.options.selectShape, width: t.options.width, height: t.options.height, angle: t.options.angle, moveSizeRelationship: t.options.moveSizeRelationship, locked: t.options.locked, printObject: t.options.printObject, sheetName: t.sheetName, ignoreEvent: t.options.ignoreEvent, rotateFlag: t.options.rotateFlag }) } e.changeShapeSizeAndProperties = Qs, tr = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) {
                    var o, n, r, a = this.sheet(),
                        s = t.selectedShape,
                        l = t.type;
                    if ("group" === l && (o = a.shapes.group(s), o.isSelected(!0), t.groupShapeName ? o.name(t.groupShapeName) : t.groupShapeName = o.name()), "ungroup" === l)
                        for (n = 0; n < s.length; n++) s[n] instanceof GC.Spread.Sheets.Shapes.GroupShape && (r = s[n].all(), a.shapes.ungroup(s[n]), r.forEach(function(e) { e.isSelected(!0) }));
                    t.ignoreEvent || vr(s)
                }, t
            }(qn), t[X] = { canUndo: !1, execute: function(e, t, i) { e.commandManager().execute({ cmd: "cutShapes", sheetName: t.sheetName }) } }, t[J] = { canUndo: !1, execute: function(e, t, i) { e.commandManager().execute({ cmd: "copyShapes", sheetName: t.sheetName }) } }, t[Y] = {
                canUndo: !1,
                execute: function(e, t, i) {
                    var o = new ne(e, t),
                        n = { value: 0, spread: e };
                    return o.execute(e, n, i)
                }
            }, t[Q] = {
                canUndo: !0,
                execute: function(e, t, o) {
                    var n, r, a = i.wrapper.spread,
                        s = a.getActiveSheet(),
                        l = s.shapes.all(),
                        c = [];
                    for (n = 0; n < l.length; n++) l[n].isSelected() && c.push(l[n]);
                    return t.selectedShape = c, t.type = "group", t.sheetName = s.name(), r = new tr(e, t), r.execute(e, t, o)
                }
            }, t[Z] = {
                canUndo: !0,
                execute: function(e, t, o) {
                    var n, r, a = i.wrapper.spread,
                        s = a.getActiveSheet(),
                        l = s.shapes.all(),
                        c = [];
                    for (n = 0; n < l.length; n++) l[n].isSelected() && c.push(l[n]);
                    return t.selectedShape = c, t.type = "ungroup", t.sheetName = s.name(), r = new tr(e, t), r.execute(e, t, o)
                }
            }, t[ee] = { canUndo: !1, execute: function(e, t, o) { i.ribbon.shapeClicked() } }, ir = { canUndo: !0, execute: function(e, t, i) { var o = new tr(e, t); return o.execute(e, t, i) } };

            function Zs(e, t) { kr(e, "shapeGroup", ir, { selectedShape: t.options.selectShape, type: t.options.type, sheetName: t.sheetName, ignoreEvent: t.options.ignoreEvent }) } e.shapeGroup = Zs, or = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }

                function o(e, t) {
                    var i, n;
                    if (void 0 !== t)
                        if (e && e instanceof GC.Spread.Sheets.Shapes.GroupShape)
                            for (i = e.all(), n = 0; n < i.length; n++) o(i[n], t);
                        else e.text && e.text(t)
                }
                return t.prototype.executeImp = function(e, t, i) {
                    var n, r = t.selectedShape,
                        a = t.text;
                    for (n = 0; n < r.length; n++) o(r[n], a)
                }, t
            }(qn), nr = { canUndo: !0, execute: function(e, t, i) { var o = new or(e, t); return o.execute(e, t, i) } };

            function el(e, t) { kr(e, "setShapeText", nr, { selectedShape: t.options.selectShape, text: t.options.text, sheetName: t.sheetName }) } e.setShapeText = el, rr = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t, i) }
                return t.prototype.executeImp = function(e, t, i) { if (t.execute) return t.execute.call(this, e, t, i) }, t
            }(te), ar = {
                canUndo: !0,
                execute: function(e, t, i) {
                    var o = new rr(e, t);
                    o.execute(e, t, i)
                }
            };

            function tl(e, t) { kr(e, "baseDialogCommand", ar, { execute: t.options.execute, value: t.options.value, selections: t.selections, sheetName: t.sheetName }) } e.baseDialogCommand = tl, e.dialogAction = {}, sr = function(e, t, o) {
                var n, r, a, s = t.value.arg,
                    l = t.value.scope,
                    c = t.value.name,
                    d = t.value.commentValue,
                    p = t.value.nameValue,
                    u = t.value.referToValue,
                    h = t.value.sheetIndex,
                    f = t.value.inWorkbook,
                    g = t.value.activeRowIndex,
                    m = t.value.activeColumnIndex;
                if ("edit" === s)
                    if ("Workbook" === l) i.wrapper.spread.removeCustomName(c);
                    else {
                        for (r = 0; r < i.wrapper.spread.sheets.length; r++)
                            if (i.wrapper.spread.sheets[r].name() === l) { n = r; break } i.wrapper.spread.sheets[n].removeCustomName(c)
                    } a = ("" + d).replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"), f ? i.wrapper.spread.addCustomName(p, u, g, m, a) : i.wrapper.spread.sheets[h].addCustomName(p, u, g, m, a)
            }, e.dialogAction.newNameDialoagApplySetting = sr, lr = function(e, t, i) {
                var o = t.value.txt,
                    n = t.value.activeRowIndex,
                    r = t.value.activeColumnIndex,
                    a = this.sheet();
                a.setFormula(n, r, o)
            }, e.dialogAction.insertFunctionDiaplogApplySetting = lr, cr = function(e, t, i) {
                var o, n, r = t.value.rowSheet,
                    a = t.value.colSheet,
                    s = this.sheet(),
                    l = function(e, t, i, o, n) {
                        var r, a, l, c, d, p, u, h, f = e.getStyle(t, i, o);
                        s.setStyle(t, i, f, n), r = e.getValue(t, i, o), a = s.getValue(t, i, n), r !== a && s.setValue(t, i, r, n), l = e.getColumnWidth(i, o), void 0 !== l && l >= 0 && s.setColumnWidth(i, l, n), c = e.getRowHeight(t, o), void 0 !== c && c >= 0 && s.setRowHeight(t, c, n), d = e.getColumnVisible(i, o), s.setColumnVisible(i, d, n), p = e.getRowVisible(t, o), s.setRowVisible(t, p, n), u = e.getColumnResizable(i, o), s.setColumnResizable(i, u, n), h = e.getRowResizable(t, o), s.setRowResizable(t, h, n)
                    },
                    c = function(e, t, i) {
                        var n = s.getSpans(void 0, i);
                        for (o = 0; o < n.length; o++) s.removeSpan(n[o].row, n[o].col, i);
                        if (n = e.getSpans(void 0, t), 0 !== n.length)
                            for (o = 0; o < n.length; o++) s.addSpan(n[o].row, n[o].col, n[o].rowCount, n[o].colCount, i)
                    },
                    d = function(e, t) {
                        var i = e.getColumnCount(3),
                            o = t.getColumnCount(3),
                            n = e.getRowCount(3),
                            r = t.getRowCount(3);
                        s.setColumnCount(i, 2), s.setRowCount(n, 2), s.setColumnCount(o, 1), s.setRowCount(r, 1)
                    };
                for (d(r, a), o = 0; o < r.getRowCount(); o++)
                    for (n = 0; n < r.getColumnCount(); n++) l(r, o, n, 3, 2);
                for (o = 0; o < a.getRowCount(); o++)
                    for (n = 0; n < a.getColumnCount(); n++) l(a, o, n, 3, 1);
                for (n = 0; n < r.getColumnCount(); n++) l(r, -1, n, 3, 2);
                for (n = 0; n < a.getColumnCount(); n++) l(a, -1, n, 3, 1);
                for (o = 0; o < r.getRowCount(); o++) l(r, o, -1, 3, 2);
                for (o = 0; o < a.getRowCount(); o++) l(a, o, -1, 3, 1);
                l(r, -1, -1, 3, 2), l(a, -1, -1, 3, 1), c(r, 3, 2), c(a, 3, 1)
            }, e.dialogAction.headerCellsApplySetting = cr, dr = function(e, t, i) {
                var o, n, r = t.value.formats,
                    a = t.value.tempFormats;
                for (r.clearRule(), o = 0; o < a.count(); o++) n = a.getRule(o), n.condition && delete n.condition, void 0 !== n.style.locked && delete n.style.locked, r.addRule(n)
            }, e.dialogAction.managerRulesApplySetting = dr, pr = function(e, t, n) {
                var r = t.value.styleName,
                    a = this.spread(),
                    s = r.toLowerCase();
                a.getNamedStyle(r) || (i.CellStyleDialog.buildInCellStyle.hasOwnProperty(s) ? this.spread().addNamedStyle(i.CellStyleDialog.buildInCellStyle[s]) : i.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(s) && this.spread().addNamedStyle(i.CellStyleDialog.existedCustomCellStyle[s])), this.execInSelections(this.sheet(), function(e, t, i) {
                    var n, s = e.getActualStyle(t, i),
                        l = e.getNamedStyle(r) || a.getNamedStyle(r);
                    for (n in l) s[n] && (s[n] = o);
                    s.parentName = r, e.setStyle(t, i, s)
                })
            }, e.dialogAction.addAndSetStyleByName = pr, ur = function(e, t, n) {
                var r, a, s, l = t.value.styleInfo,
                    c = t.value.fontInfo,
                    d = t.value.borderInfo,
                    p = t.value.mergeInfo;
                if (l.watermark || (l.labelOptions = o), l.font = o, l.foreColor || (l.foreColor = o), l.borderTop && (l.borderTop = o), l.borderLeft && (l.borderLeft = o), l.borderBottom && (l.borderBottom = o), l.borderRight && (l.borderRight = o), l.diagonalUp && (l.diagonalUp = o), l.diagonalDown && (l.diagonalDown = o), kr(e, "setStyle", to, { value: l, selections: t.selections, sheetName: t.sheetName }), void 0 !== c.fontFamily && kr(e, "setFontFamily", Ae, { value: c.fontFamily, selections: t.selections, sheetName: t.sheetName }), void 0 !== c.fontSize && kr(e, "setFontSize", Ie, { value: c.fontSize + "pt", selections: t.selections, sheetName: t.sheetName }), void 0 !== c.fontStyle && kr(e, "setFontStyle", Pe, { value: c.fontStyle, selections: t.selections, sheetName: t.sheetName }), void 0 !== c.fontWeight && kr(e, "setFontWeight", $e, { value: c.fontWeight, selections: t.selections, sheetName: t.sheetName }), void 0 !== d && kr(e, "setAllBorder", et, { orignalBorder: d.orignalBorder, borderType: d.borderType, selections: t.selections, sheetName: t.sheetName }), p.merged && p.merged !== i.BaseMetaObject.indeterminateValue) {
                    for (r = t.selections, a = 0; a < r.length; a++)
                        for (s = a + 1; s < r.length; s++)
                            if (r[a].intersect(r[s].row, r[s].col, r[s].rowCount, r[s].colCount)) return;
                    kr(e, "mergeCells", ut, { selections: t.selections, sheetName: t.sheetName })
                }
            }, e.dialogAction.formatDialogApplySetting = ur, hr = function(e, t) {
                var i, o, n = 1,
                    r = t;
                for (i = 0; i < e.sheets.length; i++)
                    for (o = e.sheets[i]; o.slicers.get(r);) r = t + "_" + n, n++;
                return r
            }, fr = function(e, t, i) {
                var o, n, r, a, s = t.value.tableName,
                    l = t.value.columnsChecked,
                    c = this.sheet(),
                    d = c.tables.findByName(s),
                    p = 100,
                    u = 200;
                for (n = 0; n < l.length; n++) r = d.getColumnName(l[n]), a = hr(e, r), o = c.slicers.add(a, d.name(), r), o.position(new GC.Spread.Sheets.Point(p, u)), p += 30, u += 30;
                o && o.isSelected(!0)
            }, e.dialogAction.insertSlicerForDialog = fr, gr = function(e, t, i) {
                var o, n, r, a = t.value.slicerSettings,
                    s = t.value.selectedSlicers,
                    l = s.length;
                if (s && 0 !== l)
                    for (o = 0; o < l; o++) n = s[o], r = a[0], 1 === l && n.name(r), n.showHeader(a[1]), n.captionName(a[2]), "ascending" === a[3] ? n.sortState(1) : n.sortState(2), n.showNoDataItems(!a[4]), n.visuallyNoDataItems(a[5]), n.showNoDataItemsInLast(a[6])
            }, e.dialogAction.SlicerSettingForDialog = gr, mr = function(e, t, o) {
                var n, r, a, s, l, c = t.value.selectedSlicers,
                    d = t.value.formatOption,
                    p = d.horizontal,
                    u = d.vertical,
                    h = d.columnCount,
                    f = d.itemHeight,
                    g = d.slicerHeight,
                    m = d.slicerWidth,
                    b = d.disableResizingAndMoving,
                    v = d.locked,
                    y = d.noMoveSize,
                    w = d.moveNoSize,
                    x = d.moveSize;
                for (r in c) n = c[r], r && ($.isNumeric(d.horizontal) && $.isNumeric(d.vertical) && (a = parseInt(p), s = parseInt(u), l = new GC.Spread.Sheets.Point(a, s), n.position(l)), $.isNumeric(h) && (h = parseInt(h)) > 0 && n.columnCount(h), $.isNumeric(f) && (f = i.util.formatNumber(f), n.itemHeight(f)), $.isNumeric(g) && (g = i.util.formatNumber(g), n.height(g)), $.isNumeric(m) && (m = i.util.formatNumber(m), n.width(m)), b ? n.disableResizingAndMoving(!0) : n.disableResizingAndMoving(!1), v ? n.isLocked(!0) : n.isLocked(!1), y && (n.dynamicMove(!1), n.dynamicSize(!1)), w && (n.dynamicMove(!0), n.dynamicSize(!1)), x && (n.dynamicMove(!0), n.dynamicSize(!0)))
            }, e.dialogAction.FormatSlicerForDialog = mr, i.spreadActions = e
        }(i.spreadActions || {})
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e, t, o, n;
            i.spreadMeta = { style: { properties: { formatter: { type: i.PrimitiveTypes.STRING }, backColor: { type: i.PrimitiveTypes.STRING }, foreColor: { type: i.PrimitiveTypes.STRING }, font: { type: i.PrimitiveTypes.STRING }, hAlign: { type: i.PrimitiveTypes.NUMBER, defaultValue: 3 }, vAlign: { type: i.PrimitiveTypes.NUMBER, defaultValue: 1 }, textIndent: { type: i.PrimitiveTypes.NUMBER, defaultValue: 0 }, wordWrap: { type: i.PrimitiveTypes.BOOLEAN, defaultValue: !1 }, shrinkToFit: { type: i.PrimitiveTypes.BOOLEAN, defaultValue: !1 }, isVerticalText: { type: i.PrimitiveTypes.BOOLEAN, defaultValue: !1 }, locked: { type: i.PrimitiveTypes.BOOLEAN, defaultValue: !0 }, borderTop: { type: i.PrimitiveTypes.OBJECT }, borderLeft: { type: i.PrimitiveTypes.OBJECT }, borderRight: { type: i.PrimitiveTypes.OBJECT }, borderBottom: { type: i.PrimitiveTypes.OBJECT }, borderVertical: { type: i.PrimitiveTypes.OBJECT }, borderHorizontal: { type: i.PrimitiveTypes.OBJECT }, diagonalUp: { type: i.PrimitiveTypes.OBJECT }, diagonalDown: { type: i.PrimitiveTypes.OBJECT }, textDecoration: { type: i.PrimitiveTypes.NUMBER, defaultValue: !0 }, watermark: { type: i.PrimitiveTypes.STRING }, cellPadding: { type: i.PrimitiveTypes.STRING }, labelOptions: { type: i.PrimitiveTypes.OBJECT } } } }, e = GC.Spread.Sheets, t = function(t) {
                i.extends(o, t);

                function o(e) { t.call(this, e, i.spreadMeta.style, i.spreadMeta), this.Co = {} }
                return o.prototype.Bo = function(e) {
                    var t = this,
                        o = this.vo.properties[e];
                    return ko.computed({
                        read: function() { var o = t.Co[e]; return void 0 === o ? (this.Co[e] = t.Yl(e), this.Co[e]) : o === i.BaseMetaObject.undefinedValue ? void 0 : o },
                        write: function(n) {
                            var r = n;
                            void 0 === r ? r = i.BaseMetaObject.undefinedValue : typeof r !== o.type && (r = i.BaseMetaObject.zo(r, o.type)), t.Co[e] = r
                        },
                        owner: this
                    })
                }, o.prototype.result = function() {
                    var t = this,
                        o = new e.Style;
                    return Object.getOwnPropertyNames(this.Co).forEach(function(e) {
                        var n = t.Co[e];
                        void 0 !== n && n !== i.BaseMetaObject.indeterminateValue && (n === i.BaseMetaObject.undefinedValue && (n = void 0), o[e] = n)
                    }), o
                }, o.prototype.Yl = function(e) {}, o
            }(i.BaseMetaObject), i.StyleShadowObjectBase = t, o = function(e) {
                i.extends(t, e);

                function t(t) { e.call(this, t), this.Os = t, this.Ao() }
                return t.prototype.Yl = function(e) { if (void 0 !== this.Os && null !== this.Os) return this.Os[e] }, t
            }(t), i.StyleShadowObject = o, n = function(e) {
                i.extends(t, e);

                function t(t, i) { e.call(this, t), this.Ov = t.getActiveSheet(), void 0 === i && (i = this.Ov.getSelections()), this.Ys = i, this.Ao() }
                return t.prototype.Yl = function(e) {
                    var t, o, n, r, a, s = i.BaseMetaObject.undefinedValue;
                    for (t = 0; t < this.Ys.length; t++)
                        for (o = this.Ys[t], -1 === o.col && (o.col = 0), -1 === o.row && (o.row = 0), n = 0; n < o.rowCount; n++)
                            for (r = 0; r < o.colCount; r++)
                                if (a = this.kC(o.row + n, o.col + r, e), s === i.BaseMetaObject.undefinedValue) s = a;
                                else if (JSON.stringify(s) !== JSON.stringify(a)) return i.BaseMetaObject.indeterminateValue;
                    return s
                }, t.prototype.kC = function(e, t, o) {
                    var n, r, a;

                    function s(i) { var n, r; "locked" === o && (n = i.conditionalFormats, r = n.getRules(e, t), r.forEach(function(e) { void 0 !== e.style.locked && delete e.style.locked })) }
                    if (s(this.Ov), void 0 !== (n = this.Ov.getActualStyle(e, t)) && null !== n && !("font" === o && n.font && (r = i.util.getFromCache("defaultFont", function() { return i.util.parseFont(i.res.defaultFont) }), a = i.util.parseFont(n.font), a.fontFamily === r.fontFamily && a.fontSize === r.fontSize && a.fontStyle === r.fontStyle && a.fontWeight === r.fontWeight) || "foreColor" === o && "Text 1" === n.foreColor)) return n[o]
                }, t
            }(t), i.SpreadStyleShadowObject = n
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function() {
                function e() {}
                return e.getRangeType = function(e) { return e ? -1 === e.col && -1 === e.row ? 3 : -1 === e.col ? 1 : -1 === e.row ? 0 : 2 : -1 }, e
            }();
            i.SpreadUtility = e,
                function(e) { e[e.Column = 0] = "Column", e[e.Row = 1] = "Row", e[e.Cell = 2] = "Cell", e[e.Sheet = 3] = "Sheet", i.RangeType = e }(i.RangeType || {})
        }()
    }, function(e, t, i) {
        var o = i(2).app,
            n = GC.Spread.Sheets,
            r = GC.Spread.Sheets.Designer;
        ! function(e) {
            "use strict";
            e.spread;
            var t;
            e.spreadElement;

            function i() { var t = e.spread.getActiveSheet().currentTheme().colors(); return [{ name: "Background 1", baseColor: t.getColor("Background 1") }, { name: "Text 1", baseColor: t.getColor("Text 1") }, { name: "Background 2", baseColor: t.getColor("Background 2") }, { name: "Text 2", baseColor: t.getColor("Text 2") }, { name: "Accent 1", baseColor: t.getColor("Accent 1") }, { name: "Accent 2", baseColor: t.getColor("Accent 2") }, { name: "Accent 3", baseColor: t.getColor("Accent 3") }, { name: "Accent 4", baseColor: t.getColor("Accent 4") }, { name: "Accent 5", baseColor: t.getColor("Accent 5") }, { name: "Accent 6", baseColor: t.getColor("Accent 6") }] } e.getThemeColors = i, e.shouldModifiedHandlerExecute = !0;

            function o(i) {
                void 0 === i && (i = !1), i || (e.spread.destroy(), t.empty(), e.spread = null);
                try { e.spread = new n.Workbook(t[0]), e.spread.setSheetCount(2) /*,/*a(e.spread.getSheet(1))*/ , e.spreadElement = t, r.formulaBar.initFormulaBar(i), r.contextMenu.initContextMenu(), e.spread.commandManager().addListener("z_commandExecuted.designer", r.ribbon.updateUndoRedo) } catch (t) { return void(e.spread.notWorking = !0) } e.shouldModifiedHandlerExecute = !0;
                var o = function() { r.actions.isFileModified = !0, e.shouldModifiedHandlerExecute && (r.actions.updateWindowTitle(), e.shouldModifiedHandlerExecute = !1) };
                e.spread.bind(n.Events.CellChanged, o), e.spread.bind(n.Events.RowChanged, o), e.spread.bind(n.Events.ColumnChanged, o), e.spread.bind(n.Events.ActiveSheetChanged, o), e.spread.bind(n.Events.InvalidOperation, function(e, t) { 5 === t.invalidType && r.MessageBox.show(t.message, r.res.title, 3) }), e.spread.bind(GC.Spread.Sheets.Events.RangeChanged, function(t, i) {

                    var o = e.spread.getActiveSheet(),
                        n = o.getActiveRowIndex(),
                        a = o.getActiveColumnIndex();
                    if (0 === i.action && r.ribbon.updateRibbonAll(), 2 === i.action) {
                        if (s(), o.tables.find(n, a)) return $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0), void $(".ribbon-bar").gcuitabs("select", "tableTab");
                        $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !1), $(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0), $(".ribbon-bar").gcuitabs("select", "homeTab")
                    }
                }), e.spread.bind(GC.Spread.Sheets.Events.FloatingObjectRemoved, function(t, i) {
                    var o, r, a;
                    i.floatingObject instanceof n.Slicers.Slicer && (s(), o = e.spread.getActiveSheet(), r = o.getActiveRowIndex(), a = o.getActiveColumnIndex(), o.tables.find(r, a) ? ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0), $(".ribbon-bar").gcuitabs("select", "tableTab")) : ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0), $(".ribbon-bar").gcuitabs("select", "homeTab")))
                }), l(), r.ribbon.attachEvent(!i), c(), r.ribbon.resetSpreadNamedStyle()
            }

            function a(e) {
                var t, i, o, n, r, a, s, l, c, d, p, u;
                e.suspendPaint(), t = "GrapeCity SpreadJS", i = "This SpreadJS spreadsheet demo uses the online version of the SpreadJS Sheets Designer", o = "to showcase several of the features that SpreadJS Sheets offers.", n = "Explore the features and enter sample data directly into the cells to add formulas or charts,", r = "similar to Microsoft Excel. You can also import and export Excel files using the File menu.", a = "Excel imports/exports are handled client-side only and no data is sent to the server.", s = "Note \u2013 the JavaScript source code of this Designer is available separately for purchase,", l = "allowing you to quickly add and offer any of these menu features to your customers.", c = "Contact us.to learn more:", d = "us.sales@grapecity.com", p = "Visit the SpreadJS page:", u = "https://www.grapecity.com/en/spreadjs", e.name("About"), e.setColumnWidth(1, 350), e.setRowHeight(1, 38), e.getCell(1, 1).value(t).font("bold 26.667px Calibri"), e.setRowHeight(3, 24),
                    e.setRowHeight(4, 24), e.getCell(3, 1).value(i).font("18.67px Calibri"), e.getCell(4, 1).value(o).font("18.67px Calibri"), e.setRowHeight(5, 14), e.setRowHeight(6, 24), e.setRowHeight(7, 24), e.setRowHeight(8, 24), e.getCell(6, 1).value(n).font("18.67px Calibri"), e.getCell(7, 1).value(r).font("18.67px Calibri"), e.getCell(8, 1).value(a).font("18.67px Calibri"), e.setRowHeight(9, 14), e.setRowHeight(10, 24), e.setRowHeight(11, 24), e.getCell(10, 1).value(s).font("18.67px Calibri"), e.getCell(11, 1).value(l).font("18.67px Calibri"), e.setRowHeight(13, 24), e.setRowHeight(14, 24), e.setRowHeight(15, 24), e.getCell(14, 1).value(c).font("18.67px Calibri"), e.getCell(15, 1).value(d).font("18.67px Calibri").cellType(new GC.Spread.Sheets.CellTypes.HyperLink), e.setRowHeight(16, 24), e.setRowHeight(17, 24), e.getCell(16, 1).value(p).font("18.67px Calibri"), e.getCell(17, 1).value(u).font("18.67px Calibri").cellType(new GC.Spread.Sheets.CellTypes.HyperLink), e.resumePaint()
            }
            e.reset = o;

            function s() {
                var e = 6;
                $(".ribbon-bar>ul").find("li:gt(" + e + ")").css("display", "none"), $(".ribbon-bar>div:gt(" + e + ")").attr("aria-hidden", !0)
            }

            function l() { $(".custom-format-table").css("display", "none"), $(".custom-preview").find(".table-format-preview").css("display", "none"), r.FormatTableDialog.customTableStyle = {}, r.FormatTableDialog.currentId = 1, $(".custom-format-slicer").css("display", "none"), $(".slicer-custom-preview").find(".slicer-format-preview").css("display", "none"), r.SlicerStyleDialog.customSlicerStyle = {}, r.SlicerStyleDialog.currentId = 1 }

            function c() { e.spread.getActiveSheet() && e.spread.focus(!0) } e.setFocusToSpread = c, r.loader.ready(function() {
             t = $(".spreadWrapper .ss"), o(!0) }), r.wrapper = e
        }(r.wrapper || {})
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;

        ! function(e) {
            "use strict";

            function t() { $(".statusBar").find(".statusbar-zoom-slider").slider({ max: 400, min: 50 }) }

            function o() {
                $(".statusBar").find(".statusbar-zoom-value").click(function() {
                    var e = new i.ZoomDialog;
                    e.open()
                }), i.wrapper.spreadElement.bind("FileOpened", function(e, t) { i.ribbon.updateZoomToStatusBar() })
            }
            i.loader.ready(function() { t(), i.wrapper.spread.notWorking || o() }), i.statusBar = e
        }(i.statusBar || {})
    }, function(e, t) {
        var i = "borderpicker",
            o = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function(e) {
                o.extends(t, e);

                function t() { e.apply(this, arguments) }
                return t.prototype._create = function() {
                    var e, t, i, o;
                    this.element.addClass("gcui-borderpicker"), e = $("<div></div>"), t = $("<label></label>"), t.addClass("gcui-borderpicker-line-style-label").text(this.options.lineStyleTitle).appendTo(e), this.element.append(e), this.lC(this.element), i = $("<div></div>"), o = $("<label></label>"), o.addClass("gcui-borderpicker-line-color-label").text(this.options.borderColorTitle).appendTo(i), this.element.append(i), this.Lv(this.element), this.ts()
                }, t.prototype._setOption = function(e, t) {
                    if ("lineStyle" === e) this.options.lineStyle = t, this.mC();
                    else if ("borderColor" === e) this.options.borderColor = t, this.nC(), this.sx();
                    else if ("lineStyleTitle" === e) this.options.lineStyleTitle = t, this.element.find(".gcui-borderpicker-line-style-label").text(t);
                    else if ("borderColorTitle" === e) this.options.lineStyleTitle = t, this.element.find(".gcui-borderpicker-line-color-label").text(t);
                    else {
                        if ("colorOptions" !== e) throw "This key doesn't exist.";
                        this.options.colorOptions = t, this.oC()
                    }
                }, t.prototype.ts = function() {
                    var e = this;
                    this.element.find(".line-style").on("click.borderpicker", function(t) {
                        var i = t.target || t.srcElement,
                            o = $(i).data("lineStyle"),
                            n = GC.Spread.Sheets.LineStyle;
                        e.options.lineStyle = n[o], e.pC($(i)), e._trigger("lineStyleChanged", t, e.options.lineStyle)
                    })
                }, t.prototype.lC = function(e) {
                    var t = $("<div class='line-style-out-div'></div>"),
                        i = $("<div class='line-style-backcolor-div'></div>"),
                        n = $("<div class='line-style line-style-empty' data-line-style='empty'>None</div>"),
                        r = $("<div class='line-style line-style-dotted' data-line-style='dotted' ></div>"),
                        a = $("<div class='line-style line-style-dashed' data-line-style='dashed' ></div>"),
                        s = $("<div class='line-style line-style-dash-dot-dot' data-line-style='dashDotDot' ></div>"),
                        l = $("<div class='line-style line-style-dash-dot' data-line-style='dashDot' ></div>"),
                        c = $("<div class='line-style line-style-hair' data-line-style='hair' ></div>"),
                        d = $("<div class='line-style line-style-thin' data-line-style='thin' ></div>"),
                        p = $("<div class='line-style line-style-medium-dash-dot-dot' data-line-style='mediumDashDotDot' ></div>"),
                        u = $("<div class='line-style line-style-slanted-dash-dot' data-line-style='slantedDashDot' ></div>"),
                        h = $("<div class='line-style line-style-medium-dash-dot' data-line-style='mediumDashDot' ></div>"),
                        f = $("<div class='line-style line-style-medium-dashed' data-line-style='mediumDashed' ></div>"),
                        g = $("<div class='line-style line-style-medium' data-line-style='medium' ></div>"),
                        m = $("<div class='line-style line-style-thick' data-line-style='thick' ></div>"),
                        b = $("<div class='line-style line-style-double' data-line-style='double' ></div>");
                    n.text(o.res.borderPicker.none), i.append(n).append(r).append(a).append(s).append(l).append(c).append(d).append(p).append(u).append(h).append(f).append(g).append(m).append(b), t.append(i), e.append(t)
                }, t.prototype.Lv = function(e) {
                    var t, i = this,
                        o = $("<div></div>").addClass("gcui-borderpicker-color"),
                        n = $("<span></span>").appendTo(o);
                    $("<span></span>").addClass("gcui-borderpicker-color-preview").appendTo(n), t = $("<div></div>").addClass("gcui-borderpicker-color-popup").appendTo(o), this.k = $("<div></div>").addClass("gcui-borderpicker-color-picker").colorpicker({ valueChanged: function(e, t) { void 0 === t.color ? (i.options.borderColor = void 0, i.qC(e, void 0)) : (i.options.borderColor = t, i.qC(e, t)) }, choosedColor: function(e, t) { o.comboframe("close") }, openColorDialog: function(e, t) { o.comboframe("close") } }).appendTo(t), o.comboframe().click(function() { o.comboframe("open") }), this.k.colorpicker("option", this.options.colorOptions), e.append(o)
                }, t.prototype.oC = function() { this.element.find(".gcui-borderpicker-color").remove(), this.Lv(this.element) }, t.prototype.qC = function(e, t) { this.cw(), this.nC(), this.k.colorpicker("option", "selectedItem", this.options.borderColor), this._trigger("colorChanged", e, t) }, t.prototype.cw = function() { this.options.borderColor ? this.element.find(".gcui-borderpicker-color-preview").css("background-color", this.options.borderColor.color) : this.element.find(".gcui-borderpicker-color-preview").css("background-color", "black") }, t.prototype.sx = function() { this.cw(), this.k.colorpicker("option", "selectedItem", this.options.borderColor) }, t.prototype.nC = function() { this.options.borderColor ? this.element.find(".line-style-backcolor-div").css("background-color", this.options.borderColor.color) : this.element.find(".line-style-backcolor-div").css("background-color", "black") }, t.prototype.mC = function() {
                    var e = this;
                    this.element.find(".line-style").each(function() {
                        var t, i = $(this).data("lineStyle");
                        switch (e.options.lineStyle) {
                            case 0:
                                t = "empty";
                                break;
                            case 1:
                                t = "thin";
                                break;
                            case 2:
                                t = "medium";
                                break;
                            case 3:
                                t = "dashed";
                                break;
                            case 4:
                                t = "dotted";
                                break;
                            case 5:
                                t = "thick";
                                break;
                            case 6:
                                t = "double";
                                break;
                            case 7:
                                t = "hair";
                                break;
                            case 8:
                                t = "mediumDashed";
                                break;
                            case 9:
                                t = "dashDot";
                                break;
                            case 10:
                                t = "mediumDashDot";
                                break;
                            case 11:
                                t = "dashDotDot";
                                break;
                            case 12:
                                t = "mediumDashDotDot"
                        }
                        i === t && e.pC($(this))
                    })
                }, t.prototype.rC = function() { this.element.find(".line-style").removeClass("line-style-selected") }, t.prototype.pC = function(e) { this.rC(), e.addClass("line-style-selected") }, t.DefaultOptions = { lineStyle: 1, borderColor: { name: "Text 1", baseColor: "#000000", tint: 0, color: "rgb(0,0,0)" }, lineStyleTitle: o.res.borderPicker.lineStyleTitle, borderColorTitle: o.res.borderPicker.borderColorTitle, colorOptions: { showNoFill: !1 } }, t
            }(o.gcui.gcuiWidget);
            o.BorderPicker = e, e.prototype.options = $.extend(!0, {}, o.gcui.gcuiWidget.prototype.options, e.DefaultOptions), $.gcui.registerWidget(i, e.prototype)
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer,
            o = "colorpicker";
        ! function() {
            "use strict";
            var e = function() {
                    function e() {}
                    return e.sC = function(e) { var t = this.tC(e, !1); return t.luminosity / 240 }, e.uC = function(e, t, i) { var o, n, r, a, s; return 0 === i ? o = n = r = parseInt("" + 255 * t / 240, 10) : (s = t <= 120 ? (t * (240 + i) + 120) / 240 : t + i - (t * i + 120) / 240, a = 2 * t - s, o = parseInt("" + (255 * this.vC(a, s, e + 80) + 120) / 240, 10), n = parseInt("" + (255 * this.vC(a, s, e) + 120) / 240, 10), r = parseInt("" + (255 * this.vC(a, s, e - 80) + 120) / 240, 10)), { a: 255, r: o, g: n, b: r } }, e.tC = function(e, t) { var i, o, n, r, a, s, l, c, d, p, u, h, f; return t ? (r = e.r, a = e.g, s = e.b) : (r = parseInt(e.substring(1, 3), 16), a = parseInt(e.substring(3, 5), 16), s = parseInt(e.substring(5, 7), 16)), l = Math.max(Math.max(r, a), s), c = Math.min(Math.min(r, a), s), d = l + c, i = parseInt("" + (240 * d + 255) / 510, 10), p = l - c, 0 === p ? (o = 0, n = 160) : (o = i <= 120 ? parseInt("" + (240 * p + d / 2) / d, 10) : parseInt("" + (240 * p + (510 - d) / 2) / (510 - d), 10), u = (40 * (l - r) + p / 2) / p, h = (40 * (l - a) + p / 2) / p, f = (40 * (l - s) + p / 2) / p, n = r === l ? parseInt("" + (f - h), 10) : a === l ? parseInt("" + (80 + u - f), 10) : parseInt("" + (160 + h - u), 10), n < 0 && (n += 240), n > 240 && (n -= 240)), { luminosity: i, saturation: o, hue: n } }, e.vC = function(e, t, i) { return i < 0 && (i += 240), i > 240 && (i -= 240), i < 40 ? e + ((t - e) * i + 20) / 40 : i < 120 ? t : i < 160 ? e + ((t - e) * (160 - i) + 20) / 40 : e }, e
                }(),
                t = function() {
                    function t() { this.value = "" }
                    return t.prototype.open = function() { this.innerDialog.dialog("open"), "" === this.value ? (this.innerDialog.find(".colordialog-div-currentcolor").css("background", "rgb(0,0,0)"), this.innerDialog.find(".colordialog-div-newcolor").css("background", "rgb(0,0,0)")) : void 0 === this.value ? (this.innerDialog.find(".colordialog-div-currentcolor").css("background", "rgb(255,255,255)"), this.innerDialog.find(".colordialog-div-newcolor").css("background", "rgb(255,255,255)")) : (this.innerDialog.find(".colordialog-div-currentcolor").css("background", this.value), this.innerDialog.find(".colordialog-div-newcolor").css("background", this.value)) }, t.prototype._create = function() {
                        var e, t = this;
                        this.hls = { luminosity: 128, saturation: 0, hue: 0 }, this.isDragingLum = !1, this.isDragingHueSat = !1, this.innerDialog = $("<div title='Color' class='colordialog-div-container'></div>"), this.innerDialog.dialog({ title: i.res.colorPicker.colorDialogTitle, autoOpen: !1, resizable: !1, width: 280, modal: !0, buttons: [{ text: i.res.ok, click: function(e) { $(this).dialog("close"), t.value = "rgb(" + t.innerDialog.find(".colordialog-input-red").val() + "," + t.innerDialog.find(".colordialog-input-green").val() + "," + t.innerDialog.find(".colordialog-input-blue").val() + ")", t.Kq(e, !0) } }, { text: i.res.cancel, click: function(e) { $(this).dialog("close"), t.Kq(e, !1) } }], beforeClose: function(e, i) { e.currentTarget && t.Kq(e, !1) } }).append($("<table><tbody><tr><td><div class='colordialog-div-pickercolor-image'><span class='colordialog-span-pickercolor-mousepointer'></span></div></td><td><div class='colordialog-div-dragcolor-container'><div class='colordialog-div-dragcolor'></div><span class='colordialog-span-dragcolor-arrow'></span></div></td></tr><tr><td><table><tbody><tr><td class='red-input-label'>Red:</td><td><input class='colordialog-rgb colordialog-input-red'></input></td></tr><tr><td class='green-input-label'>Green:</td><td><input class='colordialog-rgb colordialog-input-green'></input></td></tr><tr><td class='blue-input-label'>Blue:</td><td><input class='colordialog-rgb colordialog-input-blue'></input></td></tr></tbody></table></td><td><table class='colordialog-table-newcurrentcolor'><tbody><tr><td class='new-label'>New</td></tr><tr><td><div class='colordialog-div-newcolor'></div></td></tr><tr><td><div class='colordialog-div-currentcolor'></div></td></tr><tr><td class='current-label'>Current</td></tr></tbody></table></td></tr></tbody></table>")), this.innerDialog.find(".colordialog-table-newcurrentcolor").attr("cellSpacing", "0px").attr("cellPadding", "0px"), this.innerDialog.find(".red-input-label").text(i.res.colorPicker.red), this.innerDialog.find(".green-input-label").text(i.res.colorPicker.green), this.innerDialog.find(".blue-input-label").text(i.res.colorPicker.blue), this.innerDialog.find(".new-label").text(i.res.colorPicker.newLabel), this.innerDialog.find(".current-label").text(i.res.colorPicker.currentLabel), this.innerDialog.find(".colordialog-rgb").spinner({ max: 255, min: 0, change: function() { t.wC() }, spin: function() { t.wC() } }), "" !== this.value && this.innerDialog.find(".colordialog-div-currentcolor").css("background", this.value), "" === this.value ? (e = this.innerDialog.find(".colordialog-div-dragcolor"), e.css("background-image", "linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"), e.css("background-image", "-o-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"), e.css("background-image", "-moz-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"), e.css("background-image", "-webkit-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"), e.css("background-image", "-ms-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"), e.css("background-image", "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)),  color-stop(1, rgb(0, 0, 0)))"), this.innerDialog.find(".colordialog-input-red").spinner().spinner("value", 0), this.innerDialog.find(".colordialog-input-green").spinner().spinner("value", 0), this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", 0)) : this.CA(!0, this.value), this.xC()
                    }, t.prototype.wC = function() {
                        var t, i, o, n, r, a, s = this;
                        s.isDragingLum || ("" === s.innerDialog.find(".colordialog-input-red").val() && s.innerDialog.find(".colordialog-input-red").spinner().spinner("value", 0), "" === s.innerDialog.find(".colordialog-input-green").val() && s.innerDialog.find(".colordialog-input-green").spinner().spinner("value", 0), "" === s.innerDialog.find(".colordialog-input-blue").val() && s.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", 0), t = parseInt(s.innerDialog.find(".colordialog-input-red").val()), i = parseInt(s.innerDialog.find(".colordialog-input-green").val()), o = parseInt(s.innerDialog.find(".colordialog-input-blue").val()), "" + t == "NaN" && (t = 0), "" + i == "NaN" && (i = 0), "" + o == "NaN" && (o = 0), n = "rgb(" + t + "," + i + "," + o + ")", s.CA(!0, n), r = { a: 255, r: t, g: i, b: o }, a = e.tC(r, !0), s.hls.hue = Math.floor(a.hue / 240 * 255), s.hls.luminosity = Math.floor(a.luminosity / 240 * 255), s.hls.saturation = Math.floor(a.saturation / 240 * 255), s.isDragingLum || s.isDragingHueSat || s.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", 160 - s.hls.luminosity / 255 * 160 + 4), s.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", s.hls.hue / 255 * 190 - 5).css("top", 160 - s.hls.saturation / 255 * 160 - 5))
                    }, t.prototype.xC = function() {
                        var e, t, i, o = this;
                        this.innerDialog.find(".colordialog-div-pickercolor-image").mousedown(function(e) {
                            var t, i, n, r, a, s, l;
                            o.isDragingHueSat = !0, t = e.target || e.srcElement, i = t, -1 !== i.className.indexOf("colordialog-span-pickercolor-mousepointer") ? (a = i, n = e.offsetX + parseInt(a.style.left), r = e.offsetY + parseInt(a.style.top)) : (n = e.offsetX, r = e.offsetY), s = 190, l = 160, o.hls.saturation = (l - r) / l * 255, o.hls.hue = n / s * 255, o.CA(!1, void 0), o.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", n - 5).css("top", r - 5)
                        }), $(document).mouseup(function(e) { o.isDragingHueSat = !1, o.isDragingLum = !1 }), this.innerDialog.find(".colordialog-div-pickercolor-image").mousemove(function(e) {
                            var t, i, n, r, a, s, l;
                            o.isDragingHueSat && (t = e.target || e.srcElement, i = t, -1 !== i.className.indexOf("colordialog-span-pickercolor-mousepointer") ? (a = i, n = e.offsetX + parseInt(a.style.left), r = e.offsetY + parseInt(a.style.top)) : (n = e.offsetX, r = e.offsetY), s = 190, l = 160, o.hls.saturation = (l - r) / l * 255, o.hls.hue = n / s * 255, o.CA(!1, void 0), o.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", n - 5).css("top", r - 5))
                        }), i = function(i) {
                            var n, r;
                            o.isDragingLum && (n = i.clientY - t + e, n > 160 && (n = 160), n < 0 && (n = 0), o.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", n + 4), r = 160, o.hls.luminosity = (160 - n) / r * 255, o.CA(!1, void 0))
                        }, this.innerDialog.find(".colordialog-div-dragcolor-container").mousedown(function(n) {
                            var r, a, s, l, c;
                            o.isDragingLum = !0, r = n.target || n.srcElement, a = r, -1 !== a.className.indexOf("colordialog-span-dragcolor-arrow") ? (l = a, s = n.offsetY + parseInt(l.style.top) - 8) : s = n.offsetY, s > 160 && (s = 160), s < 0 && (s = 0), o.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", s + 4), c = 160, o.hls.luminosity = (160 - s) / c * 255, o.CA(!1, void 0), e = s, t = n.clientY, $(document).on("mousemove", i)
                        })
                    }, t.prototype.Kq = function(e, t) { $(this).trigger("dialogClose", t) }, t.prototype.CA = function(t, i) {
                        var o, n, r, a, s, l, c, d, p, u, h, f;
                        i ? (r = i.split(","), a = r[0].split("("), s = r[2].split(")"), l = a[1], c = r[1], d = s[0], o = { a: 255, r: parseInt(l), g: parseInt(c), b: parseInt(d) }, t && (p = e.tC(o, !0), n = e.uC(Math.floor(p.hue / 255 * 240), Math.floor(128 / 255 * 240), Math.floor(p.saturation / 255 * 240)))) : (o = 0 === this.hls.luminosity ? { a: 255, r: 0, g: 0, b: 0 } : 255 === this.hls.luminosity ? { a: 255, r: 255, g: 255, b: 255 } : e.uC(Math.floor(this.hls.hue / 255 * 240), Math.floor(this.hls.luminosity / 255 * 240), Math.floor(this.hls.saturation / 255 * 240)), (t || 0 === this.hls.luminosity || 255 === this.hls.luminosity) && (n = e.uC(Math.floor(this.hls.hue / 255 * 240), Math.floor(128 / 255 * 240), Math.floor(this.hls.saturation / 255 * 240)))), o.r = parseInt("" + o.r, 10), o.g = parseInt("" + o.g, 10), o.b = parseInt("" + o.b, 10), this.innerDialog.find(".colordialog-input-red").spinner().spinner("value", "" + o.r), this.innerDialog.find(".colordialog-input-green").spinner().spinner("value", "" + o.g), this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", "" + o.b), u = "rgb(" + o.r + ", " + o.g + ", " + o.b + ")", this.innerDialog.find(".colordialog-div-newcolor").css("background", u), (t || 0 === this.hls.luminosity || 255 === this.hls.luminosity) && n && (n.r = parseInt("" + n.r, 10), n.g = parseInt("" + n.g, 10), n.b = parseInt("" + n.b, 10), h = "rgb(" + n.r + ", " + n.g + ", " + n.b + ")", f = this.innerDialog.find(".colordialog-div-dragcolor"), f.css("background-image", "linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"), f.css("background-image", "-o-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"), f.css("background-image", "-moz-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"), f.css("background-image", "-webkit-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"), f.css("background-image", "-ms-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"), f.css("background-image", "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)), color-stop(0.5, " + h + "), color-stop(1, rgb(0, 0, 0)))"))
                    }, t.prototype.destroy = function() { this.innerDialog && (this.innerDialog.dialog("destroy"), this.innerDialog.remove()) }, t
                }(),
                n = function(o) {
                    i.extends(n, o);

                    function n() { o.apply(this, arguments) }
                    return n.prototype._create = function() {
                        var e, i, o, n, r, a, s, l, c, d = this.options;
                        this.colorItems = [], e = $("<div class='colorpicker-outDiv'></div>"), i = this.yC(), o = this.zC(), d.showThemeColorTitle || (r = i.find("tr").get(0), $(r).css("display", "none")), d.showStandardColorTitle || (a = o.find("tr").get(0), $(a).css("display", "none"), n = $("<span class='colorpicker-horizontalseparator'></span>"), $(n).css("margin", "5px"), i.append(n), $(i).find(".colorpicker-colorcell").css("margin", "1px")), d.showOutline || e.css("border", "0px"), e.append(i, o), d.showNoFill && (s = this.AC(), e.append(s)), d.showMoreColors && (n = $("<span class='colorpicker-horizontalseparator'></span>"), l = this.BC(), e.append(n, l)), e.appendTo(this.element), e.bind("selectstart", function() { return !1 }), this.ts(), null !== this.dialog && void 0 !== this.dialog || (this.dialog = new t, this.dialog._create(), c = this, $(this.dialog).on("dialogClose", function(e, t) {
                            if (t) {
                                var i;
                                i = { color: c.dialog.value, isSetColorDirectly: !0 }, c.CC(), c.DC(c.dialog.value), c.options.value = c.dialog.value, c.options.selectedItem = { name: "", baseColor: "", tint: 0, color: c.dialog.value }, c.oo(e, i)
                            }
                        }))
                    }, n.prototype.yC = function() {
                        var e, t, i, o, n, r = this.EC(this.options.themeColors),
                            a = $("<div></div>"),
                            s = $("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"),
                            l = $("<tbody></tbody>"),
                            c = $("<tr></tr>"),
                            d = $("<td></td>");
                        for (d.attr("colspan", "10"), d.append($("<div class='colorpicker-title colorpicker-div-themecolor-title'></div>").text(this.options.themeColorsTitle)), c.append(d), l.append(c), e = 0; e < 6; e++) {
                            for (t = $("<tr></tr>"), this.colorItems[e] = [], 0 === e && t.addClass("colorpicker-themecolors-firstline"), i = 0; i < 10; i++) o = $("<td></td>"), n = $("<div></div>"), n.addClass("colorpicker-colorcell"), 0 === e ? (n.css("background", this.options.themeColors[i].baseColor), n.attr("row", "0"), n.attr("col", "" + i), this.colorItems[e][i] = { name: this.options.themeColors[i].name, baseColor: this.options.themeColors[i].baseColor, tint: 0, color: this.options.themeColors[i].baseColor }) : (n.css("background", r[5 * i + e - 1].color), n.attr("row", "" + e), n.attr("col", "" + i), this.colorItems[e][i] = { name: this.options.themeColors[i].name + " " + r[5 * i + e - 1].tint, baseColor: this.options.themeColors[i].baseColor, tint: r[5 * i + e - 1].tint, color: r[5 * i + e - 1].color }), n.append($("<div class='colorpicker-div-inner-colorcell'></div>")), o.append(n), t.append(o);
                            l.append(t)
                        }
                        return s.append(l), a.append(s), a
                    }, n.prototype.zC = function() { var e, t, i, o, n, r, a, s, l; for (this.colorItems[6] = [], e = $("<div></div>"), t = $("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"), i = $("<tbody></tbody>"), o = $("<tr></tr>"), n = $("<td></td>"), n.attr("colspan", "10"), n.append($("<div class='colorpicker-title colorpicker-div-standardcolor-title'></div>").text(this.options.standardColorsTitle)), o.append(n), i.append(o), r = $("<tr></tr>"), a = 0; a < 10; a++) s = $("<td></td>"), l = $("<div></div>"), l.css("background", this.options.standardColors[a].baseColor), l.attr("row", "6"), l.attr("col", "" + a), this.colorItems[6][a] = { name: this.options.standardColors[a].name, baseColor: this.options.standardColors[a].baseColor, tint: 0, color: this.options.standardColors[a].baseColor }, l.addClass("colorpicker-colorcell"), l.append($("<div class='colorpicker-div-inner-colorcell'></div>")), s.append(l), r.append(s); return i.append(r), t.append(i), e.append(t), e }, n.prototype.AC = function() { var e = $("<div class='colorpicker-div-nocolor'></div>"); return e.append($("<table class='colorpicker-table-nocolor'><tbody><tr><td class='colorpicker-td-nocolor-image'><div class='colorpicker-div-out-nofill' ><div class='colorpicker-div-nocolor-image'></div></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-nofill-text'>" + this.options.noFillText + "</label></td></tr></tbody></table>")), e }, n.prototype.BC = function() { var e = $("<div class='colorpicker-div-morecolors' ></div>"); return e.append($("<table class='colorpicker-table-morecolors'><tbody><tr><td class='colorpicker-td-morecolors-image'><div class='colorpicker-div-morecolor-icon'></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-morecolors-text'>" + this.options.moreColorsText + "</label></td></tr></tbody></table>")), e }, n.prototype.ts = function() {
                        var e = this;
                        this.element.find(".colorpicker-colorcell").on("mouseover.colorpicker", function(t) {
                            var i, o = t.target || t.srcElement,
                                n = o; - 1 !== n.className.indexOf("colorpicker-div-inner-colorcell") && (n = n.parentElement), "" !== e.options.value && n.style.background === e.options.value || ($(n).addClass("hover"), i = n.childNodes[0], $(i).addClass("hover"))
                        }), this.element.find(".colorpicker-colorcell").on("mousedown.colorpicker", function(t) {
                            var i, o, n, r, a, s, l = t.target || t.srcElement,
                                c = l;
                            if (-1 !== c.className.indexOf("colorpicker-div-inner-colorcell") && (c = c.parentElement), i = $(c).attr("col"), o = $(c).attr("row"), e.FC(t, e.colorItems[o][i]), !$(c).hasClass("selected")) {
                                if ($(c).removeClass("hover").addClass("selected"), n = c.childNodes[0], $(n).removeClass("hover").addClass("selected"), "" !== e.options.value)
                                    if (void 0 === e.options.value) e.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                                    else
                                        for (r = e.element.find(".colorpicker-colorcell"), a = 0; a < r.length; a++) r[a].style.background === e.options.value && ($(r[a]).removeClass("selected"), s = r[a].childNodes[0], $(s).removeClass("selected"));
                                e.options.value = e.HC(c.style.background), e.colorItems[o][i].color = e.HC(e.colorItems[o][i].color), e.options.selectedItem = e.colorItems[o][i], e.oo(t, e.colorItems[o][i])
                            }
                        }), this.element.find(".colorpicker-colorcell").on("mouseout.colorpicker", function(t) {
                            var i, o = t.target || t.srcElement,
                                n = o; - 1 !== n.className.indexOf("colorpicker-div-inner-colorcell") && (n = n.parentElement), "" !== e.options.value && n.style.background === e.options.value || ($(n).removeClass("hover"), i = n.childNodes[0], $(i).removeClass("hover"))
                        }), this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseover.colorpicker", function(t) {
                            var i = t.target || t.srcElement,
                                o = i,
                                n = e.element.find(".colorpicker-div-nocolor"),
                                r = e.element.find(".colorpicker-div-morecolors");
                            n.length > 0 && n[0].contains(o) ? n.addClass("hovered") : r.length > 0 && r[0].contains(o) && r.addClass("hovered")
                        }), this.element.find(".colorpicker-div-nocolor").on("mousedown.colorpicker", function(t) {
                            var i, o, n;
                            if (e.element.find(".colorpicker-div-out-nofill").addClass("selected"), "" !== e.options.value)
                                for (i = e.element.find(".colorpicker-colorcell"), o = 0; o < i.length; o++)
                                    if (i[o].style.background === e.options.value) { $(i[o]).removeClass("selected"), n = i[o].childNodes[0], $(n).removeClass("selected"); break } e.options.value = void 0, e.options.selectedItem = void 0, e.oo(t, void 0), e.FC(t, void 0)
                        }), this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseout.colorpicker", function(t) {
                            var i = t.target || t.srcElement,
                                o = i,
                                n = e.element.find(".colorpicker-div-nocolor"),
                                r = e.element.find(".colorpicker-div-morecolors");
                            n.length > 0 && n[0].contains(o) ? n.removeClass("hovered") : r.length > 0 && r[0].contains(o) && r.removeClass("hovered")
                        }), this.element.find(".colorpicker-div-morecolors").on("click.colorpicker", function(t) { e.IC(t), e.JC() })
                    }, n.prototype.ew = function() { this.element.find(".colorpicker-colorcell,.colorpicker-div-nocolor,.colorpicker-div-morecolors").off(".colorpicker") }, n.prototype.JC = function() { this.dialog.value = this.options.value, "" === this.dialog.value || void 0 === this.dialog.value ? this.dialog.CA(!0, "rgb(0,0,0)") : this.dialog.CA(!0, this.dialog.value), this.dialog.open() }, n.prototype.setOption = function(e, t) { this._setOption(e, t) }, n.prototype._setOption = function(e, t) { "noFillText" === e ? (this.options.noFillText = t, this.options.showNoFill && this.element.find(".colorpicker-label-nofill-text").text(t)) : "moreColorsText" === e ? (this.options.moreColorsText = t, this.options.showMoreColors && this.element.find(".colorpicker-label-morecolors-text").text(t)) : "showNoFill" === e ? (this.options.showNoFill = t, this.KC()) : "showMoreColors" === e ? (this.options.showMoreColors = t, this.KC()) : "themeColorsTitle" === e ? (this.options.themeColorsTitle = t, this.element.find(".colorpicker-div-themecolor-title").text(t)) : "standardColorsTitle" === e ? (this.options.standardColorsTitle = t, this.element.find(".colorpicker-div-standardcolor-title").text(t)) : "themeColors" === e ? (this.options.themeColors = t, this.KC()) : "standardColors" === e ? (this.options.standardColors = t, this.KC()) : "value" === e ? (t = this.HC(t), this.DC(t), this.options.value = t, this.options.selectedItem = { name: "", baseColor: "", tint: 0, color: t }) : "selectedItem" === e ? void 0 === t || null === t ? (this.CC(), this.options.selectedItem = t, this.options.value = t) : (t.color = this.HC(t.color), this.LC(t), this.options.selectedItem = t, this.options.value = this.options.selectedItem.color) : "showThemeColorTitle" === e ? (this.options.showThemeColorTitle = t, this.KC()) : "showStandardColorTitle" === e ? (this.options.showStandardColorTitle = t, this.KC()) : "showOutline" === e && (this.options.showOutline = t, this.KC()) }, n.prototype.KC = function() { this.ew(), this.element.empty(), this._create() }, n.prototype.HC = function(e) { return $("<span></span>").css("background-color", e).css("background-color") }, n.prototype.DC = function(e) {
                        var t, i, o, n;
                        if ("" !== this.options.value)
                            if (void 0 === this.options.value) this.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                            else
                                for (t = this.element.find(".colorpicker-colorcell"), i = 0; i < t.length; i++)
                                    if (t[i].style.background === this.options.value) { $(t[i]).removeClass("selected"), o = t[i].childNodes[0], $(o).removeClass("selected"); break } if ("" !== e)
                            if (void 0 === e) this.element.find(".colorpicker-div-out-nofill").addClass("selected");
                            else
                                for (t = this.element.find(".colorpicker-colorcell"), i = 0; i < t.length; i++)
                                    if (t[i].style.background === e) { $(t[i]).addClass("selected"), n = t[i].childNodes[0], $(n).addClass("selected"); break }
                    }, n.prototype.CC = function() {
                        var e, t, i, o, n, r, a;
                        if (null !== this.options.selectedItem)
                            if (void 0 === this.options.selectedItem) this.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                            else if (e = this.element.find(".colorpicker-colorcell"), null !== this.options.selectedItem.name && void 0 !== this.options.selectedItem.name) {
                            for (o = -1, n = -1, r = 0; r < this.colorItems.length; r++) {
                                for (a = 0; a < this.colorItems[r].length; a++)
                                    if (this.colorItems[r][a].name === this.options.selectedItem.name) { o = r, n = a; break } if (-1 !== o && -1 !== n) break
                            }
                            for (t = 0; t < e.length; t++)
                                if ($(e[t]).attr("row") === "" + o && $(e[t]).attr("col") === "" + n) { $(e[t]).removeClass("selected"), i = e[t].childNodes[0], $(i).removeClass("selected"); break }
                        } else
                            for (t = 0; t < e.length; t++)
                                if (e[t].style.background === this.options.selectedItem.color && $(e[t]).hasClass("selected")) { $(e[t]).removeClass("selected"), i = e[t].childNodes[0], $(i).removeClass("selected"); break }
                    }, n.prototype.LC = function(e) {
                        var t, i, o, n, r, a, s;
                        if (this.CC(), "" !== e)
                            if (void 0 === e) this.element.find(".colorpicker-div-out-nofill").addClass("selected");
                            else if (t = this.element.find(".colorpicker-colorcell"), null !== e.name && void 0 !== e.name) {
                            for (n = -1, r = -1, a = 0; a < this.colorItems.length; a++) {
                                for (s = 0; s < this.colorItems[a].length; s++)
                                    if (this.colorItems[a][s].name === e.name) { n = a, r = s; break } if (-1 !== n && -1 !== r) break
                            }
                            for (i = 0; i < t.length; i++)
                                if ($(t[i]).attr("row") === "" + n && $(t[i]).attr("col") === "" + r) { $(t[i]).addClass("selected"), o = t[i].childNodes[0], $(o).addClass("selected"); break }
                        } else
                            for (i = 0; i < t.length; i++)
                                if (t[i].style.background === e.color) { $(t[i]).addClass("selected"), o = t[i].childNodes[0], $(o).addClass("selected"); break }
                    }, n.prototype.oo = function(e, t) { this._trigger("valueChanged", e, t) }, n.prototype.IC = function(e) { this._trigger("openColorDialog", e) }, n.prototype.FC = function(e, t) { this._trigger("choosedColor", e, t) }, n.prototype.EC = function(t) {
                        var i, o, n, r, a, s, l, c, d = [];
                        for (i = 0; i < t.length; i++) d.push(t[i].baseColor);
                        for (o = 5, n = [], r = [-5, -15, -25, -35, -50], a = [-10, -25, -50, -75, -90], s = [80, 60, 40, -25, -50], i = 0; i < 10; i++)
                            for (l = e.sC(d[i]), c = 0; c < 5; c++) 1 === l ? n.push({ color: this.MC(d[i], r[c]), tint: r[c] }) : l >= .8 ? n.push({ color: this.MC(d[i], a[c]), tint: a[c] }) : 0 === l ? n.push({ color: this.MC(d[i], Math.abs(r[o - c - 1])), tint: Math.abs(r[o - c - 1]) }) : l <= .2 ? n.push({ color: this.MC(d[i], Math.abs(a[o - c - 1])), tint: Math.abs(a[o - c - 1]) }) : n.push({ color: this.MC(d[i], s[c]), tint: s[c] });
                        return n
                    }, n.prototype.MC = function(t, i) { var o, n, r; return 0 === (i /= 100) ? t : (o = e.tC(t, !1), n = parseInt("" + (i > 0 ? (240 - o.luminosity) * i : o.luminosity * i), 10), r = e.uC(o.hue, o.luminosity + n, o.saturation), "rgb(" + r.r + ", " + r.g + ", " + r.b + ")") }, n.prototype.destroy = function() { this.ew(), this.element.empty(), this.dialog && this.dialog.destroy() }, n.DefaultOptions = { themeColors: [{ name: "text 1", baseColor: "#FFFFFF" }, { name: "background 1", baseColor: "#000000" }, { name: "text 2", baseColor: "#E7E6E6" }, { name: "background 2", baseColor: "#44546A" }, { name: "accent 1", baseColor: "#5B9BD5" }, { name: "accent 2", baseColor: "#ED7D31" }, { name: "accent 3", baseColor: "#8064A2" }, { name: "accent 4", baseColor: "#4BACC6" }, { name: "accent 5", baseColor: "#F79646" }, { name: "accent 6", baseColor: "#0000FF" }], themeColorsTitle: i.res.colorPicker.themeColorsTitle, standardColors: [{ baseColor: "#C00000" }, { baseColor: "#FF0000" }, { baseColor: "#FFC000" }, { baseColor: "#FFFF00" }, { baseColor: "#92D050" }, { baseColor: "#00B050" }, { baseColor: "#00B0F0" }, { baseColor: "#0070C0" }, { baseColor: "#002060" }, { baseColor: "#7030A0" }], standardColorsTitle: i.res.colorPicker.standardColorsTitle, showNoFill: !0, noFillText: i.res.colorPicker.noFillText, showMoreColors: !0, moreColorsText: i.res.colorPicker.moreColorsText, value: "", showThemeColorTitle: !0, showStandardColorTitle: !0, showOutline: !0 }, n
                }(i.gcui.gcuiWidget);
            i.ColorPicker = n, n.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, n.DefaultOptions), $.gcui.registerWidget(o, n.prototype), i.ColorDailog = t
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function(e) {
                i.extends(t, e);

                function t() { e.apply(this, arguments) }
                return t.prototype._create = function() {
                    var e, i = this;
                    this.NC = t.OC++,
                        this.element.addClass("gcui-comboframe").addClass("ui-state-default"), e = $(this.element.children()[0]).addClass("gcui-comboframe-content"), this.PC = $(this.element.children()[1]).addClass("gcui-comboframe-dropdown"), this.PC.gcuipopup({ autoHide: !0, ensureOutermost: !0, hidden: function() { i.element.removeClass("ui-state-active"), i.Hq.removeClass("ui-state-active") } }), this.Hq = $("<button></button>").addClass("gcui-comboframe-button").appendTo(this.element).button({ icons: { secondary: "ui-icon-triangle-1-s" } }), this.element.on("mouseenter.gcui-comboframe", function() { i.element.addClass("ui-state-hover") }).on("mouseleave.gcui-comboframe", function() { i.element.removeClass("ui-state-hover") }), this.Hq.on("click.gcui-comboframe", function() { i.Hq.addClass("ui-state-active"), i.open() }), e.on("focus.gcui-comboframe", function() { i.element.addClass("ui-state-focus") }).on("blur.gcui-comboframe", function() { i.element.removeClass("ui-state-focus") })
                }, t.prototype.open = function() { this.PC.gcuipopup("show", { of: this.element, my: "left top", at: "left bottom" }), this.element.addClass("ui-state-active") }, t.prototype.close = function() { this.PC.gcuipopup("hide") }, t.widgetName = "comboframe", t.defaultOptions = {}, t.OC = 0, t
            }(i.gcui.gcuiWidget);
            i.ComboFrame = e, e.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, e.defaultOptions), $.gcui.registerWidget(e.widgetName, e.prototype)
        }()
    }, function(e, t) {
        var i = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function(e) {
                i.extends(t, e);

                function t() { e.apply(this, arguments) }
                return t.prototype.family = function(e) { return void 0 === e ? this.QC : (this.QC !== e && (this.QC = e, this.RC()), this) }, t.prototype.size = function(e) { return void 0 === e ? this.uq : (this.uq !== e && (this.uq = e, this.RC()), this) }, t.prototype.style = function(e) { return void 0 === e ? this.Os : (this.Os !== e && (this.Os = e, this.RC()), this) }, t.prototype.weight = function(e) { return void 0 === e ? this.SC : (this.SC !== e && (this.SC = e, this.RC()), this) }, t.prototype.color = function(e) { return void 0 === e ? this.TC : (this.TC = e, this.options.color = e, this.RC(), this) }, t.prototype.underline = function(e) { return void 0 === e ? this.yA : (this.yA !== e && (this.yA = e, this.RC()), this) }, t.prototype.doubleUnderline = function(e) { return void 0 === e ? this.zA : (this.zA !== e && (this.zA = e, this.RC()), this) }, t.prototype.strikethrough = function(e) { return void 0 === e ? this.AA : (this.AA !== e && (this.AA = e, this.RC()), this) }, t.prototype.colorOption = function(e, t) { return void 0 === t ? this.k.colorpicker("option", e) : (this.k.colorpicker("option", e, t), this) }, t.prototype._create = function() {
                    this.NC = t.OC++, this.element.addClass("gcui-fontpicker"), this.UC("family", this.options.families, this.options.familyLabelText), this.UC("style", this.options.styles, this.options.styleLabelText), this.UC("size", this.options.size, this.options.sizeLabelText), this.UC("weight", this.options.weights, this.options.weightLabelText);
                    var e = $("<div></div>").addClass("gcui-fontpicker-group-others").addClass("gcui-fontpicker-group");
                    this.options.isColorVisible && ($("<label></label>").addClass("gcui-fontpicker-group-label").text(this.options.colorLabelText).appendTo(e), this.Lv(e)), this.VC(e), e.append($('<div class="clear-float"></div>')), this.WC(e), this.XC(e), this.element.append(e)
                }, t.prototype._setOption = function(e, t) {
                    if ("customFontStyle" === e) {
                        this.options.customFontStyle = t;
                        for (var i in this.options.customFontStyle)
                            if ("disabled" === this.options.customFontStyle[i]) switch (i) {
                                case "family":
                                    $("#gcui-fontpicker-input-family-" + this.NC).attr("disabled", "disabled"), $("#gcui-fontpicker-select-family-" + this.NC).attr("disabled", "disabled");
                                    break;
                                case "size":
                                    $("#gcui-fontpicker-input-size-" + this.NC).attr("disabled", "disabled"), $("#gcui-fontpicker-select-size-" + this.NC).attr("disabled", "disabled");
                                    break;
                                case "weight":
                                    $("#gcui-fontpicker-input-weight-" + this.NC).attr("disabled", "disabled"), $("#gcui-fontpicker-select-weight-" + this.NC).attr("disabled", "disabled");
                                    break;
                                case "style":
                                    $("#gcui-fontpicker-input-style-" + this.NC).attr("disabled", "disabled"), $("#gcui-fontpicker-select-style-" + this.NC).attr("disabled", "disabled")
                            }
                    }
                }, t.prototype.UC = function(e, i, o) {
                    var n, r, a, s, l, c = this,
                        d = $("<div></div>").addClass("gcui-fontpicker-group").addClass("gcui-fontpicker-picker-group").addClass("gcui-fontpicker-group-" + e),
                        p = "gcui-fontpicker-input-" + e + "-" + this.NC;
                    if ($("<lable></lable>").attr("for", p).addClass("gcui-fontpicker-group-label").text(o).appendTo(d), n = $("<input>").attr({ id: p, name: e, type: "text" }).addClass("ui-widget ui-widget-content").addClass("gcui-fontpicker-input-" + e), d.append(n), r = "gcui-fontpicker-select-" + e + "-" + this.NC, a = $("<select></select>").attr({ id: r, name: e + "-list", size: 6 }).addClass("ui-widget ui-widget-content").addClass("gcui-fontpicker-select-" + e), "weight" === e && a.attr("size", 8), Array.isArray(i))
                        for (s = 0; s < i.length; s++) a.append($("<option></option>").val(i[s]).text(i[s]));
                    else
                        for (l in i) a.append($("<option></option>").val(l).text(i[l]));
                    a.on("change.gcui-fontpicker", function(o) {
                        var r = a.val();
                        n.val(t.YC(i, r)), c[e]() !== r && (c[e](r), c.qC(o, e, r))
                    }), n.on("keyup.gcui-fontpicker", function(o) {
                        var r = t.ZC(i, n.val());
                        void 0 !== r && (a.val(r), c[e]() !== r && (c[e](r), c.qC(o, e, r)))
                    }), n.on("blur.gcui-fontpicker", function(o) {
                        var r = a.val() || "";
                        n.val(t.YC(i, r)), c[e]() !== r && (c[e](r), c.qC(o, e, r))
                    }), d.append(a), this.element.append(d)
                }, t.prototype.Lv = function(e) {
                    var t, i = this,
                        o = $("<div></div>").addClass("gcui-fontpicker-color"),
                        n = $("<span></span>").appendTo(o);
                    $("<span></span>").addClass("gcui-fontpicker-color-preview").appendTo(n), t = $("<div></div>").addClass("gcui-fontpicker-color-popup").appendTo(o), i.k = $("<div></div>").addClass("gcui-fontpicker-color-picker").colorpicker({ valueChanged: function(e, t) { void 0 === t.color ? (i.TC = void 0, i.qC(e, "color", void 0)) : (i.TC = t, i.qC(e, "color", t)) }, choosedColor: function(e, t) { o.comboframe("close") }, openColorDialog: function(e, t) { o.comboframe("close") } }).appendTo(t), o.comboframe().click(function() { o.comboframe("open") }), e.append(o)
                }, t.prototype.VC = function(e) {
                    var t = this,
                        i = $("<div></div>").addClass("hidden"),
                        o = "gcui-fontpicker-normal-font-" + this.NC;
                    $("<input>").attr("type", "checkbox").attr("id", o).addClass("gcui-fontpicker-normal-font").click(function(e) { this.checked && (t.QC && (t.QC = null, t.qC(e, "family", null)), t.Os && (t.Os = null, t.qC(e, "style", null)), t.uq && (t.uq = null, t.qC(e, "size", null)), t.SC && (t.SC = null, t.qC(e, "weight", null)), t.TC && (t.TC = null, t.qC(e, "color", null)), t.RC()) }).appendTo(i), $("<label></label>").attr("for", o).text(this.options.normalFontLabelText).appendTo(i), e.append(i)
                }, t.prototype.XC = function(e) {
                    var t = $("<fieldset></fieldset>").addClass("ui-widget-content");
                    $("<legend></legend>").text(this.options.previewLabelText).appendTo(t), $("<div></div>").addClass("gcui-fontpicker-preview-container").append($("<span></span>").text(this.options.previewText).addClass("gcui-fontpicker-preview")).appendTo(t), e.append(t)
                }, t.prototype.WC = function(e) {
                    var t, o, n, r = this,
                        a = "effects-underline",
                        s = "effects-double-underline",
                        l = "effects-strikethrough",
                        c = $("<fieldset></fieldset>").addClass("ui-widget-content");
                    $("<legend></legend>").text(i.res.fontPicker.effects).appendTo(c), t = $("<div></div>").addClass("gcui-fontpicker-effects-container").appendTo(c), o = $("<div></div>"), n = $("<div></div>"), $("<input>").attr({ id: a, type: "checkbox" }).addClass("effects-underline").click(function(e) { r.yA = r.element.find(".effects-underline").prop("checked"), r.qC(e, "underline", r.yA), r.$C("underline", r.yA), r.yA && r.zA && (r.zA = !1, r.qC(e, "doubleUnderline", r.zA), r.$C("double-underline", r.zA)) }).appendTo(o), $("<label>").text(i.res.fontPicker.underline).attr("for", a).appendTo(o), $("<input>").attr({ id: l, type: "checkbox" }).addClass("effects-strikethrough").click(function(e) { r.AA = r.element.find(".effects-strikethrough").prop("checked"), r.qC(e, "strikethrough", r.AA) }).appendTo(o), $("<label>").text(i.res.fontPicker.strikethrough).attr("for", l).appendTo(o), $("<input>").attr({ id: s, type: "checkbox" }).addClass("effects-double-underline").click(function(e) { r.zA = r.element.find(".effects-double-underline").prop("checked"), r.qC(e, "doubleUnderline", r.zA), r.$C("double-underline", r.zA), r.yA && r.zA && (r.yA = !1, r.qC(e, "underline", r.yA), r.$C("underline", r.yA)) }).appendTo(n), $("<label>").text(i.res.fontPicker.doubleUnderline).attr("for", s).appendTo(n), o.appendTo(t), n.appendTo(t), e.append(c)
                }, t.prototype.RC = function() {
                    var e = this;
                    e.cw(), e.options.isColorVisible && e.k.colorpicker("option", "selectedItem", e.TC), e._C(e.QC), e.aD("style", e.options.styles, e.Os), e.aD("size", e.options.size, e.uq), e.aD("weight", e.options.weights, e.SC), e.$C("underline", e.yA), e.$C("double-underline", e.zA), e.$C("strikethrough", e.AA), e.bD()
                }, t.prototype._C = function(e) {
                    var t, i, o, n;
                    e.match(/^["'].*["']$/) && (e = e.substring(1, e.length - 1)), o = RegExp("^(.*,s*)?[\"']?" + e + "[\"']?s*(,.*)?$");
                    for (n in this.options.families)
                        if (o.test(n)) { t = this.options.families[n], i = n; break } t && i ? (this.element.find(".gcui-fontpicker-input-family").val(t), this.element.find(".gcui-fontpicker-select-family").val(i)) : (this.element.find(".gcui-fontpicker-input-family").val(""), this.element.find(".gcui-fontpicker-select-family").get(0).selectedIndex = -1)
                }, t.prototype.$C = function(e, t) { this.element.find(".effects-" + e).prop("checked", t) }, t.prototype.aD = function(e, i, o) {
                    var n = t.YC(i, o);
                    this.element.find(".gcui-fontpicker-input-" + e).val(n), this.element.find(".gcui-fontpicker-select-" + e).val(o)
                }, t.prototype.bD = function() { this.QC || this.Os || this.uq || this.SC || this.TC ? this.element.find(".gcui-fontpicker-normal-font").prop("checked", !1) : this.element.find(".gcui-fontpicker-normal-font").prop("checked", !0) }, t.prototype.cw = function() {
                    var e, t, i = this.element.find(".gcui-fontpicker-preview");
                    this.TC ? (this.element.find(".gcui-fontpicker-color-preview").css("background-color", this.TC.color), i.css("color", this.TC.color)) : (this.element.find(".gcui-fontpicker-color-preview").css("background-color", "transparent"), i.css("color", "black")), e = "", this.yA && !this.zA && (e += "underline "), this.AA && (e += "line-through"), i.css("text-decoration", e), this.zA && !this.yA ? i.css("border-bottom", "double") : i.css("border-bottom", "none"), t = "", this.Os && (t += this.Os + " "), this.SC && (t += this.SC + " "), this.uq ? t += this.uq + "pt " : t += this.options.defaultSize + "pt ", this.QC ? t += this.QC + "," + this.options.alternativeFonts : t += this.options.alternativeFonts, i.css("font", t)
                }, t.YC = function(e, t) { return Array.isArray(e) ? t : e[t] }, t.ZC = function(e, t) {
                    var i, o, n, r;
                    if (Array.isArray(e)) return t;
                    if ("" === t) return t;
                    for (t = t.toLocaleLowerCase(), i = Object.getOwnPropertyNames(e), o = 0; o < i.length; o++)
                        if (n = i[o], r = e[n].toLocaleLowerCase(), 0 === r.indexOf(t)) return n
                }, t.prototype.qC = function(e, t, i) { this.cw(), (this.QC || this.Os || this.uq || this.SC || this.TC || this.yA || this.zA || this.AA) && this.element.find(".gcui-fontpicker-normal-font").prop("checked", !1), this._trigger("changed", e, { name: t, value: i }) }, t.widgetName = "fontpicker", t.defaultOptions = { familyLabelText: i.res.fontPicker.familyLabelText, styleLabelText: i.res.fontPicker.styleLabelText, sizeLabelText: i.res.fontPicker.sizeLabelText, weightLabelText: i.res.fontPicker.weightLabelText, colorLabelText: i.res.fontPicker.colorLabelText, normalFontLabelText: i.res.fontPicker.normalFontLabelText, previewLabelText: i.res.fontPicker.previewLabelText, previewText: i.res.fontPicker.previewText, families: i.res.fontPicker.fontFamilies, styles: i.res.fontPicker.fontStyles, size: [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72], weights: i.res.fontPicker.fontWeights, alternativeFonts: i.res.fontPicker.alternativeFonts, defaultSize: i.res.fontPicker.defaultSize, isColorVisible: !0, customFontStyle: { family: !0, style: !0, size: !0, weight: !0 } }, t.OC = 0, t
            }(i.gcui.gcuiWidget);
            i.FontPicker = e, e.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, e.defaultOptions), $.gcui.registerWidget(e.widgetName, e.prototype)
        }()
    }, function(e, t) {
        var i = "sliderpanel",
            o = 30,
            n = GC.Spread.Sheets.Designer;
        ! function() {
            "use strict";
            var e = function(e) {
                n.extends(t, e);

                function t() { e.apply(this, arguments) }
                return t.prototype._create = function() {
                    this.cD = n.wrapper.spreadElement, this.dD = $(".slider-panel-handler"), this.eD = "mousedown.resizeStart", this.fD = "mouseup.resizeEnd", this.gD = "mousemove.continueResize", this.hD = !1, this.hl = 0, this.iD = 0;
                    var e = this.element;
                    this.jD = $("<div>").addClass("slider-panel-subPanel slider-panel-panel1").appendTo(e), this.kD = $("<div>").addClass("slider-panel-subPanel-spliter").appendTo(e), this.lD = $("<div>").addClass("slider-panel-subPanel slider-panel-panel2").appendTo(e), this.mD = $("<div>").addClass("slider-panel-guidesline").appendTo(e), this.ts(), this.jD.hide(), this.kD.hide(), this.lD.hide()
                }, t.prototype._setOption = function(e, t) {}, t.prototype.ts = function() {
                    var e = this;
                    this.dD.bind(this.eD, function(t) {
                        e.iD = t.pageX, e.hD || ($(document).bind(e.gD, function(t) {
                            var i = $(n.util.getCanvas(n.wrapper.spread)).offset();
                            e.mD.css("display", "inline-block"), e.mD.offset({ left: t.pageX, top: i.top })
                        }).bind(e.fD, function(t) { $(document).unbind(e.gD), $(document).unbind(e.fD), e.mD.css("display", "none"), e.iD = t.pageX - e.iD, e.nD(e.iD), e.hD = !1 }), e.hD = !0)
                    }), $(n).bind("layoutChanged", function() { e.nD() })
                }, t.prototype.nD = function(e) {
                    var t, i, r, a, s = $(".content"),
                        l = this.element,
                        c = $(".content").children(".fill-spread-content").height(),
                        d = this.jD,
                        p = this.lD,
                        u = this.kD,
                        h = l.is(":visible"),
                        f = d.is(":visible"),
                        g = p.is(":visible"),
                        m = u.is(":visible");
                    if (h) {
                        if (e || (e = 0), t = parseInt(l.css("width")), isNaN(t)) return;
                        t -= e, i = 0, g && (i = p.width()), t < i && (t = i), r = $(window).width() - t - this.hl, r < o && (r = o, t = $(window).width() - r - this.hl), s.css("width", r), n.wrapper.spreadElement.css("width", r), l.css("width", t), a = 0, m && (a = 2 * parseInt(u.css("border-left-width"))), g && f ? d.width(t - p.width() - a) : f && d.width(t), n.wrapper.spread.refresh()
                    }
                    s.css("height", c)
                }, t.prototype.oD = function() {
                    var e, t, i, o = 0,
                        r = this.jD,
                        a = this.lD,
                        s = this.dD,
                        l = this.kD;
                    r.is(":visible") && (o += r.width()), a.is(":visible") && (o += a.width()), l.is(":visible") && (o += 2 * parseInt(l.css("border-left-width"))), (e = $(window).width()) && !isNaN(e) && (this.hl = 0, s.is(":visible") && (t = parseInt(s.css("border-width")), isNaN(t) || (this.hl += 2 * t)), i = 1, this.hl += 2 * i, this.cD.css({ display: "inline-block", width: e - this.hl - o + "px" }), n.wrapper.spread.refresh(), this.element.css({ display: "inline-block", width: o + "px", border: i + "px solid lightgray" }))
                }, t.prototype.open = function(e) {
                    var t = this.jD,
                        i = this.lD;
                    "panel1" === e ? (t.show(), this.dD.show()) : "panel2" === e && (i.show(), this.kD.show()), this.element.show(), this.oD()
                }, t.prototype.close = function(e) {
                    var t, i = this.jD,
                        o = this.lD;
                    "panel1" === e ? (i.hide(), this.dD.hide()) : "panel2" === e && (o.hide(), this.kD.hide()), this.oD(), i.is(":visible") || o.is(":visible") || (this.element.hide(), t = $(".content"), t.css("width", "100%"), this.cD.css("width", "100%")), n.wrapper.spread.refresh()
                }, t.prototype.getContainer = function(e) { return "panel1" === e ? this.jD : "panel2" === e ? this.lD : void 0 }, t
            }(n.gcui.gcuiWidget);
            n.SliderPanel = e, e.prototype.options = $.extend(!0, {}, n.gcui.gcuiWidget.prototype.options, e.DefaultOptions), $.gcui.registerWidget(i, e.prototype)
        }()
    }, function(e, t, i) {
        ! function() {
            "use strict";
            i(5), i(10), i(11), i(6), i(9), i(7), i(8)
        }()
    }])
});